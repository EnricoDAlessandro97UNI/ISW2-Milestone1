{"sha":"5d282dceae140577b97a12db5b2b531c7d84e985","node_id":"MDY6Q29tbWl0NDc4NTkyNTI2OjVkMjgyZGNlYWUxNDA1NzdiOTdhMTJkYjViMmI1MzFjN2Q4NGU5ODU=","commit":{"author":{"name":"Matteo Merli","email":"mmerli@apache.org","date":"2017-05-04T08:27:44Z"},"committer":{"name":"eolivelli","email":"eolivelli@apache.org","date":"2017-05-04T08:27:44Z"},"message":"BOOKKEEPER-1045: Execute tests in different JVM processes\n\nThe current Maven Surefire configuration is using:\n```xml\n<forkMode>always</forkMode>\n```\n\nThis is a deprecated config and apparently it's not creating new processes for each test as intended.\n\nCurrently the tests are leaking a big number of files and threads due to several reasons:\n * Tests that instantiate bookies and call shutdown() without calling start() before are creating and initializing the ledger storage but not closing it, leaking threads and several fds\n  * ZooKeeperClient sometimes doesn't shutdown the zk handle if the test completes too quickly, leaking sockets.\n * Several tests are passing bad config, so the bookie/client start gets exception (on purpose) and then doesn't clean up some partial objects.\n * ...\n\nThat make running the test suite to be dependent on ulimit of the machine.\n\nUntil we can fix (almost) all the test to do proper cleanup, we should make maven to run tests in separated processes.\n\nAuthor: Matteo Merli <mmerli@apache.org>\n\nReviewers: Enrico Olivelli<eolivelli@apache.org>, Jia Zhai <zhaijia@apache.org>\n\nCloses #135 from merlimat/bk-1045-test-forks","tree":{"sha":"37172a5ad2233a55e23d9b58ff54b1e3be8e1954","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/git/trees/37172a5ad2233a55e23d9b58ff54b1e3be8e1954"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/git/commits/5d282dceae140577b97a12db5b2b531c7d84e985","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/commits/5d282dceae140577b97a12db5b2b531c7d84e985","html_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/commit/5d282dceae140577b97a12db5b2b531c7d84e985","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/commits/5d282dceae140577b97a12db5b2b531c7d84e985/comments","author":{"login":"merlimat","id":62500,"node_id":"MDQ6VXNlcjYyNTAw","avatar_url":"https://avatars.githubusercontent.com/u/62500?v=4","gravatar_id":"","url":"https://api.github.com/users/merlimat","html_url":"https://github.com/merlimat","followers_url":"https://api.github.com/users/merlimat/followers","following_url":"https://api.github.com/users/merlimat/following{/other_user}","gists_url":"https://api.github.com/users/merlimat/gists{/gist_id}","starred_url":"https://api.github.com/users/merlimat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/merlimat/subscriptions","organizations_url":"https://api.github.com/users/merlimat/orgs","repos_url":"https://api.github.com/users/merlimat/repos","events_url":"https://api.github.com/users/merlimat/events{/privacy}","received_events_url":"https://api.github.com/users/merlimat/received_events","type":"User","site_admin":false},"committer":{"login":"eolivelli","id":9469110,"node_id":"MDQ6VXNlcjk0NjkxMTA=","avatar_url":"https://avatars.githubusercontent.com/u/9469110?v=4","gravatar_id":"","url":"https://api.github.com/users/eolivelli","html_url":"https://github.com/eolivelli","followers_url":"https://api.github.com/users/eolivelli/followers","following_url":"https://api.github.com/users/eolivelli/following{/other_user}","gists_url":"https://api.github.com/users/eolivelli/gists{/gist_id}","starred_url":"https://api.github.com/users/eolivelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eolivelli/subscriptions","organizations_url":"https://api.github.com/users/eolivelli/orgs","repos_url":"https://api.github.com/users/eolivelli/repos","events_url":"https://api.github.com/users/eolivelli/events{/privacy}","received_events_url":"https://api.github.com/users/eolivelli/received_events","type":"User","site_admin":false},"parents":[{"sha":"057af8dbce6c08794eb8b46ca52ca13f222d9bbb","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/commits/057af8dbce6c08794eb8b46ca52ca13f222d9bbb","html_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/commit/057af8dbce6c08794eb8b46ca52ca13f222d9bbb"}],"stats":{"total":2,"additions":1,"deletions":1},"files":[{"sha":"3a7a77055cd6d2d087a1c8add7d8ddef0f716186","filename":"pom.xml","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/blob/5d282dceae140577b97a12db5b2b531c7d84e985/pom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/raw/5d282dceae140577b97a12db5b2b531c7d84e985/pom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/contents/pom.xml?ref=5d282dceae140577b97a12db5b2b531c7d84e985","patch":"@@ -74,7 +74,7 @@\n         <configuration>\n           <argLine>-Xmx2G -Djava.net.preferIPv4Stack=true</argLine>\n \t  <redirectTestOutputToFile>true</redirectTestOutputToFile>\n-\t  <forkMode>always</forkMode>\n+\t  <reuseForks>false</reuseForks>\n \t  <forkedProcessTimeoutInSeconds>1800</forkedProcessTimeoutInSeconds>\n         </configuration>\n       </plugin>"}]}