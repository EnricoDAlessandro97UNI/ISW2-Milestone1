{"sha":"d96a2db912278e3d88ed59d8d3e15b62bc37ffd4","node_id":"MDY6Q29tbWl0NDc4NTkyNTI2OmQ5NmEyZGI5MTIyNzhlM2Q4OGVkNTlkOGQzZTE1YjYyYmMzN2ZmZDQ=","commit":{"author":{"name":"Matteo Merli","email":"mmerli@yahoo-inc.com","date":"2016-02-09T07:32:28Z"},"committer":{"name":"Sijie Guo","email":"sijie@apache.org","date":"2016-02-09T07:32:28Z"},"message":"BOOKKEEPER-886: Allow to disable ledgers operation throttling\n\nAuthor: Matteo Merli <mmerli@yahoo-inc.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #7 from merlimat/bk-886-disable-throttling","tree":{"sha":"143fc5fe4da5045e9ac8d07ecef9a2be3e66d985","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/git/trees/143fc5fe4da5045e9ac8d07ecef9a2be3e66d985"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/git/commits/d96a2db912278e3d88ed59d8d3e15b62bc37ffd4","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/commits/d96a2db912278e3d88ed59d8d3e15b62bc37ffd4","html_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/commit/d96a2db912278e3d88ed59d8d3e15b62bc37ffd4","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/commits/d96a2db912278e3d88ed59d8d3e15b62bc37ffd4/comments","author":{"login":"merlimat","id":62500,"node_id":"MDQ6VXNlcjYyNTAw","avatar_url":"https://avatars.githubusercontent.com/u/62500?v=4","gravatar_id":"","url":"https://api.github.com/users/merlimat","html_url":"https://github.com/merlimat","followers_url":"https://api.github.com/users/merlimat/followers","following_url":"https://api.github.com/users/merlimat/following{/other_user}","gists_url":"https://api.github.com/users/merlimat/gists{/gist_id}","starred_url":"https://api.github.com/users/merlimat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/merlimat/subscriptions","organizations_url":"https://api.github.com/users/merlimat/orgs","repos_url":"https://api.github.com/users/merlimat/repos","events_url":"https://api.github.com/users/merlimat/events{/privacy}","received_events_url":"https://api.github.com/users/merlimat/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"node_id":"MDQ6VXNlcjEyMTc4NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"sha":"63a2a91eba191e92a1902cf5400325dcf4d36089","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/commits/63a2a91eba191e92a1902cf5400325dcf4d36089","html_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/commit/63a2a91eba191e92a1902cf5400325dcf4d36089"}],"stats":{"total":21,"additions":16,"deletions":5},"files":[{"sha":"12d689c6165a400af0d95068dd02db1e31829337","filename":"bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java","status":"modified","additions":9,"deletions":2,"changes":11,"blob_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/blob/d96a2db912278e3d88ed59d8d3e15b62bc37ffd4/bookkeeper-server%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fbookkeeper%2Fclient%2FLedgerHandle.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/raw/d96a2db912278e3d88ed59d8d3e15b62bc37ffd4/bookkeeper-server%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fbookkeeper%2Fclient%2FLedgerHandle.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/contents/bookkeeper-server%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fbookkeeper%2Fclient%2FLedgerHandle.java?ref=d96a2db912278e3d88ed59d8d3e15b62bc37ffd4","patch":"@@ -101,7 +101,11 @@ public class LedgerHandle {\n \n         this.ledgerId = ledgerId;\n \n-        this.throttler = RateLimiter.create(bk.getConf().getThrottleValue());\n+        if (bk.getConf().getThrottleValue() > 0) { \n+            this.throttler = RateLimiter.create(bk.getConf().getThrottleValue());\n+        } else {\n+            this.throttler = null;\n+        }\n \n         macManager = DigestManager.instantiate(ledgerId, password, digestType);\n         this.ledgerKey = MacDigestManager.genDigest(\"ledger\", password);\n@@ -648,7 +652,10 @@ void doAsyncAddEntry(final PendingAddOp op, final byte[] data, final int offset,\n                     \"Invalid values for offset(\" +offset\n                     +\") or length(\"+length+\")\");\n         }\n-        throttler.acquire();\n+\n+        if (throttler != null) {\n+            throttler.acquire();\n+        }\n \n         final long entryId;\n         final long currentLength;"},{"sha":"d9c11d107d8d31a49c18d9bffa1ec0a635d0aa13","filename":"bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java","status":"modified","additions":3,"deletions":1,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/blob/d96a2db912278e3d88ed59d8d3e15b62bc37ffd4/bookkeeper-server%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fbookkeeper%2Fclient%2FPendingReadOp.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/raw/d96a2db912278e3d88ed59d8d3e15b62bc37ffd4/bookkeeper-server%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fbookkeeper%2Fclient%2FPendingReadOp.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/contents/bookkeeper-server%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fbookkeeper%2Fclient%2FPendingReadOp.java?ref=d96a2db912278e3d88ed59d8d3e15b62bc37ffd4","patch":"@@ -343,7 +343,9 @@ private static class ReadContext {\n     }\n \n     void sendReadTo(BookieSocketAddress to, LedgerEntryRequest entry) throws InterruptedException {\n-        lh.throttler.acquire();\n+        if (lh.throttler != null) {\n+            lh.throttler.acquire();\n+        }\n \n         lh.bk.bookieClient.readEntry(to, lh.ledgerId, entry.entryId,\n                                      this, new ReadContext(to, entry));"},{"sha":"7a99559c4ef33bb69dc739fc0683bafa19ccb26f","filename":"bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ClientConfiguration.java","status":"modified","additions":4,"deletions":2,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/blob/d96a2db912278e3d88ed59d8d3e15b62bc37ffd4/bookkeeper-server%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fbookkeeper%2Fconf%2FClientConfiguration.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/raw/d96a2db912278e3d88ed59d8d3e15b62bc37ffd4/bookkeeper-server%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fbookkeeper%2Fconf%2FClientConfiguration.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/contents/bookkeeper-server%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fbookkeeper%2Fconf%2FClientConfiguration.java?ref=d96a2db912278e3d88ed59d8d3e15b62bc37ffd4","patch":"@@ -106,10 +106,12 @@ public int getThrottleValue() {\n     /**\n      * Set throttle value.\n      *\n-     * Since BookKeeper process requests in asynchrous way, it will holds\n+     * Since BookKeeper process requests in asynchronous way, it will holds\n      * those pending request in queue. You may easily run it out of memory\n      * if producing too many requests than the capability of bookie servers can handle.\n-     * To prevent that from happeding, you can set a throttle value here.\n+     * To prevent that from happening, you can set a throttle value here.\n+     *\n+     * Setting the throttle value to 0, will disable any throttling.\n      *\n      * @param throttle\n      *          Throttle Value"}]}