{"sha":"c7e78df8b7555b3a57f69ffbdff3072d29b8e024","node_id":"MDY6Q29tbWl0NDc4NTkyNTI2OmM3ZTc4ZGY4Yjc1NTViM2E1N2Y2OWZmYmRmZjMwNzJkMjliOGUwMjQ=","commit":{"author":{"name":"xieliang","email":"xieliang007@gmail.com","date":"2017-01-04T08:41:56Z"},"committer":{"name":"Sijie Guo","email":"sijie@apache.org","date":"2017-01-04T08:41:56Z"},"message":"DL-140: Fix distributedlog-core findbug inconsistent synchronization warings\n\nAuthor: xieliang <xieliang007@gmail.com>\n\nReviewers: Leigh Stewart <lstewart@apache.org>\n\nCloses #71 from xieliang/DL-140","tree":{"sha":"e4fb9e050371769d1e2e79b07a973ddc47a0055f","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/git/trees/e4fb9e050371769d1e2e79b07a973ddc47a0055f"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/git/commits/c7e78df8b7555b3a57f69ffbdff3072d29b8e024","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/commits/c7e78df8b7555b3a57f69ffbdff3072d29b8e024","html_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/commit/c7e78df8b7555b3a57f69ffbdff3072d29b8e024","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/commits/c7e78df8b7555b3a57f69ffbdff3072d29b8e024/comments","author":{"login":"xieliang","id":1712953,"node_id":"MDQ6VXNlcjE3MTI5NTM=","avatar_url":"https://avatars.githubusercontent.com/u/1712953?v=4","gravatar_id":"","url":"https://api.github.com/users/xieliang","html_url":"https://github.com/xieliang","followers_url":"https://api.github.com/users/xieliang/followers","following_url":"https://api.github.com/users/xieliang/following{/other_user}","gists_url":"https://api.github.com/users/xieliang/gists{/gist_id}","starred_url":"https://api.github.com/users/xieliang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xieliang/subscriptions","organizations_url":"https://api.github.com/users/xieliang/orgs","repos_url":"https://api.github.com/users/xieliang/repos","events_url":"https://api.github.com/users/xieliang/events{/privacy}","received_events_url":"https://api.github.com/users/xieliang/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"node_id":"MDQ6VXNlcjEyMTc4NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"sha":"da6cd40e0864548b94fee3fed63549026e446dd9","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/commits/da6cd40e0864548b94fee3fed63549026e446dd9","html_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/commit/da6cd40e0864548b94fee3fed63549026e446dd9"}],"stats":{"total":14,"additions":7,"deletions":7},"files":[{"sha":"d1c28d79f41a070ad5692188e81cebe51b778af2","filename":"src/main/java/com/twitter/distributedlog/BKAbstractLogWriter.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/blob/c7e78df8b7555b3a57f69ffbdff3072d29b8e024/src%2Fmain%2Fjava%2Fcom%2Ftwitter%2Fdistributedlog%2FBKAbstractLogWriter.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/raw/c7e78df8b7555b3a57f69ffbdff3072d29b8e024/src%2Fmain%2Fjava%2Fcom%2Ftwitter%2Fdistributedlog%2FBKAbstractLogWriter.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/contents/src%2Fmain%2Fjava%2Fcom%2Ftwitter%2Fdistributedlog%2FBKAbstractLogWriter.java?ref=c7e78df8b7555b3a57f69ffbdff3072d29b8e024","patch":"@@ -54,7 +54,7 @@ abstract class BKAbstractLogWriter implements Closeable, AsyncCloseable, Abortab\n \n     // States\n     private Promise<Void> closePromise = null;\n-    private boolean forceRolling = false;\n+    private volatile boolean forceRolling = false;\n     private boolean forceRecovery = false;\n \n     // Truncation Related\n@@ -531,7 +531,7 @@ protected synchronized void checkClosedOrInError(String operation) throws Alread\n     }\n \n     @VisibleForTesting\n-    public synchronized void setForceRolling(boolean forceRolling) {\n+    public void setForceRolling(boolean forceRolling) {\n         this.forceRolling = forceRolling;\n     }\n "},{"sha":"df645050ef881b772f0a60289d41b0501e60f888","filename":"src/main/java/com/twitter/distributedlog/BKLogSegmentWriter.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/blob/c7e78df8b7555b3a57f69ffbdff3072d29b8e024/src%2Fmain%2Fjava%2Fcom%2Ftwitter%2Fdistributedlog%2FBKLogSegmentWriter.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/raw/c7e78df8b7555b3a57f69ffbdff3072d29b8e024/src%2Fmain%2Fjava%2Fcom%2Ftwitter%2Fdistributedlog%2FBKLogSegmentWriter.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/contents/src%2Fmain%2Fjava%2Fcom%2Ftwitter%2Fdistributedlog%2FBKLogSegmentWriter.java?ref=c7e78df8b7555b3a57f69ffbdff3072d29b8e024","patch":"@@ -420,7 +420,7 @@ synchronized long getLastTxIdAcknowledged() {\n      *\n      * @return position-within-logsegment of the last written log record.\n      */\n-    int getPositionWithinLogSegment() {\n+    synchronized int getPositionWithinLogSegment() {\n         return positionWithinLogSegment;\n     }\n "},{"sha":"01a91ab7ef91707e4e7759484e22fb0a516d6bca","filename":"src/main/java/com/twitter/distributedlog/EnvelopedEntryWriter.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/blob/c7e78df8b7555b3a57f69ffbdff3072d29b8e024/src%2Fmain%2Fjava%2Fcom%2Ftwitter%2Fdistributedlog%2FEnvelopedEntryWriter.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/raw/c7e78df8b7555b3a57f69ffbdff3072d29b8e024/src%2Fmain%2Fjava%2Fcom%2Ftwitter%2Fdistributedlog%2FEnvelopedEntryWriter.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/contents/src%2Fmain%2Fjava%2Fcom%2Ftwitter%2Fdistributedlog%2FEnvelopedEntryWriter.java?ref=c7e78df8b7555b3a57f69ffbdff3072d29b8e024","patch":"@@ -176,7 +176,7 @@ public synchronized Buffer getBuffer() throws InvalidEnvelopedEntryException, IO\n     }\n \n     @Override\n-    public DLSN finalizeTransmit(long lssn, long entryId) {\n+    public synchronized DLSN finalizeTransmit(long lssn, long entryId) {\n         return new DLSN(lssn, entryId, count - 1);\n     }\n "},{"sha":"8eabf889987d70335a839270aad2d22906010a75","filename":"src/main/java/com/twitter/distributedlog/MaxTxId.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/blob/c7e78df8b7555b3a57f69ffbdff3072d29b8e024/src%2Fmain%2Fjava%2Fcom%2Ftwitter%2Fdistributedlog%2FMaxTxId.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/raw/c7e78df8b7555b3a57f69ffbdff3072d29b8e024/src%2Fmain%2Fjava%2Fcom%2Ftwitter%2Fdistributedlog%2FMaxTxId.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/contents/src%2Fmain%2Fjava%2Fcom%2Ftwitter%2Fdistributedlog%2FMaxTxId.java?ref=c7e78df8b7555b3a57f69ffbdff3072d29b8e024","patch":"@@ -65,7 +65,7 @@ synchronized long get() {\n         return currentMax;\n     }\n \n-    public Versioned<Long> getVersionedData(long txId) {\n+    public synchronized Versioned<Long> getVersionedData(long txId) {\n         return new Versioned<Long>(Math.max(txId, get()), version);\n     }\n "},{"sha":"4d0de7f278d12fd7954b38c29d42a87c0bfc5a0a","filename":"src/main/java/com/twitter/distributedlog/lock/ZKDistributedLock.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/blob/c7e78df8b7555b3a57f69ffbdff3072d29b8e024/src%2Fmain%2Fjava%2Fcom%2Ftwitter%2Fdistributedlog%2Flock%2FZKDistributedLock.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/raw/c7e78df8b7555b3a57f69ffbdff3072d29b8e024/src%2Fmain%2Fjava%2Fcom%2Ftwitter%2Fdistributedlog%2Flock%2FZKDistributedLock.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/contents/src%2Fmain%2Fjava%2Fcom%2Ftwitter%2Fdistributedlog%2Flock%2FZKDistributedLock.java?ref=c7e78df8b7555b3a57f69ffbdff3072d29b8e024","patch":"@@ -336,12 +336,12 @@ int getReacquireCount() {\n     }\n \n     @VisibleForTesting\n-    Future<ZKDistributedLock> getLockReacquireFuture() {\n+    synchronized Future<ZKDistributedLock> getLockReacquireFuture() {\n         return lockReacquireFuture;\n     }\n \n     @VisibleForTesting\n-    Future<ZKDistributedLock> getLockAcquireFuture() {\n+    synchronized Future<ZKDistributedLock> getLockAcquireFuture() {\n         return lockAcquireFuture;\n     }\n "}]}