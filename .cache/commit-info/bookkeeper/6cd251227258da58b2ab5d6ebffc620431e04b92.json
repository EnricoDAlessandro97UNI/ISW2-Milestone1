{"sha":"6cd251227258da58b2ab5d6ebffc620431e04b92","node_id":"MDY6Q29tbWl0NDc4NTkyNTI2OjZjZDI1MTIyNzI1OGRhNThiMmFiNWQ2ZWJmZmM2MjA0MzFlMDRiOTI=","commit":{"author":{"name":"xieliang","email":"xieliang007@gmail.com","date":"2017-01-07T00:30:32Z"},"committer":{"name":"Sijie Guo","email":"sijieg@twitter.com","date":"2017-01-07T00:30:32Z"},"message":"DL-171: adding a short sleep to let the WriteCompleteListener have time to run before the final position be requested\n\nonce the \"writer.write\" is done, if \"writer.position()\" be invoked easier than the WriteCompleteListener onSuccess callback, due to the \"synchronized\", the position result will be 0, not the expected 33. we can just add a short sleep to avoid this test issue.\n\nAuthor: xieliang <xieliang007@gmail.com>\n\nReviewers: Sijie Guo <sijie@apache.org>\n\nCloses #98 from xieliang/DL-171-Fix-TestAppendOnlyStreamWriter","tree":{"sha":"0753a4cd18ccf36f11c358d94e68e03d620ff7e1","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/git/trees/0753a4cd18ccf36f11c358d94e68e03d620ff7e1"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/git/commits/6cd251227258da58b2ab5d6ebffc620431e04b92","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/commits/6cd251227258da58b2ab5d6ebffc620431e04b92","html_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/commit/6cd251227258da58b2ab5d6ebffc620431e04b92","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/commits/6cd251227258da58b2ab5d6ebffc620431e04b92/comments","author":{"login":"xieliang","id":1712953,"node_id":"MDQ6VXNlcjE3MTI5NTM=","avatar_url":"https://avatars.githubusercontent.com/u/1712953?v=4","gravatar_id":"","url":"https://api.github.com/users/xieliang","html_url":"https://github.com/xieliang","followers_url":"https://api.github.com/users/xieliang/followers","following_url":"https://api.github.com/users/xieliang/following{/other_user}","gists_url":"https://api.github.com/users/xieliang/gists{/gist_id}","starred_url":"https://api.github.com/users/xieliang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xieliang/subscriptions","organizations_url":"https://api.github.com/users/xieliang/orgs","repos_url":"https://api.github.com/users/xieliang/repos","events_url":"https://api.github.com/users/xieliang/events{/privacy}","received_events_url":"https://api.github.com/users/xieliang/received_events","type":"User","site_admin":false},"committer":null,"parents":[{"sha":"817989ce704261be588d33ff952719706599b6c6","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/commits/817989ce704261be588d33ff952719706599b6c6","html_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/commit/817989ce704261be588d33ff952719706599b6c6"}],"stats":{"total":1,"additions":1,"deletions":0},"files":[{"sha":"b5498bacf16ec866461f011a0b4525fe3f53f80d","filename":"src/test/java/org/apache/distributedlog/TestAppendOnlyStreamWriter.java","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/blob/6cd251227258da58b2ab5d6ebffc620431e04b92/src%2Ftest%2Fjava%2Forg%2Fapache%2Fdistributedlog%2FTestAppendOnlyStreamWriter.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/raw/6cd251227258da58b2ab5d6ebffc620431e04b92/src%2Ftest%2Fjava%2Forg%2Fapache%2Fdistributedlog%2FTestAppendOnlyStreamWriter.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/contents/src%2Ftest%2Fjava%2Forg%2Fapache%2Fdistributedlog%2FTestAppendOnlyStreamWriter.java?ref=6cd251227258da58b2ab5d6ebffc620431e04b92","patch":"@@ -189,6 +189,7 @@ public void testPositionUpdatesOnlyAfterWriteCompletionWithoutFsync() throws Exc\n         assertEquals(0, writer.position());\n \n         Await.result(writer.write(byteStream));\n+        Thread.sleep(100); // let WriteCompleteListener have time to run\n         assertEquals(33, writer.position());\n \n         writer.close();"}]}