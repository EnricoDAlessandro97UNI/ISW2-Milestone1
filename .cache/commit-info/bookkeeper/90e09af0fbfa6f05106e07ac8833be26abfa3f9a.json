{"sha":"90e09af0fbfa6f05106e07ac8833be26abfa3f9a","node_id":"MDY6Q29tbWl0NDc4NTkyNTI2OjkwZTA5YWYwZmJmYTZmMDUxMDZlMDdhYzg4MzNiZTI2YWJmYTNmOWE=","commit":{"author":{"name":"Sijie Guo","email":"sijie@apache.org","date":"2017-01-11T05:45:42Z"},"committer":{"name":"Sijie Guo","email":"sijie@apache.org","date":"2017-01-11T05:45:42Z"},"message":"Fix the script to make sure binary package can execute scripts correctly\n\n- fix the release jar path\n- copy the common script to each modules otherwise the built package won't be able to execute\n- change the type of runner and copy the runner script to each tutorial module\n\nAuthor: Sijie Guo <sijie@apache.org>\n\nReviewers: Jia Zhai <zhaijia@apache.org>\n\nCloses #111 from sijie/sijie/copy_all_scripts_to_modules","tree":{"sha":"33a2978c45029cec8ffdfa218e5e12b25469eb5f","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/git/trees/33a2978c45029cec8ffdfa218e5e12b25469eb5f"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/git/commits/90e09af0fbfa6f05106e07ac8833be26abfa3f9a","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/commits/90e09af0fbfa6f05106e07ac8833be26abfa3f9a","html_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/commit/90e09af0fbfa6f05106e07ac8833be26abfa3f9a","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/commits/90e09af0fbfa6f05106e07ac8833be26abfa3f9a/comments","author":{"login":"sijie","id":1217863,"node_id":"MDQ6VXNlcjEyMTc4NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"committer":{"login":"sijie","id":1217863,"node_id":"MDQ6VXNlcjEyMTc4NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1217863?v=4","gravatar_id":"","url":"https://api.github.com/users/sijie","html_url":"https://github.com/sijie","followers_url":"https://api.github.com/users/sijie/followers","following_url":"https://api.github.com/users/sijie/following{/other_user}","gists_url":"https://api.github.com/users/sijie/gists{/gist_id}","starred_url":"https://api.github.com/users/sijie/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sijie/subscriptions","organizations_url":"https://api.github.com/users/sijie/orgs","repos_url":"https://api.github.com/users/sijie/repos","events_url":"https://api.github.com/users/sijie/events{/privacy}","received_events_url":"https://api.github.com/users/sijie/received_events","type":"User","site_admin":false},"parents":[{"sha":"5548c21dff62d544a0035f0cbb3cc59e385a4bd5","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/commits/5548c21dff62d544a0035f0cbb3cc59e385a4bd5","html_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/commit/5548c21dff62d544a0035f0cbb3cc59e385a4bd5"}],"stats":{"total":131,"additions":128,"deletions":3},"files":[{"sha":"0b8278ccc3358ed48dfaee37d15bceaef3792706","filename":"bin/common.sh","status":"added","additions":126,"deletions":0,"changes":126,"blob_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/blob/90e09af0fbfa6f05106e07ac8833be26abfa3f9a/bin%2Fcommon.sh","raw_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/raw/90e09af0fbfa6f05106e07ac8833be26abfa3f9a/bin%2Fcommon.sh","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/contents/bin%2Fcommon.sh?ref=90e09af0fbfa6f05106e07ac8833be26abfa3f9a","patch":"@@ -0,0 +1,126 @@\n+#!/usr/bin/env bash\n+#\n+#/**\n+# * Copyright 2007 The Apache Software Foundation\n+# *\n+# * Licensed to the Apache Software Foundation (ASF) under one\n+# * or more contributor license agreements.  See the NOTICE file\n+# * distributed with this work for additional information\n+# * regarding copyright ownership.  The ASF licenses this file\n+# * to you under the Apache License, Version 2.0 (the\n+# * \"License\"); you may not use this file except in compliance\n+# * with the License.  You may obtain a copy of the License at\n+# *\n+# *     http://www.apache.org/licenses/LICENSE-2.0\n+# *\n+# * Unless required by applicable law or agreed to in writing, software\n+# * distributed under the License is distributed on an \"AS IS\" BASIS,\n+# * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+# * See the License for the specific language governing permissions and\n+# * limitations under the License.\n+# */\n+\n+if [ $(uname) == \"Linux\" ]; then\n+  # check if net.ipv6.bindv6only is set to 1\n+  bindv6only=$(/sbin/sysctl -n net.ipv6.bindv6only 2> /dev/null)\n+  if [ -n \"${bindv6only}\" ] && [ \"${bindv6only}\" -eq \"1\" ]; then\n+    echo \"Error: \\\"net.ipv6.bindv6only\\\" is set to 1 - Java networking could be broken\"\n+    echo \"For more info (the following page also applies to DistributedLog): http://wiki.apache.org/hadoop/HadoopIPv6\"\n+    exit 1\n+  fi\n+fi\n+\n+# See the following page for extensive details on setting\n+# up the JVM to accept JMX remote management:\n+# http://java.sun.com/javase/6/docs/technotes/guides/management/agent.html\n+# by default we allow local JMX connections\n+if [ -z \"${JMXLOCALONLY}\" ]; then\n+  JMXLOCALONLY=false\n+fi\n+\n+if [ -z \"${JMXDISABLE}\" ]; then\n+  echo \"JMX enabled by default\" >&2\n+  # for some reason these two options are necessary on jdk6 on Ubuntu\n+  # accord to the docs they are not necessary, but otw jconsole cannot\n+  # do a local attach\n+  JMX_ARGS=\"-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=${JMXLOCALONLY}\"\n+else\n+  echo \"JMX disabled by user request\" >&2\n+fi\n+\n+echo \"DLOG_HOME => ${DLOG_HOME}\"\n+DEFAULT_LOG_CONF=\"${DLOG_HOME}/conf/log4j.properties\"\n+\n+[ -f \"${DLOG_HOME}/conf/dlogenv.sh\" ] && source \"${DLOG_HOME}/conf/dlogenv.sh\"\n+\n+# exclude tests jar\n+RELEASE_JAR=$(ls ${DLOG_HOME}/distributedlog-*.jar 2> /dev/null | grep -v 'tests|javadoc|sources' | tail -1)\n+if [ $? == 0 ]; then\n+  DLOG_JAR=\"${RELEASE_JAR}\"\n+fi\n+\n+# exclude tests jar\n+BUILT_JAR=$(ls ${DLOG_HOME}/target/distributedlog-*.jar 2> /dev/null | grep -v 'tests|javadoc|sources' | tail -1)\n+\n+if [ -e \"${BUILD_JAR}\" ] && [ -e \"${DLOG_JAR}\" ]; then\n+  echo \"\\nCouldn't find dlog jar.\";\n+  echo \"Make sure you've run 'mvn package'\\n\";\n+  exit 1;\n+elif [ -e \"${BUILT_JAR}\" ]; then\n+  DLOG_JAR=\"${BUILT_JAR}\"\n+fi\n+\n+add_maven_deps_to_classpath() {\n+  MVN=\"mvn\"\n+  if [ -n \"${MAVEN_HOME}\" ]; then\n+    MVN=\"${MAVEN_HOME}/bin/mvn\"\n+  fi\n+\n+  # Need to generate classpath from maven pom. This is costly so generate it\n+  # and cache it. Save the file into our target dir so a mvn clean will get\n+  # clean it up and force us create a new one.\n+  f=\"${PWD}/${DLOG_HOME}/target/cached_classpath.txt\"\n+  if [ ! -f \"${f}\" ]; then\n+    \"${MVN}\" -f \"${DLOG_HOME}/pom.xml\" dependency:build-classpath -Dmdep.outputFile=\"${f}\" &> /dev/null\n+  fi\n+  DLOG_CLASSPATH=\"${CLASSPATH}\":$(cat \"${f}\")\n+}\n+\n+if [ -d \"${DLOG_HOME}/lib\" ]; then\n+  for i in ${DLOG_HOME}/lib/*.jar; do\n+    DLOG_CLASSPATH=\"${DLOG_CLASSPATH}:${i}\"\n+  done\n+else\n+  add_maven_deps_to_classpath\n+fi\n+\n+# if no args specified, exit\n+if [ $# = 0 ]; then\n+  exit 1\n+fi\n+\n+if [ -z \"${DLOG_LOG_CONF}\" ]; then\n+  DLOG_LOG_CONF=\"${DEFAULT_LOG_CONF}\"\n+fi\n+\n+DLOG_CLASSPATH=\"${DLOG_JAR}:${DLOG_CLASSPATH}:${DLOG_EXTRA_CLASSPATH}\"\n+if [ -n \"${DLOG_LOG_CONF}\" ]; then\n+  DLOG_CLASSPATH=\"$(dirname ${DLOG_LOG_CONF}):${DLOG_CLASSPATH}\"\n+  OPTS=\"${OPTS} -Dlog4j.configuration=$(basename ${DLOG_LOG_CONF})\"\n+fi\n+OPTS=\"-cp ${DLOG_CLASSPATH} ${OPTS} ${DLOG_EXTRA_OPTS}\"\n+\n+OPTS=\"${OPTS} ${DLOG_EXTRA_OPTS}\"\n+\n+# Disable ipv6 as it can cause issues\n+OPTS=\"${OPTS} -Djava.net.preferIPv4Stack=true\"\n+\n+# log directory & file\n+DLOG_ROOT_LOGGER=${DLOG_ROOT_LOGGER:-\"INFO,R\"}\n+DLOG_LOG_DIR=${DLOG_LOG_DIR:-\"$DLOG_HOME/logs\"}\n+DLOG_LOG_FILE=${DLOG_LOG_FILE:-\"dlog.log\"}\n+\n+#Configure log configuration system properties\n+OPTS=\"$OPTS -Ddlog.root.logger=${DLOG_ROOT_LOGGER}\"\n+OPTS=\"$OPTS -Ddlog.log.dir=${DLOG_LOG_DIR}\"\n+OPTS=\"$OPTS -Ddlog.log.file=${DLOG_LOG_FILE}\""},{"sha":"6a93eb3968a8c62c30a431f5157b457b62b3f4be","filename":"bin/dlog","status":"modified","additions":2,"deletions":3,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/blob/90e09af0fbfa6f05106e07ac8833be26abfa3f9a/bin%2Fdlog","raw_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/raw/90e09af0fbfa6f05106e07ac8833be26abfa3f9a/bin%2Fdlog","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/contents/bin%2Fdlog?ref=90e09af0fbfa6f05106e07ac8833be26abfa3f9a","patch":"@@ -21,9 +21,8 @@\n set -e\n \n BASEDIR=$(dirname \"$0\")\n-DLOG_ROOT=\"${BASEDIR}/../..\"\n \n-DLOG_HOME=\"${DLOG_ROOT}/distributedlog-core\"\n+DLOG_HOME=\"${BASEDIR}/..\"\n \n usage() {\n   cat <<EOF\n@@ -48,7 +47,7 @@ These variable can also be set in conf/dlogenv.sh\n EOF\n }\n \n-source \"${DLOG_ROOT}\"/scripts/common.sh\n+source \"${DLOG_HOME}\"/bin/common.sh\n \n # get arguments\n COMMAND=$1"}]}