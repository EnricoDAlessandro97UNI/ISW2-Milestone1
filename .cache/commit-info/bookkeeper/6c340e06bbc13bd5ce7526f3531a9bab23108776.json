{"sha":"6c340e06bbc13bd5ce7526f3531a9bab23108776","node_id":"MDY6Q29tbWl0NDc4NTkyNTI2OjZjMzQwZTA2YmJjMTNiZDVjZTc1MjZmMzUzMWE5YmFiMjMxMDg3NzY=","commit":{"author":{"name":"zhaijack","email":"zhaijia03@gmail.com","date":"2017-08-03T08:18:01Z"},"committer":{"name":"jiazhai","email":"zhaijia@live.com","date":"2017-08-03T08:18:01Z"},"message":"ISSUE #362: [DOCUMENTATION] update command line tools\n\nDescriptions of the changes in this PR:\n\nenrich doc for bookie shell\n\n---\nBe sure to do all of the following to help us incorporate your contribution\nquickly and easily:\n\n- [X] Make sure the PR title is formatted like:\n    `<Issue # or BOOKKEEPER-#>: Description of pull request`\n    `e.g. Issue 123: Description ...`\n    `e.g. BOOKKEEPER-1234: Description ...`\n- [ ] Make sure tests pass via `mvn clean apache-rat:check install findbugs:check`.\n- [X] Replace `<Issue # or BOOKKEEPER-#>` in the title with the actual Issue/JIRA number.\n\n---\n\nAuthor: zhaijack <zhaijia03@gmail.com>\n\nReviewers: Luc Perkins <None>, Sijie Guo <None>\n\nThis closes #369 from zhaijack/issue_362, closes #362","tree":{"sha":"64199ea682e1f2333c536f88895bbedb7e5300e2","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/git/trees/64199ea682e1f2333c536f88895bbedb7e5300e2"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/git/commits/6c340e06bbc13bd5ce7526f3531a9bab23108776","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/commits/6c340e06bbc13bd5ce7526f3531a9bab23108776","html_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/commit/6c340e06bbc13bd5ce7526f3531a9bab23108776","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/commits/6c340e06bbc13bd5ce7526f3531a9bab23108776/comments","author":{"login":"zhaijack","id":26834121,"node_id":"MDQ6VXNlcjI2ODM0MTIx","avatar_url":"https://avatars.githubusercontent.com/u/26834121?v=4","gravatar_id":"","url":"https://api.github.com/users/zhaijack","html_url":"https://github.com/zhaijack","followers_url":"https://api.github.com/users/zhaijack/followers","following_url":"https://api.github.com/users/zhaijack/following{/other_user}","gists_url":"https://api.github.com/users/zhaijack/gists{/gist_id}","starred_url":"https://api.github.com/users/zhaijack/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zhaijack/subscriptions","organizations_url":"https://api.github.com/users/zhaijack/orgs","repos_url":"https://api.github.com/users/zhaijack/repos","events_url":"https://api.github.com/users/zhaijack/events{/privacy}","received_events_url":"https://api.github.com/users/zhaijack/received_events","type":"User","site_admin":false},"committer":null,"parents":[{"sha":"8b895d3087130107f4b5714560e7493349c10f5d","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/commits/8b895d3087130107f4b5714560e7493349c10f5d","html_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/commit/8b895d3087130107f4b5714560e7493349c10f5d"}],"stats":{"total":136,"additions":113,"deletions":23},"files":[{"sha":"c5a65c0006d3a3fd6c0bff59c7cca17bc5604e9c","filename":"bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java","status":"modified","additions":18,"deletions":18,"changes":36,"blob_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/blob/6c340e06bbc13bd5ce7526f3531a9bab23108776/bookkeeper-server%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fbookkeeper%2Fbookie%2FBookieShell.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/raw/6c340e06bbc13bd5ce7526f3531a9bab23108776/bookkeeper-server%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fbookkeeper%2Fbookie%2FBookieShell.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/contents/bookkeeper-server%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fbookkeeper%2Fbookie%2FBookieShell.java?ref=6c340e06bbc13bd5ce7526f3531a9bab23108776","patch":"@@ -202,7 +202,7 @@ Options getOptions() {\n \n         @Override\n         String getDescription() {\n-            return \"Format bookkeeper metadata in zookeeper\";\n+            return \"Format bookkeeper metadata in zookeeper.\";\n         }\n \n         @Override\n@@ -245,7 +245,7 @@ Options getOptions() {\n \n         @Override\n         String getDescription() {\n-            return \"Format the current server contents\";\n+            return \"Format the current server contents.\";\n         }\n \n         @Override\n@@ -298,7 +298,7 @@ Options getOptions() {\n \n         @Override\n         String getDescription() {\n-            return \"Recover the ledger data for failed bookie\";\n+            return \"Recover the ledger data for failed bookie.\";\n         }\n \n         @Override\n@@ -433,7 +433,7 @@ Options getOptions() {\n \n         @Override\n         String getDescription() {\n-            return \"Read a range of entries from a ledger\";\n+            return \"Read a range of entries from a ledger.\";\n         }\n \n         @Override\n@@ -512,7 +512,7 @@ Options getOptions() {\n         @Override\n         String getDescription() {\n             return \"List ledgers marked as underreplicated, with optional options to specify missingreplica\"\n-                + \" (BookieId) and to exclude missingreplica\";\n+                + \" (BookieId) and to exclude missingreplica.\";\n         }\n \n         @Override\n@@ -632,7 +632,7 @@ public int runCmd(CommandLine cmdLine) throws Exception {\n \n         @Override\n         String getDescription() {\n-            return \"List all ledgers on the cluster (this may take a long time)\";\n+            return \"List all ledgers on the cluster (this may take a long time).\";\n         }\n \n         @Override\n@@ -724,7 +724,7 @@ public int runCmd(CommandLine cmdLine) throws Exception {\n \n         @Override\n         String getDescription() {\n-            return \"Print the metadata for a ledger\";\n+            return \"Print the metadata for a ledger.\";\n         }\n \n         @Override\n@@ -786,7 +786,7 @@ public int runCmd(CommandLine cmdLine) throws Exception {\n \n         @Override\n         String getDescription() {\n-            return \"Simple test to create a ledger and write entries to it\";\n+            return \"Simple test to create a ledger and write entries to it.\";\n         }\n \n         @Override\n@@ -898,7 +898,7 @@ class ReadLogCmd extends MyCommand {\n             super(CMD_READLOG);\n             rlOpts.addOption(\"m\", \"msg\", false, \"Print message body\");\n             rlOpts.addOption(\"l\", \"ledgerid\", true, \"Ledger ID\");\n-            rlOpts.addOption(\"e\", \"entryid\", true, \"EntryID\");\n+            rlOpts.addOption(\"e\", \"entryid\", true, \"Entry ID\");\n             rlOpts.addOption(\"sp\", \"startpos\", true, \"Start Position\");\n             rlOpts.addOption(\"ep\", \"endpos\", true, \"End Position\");\n         }\n@@ -1213,7 +1213,7 @@ public int runCmd(CommandLine cmdLine) throws Exception {\n \n         @Override\n         String getDescription() {\n-            return \"List the files in JournalDirectory/LedgerDirectories/IndexDirectories\";\n+            return \"List the files in JournalDirectory/LedgerDirectories/IndexDirectories.\";\n         }\n \n         @Override\n@@ -1364,7 +1364,7 @@ Options getOptions() {\n \n         @Override\n         String getDescription() {\n-            return \"Setter and Getter for LostBookieRecoveryDelay value (in seconds) in Zookeeper\";\n+            return \"Setter and Getter for LostBookieRecoveryDelay value (in seconds) in Zookeeper.\";\n         }\n \n         @Override\n@@ -1421,7 +1421,7 @@ Options getOptions() {\n \n         @Override\n         String getDescription() {\n-            return \"Print the node which holds the auditor lock\";\n+            return \"Print the node which holds the auditor lock.\";\n         }\n \n         @Override\n@@ -1475,7 +1475,7 @@ Options getOptions() {\n \n         @Override\n         String getDescription() {\n-            return \"Update bookie id in cookie\";\n+            return \"Update bookie id in cookie.\";\n         }\n \n         @Override\n@@ -1680,7 +1680,7 @@ Options getOptions() {\n \n         @Override\n         String getDescription() {\n-            return \"Update bookie id in ledgers (this may take a long time)\";\n+            return \"Update bookie id in ledgers (this may take a long time).\";\n         }\n \n         @Override\n@@ -1821,7 +1821,7 @@ public int runCmd(CommandLine cmdLine) throws Exception {\n \n         @Override\n         String getDescription() {\n-            return \"Delete a ledger\";\n+            return \"Delete a ledger.\";\n         }\n \n         @Override\n@@ -1848,7 +1848,7 @@ class BookieInfoCmd extends MyCommand {\n \n         @Override\n         String getDescription() {\n-            return \"Retrieve bookie info such as free and total disk space\";\n+            return \"Retrieve bookie info such as free and total disk space.\";\n         }\n \n         @Override\n@@ -1916,7 +1916,7 @@ class TriggerAuditCmd extends MyCommand {\n \n         @Override\n         String getDescription() {\n-            return \"Force trigger the Audit by resetting the lostBookieRecoveryDelay\";\n+            return \"Force trigger the Audit by resetting the lostBookieRecoveryDelay.\";\n         }\n \n         @Override\n@@ -1958,7 +1958,7 @@ class DecommissionBookieCmd extends MyCommand {\n         @Override\n         String getDescription() {\n             return \"Force trigger the Audittask and make sure all the ledgers stored in the decommissioning bookie\"\n-                + \" are replicated\";\n+                + \" are replicated.\";\n         }\n \n         @Override"},{"sha":"e43c5377f06009c8ed58e511063ccd655d5f503d","filename":"site/_data/cli/shell.yaml","status":"modified","additions":95,"deletions":5,"changes":100,"blob_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/blob/6c340e06bbc13bd5ce7526f3531a9bab23108776/site%2F_data%2Fcli%2Fshell.yaml","raw_url":"https://github.com/EnricoDAlessandro97UNI/bookkeeper/raw/6c340e06bbc13bd5ce7526f3531a9bab23108776/site%2F_data%2Fcli%2Fshell.yaml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/bookkeeper/contents/site%2F_data%2Fcli%2Fshell.yaml?ref=6c340e06bbc13bd5ce7526f3531a9bab23108776","patch":"@@ -1,67 +1,157 @@\n commands:\n - name: autorecovery\n+  description: Enable or disable autorecovery in the cluster.\n   options:\n   - flag: -enable\n-    description: Enables autorecovery\n+    description: Enable autorecovery of underreplicated ledgers\n   - flag: -disable\n-    description: Disables autorecovery\n+    description: Disable autorecovery of underreplicated ledgers\n - name: bookieFormat\n+  description: Format the current server contents.\n   options:\n   - flag: -nonInteractive\n+    description: Whether to confirm if old data exists.\n   - flag: -force\n+    description: If [nonInteractive] is specified, then whether to force delete the old data without prompt..?\n   - flag: -deleteCookie\n+    description: Delete its cookie on zookeeper\n+- name: bookieinfo\n+  description: Retrieve bookie info such as free and total disk space.\n - name: bookiesanity\n+  description: Sanity test for local bookie. Create ledger and write/read entries on the local bookie.\n   options:\n   - flag: -entries N\n+    description: Total entries to be added for the test (default 10)\n   - flag: -timeout N\n+    description: Timeout for write/read operations in seconds (default 1)\n+- name: decommissionbookie\n+  description: Force trigger the Audittask and make sure all the ledgers stored in the decommissioning bookie are replicated.\n+- name: deleteledger\n+  description: Delete a ledger\n+  options:\n+  - flag: -ledgerid N\n+    description: Ledger ID\n+  - flag: -force\n+    description: Whether to force delete the Ledger without prompt..?\n+- name: expandstorage\n+  description: Add new empty ledger/index directories. Update the directories info in the conf file before running the command.\n - name: help\n   description: Displays the help message.\n - name: lastmark\n+  description: Print last log marker.\n - name: ledger\n+  description: Dump ledger index entries into readable format.\n   options:\n   - flag: -m LEDGER_ID\n+    description: Print meta information\n - name: ledgermetadata\n+  description: Print the metadata for a ledger.\n   options:\n-  - flag: -ledgerid LEDGER_ID\n+  - flag: -ledgerid N\n+    description: Ledger ID\n - name: listbookies\n+  description: List the bookies, which are running as either readwrite or readonly mode.\n   options:\n   - flag: -readwrite\n+  description: Print readwrite bookies\n   - flag: -readonly\n+  description: Print readonly bookies\n   - flag: -hostnames\n+  description: Also print hostname of the bookie\n+- name: listfilesondisc\n+  description: List the files in JournalDirectory/LedgerDirectories/IndexDirectories.\n+  options:\n+  - flag: -journal\n+    description: Print list of journal files\n+  - flag: -entrylog\n+    description: Print list of entryLog files\n+  - flag: -index\n+    description: Print list of index files\n - name: listledgers\n+  description: List all ledgers in the cluster (this may take a long time).\n   options:\n   - flag: -meta\n+    description: Print metadata\n - name: listunderreplicated\n+  description: List ledgers marked as underreplicated, with optional options to specify missing replica (BookieId) and to exclude missing replica.\n+  options:\n+  - flag: -missingreplica N\n+    description: Bookie Id of missing replica\n+  - flag: -excludingmissingreplica N\n+    description: Bookie Id of missing replica to ignore\n - name: metaformat\n+  description: Format Bookkeeper metadata in Zookeeper.\n   options:\n   - flag: -nonInteractive\n+    description: Whether to confirm if old data exists..?\n   - flag: -force\n+    description: If [nonInteractive] is specified, then whether to force delete the old data without prompt.\n+- name: lostbookierecoverydelay\n+  description: Setter and Getter for LostBookieRecoveryDelay value (in seconds) in Zookeeper.\n+  options:\n+  - flag: -get\n+    description: Get LostBookieRecoveryDelay value (in seconds)\n+  - flag: -set N\n+    description: Set LostBookieRecoveryDelay value (in seconds)\n - name: readjournal\n+  description: Scan a journal file and format the entries into readable format.\n   options:\n   - flag: -msg JOURNAL_ID|JOURNAL_FILENAME\n+    description: Print message body\n+  - flag: -dir\n+    description: Journal directory (needed if more than one journal configured)\n - name: readledger\n+  description: Read a range of entries from a ledger.\n   argument: <ledger_id> [<start_entry_id> [<end_entry_id>]]\n - name: readlog\n+  description: Scan an entry file and format the entries into readable format.\n   argument: <entry_log_id | entry_log_file_name>\n   options:\n   - flag: -msg\n+    description: Print message body\n+  - flag: -ledgerid N\n+    description: Ledger ID\n+  - flag: -entryid N\n+    description: Entry ID\n+  - flag: -startpos N\n+    description: Start Position\n+  - flag: -endpos\n+    description: End Position\n - name: recover\n-  argument: <bookieSrc> [bookieDest]\n+  description: Recover the ledger data for failed bookie.\n+  argument: [-deleteCookie] <bookieSrc> [bookieDest]\n   options:\n   - flag: -deleteCookie\n+    description: Delete cookie node for the bookie.\n - name: simpletest\n+  description: Simple test to create a ledger and write entries to it.\n+  argument: [-ensemble N] [-writeQuorum N] [-ackQuorum N] [-numEntries N]\n   options:\n   - flag: -ensemble N\n+    description: Ensemble size (default 3)\n   - flag: -writeQuorum N\n+    description: Write quorum size (default 2)\n   - flag: ackQuorum N\n+    description: Ack quorum size (default 2)\n   - flag: -numEntries N\n+    description: Entries to write (default 1000)\n+- name: triggeraudit\n+  description: Force trigger the Audit by resetting the lostBookieRecoveryDelay.\n - name: updatecookie\n+  description: Update bookie id in cookie.\n   options:\n   - flag: -bookieId <hostname|ip>\n-- name: updateledger\n+    description: Bookie Id\n+- name: updateledgers\n+  description:  Update bookie id in ledgers (this may take a long time).\n   options:\n   - flag: -bookieId <hostname|ip>\n+    description: Bookie Id\n   - flag: -updatespersec N\n+    description: Number of ledgers updating per second (default: 5 per sec)\n   - flag: -limit N\n+    description: Maximum number of ledgers to update (default: no limit)\n   - flag: -verbose\n+    description: Print status of the ledger updation (default: false)\n   - flag: -printprogress N\n+    description: Print messages on every configured seconds if verbose turned on (default: 10 secs)"}]}