{"sha":"023b200886972f236323a649e30523d5945e4ec6","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjAyM2IyMDA4ODY5NzJmMjM2MzIzYTY0OWUzMDUyM2Q1OTQ1ZTRlYzY=","commit":{"author":{"name":"Andrea Patricelli","email":"andreapatricelli@apache.org","date":"2017-06-26T10:37:19Z"},"committer":{"name":"Andrea Patricelli","email":"andreapatricelli@apache.org","date":"2017-06-26T10:37:41Z"},"message":"[SYNCOPE-1116] added propagation action to documentation, fixed failing tests","tree":{"sha":"280161e5ee15383342d4a1252339801fe5180d19","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/280161e5ee15383342d4a1252339801fe5180d19"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/023b200886972f236323a649e30523d5945e4ec6","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/023b200886972f236323a649e30523d5945e4ec6","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/023b200886972f236323a649e30523d5945e4ec6","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/023b200886972f236323a649e30523d5945e4ec6/comments","author":{"login":"andrea-patricelli","id":3763111,"node_id":"MDQ6VXNlcjM3NjMxMTE=","avatar_url":"https://avatars.githubusercontent.com/u/3763111?v=4","gravatar_id":"","url":"https://api.github.com/users/andrea-patricelli","html_url":"https://github.com/andrea-patricelli","followers_url":"https://api.github.com/users/andrea-patricelli/followers","following_url":"https://api.github.com/users/andrea-patricelli/following{/other_user}","gists_url":"https://api.github.com/users/andrea-patricelli/gists{/gist_id}","starred_url":"https://api.github.com/users/andrea-patricelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrea-patricelli/subscriptions","organizations_url":"https://api.github.com/users/andrea-patricelli/orgs","repos_url":"https://api.github.com/users/andrea-patricelli/repos","events_url":"https://api.github.com/users/andrea-patricelli/events{/privacy}","received_events_url":"https://api.github.com/users/andrea-patricelli/received_events","type":"User","site_admin":false},"committer":{"login":"andrea-patricelli","id":3763111,"node_id":"MDQ6VXNlcjM3NjMxMTE=","avatar_url":"https://avatars.githubusercontent.com/u/3763111?v=4","gravatar_id":"","url":"https://api.github.com/users/andrea-patricelli","html_url":"https://github.com/andrea-patricelli","followers_url":"https://api.github.com/users/andrea-patricelli/followers","following_url":"https://api.github.com/users/andrea-patricelli/following{/other_user}","gists_url":"https://api.github.com/users/andrea-patricelli/gists{/gist_id}","starred_url":"https://api.github.com/users/andrea-patricelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrea-patricelli/subscriptions","organizations_url":"https://api.github.com/users/andrea-patricelli/orgs","repos_url":"https://api.github.com/users/andrea-patricelli/repos","events_url":"https://api.github.com/users/andrea-patricelli/events{/privacy}","received_events_url":"https://api.github.com/users/andrea-patricelli/received_events","type":"User","site_admin":false},"parents":[{"sha":"9442842a4376a32d239dd434e8e421ef4f0350b0","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/9442842a4376a32d239dd434e8e421ef4f0350b0","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/9442842a4376a32d239dd434e8e421ef4f0350b0"}],"stats":{"total":35,"additions":24,"deletions":11},"files":[{"sha":"a1e4179e04cf690dc7052125ea1b45b6da574abc","filename":"core/persistence-jpa/src/main/java/org/apache/syncope/core/persistence/jpa/dao/JPARealmDAO.java","status":"modified","additions":1,"deletions":3,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/023b200886972f236323a649e30523d5945e4ec6/core%2Fpersistence-jpa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FJPARealmDAO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/023b200886972f236323a649e30523d5945e4ec6/core%2Fpersistence-jpa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FJPARealmDAO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FJPARealmDAO.java?ref=023b200886972f236323a649e30523d5945e4ec6","patch":"@@ -178,9 +178,7 @@ public List<Realm> findDescendants(final Realm realm) {\n \n     @Override\n     public List<Realm> findAll() {\n-        TypedQuery<Realm> query = entityManager().createQuery(\n-                \"SELECT e FROM \" + JPARealm.class.getSimpleName() + \" e \", Realm.class);\n-        return query.getResultList();\n+        return findDescendants(getRoot());\n     }\n \n     @Override"},{"sha":"8cd8fe1a4bc039a6d73cab6d7254ae41bb64b990","filename":"core/provisioning-java/src/main/java/org/apache/syncope/core/provisioning/java/propagation/LDAPNestedRealmPropagationActions.java","status":"modified","additions":4,"deletions":0,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/023b200886972f236323a649e30523d5945e4ec6/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fpropagation%2FLDAPNestedRealmPropagationActions.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/023b200886972f236323a649e30523d5945e4ec6/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fpropagation%2FLDAPNestedRealmPropagationActions.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fpropagation%2FLDAPNestedRealmPropagationActions.java?ref=023b200886972f236323a649e30523d5945e4ec6","patch":"@@ -32,6 +32,10 @@\n import org.slf4j.LoggerFactory;\n import org.springframework.beans.factory.annotation.Autowired;\n \n+/**\n+ * Action for propagating realms to LDAP resource respecting realms hierarchy.\n+ *\n+ */\n public class LDAPNestedRealmPropagationActions extends DefaultPropagationActions {\n \n     private static final Logger LOG = LoggerFactory.getLogger(LDAPNestedRealmPropagationActions.class);"},{"sha":"66df83e7ed3add5da21584b7747165851a9229eb","filename":"fit/core-reference/src/test/java/org/apache/syncope/fit/console/RealmsITCase.java","status":"modified","additions":7,"deletions":7,"changes":14,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/023b200886972f236323a649e30523d5945e4ec6/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fconsole%2FRealmsITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/023b200886972f236323a649e30523d5945e4ec6/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fconsole%2FRealmsITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fconsole%2FRealmsITCase.java?ref=023b200886972f236323a649e30523d5945e4ec6","patch":"@@ -154,14 +154,14 @@ public void addUserTemplate() {\n     @Test\n     public void verifyPropagation() {\n         TESTER.executeAjaxEvent(\"body:content:realmChoicePanel:container:realms:btn\", Constants.ON_CLICK);\n-        TESTER.executeAjaxEvent(\"body:content:realmChoicePanel:container:realms:dropdown-menu:buttons:3:button\",\n+        TESTER.executeAjaxEvent(\"body:content:realmChoicePanel:container:realms:dropdown-menu:buttons:2:button\",\n                 Constants.ON_CLICK);\n \n         TESTER.clickLink(\n                 \"body:content:body:container:content:tabbedPanel:panel:actions:actions:actionRepeater:1:action:action\");\n         TESTER.assertComponent(\"body:content:body:outerObjectsRepeater:0:outer\", Modal.class);\n         TESTER.assertModelValue(\"body:content:body:outerObjectsRepeater:0:outer:form:content:form:view:details:\"\n-                + \"container:generics:name:textField\", \"two\");\n+                + \"container:generics:name:textField\", \"even\");\n \n         FormTester formTester = TESTER.newFormTester(\n                 \"body:content:body:outerObjectsRepeater:0:outer:form:content:form\");\n@@ -173,7 +173,7 @@ public void verifyPropagation() {\n         TESTER.cleanupFeedbackMessages();\n \n         // ----------------------------------\n-        // Check for propagation rsults\n+        // Check for propagation results\n         // ----------------------------------\n         Component component = findComponentByProp(\"resource\", \"body:content:body:outerObjectsRepeater:0:outer:form:\"\n                 + \"content:customResultBody:firstLevelContainer:first:container\", \"resource-ldap-orgunit\");\n@@ -196,7 +196,7 @@ public void verifyPropagation() {\n                 + \"secondLevelContainer:second:remoteObject:propView:2:value:newAttribute:field-label\", \"ou\");\n \n         TESTER.assertModelValue(\"body:content:body:outerObjectsRepeater:0:outer:form:content:customResultBody:\"\n-                + \"secondLevelContainer:second:remoteObject:propView:2:value:newAttribute:textField\", \"two\");\n+                + \"secondLevelContainer:second:remoteObject:propView:2:value:newAttribute:textField\", \"even\");\n \n         TESTER.clickLink(\"body:content:body:outerObjectsRepeater:0:outer:form:content:customResultBody:\"\n                 + \"secondLevelContainer:back\");\n@@ -212,7 +212,7 @@ public void verifyPropagation() {\n                 \"body:content:body:container:content:tabbedPanel:panel:actions:actions:actionRepeater:1:action:action\");\n         TESTER.assertComponent(\"body:content:body:outerObjectsRepeater:0:outer\", Modal.class);\n         TESTER.assertModelValue(\"body:content:body:outerObjectsRepeater:0:outer:form:content:form:view:details:\"\n-                + \"container:generics:name:textField\", \"two\");\n+                + \"container:generics:name:textField\", \"even\");\n \n         formTester = TESTER.newFormTester(\n                 \"body:content:body:outerObjectsRepeater:0:outer:form:content:form\");\n@@ -224,7 +224,7 @@ public void verifyPropagation() {\n         TESTER.cleanupFeedbackMessages();\n \n         // ----------------------------------\n-        // Check for propagation rsults\n+        // Check for propagation results\n         // ----------------------------------\n         component = findComponentByProp(\"resource\", \"body:content:body:outerObjectsRepeater:0:outer:form:\"\n                 + \"content:customResultBody:firstLevelContainer:first:container\", \"resource-ldap-orgunit\");\n@@ -235,7 +235,7 @@ public void verifyPropagation() {\n                 + \"secondLevelContainer:second:remoteObject:propView:2:value:oldAttribute:field-label\", \"ou\");\n \n         TESTER.assertModelValue(\"body:content:body:outerObjectsRepeater:0:outer:form:content:customResultBody:\"\n-                + \"secondLevelContainer:second:remoteObject:propView:2:value:oldAttribute:textField\", \"two\");\n+                + \"secondLevelContainer:second:remoteObject:propView:2:value:oldAttribute:textField\", \"even\");\n \n         TESTER.assertLabel(\"body:content:body:outerObjectsRepeater:0:outer:form:content:customResultBody:\"\n                 + \"secondLevelContainer:second:remoteObject:propView:2:value:newAttribute:field-label\", \"ou\");"},{"sha":"549f4e0c08a4bab2b2e033f9d0454ebf30526958","filename":"fit/core-reference/src/test/java/org/apache/syncope/fit/core/PushTaskITCase.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/023b200886972f236323a649e30523d5945e4ec6/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FPushTaskITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/023b200886972f236323a649e30523d5945e4ec6/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FPushTaskITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FPushTaskITCase.java?ref=023b200886972f236323a649e30523d5945e4ec6","patch":"@@ -274,7 +274,7 @@ public void pushMatchingUser() throws Exception {\n     public void orgUnit() {\n         assertNull(getLdapRemoteObject(RESOURCE_LDAP_ADMIN_DN, RESOURCE_LDAP_ADMIN_PWD, \"ou=odd,o=isp\"));\n         assertNull(getLdapRemoteObject(RESOURCE_LDAP_ADMIN_DN, RESOURCE_LDAP_ADMIN_PWD, \"ou=even,o=isp\"));\n-        assertNull(getLdapRemoteObject(RESOURCE_LDAP_ADMIN_DN, RESOURCE_LDAP_ADMIN_PWD, \"ou=two,o=isp\"));\n+        assertNull(getLdapRemoteObject(RESOURCE_LDAP_ADMIN_DN, RESOURCE_LDAP_ADMIN_PWD, \"ou=two,ou=even,o=isp\"));\n \n         // 1. create task for pulling org units\n         PushTaskTO task = new PushTaskTO();"},{"sha":"02fe734ef5a751b79c8bda41dcece6e201021add","filename":"src/main/asciidoc/reference-guide/concepts/provisioning/propagation.adoc","status":"modified","additions":11,"deletions":0,"changes":11,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/023b200886972f236323a649e30523d5945e4ec6/src%2Fmain%2Fasciidoc%2Freference-guide%2Fconcepts%2Fprovisioning%2Fpropagation.adoc","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/023b200886972f236323a649e30523d5945e4ec6/src%2Fmain%2Fasciidoc%2Freference-guide%2Fconcepts%2Fprovisioning%2Fpropagation.adoc","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/src%2Fmain%2Fasciidoc%2Freference-guide%2Fconcepts%2Fprovisioning%2Fpropagation.adoc?ref=023b200886972f236323a649e30523d5945e4ec6","patch":"@@ -99,6 +99,17 @@ endif::[]\n the cipher algorithm associated with the password must match the value of `passwordHashAlgorithm` for the \n https://connid.atlassian.net/wiki/display/BASE/LDAP#LDAP-Configuration[LDAP connector bundle^].\n \n+| \n+ifeval::[\"{snapshotOrRelease}\" == \"release\"]\n+https://github.com/apache/syncope/blob/syncope-{docVersion}/core/provisioning-java/src/main/java/org/apache/syncope/core/provisioning/java/propagation/LDAPNestedRealmPropagationActions.java[LDAPNestedRealmPropagationActions^]\n+endif::[]\n+ifeval::[\"{snapshotOrRelease}\" == \"snapshot\"]\n+https://github.com/apache/syncope/blob/2_0_X/core/provisioning-java/src/main/java/org/apache/syncope/core/provisioning/java/propagation/LDAPNestedRealmPropagationActions.java[LDAPNestedRealmPropagationActions^]\n+endif::[]\n+| If a realm is child of some other realm (except root), i.e. has depth greater than 1, hence this hierarchy has to be \n+respected while propagating a realm to an LDAP resource.\n+This propagation action guarantees correct hierarchy propagation.\n+\n | \n ifeval::[\"{snapshotOrRelease}\" == \"release\"]\n https://github.com/apache/syncope/blob/syncope-{docVersion}/core/provisioning-java/src/main/java/org/apache/syncope/core/provisioning/java/propagation/LDAPPasswordPropagationActions.java[DBPasswordPropagationActions^]"}]}