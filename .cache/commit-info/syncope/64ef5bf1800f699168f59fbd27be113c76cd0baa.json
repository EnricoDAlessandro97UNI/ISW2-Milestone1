{"sha":"64ef5bf1800f699168f59fbd27be113c76cd0baa","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjY0ZWY1YmYxODAwZjY5OTE2OGY1OWZiZDI3YmUxMTNjNzZjZDBiYWE=","commit":{"author":{"name":"Colm O hEigeartaigh","email":"coheigea@apache.org","date":"2017-07-27T15:47:35Z"},"committer":{"name":"Colm O hEigeartaigh","email":"coheigea@apache.org","date":"2017-07-27T15:47:35Z"},"message":"SYNCOPE-1174 - NPE in AccessTokenDataBinderImpl if no 'jwt.lifetime.minutes' schema is present","tree":{"sha":"237a283a36d0ce821546d135e5442fdf8068a036","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/237a283a36d0ce821546d135e5442fdf8068a036"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/64ef5bf1800f699168f59fbd27be113c76cd0baa","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/64ef5bf1800f699168f59fbd27be113c76cd0baa","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/64ef5bf1800f699168f59fbd27be113c76cd0baa","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/64ef5bf1800f699168f59fbd27be113c76cd0baa/comments","author":{"login":"coheigea","id":472162,"node_id":"MDQ6VXNlcjQ3MjE2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/472162?v=4","gravatar_id":"","url":"https://api.github.com/users/coheigea","html_url":"https://github.com/coheigea","followers_url":"https://api.github.com/users/coheigea/followers","following_url":"https://api.github.com/users/coheigea/following{/other_user}","gists_url":"https://api.github.com/users/coheigea/gists{/gist_id}","starred_url":"https://api.github.com/users/coheigea/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coheigea/subscriptions","organizations_url":"https://api.github.com/users/coheigea/orgs","repos_url":"https://api.github.com/users/coheigea/repos","events_url":"https://api.github.com/users/coheigea/events{/privacy}","received_events_url":"https://api.github.com/users/coheigea/received_events","type":"User","site_admin":false},"committer":{"login":"coheigea","id":472162,"node_id":"MDQ6VXNlcjQ3MjE2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/472162?v=4","gravatar_id":"","url":"https://api.github.com/users/coheigea","html_url":"https://github.com/coheigea","followers_url":"https://api.github.com/users/coheigea/followers","following_url":"https://api.github.com/users/coheigea/following{/other_user}","gists_url":"https://api.github.com/users/coheigea/gists{/gist_id}","starred_url":"https://api.github.com/users/coheigea/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coheigea/subscriptions","organizations_url":"https://api.github.com/users/coheigea/orgs","repos_url":"https://api.github.com/users/coheigea/repos","events_url":"https://api.github.com/users/coheigea/events{/privacy}","received_events_url":"https://api.github.com/users/coheigea/received_events","type":"User","site_admin":false},"parents":[{"sha":"aa11ac9b41e738a37d695dc3a480965d9934c6ca","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/aa11ac9b41e738a37d695dc3a480965d9934c6ca","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/aa11ac9b41e738a37d695dc3a480965d9934c6ca"}],"stats":{"total":11,"additions":10,"deletions":1},"files":[{"sha":"b415fb2d80be1f59c54d0dfe8b8de548fd8e4d01","filename":"core/provisioning-java/src/main/java/org/apache/syncope/core/provisioning/java/data/AccessTokenDataBinderImpl.java","status":"modified","additions":10,"deletions":1,"changes":11,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/64ef5bf1800f699168f59fbd27be113c76cd0baa/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fdata%2FAccessTokenDataBinderImpl.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/64ef5bf1800f699168f59fbd27be113c76cd0baa/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fdata%2FAccessTokenDataBinderImpl.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fdata%2FAccessTokenDataBinderImpl.java?ref=64ef5bf1800f699168f59fbd27be113c76cd0baa","patch":"@@ -38,6 +38,7 @@\n import org.apache.syncope.core.persistence.api.dao.ConfDAO;\n import org.apache.syncope.core.persistence.api.entity.AccessToken;\n import org.apache.syncope.core.persistence.api.entity.EntityFactory;\n+import org.apache.syncope.core.persistence.api.entity.conf.CPlainAttr;\n import org.apache.syncope.core.provisioning.api.data.AccessTokenDataBinder;\n import org.apache.syncope.core.provisioning.api.serialization.POJOHelper;\n import org.apache.syncope.core.spring.BeanUtils;\n@@ -124,9 +125,17 @@ public Pair<String, Date> create(\n         }\n \n         if (replaceExisting || body == null) {\n+            int duration = 120;\n+            CPlainAttr jwtLifetimeMins = confDAO.find(\"jwt.lifetime.minutes\", \"120\");\n+            if (jwtLifetimeMins != null) {\n+                duration = jwtLifetimeMins.getValues().get(0).getLongValue().intValue();\n+            } else {\n+                LOG.warn(\"No schema found for 'jwt.lifetime.minutes'. Using default value of '120'\");\n+            }\n+\n             Triple<String, String, Date> created = generateJWT(\n                     subject,\n-                    confDAO.find(\"jwt.lifetime.minutes\", \"120\").getValues().get(0).getLongValue().intValue(),\n+                    duration,\n                     claims);\n \n             body = created.getMiddle();"}]}