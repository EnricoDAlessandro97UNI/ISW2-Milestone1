{"sha":"d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmQ5ODEzOGZjOWIwZWFjYTNhOGNiOWFkNWFmMWY0ZDg4OWFmYzA2OWI=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2012-08-13T07:18:04Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2012-08-13T07:18:04Z"},"message":"Upgrading to latest Activiti 5.10\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/syncope/trunk@1372285 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"f9c1ac2eb16528475f27fbc8f6e5888d5fe55903","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/f9c1ac2eb16528475f27fbc8f6e5888d5fe55903"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"1307ad3f3e3bd843070ad469c515285f111ca949","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/1307ad3f3e3bd843070ad469c515285f111ca949","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/1307ad3f3e3bd843070ad469c515285f111ca949"}],"stats":{"total":67,"additions":29,"deletions":38},"files":[{"sha":"ccced47eea613d8626a05c5c8a780dcb18fb314e","filename":"core/src/main/java/org/apache/syncope/core/init/ActivitiWorkflowLoader.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Finit%2FActivitiWorkflowLoader.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Finit%2FActivitiWorkflowLoader.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Finit%2FActivitiWorkflowLoader.java?ref=d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b","patch":"@@ -23,11 +23,11 @@\n import java.util.List;\n import org.activiti.engine.RepositoryService;\n import org.activiti.engine.repository.ProcessDefinition;\n+import org.apache.syncope.core.workflow.ActivitiUserWorkflowAdapter;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.stereotype.Component;\n-import org.apache.syncope.core.workflow.ActivitiUserWorkflowAdapter;\n \n @Component\n public class ActivitiWorkflowLoader {"},{"sha":"92082cee6eb35462ef2b50e91544d09185902b11","filename":"core/src/main/java/org/apache/syncope/core/init/ContentLoader.java","status":"modified","additions":0,"deletions":1,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Finit%2FContentLoader.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Finit%2FContentLoader.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Finit%2FContentLoader.java?ref=d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b","patch":"@@ -24,7 +24,6 @@\n import java.sql.ResultSet;\n import java.sql.SQLException;\n import java.util.Properties;\n-import java.util.logging.Level;\n import javax.sql.DataSource;\n import javax.xml.parsers.SAXParser;\n import javax.xml.parsers.SAXParserFactory;"},{"sha":"a189e1b73dc8f44ad5bb00b4cd6a2f7265297706","filename":"core/src/main/java/org/apache/syncope/core/workflow/activiti/SyncopeGroupManager.java","status":"modified","additions":1,"deletions":13,"changes":14,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fworkflow%2Factiviti%2FSyncopeGroupManager.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fworkflow%2Factiviti%2FSyncopeGroupManager.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fworkflow%2Factiviti%2FSyncopeGroupManager.java?ref=d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b","patch":"@@ -23,15 +23,14 @@\n import java.util.List;\n import org.activiti.engine.identity.Group;\n import org.activiti.engine.identity.GroupQuery;\n-import org.activiti.engine.impl.Page;\n import org.activiti.engine.impl.interceptor.Session;\n import org.activiti.engine.impl.persistence.entity.GroupEntity;\n import org.activiti.engine.impl.persistence.entity.GroupManager;\n-import org.springframework.beans.factory.annotation.Autowired;\n import org.apache.syncope.core.persistence.beans.role.SyncopeRole;\n import org.apache.syncope.core.persistence.beans.user.SyncopeUser;\n import org.apache.syncope.core.persistence.dao.RoleDAO;\n import org.apache.syncope.core.persistence.dao.UserDAO;\n+import org.springframework.beans.factory.annotation.Autowired;\n \n public class SyncopeGroupManager extends GroupManager implements SyncopeSession {\n \n@@ -77,17 +76,6 @@ public GroupEntity findGroupById(final String groupId) {\n         return result;\n     }\n \n-    @Override\n-    public List<Group> findGroupByQueryCriteria(final Object query, final Page page) {\n-\n-        throw new UnsupportedOperationException();\n-    }\n-\n-    @Override\n-    public long findGroupCountByQueryCriteria(final Object query) {\n-        throw new UnsupportedOperationException();\n-    }\n-\n     @Override\n     public List<Group> findGroupsByUser(final String userId) {\n         List<Group> result = Collections.EMPTY_LIST;"},{"sha":"fe28bdf8760245265adbf85a58c2ceee66b114de","filename":"core/src/main/java/org/apache/syncope/core/workflow/activiti/SyncopeGroupQueryImpl.java","status":"modified","additions":5,"deletions":0,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fworkflow%2Factiviti%2FSyncopeGroupQueryImpl.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fworkflow%2Factiviti%2FSyncopeGroupQueryImpl.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fworkflow%2Factiviti%2FSyncopeGroupQueryImpl.java?ref=d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b","patch":"@@ -146,6 +146,11 @@ public List<Group> list() {\n \n     @Override\n     public List<Group> listPage(final int firstResult, final int maxResults) {\n+        return list();\n+    }\n+\n+    @Override\n+    public GroupQuery potentialStarter(String procDefId) {\n         throw new UnsupportedOperationException();\n     }\n }"},{"sha":"298f1cec590497d9ac3bd2a719d1ce592749eef8","filename":"core/src/main/java/org/apache/syncope/core/workflow/activiti/SyncopeUserManager.java","status":"modified","additions":1,"deletions":13,"changes":14,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fworkflow%2Factiviti%2FSyncopeUserManager.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fworkflow%2Factiviti%2FSyncopeUserManager.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fworkflow%2Factiviti%2FSyncopeUserManager.java?ref=d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b","patch":"@@ -24,17 +24,16 @@\n import org.activiti.engine.identity.Group;\n import org.activiti.engine.identity.User;\n import org.activiti.engine.identity.UserQuery;\n-import org.activiti.engine.impl.Page;\n import org.activiti.engine.impl.interceptor.Session;\n import org.activiti.engine.impl.persistence.entity.GroupEntity;\n import org.activiti.engine.impl.persistence.entity.IdentityInfoEntity;\n import org.activiti.engine.impl.persistence.entity.UserEntity;\n import org.activiti.engine.impl.persistence.entity.UserManager;\n-import org.springframework.beans.factory.annotation.Autowired;\n import org.apache.syncope.core.persistence.beans.user.SyncopeUser;\n import org.apache.syncope.core.persistence.dao.EntitlementDAO;\n import org.apache.syncope.core.persistence.dao.RoleDAO;\n import org.apache.syncope.core.persistence.dao.UserDAO;\n+import org.springframework.beans.factory.annotation.Autowired;\n \n public class SyncopeUserManager extends UserManager implements SyncopeSession {\n \n@@ -97,17 +96,6 @@ public UserEntity findUserById(final String userId) {\n         return result;\n     }\n \n-    @Override\n-    public List<User> findUserByQueryCriteria(final Object query, final Page page) {\n-\n-        throw new UnsupportedOperationException();\n-    }\n-\n-    @Override\n-    public long findUserCountByQueryCriteria(final Object query) {\n-        throw new UnsupportedOperationException();\n-    }\n-\n     @Override\n     public IdentityInfoEntity findUserInfoByUserIdAndKey(final String userId, final String key) {\n "},{"sha":"292148212c5282b7052ebdc40b9334f69316378b","filename":"core/src/main/java/org/apache/syncope/core/workflow/activiti/SyncopeUserQueryImpl.java","status":"modified","additions":16,"deletions":5,"changes":21,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fworkflow%2Factiviti%2FSyncopeUserQueryImpl.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fworkflow%2Factiviti%2FSyncopeUserQueryImpl.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fworkflow%2Factiviti%2FSyncopeUserQueryImpl.java?ref=d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b","patch":"@@ -133,7 +133,7 @@ private User fromSyncopeUser(final SyncopeUser syncopeUser) {\n         return new UserEntity(syncopeUser.getUsername());\n     }\n \n-    private void execute() {\n+    private void execute(int page, int itemsPerPage) {\n         if (username != null) {\n             SyncopeUser user = userDAO.find(username);\n             if (user != null) {\n@@ -163,8 +163,11 @@ private void execute() {\n         // THIS CAN BE *VERY* DANGEROUS\n         if (result == null) {\n             result = new ArrayList<User>();\n-            for (SyncopeUser user : userDAO.findAll(EntitlementUtil.getRoleIds(entitlementDAO.findAll()))) {\n \n+            List<SyncopeUser> users = page == -1 && itemsPerPage == -1\n+                    ? userDAO.findAll(EntitlementUtil.getRoleIds(entitlementDAO.findAll()))\n+                    : userDAO.findAll(EntitlementUtil.getRoleIds(entitlementDAO.findAll()), page, itemsPerPage);\n+            for (SyncopeUser user : users) {\n                 result.add(fromSyncopeUser(user));\n             }\n         }\n@@ -173,15 +176,15 @@ private void execute() {\n     @Override\n     public long count() {\n         if (result == null) {\n-            execute();\n+            execute(-1, -1);\n         }\n         return result.size();\n     }\n \n     @Override\n     public User singleResult() {\n         if (result == null) {\n-            execute();\n+            execute(-1, -1);\n         }\n         if (result.isEmpty()) {\n             throw new ActivitiException(\"Empty result\");\n@@ -193,13 +196,21 @@ public User singleResult() {\n     @Override\n     public List<User> list() {\n         if (result == null) {\n-            execute();\n+            execute(-1, -1);\n         }\n         return result;\n     }\n \n     @Override\n     public List<User> listPage(final int firstResult, final int maxResults) {\n+        if (result == null) {\n+            execute((firstResult / maxResults) + 1, maxResults);\n+        }\n+        return result;\n+    }\n+\n+    @Override\n+    public UserQuery potentialStarter(String string) {\n         throw new UnsupportedOperationException();\n     }\n }"},{"sha":"ed57a7ab88f1d6c71a5952ab6e53438b32f85626","filename":"core/src/main/resources/content.xml","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b/core%2Fsrc%2Fmain%2Fresources%2Fcontent.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b/core%2Fsrc%2Fmain%2Fresources%2Fcontent.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fresources%2Fcontent.xml?ref=d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b","patch":"@@ -117,8 +117,8 @@ under the License.\n   <Entitlement name=\"AUDIT_ENABLE\"/>\n   <Entitlement name=\"AUDIT_DISABLE\"/>\n \n-  <ACT_GE_PROPERTY NAME_=\"schema.version\" VALUE_=\"5.9\" REV_=\"1\"/>\n-  <ACT_GE_PROPERTY NAME_=\"schema.history\" VALUE_=\"create(5.9)\" REV_=\"1\"/>\n+  <ACT_GE_PROPERTY NAME_=\"schema.version\" VALUE_=\"${activiti.version}\" REV_=\"1\"/>\n+  <ACT_GE_PROPERTY NAME_=\"schema.history\" VALUE_=\"create(${activiti.version})\" REV_=\"1\"/>\n   <ACT_GE_PROPERTY NAME_=\"next.dbid\" VALUE_=\"1\" REV_=\"1\"/>\n   <ACT_GE_PROPERTY NAME_=\"historyLevel\" VALUE_=\"1\" REV_=\"1\"/>    \n </dataset>"},{"sha":"b9c5c05ebc8a22e5295c6af96b800721bc87bf87","filename":"core/src/test/resources/content.xml","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b/core%2Fsrc%2Ftest%2Fresources%2Fcontent.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b/core%2Fsrc%2Ftest%2Fresources%2Fcontent.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Ftest%2Fresources%2Fcontent.xml?ref=d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b","patch":"@@ -692,8 +692,8 @@ under the License.\n   \n   <SyncopeLogger logName=\"syncope.audit.authentication.getEntitlements.success\" logLevel=\"DEBUG\" logType=\"AUDIT\"/>\n   \n-  <ACT_GE_PROPERTY NAME_=\"schema.version\" VALUE_=\"5.9\" REV_=\"1\"/>\n-  <ACT_GE_PROPERTY NAME_=\"schema.history\" VALUE_=\"create(5.9)\" REV_=\"1\"/>\n+  <ACT_GE_PROPERTY NAME_=\"schema.version\" VALUE_=\"${activiti.version}\" REV_=\"1\"/>\n+  <ACT_GE_PROPERTY NAME_=\"schema.history\" VALUE_=\"create(${activiti.version})\" REV_=\"1\"/>\n   <ACT_GE_PROPERTY NAME_=\"next.dbid\" VALUE_=\"1\" REV_=\"1\"/>\n   <ACT_GE_PROPERTY NAME_=\"historyLevel\" VALUE_=\"1\" REV_=\"1\"/>\n </dataset>"},{"sha":"9e921a5ee3c0ee2002ff6bb6d50cbda144c954a3","filename":"parent/pom.xml","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b/parent%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b/parent%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/parent%2Fpom.xml?ref=d98138fc9b0eaca3a8cb9ad5af1f4d889afc069b","patch":"@@ -243,7 +243,7 @@ under the License.\n         \n     <httpcomponents.version>4.2.1</httpcomponents.version>\n \n-    <activiti.version>5.9</activiti.version>\n+    <activiti.version>5.10</activiti.version>\n \n     <spring.version>3.1.2.RELEASE</spring.version>\n     <spring-security.version>3.1.2.RELEASE</spring-security.version>"}]}