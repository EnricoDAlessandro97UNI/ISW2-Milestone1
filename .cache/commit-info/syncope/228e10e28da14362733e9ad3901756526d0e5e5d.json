{"sha":"228e10e28da14362733e9ad3901756526d0e5e5d","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjIyOGUxMGUyOGRhMTQzNjI3MzNlOWFkMzkwMTc1NjUyNmQwZTVlNWQ=","commit":{"author":{"name":"skylark17","email":"matteo.alessandroni@tirasa.net","date":"2017-12-05T09:17:54Z"},"committer":{"name":"skylark17","email":"matteo.alessandroni@tirasa.net","date":"2017-12-05T09:19:56Z"},"message":"[SYNCOPE-1190] Toggle panel not refreshed after connector name update","tree":{"sha":"9c6f06055b813c328347a071066a0a4680d42986","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/9c6f06055b813c328347a071066a0a4680d42986"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/228e10e28da14362733e9ad3901756526d0e5e5d","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/228e10e28da14362733e9ad3901756526d0e5e5d","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/228e10e28da14362733e9ad3901756526d0e5e5d","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/228e10e28da14362733e9ad3901756526d0e5e5d/comments","author":{"login":"mat-ale","id":25547301,"node_id":"MDQ6VXNlcjI1NTQ3MzAx","avatar_url":"https://avatars.githubusercontent.com/u/25547301?v=4","gravatar_id":"","url":"https://api.github.com/users/mat-ale","html_url":"https://github.com/mat-ale","followers_url":"https://api.github.com/users/mat-ale/followers","following_url":"https://api.github.com/users/mat-ale/following{/other_user}","gists_url":"https://api.github.com/users/mat-ale/gists{/gist_id}","starred_url":"https://api.github.com/users/mat-ale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mat-ale/subscriptions","organizations_url":"https://api.github.com/users/mat-ale/orgs","repos_url":"https://api.github.com/users/mat-ale/repos","events_url":"https://api.github.com/users/mat-ale/events{/privacy}","received_events_url":"https://api.github.com/users/mat-ale/received_events","type":"User","site_admin":false},"committer":{"login":"mat-ale","id":25547301,"node_id":"MDQ6VXNlcjI1NTQ3MzAx","avatar_url":"https://avatars.githubusercontent.com/u/25547301?v=4","gravatar_id":"","url":"https://api.github.com/users/mat-ale","html_url":"https://github.com/mat-ale","followers_url":"https://api.github.com/users/mat-ale/followers","following_url":"https://api.github.com/users/mat-ale/following{/other_user}","gists_url":"https://api.github.com/users/mat-ale/gists{/gist_id}","starred_url":"https://api.github.com/users/mat-ale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mat-ale/subscriptions","organizations_url":"https://api.github.com/users/mat-ale/orgs","repos_url":"https://api.github.com/users/mat-ale/repos","events_url":"https://api.github.com/users/mat-ale/events{/privacy}","received_events_url":"https://api.github.com/users/mat-ale/received_events","type":"User","site_admin":false},"parents":[{"sha":"bf34f2c99befa5f0c54ed7dba3298e26131bd364","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/bf34f2c99befa5f0c54ed7dba3298e26131bd364","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/bf34f2c99befa5f0c54ed7dba3298e26131bd364"}],"stats":{"total":39,"additions":32,"deletions":7},"files":[{"sha":"bc2e99fa52e049e49cb4368505cb9c2c204887db","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/AnyDirectoryPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/228e10e28da14362733e9ad3901756526d0e5e5d/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/228e10e28da14362733e9ad3901756526d0e5e5d/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyDirectoryPanel.java?ref=228e10e28da14362733e9ad3901756526d0e5e5d","patch":"@@ -125,7 +125,7 @@ protected AnyDirectoryPanel(final String id, final Builder<A, E> builder, final\n \n         initResultTable();\n \n-        // cahnge close callback in order to update header after model update\n+        // change close callback in order to update header after model update\n         modal.setWindowClosedCallback(new ModalWindow.WindowClosedCallback() {\n \n             private static final long serialVersionUID = 8804221891699487139L;"},{"sha":"a074dd464d15c59e94b402be9d0ddd08e912ac4e","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/TogglePanel.java","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/228e10e28da14362733e9ad3901756526d0e5e5d/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FTogglePanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/228e10e28da14362733e9ad3901756526d0e5e5d/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FTogglePanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FTogglePanel.java?ref=228e10e28da14362733e9ad3901756526d0e5e5d","patch":"@@ -66,6 +66,8 @@\n     private static final long serialVersionUID = -2025535531121434056L;\n \n     protected static final Logger LOG = LoggerFactory.getLogger(TogglePanel.class);\n+    \n+    protected static final int HEADER_FIRST_ABBREVIATION = 25;\n \n     private enum Status {\n         INACTIVE,"},{"sha":"47bf258377fe71640c0338ffe761c53a0e94320e","filename":"client/console/src/main/java/org/apache/syncope/client/console/topology/TopologyNode.java","status":"modified","additions":5,"deletions":1,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/228e10e28da14362733e9ad3901756526d0e5e5d/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Ftopology%2FTopologyNode.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/228e10e28da14362733e9ad3901756526d0e5e5d/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Ftopology%2FTopologyNode.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Ftopology%2FTopologyNode.java?ref=228e10e28da14362733e9ad3901756526d0e5e5d","patch":"@@ -45,7 +45,7 @@ public enum Status {\n \n     private final String key;\n \n-    private final String displayName;\n+    private String displayName;\n \n     private String connectionDisplayName;\n \n@@ -73,6 +73,10 @@ public String getDisplayName() {\n         return displayName;\n     }\n \n+    public void setDisplayName(final String displayName) {\n+        this.displayName = displayName;\n+    }\n+\n     public String getConnectionDisplayName() {\n         return connectionDisplayName;\n     }"},{"sha":"ad0960ba9a755e14d84546f8a50ffdb3260234c1","filename":"client/console/src/main/java/org/apache/syncope/client/console/topology/TopologyNodePanel.java","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/228e10e28da14362733e9ad3901756526d0e5e5d/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Ftopology%2FTopologyNodePanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/228e10e28da14362733e9ad3901756526d0e5e5d/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Ftopology%2FTopologyNodePanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Ftopology%2FTopologyNodePanel.java?ref=228e10e28da14362733e9ad3901756526d0e5e5d","patch":"@@ -133,6 +133,7 @@ public void onEvent(final IEvent<?> event) {\n \n                 label.setDefaultModelObject(resourceName);\n                 target.add(label);\n+                node.setDisplayName(displayName);\n             }\n         }\n     }"},{"sha":"5f33ed5ca01e21fd1f8d3143f749542d44aa76cd","filename":"client/console/src/main/java/org/apache/syncope/client/console/topology/TopologyTogglePanel.java","status":"modified","additions":20,"deletions":2,"changes":22,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/228e10e28da14362733e9ad3901756526d0e5e5d/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Ftopology%2FTopologyTogglePanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/228e10e28da14362733e9ad3901756526d0e5e5d/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Ftopology%2FTopologyTogglePanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Ftopology%2FTopologyTogglePanel.java?ref=228e10e28da14362733e9ad3901756526d0e5e5d","patch":"@@ -18,6 +18,7 @@\n  */\n package org.apache.syncope.client.console.topology;\n \n+\n import de.agilecoders.wicket.core.markup.html.bootstrap.dialog.Modal;\n import java.io.Serializable;\n import java.text.MessageFormat;\n@@ -53,6 +54,7 @@\n import org.apache.wicket.ajax.markup.html.AjaxLink;\n import org.apache.wicket.authroles.authorization.strategies.role.metadata.MetaDataRoleAuthorizationStrategy;\n import org.apache.wicket.event.Broadcast;\n+import org.apache.wicket.event.IEvent;\n import org.apache.wicket.extensions.ajax.markup.html.IndicatingAjaxLink;\n import org.apache.wicket.extensions.ajax.markup.html.modal.ModalWindow;\n import org.apache.wicket.markup.html.WebMarkupContainer;\n@@ -148,7 +150,7 @@ public void onClose(final AjaxRequestTarget target) {\n                 container.addOrReplace(getConnectorFragment(node, pageRef));\n                 break;\n             case RESOURCE:\n-                container.addOrReplace(getResurceFragment(node, pageRef));\n+                container.addOrReplace(getResourceFragment(node, pageRef));\n                 break;\n             default:\n                 container.addOrReplace(getEmptyFragment());\n@@ -358,7 +360,7 @@ public String getAjaxIndicatorMarkupId() {\n         return fragment;\n     }\n \n-    private Fragment getResurceFragment(final TopologyNode node, final PageReference pageRef) {\n+    private Fragment getResourceFragment(final TopologyNode node, final PageReference pageRef) {\n         Fragment fragment = new Fragment(\"actions\", \"resourceActions\", this);\n \n         AjaxLink<String> delete = new IndicatingOnConfirmAjaxLink<String>(\"delete\", true) {\n@@ -640,6 +642,22 @@ public void onClick(final AjaxRequestTarget target) {\n         return fragment;\n     }\n \n+    @Override\n+    public void onEvent(final IEvent<?> event) {\n+        super.onEvent(event);\n+\n+        if (event.getPayload() instanceof AjaxWizard.NewItemFinishEvent) {\n+            final AjaxWizard.NewItemFinishEvent item = AjaxWizard.NewItemFinishEvent.class.cast(event.getPayload());\n+            final Serializable result = item.getResult();\n+            final AjaxRequestTarget target = item.getTarget();\n+            if (result != null && result instanceof ConnInstanceTO) {\n+                // update Toggle Panel header\n+                ConnInstanceTO conn = ConnInstanceTO.class.cast(result);\n+                setHeader(target, StringUtils.abbreviate(conn.getDisplayName(), HEADER_FIRST_ABBREVIATION));\n+            }\n+        }\n+    }\n+\n     public final class UpdateEvent {\n \n         private final AjaxRequestTarget target;"},{"sha":"1ebfc25b2496ae6b1883eb00f9ba0ceb1478e45f","filename":"client/console/src/main/java/org/apache/syncope/client/console/wicket/markup/html/form/ActionLinksTogglePanel.java","status":"modified","additions":3,"deletions":3,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/228e10e28da14362733e9ad3901756526d0e5e5d/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FActionLinksTogglePanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/228e10e28da14362733e9ad3901756526d0e5e5d/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FActionLinksTogglePanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FActionLinksTogglePanel.java?ref=228e10e28da14362733e9ad3901756526d0e5e5d","patch":"@@ -125,9 +125,9 @@ public void updateHeader(\n         } else {\n             header = new ResourceModel(\"actions\", StringUtils.EMPTY).getObject();\n         }\n-        setHeader(target, StringUtils.abbreviate(header, 25));\n+        setHeader(target, StringUtils.abbreviate(header, HEADER_FIRST_ABBREVIATION));\n     }\n-        \n+\n     public void toggleWithContent(\n             final AjaxRequestTarget target, final ActionsPanel<T> actionsPanel, final T modelObject) {\n         updateHeader(target, modelObject);\n@@ -147,7 +147,7 @@ public void onClose(final AjaxRequestTarget target) {\n \n         container.addOrReplace(frag);\n         target.add(this.container);\n-        \n+\n         toggle(target, modelObject, true);\n     }\n "}]}