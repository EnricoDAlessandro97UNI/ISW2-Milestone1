{"sha":"fcba4ceb069085f6aa7bb33050d7d77ef476be94","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmZjYmE0Y2ViMDY5MDg1ZjZhYTdiYjMzMDUwZDdkNzdlZjQ3NmJlOTQ=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2013-10-25T08:27:12Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2013-10-25T08:27:12Z"},"message":"[SYNCOPE-426] Setting UserMod#id and RoleMod#id in service implementations, prior to call to controllers\n\ngit-svn-id: https://svn.apache.org/repos/asf/syncope/branches/1_1_X@1535655 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"b81bc3344d92266070c52460b021fefaae56e025","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/b81bc3344d92266070c52460b021fefaae56e025"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/fcba4ceb069085f6aa7bb33050d7d77ef476be94","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/fcba4ceb069085f6aa7bb33050d7d77ef476be94","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/fcba4ceb069085f6aa7bb33050d7d77ef476be94","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/fcba4ceb069085f6aa7bb33050d7d77ef476be94/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"1873825489cf9cb52be9a87f716b2f9501f88c56","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/1873825489cf9cb52be9a87f716b2f9501f88c56","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/1873825489cf9cb52be9a87f716b2f9501f88c56"}],"stats":{"total":45,"additions":30,"deletions":15},"files":[{"sha":"e95fc54aafcee0ebe72e72aacc6dcc7157fa0f3b","filename":"client/src/main/java/org/apache/syncope/client/services/proxy/RoleServiceProxy.java","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fcba4ceb069085f6aa7bb33050d7d77ef476be94/client%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fservices%2Fproxy%2FRoleServiceProxy.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fcba4ceb069085f6aa7bb33050d7d77ef476be94/client%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fservices%2Fproxy%2FRoleServiceProxy.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fservices%2Fproxy%2FRoleServiceProxy.java?ref=fcba4ceb069085f6aa7bb33050d7d77ef476be94","patch":"@@ -108,6 +108,7 @@ public RoleTO selfRead(final Long roleId) {\n \r\n     @Override\r\n     public RoleTO update(final Long roleId, final RoleMod roleMod) {\r\n+        roleMod.setId(roleId);\r\n         return getRestTemplate().postForObject(baseUrl + \"role/update\", roleMod, RoleTO.class);\r\n     }\r\n }\r"},{"sha":"af59ec5ffed4d3b1e22c493b618c6634a5b012da","filename":"client/src/main/java/org/apache/syncope/client/services/proxy/UserServiceProxy.java","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fcba4ceb069085f6aa7bb33050d7d77ef476be94/client%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fservices%2Fproxy%2FUserServiceProxy.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fcba4ceb069085f6aa7bb33050d7d77ef476be94/client%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fservices%2Fproxy%2FUserServiceProxy.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fservices%2Fproxy%2FUserServiceProxy.java?ref=fcba4ceb069085f6aa7bb33050d7d77ef476be94","patch":"@@ -77,6 +77,7 @@ public Response create(final UserTO userTO) {\n \n     @Override\n     public UserTO update(final Long userId, final UserMod userMod) {\n+        userMod.setId(userId);\n         return getRestTemplate().postForObject(baseUrl + \"user/update\", userMod, UserTO.class);\n     }\n "},{"sha":"e6331b6bd6f2b9ced754ee62c85239bc53060dae","filename":"core/src/main/java/org/apache/syncope/core/services/RoleServiceImpl.java","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fcba4ceb069085f6aa7bb33050d7d77ef476be94/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fservices%2FRoleServiceImpl.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fcba4ceb069085f6aa7bb33050d7d77ef476be94/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fservices%2FRoleServiceImpl.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fservices%2FRoleServiceImpl.java?ref=fcba4ceb069085f6aa7bb33050d7d77ef476be94","patch":"@@ -115,6 +115,7 @@ public void setUriInfo(final UriInfo ui) {\n \r\n     @Override\r\n     public RoleTO update(final Long roleId, final RoleMod roleMod) {\r\n+        roleMod.setId(roleId);\r\n         return roleController.update(roleMod);\r\n     }\r\n \r"},{"sha":"b09ee2d1067451fb04695fa6c67d5734f61a2475","filename":"core/src/main/java/org/apache/syncope/core/services/UserServiceImpl.java","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fcba4ceb069085f6aa7bb33050d7d77ef476be94/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fservices%2FUserServiceImpl.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fcba4ceb069085f6aa7bb33050d7d77ef476be94/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fservices%2FUserServiceImpl.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fservices%2FUserServiceImpl.java?ref=fcba4ceb069085f6aa7bb33050d7d77ef476be94","patch":"@@ -165,6 +165,7 @@ public UserTO suspendByUsername(final String username, final PropagationRequestT\n \n     @Override\n     public UserTO update(final Long userId, final UserMod userMod) {\n+        userMod.setId(userId);\n         return userController.update(userMod);\n     }\n "},{"sha":"7f58163f8c1faefc7a9c7150e2b2f809e6760bac","filename":"core/src/test/java/org/apache/syncope/core/rest/UserTestITCase.java","status":"modified","additions":26,"deletions":15,"changes":41,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fcba4ceb069085f6aa7bb33050d7d77ef476be94/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2FUserTestITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fcba4ceb069085f6aa7bb33050d7d77ef476be94/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2FUserTestITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2FUserTestITCase.java?ref=fcba4ceb069085f6aa7bb33050d7d77ef476be94","patch":"@@ -560,8 +560,8 @@ public void createWithReject() {\n         assertNull(form.getOwner());\n \n         // 3. claim task from rossini, not in role 7 (designated for approval in workflow definition): fail\n-        UserWorkflowService userService2 =\n-                setupCredentials(userWorkflowService, UserWorkflowService.class, \"rossini\", ADMIN_PWD);\n+        UserWorkflowService userService2 = setupCredentials(\n+                userWorkflowService, UserWorkflowService.class, \"rossini\", ADMIN_PWD);\n \n         try {\n             userService2.claimForm(form.getTaskId());\n@@ -571,8 +571,8 @@ public void createWithReject() {\n         }\n \n         // 4. claim task from bellini, in role 7\n-        UserWorkflowService userService3 =\n-                setupCredentials(userWorkflowService, UserWorkflowService.class, \"bellini\", ADMIN_PWD);\n+        UserWorkflowService userService3 = setupCredentials(userWorkflowService, UserWorkflowService.class, \"bellini\",\n+                ADMIN_PWD);\n \n         form = userService3.claimForm(form.getTaskId());\n         assertNotNull(form);\n@@ -593,7 +593,7 @@ public void createWithReject() {\n         Exception exception = null;\n         try {\n             jdbcTemplate.queryForObject(\"SELECT id FROM test WHERE id=?\",\n-                    new String[] {userTO.getUsername()}, Integer.class);\n+                    new String[] { userTO.getUsername() }, Integer.class);\n         } catch (EmptyResultDataAccessException e) {\n             exception = e;\n         }\n@@ -630,7 +630,7 @@ public void createWithApproval() {\n         Exception exception = null;\n         try {\n             jdbcTemplate.queryForObject(\"SELECT id FROM test WHERE id=?\",\n-                    new String[] {userTO.getUsername()}, Integer.class);\n+                    new String[] { userTO.getUsername() }, Integer.class);\n         } catch (EmptyResultDataAccessException e) {\n             exception = e;\n         }\n@@ -947,7 +947,6 @@ public void verifyTaskRegistration() {\n         // --------------------------------------\n         // Create operation\n         // --------------------------------------\n-\n         UserTO userTO = getUniqueSampleTO(\"t@p.mode\");\n \n         // add a membership\n@@ -1843,16 +1842,16 @@ public void issueSYNCOPE122() {\n \n         final String pwdOnSyncope = userTO.getPassword();\n \n-        ConnObjectTO userOnDb =\n-                resourceService.getConnectorObject(RESOURCE_NAME_TESTDB, AttributableType.USER, userTO.getId());\n+        ConnObjectTO userOnDb = resourceService.getConnectorObject(\n+                RESOURCE_NAME_TESTDB, AttributableType.USER, userTO.getId());\n         final AttributeTO pwdOnTestDbAttr = userOnDb.getAttributeMap().get(OperationalAttributes.PASSWORD_NAME);\n         assertNotNull(pwdOnTestDbAttr);\n         assertNotNull(pwdOnTestDbAttr.getValues());\n         assertFalse(pwdOnTestDbAttr.getValues().isEmpty());\n         final String pwdOnTestDb = pwdOnTestDbAttr.getValues().iterator().next();\n \n-        ConnObjectTO userOnDb2 =\n-                resourceService.getConnectorObject(\"resource-testdb2\", AttributableType.USER, userTO.getId());\n+        ConnObjectTO userOnDb2 = resourceService.getConnectorObject(\n+                \"resource-testdb2\", AttributableType.USER, userTO.getId());\n         final AttributeTO pwdOnTestDb2Attr = userOnDb2.getAttributeMap().get(OperationalAttributes.PASSWORD_NAME);\n         assertNotNull(pwdOnTestDb2Attr);\n         assertNotNull(pwdOnTestDb2Attr.getValues());\n@@ -2126,8 +2125,8 @@ public void issueSYNCOPE354() {\n         assertTrue(userTO.getResources().contains(RESOURCE_NAME_LDAP));\n \n         // 3. read role on resource, check that user DN is included in uniqueMember\n-        ConnObjectTO connObj =\n-                resourceService.getConnectorObject(RESOURCE_NAME_LDAP, AttributableType.ROLE, roleTO.getId());\n+        ConnObjectTO connObj = resourceService.getConnectorObject(\n+                RESOURCE_NAME_LDAP, AttributableType.ROLE, roleTO.getId());\n         assertNotNull(connObj);\n         assertTrue(connObj.getAttributeMap().get(\"uniqueMember\").getValues().\n                 contains(\"uid=\" + userTO.getUsername() + \",ou=people,o=isp\"));\n@@ -2176,8 +2175,8 @@ public void issueSYNCOPE357() {\n         assertTrue(userTO.getResources().contains(RESOURCE_NAME_LDAP));\n \n         // 3. read user on resource\n-        ConnObjectTO connObj =\n-                resourceService.getConnectorObject(RESOURCE_NAME_LDAP, AttributableType.USER, userTO.getId());\n+        ConnObjectTO connObj = resourceService.getConnectorObject(\n+                RESOURCE_NAME_LDAP, AttributableType.USER, userTO.getId());\n         assertNotNull(connObj);\n \n         // 4. remove role\n@@ -2344,6 +2343,18 @@ public void issueSYNCOPE420() {\n         assertEquals(\"14\", userTO.getAttributeMap().get(\"makeItDouble\").getValues().get(0));\n     }\n \n+    @Test\n+    public void issueSYNCOPE426() {\n+        UserTO userTO = getUniqueSampleTO(\"syncope426@syncope.apache.org\");\n+        userTO = createUser(userTO);\n+        assertNotNull(userTO);\n+\n+        UserMod userMod = new UserMod();\n+        userMod.setPassword(\"anotherPassword123\");\n+        userTO = userService.update(userTO.getId(), userMod);\n+        assertNotNull(userTO);\n+    }\n+\n     private boolean getBooleanAttribute(ConnObjectTO connObjectTO, String attrName) {\n         return Boolean.parseBoolean(getStringAttribute(connObjectTO, attrName));\n     }"}]}