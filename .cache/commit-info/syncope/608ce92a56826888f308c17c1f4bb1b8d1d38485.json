{"sha":"608ce92a56826888f308c17c1f4bb1b8d1d38485","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjYwOGNlOTJhNTY4MjY4ODhmMzA4YzE3YzFmNGJiMWI4ZDFkMzg0ODU=","commit":{"author":{"name":"Unknown","email":"unknown@apache.org","date":"2010-11-25T09:23:06Z"},"committer":{"name":"Unknown","email":"unknown@apache.org","date":"2010-11-25T09:23:06Z"},"message":"Fixing JPA layer for OSWorkflow\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/syncope/trunk@1246648 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"7c0116d041fa5481f7bdbad019c841bb0f8fab5e","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/7c0116d041fa5481f7bdbad019c841bb0f8fab5e"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/608ce92a56826888f308c17c1f4bb1b8d1d38485","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/608ce92a56826888f308c17c1f4bb1b8d1d38485","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/608ce92a56826888f308c17c1f4bb1b8d1d38485","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/608ce92a56826888f308c17c1f4bb1b8d1d38485/comments","author":null,"committer":null,"parents":[{"sha":"05bb4ccbd25f58010dd0655aaca64aefd7492d77","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/05bb4ccbd25f58010dd0655aaca64aefd7492d77","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/05bb4ccbd25f58010dd0655aaca64aefd7492d77"}],"stats":{"total":24,"additions":13,"deletions":11},"files":[{"sha":"de19ab9fafbf81358db1148f0f707ea4b9dc90fe","filename":"core/src/main/java/jpasymphony/beans/JPACurrentStep.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/608ce92a56826888f308c17c1f4bb1b8d1d38485/core%2Fsrc%2Fmain%2Fjava%2Fjpasymphony%2Fbeans%2FJPACurrentStep.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/608ce92a56826888f308c17c1f4bb1b8d1d38485/core%2Fsrc%2Fmain%2Fjava%2Fjpasymphony%2Fbeans%2FJPACurrentStep.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Fjpasymphony%2Fbeans%2FJPACurrentStep.java?ref=608ce92a56826888f308c17c1f4bb1b8d1d38485","patch":"@@ -26,7 +26,7 @@ public class JPACurrentStep extends AbstractJPAStep {\n \n     @Id\n     @GeneratedValue(strategy = GenerationType.AUTO)\n-    private Long id;\n+    private long id;\n \n     @Override\n     public long getId() {"},{"sha":"50bfa5bef394f084812a33aa0cc03788bbad101c","filename":"core/src/main/java/jpasymphony/beans/JPAHistoryStep.java","status":"modified","additions":3,"deletions":3,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/608ce92a56826888f308c17c1f4bb1b8d1d38485/core%2Fsrc%2Fmain%2Fjava%2Fjpasymphony%2Fbeans%2FJPAHistoryStep.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/608ce92a56826888f308c17c1f4bb1b8d1d38485/core%2Fsrc%2Fmain%2Fjava%2Fjpasymphony%2Fbeans%2FJPAHistoryStep.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Fjpasymphony%2Fbeans%2FJPAHistoryStep.java?ref=608ce92a56826888f308c17c1f4bb1b8d1d38485","patch":"@@ -2,9 +2,9 @@\n  *  Licensed under the Apache License, Version 2.0 (the \"License\");\n  *  you may not use this file except in compliance with the License.\n  *  You may obtain a copy of the License at\n- * \n+ *\n  *       http://www.apache.org/licenses/LICENSE-2.0\n- * \n+ *\n  *  Unless required by applicable law or agreed to in writing, software\n  *  distributed under the License is distributed on an \"AS IS\" BASIS,\n  *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n@@ -26,7 +26,7 @@ public class JPAHistoryStep extends AbstractJPAStep {\n \n     @Id\n     @GeneratedValue(strategy = GenerationType.AUTO)\n-    private Long id;\n+    private long id;\n \n     @Override\n     public long getId() {"},{"sha":"d18350215f318b4433ef021c4ab793bb2783c367","filename":"core/src/main/java/jpasymphony/beans/JPAWorkflowEntry.java","status":"modified","additions":5,"deletions":3,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/608ce92a56826888f308c17c1f4bb1b8d1d38485/core%2Fsrc%2Fmain%2Fjava%2Fjpasymphony%2Fbeans%2FJPAWorkflowEntry.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/608ce92a56826888f308c17c1f4bb1b8d1d38485/core%2Fsrc%2Fmain%2Fjava%2Fjpasymphony%2Fbeans%2FJPAWorkflowEntry.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Fjpasymphony%2Fbeans%2FJPAWorkflowEntry.java?ref=608ce92a56826888f308c17c1f4bb1b8d1d38485","patch":"@@ -33,7 +33,7 @@ public class JPAWorkflowEntry extends AbstractBaseBean\n \n     @Id\n     @GeneratedValue(strategy = GenerationType.AUTO)\n-    private Long id;\n+    private long id;\n \n     private String workflowName;\n \n@@ -84,7 +84,8 @@ public void setWorkflowName(final String workflowName) {\n \n     public boolean addCurrentStep(final JPACurrentStep currentStep) {\n         currentStep.setWorkflowEntry(this);\n-        return currentSteps.add(currentStep);\n+        return currentSteps.contains(currentStep)\n+                ? false : currentSteps.add(currentStep);\n     }\n \n     public boolean removeCurrentStep(final JPACurrentStep currentStep) {\n@@ -113,7 +114,8 @@ public void setCurrentSteps(final List<JPACurrentStep> currentSteps) {\n \n     public boolean addHistoryStep(final JPAHistoryStep historyStep) {\n         historyStep.setWorkflowEntry(this);\n-        return historySteps.add(historyStep);\n+        return historySteps.contains(historyStep)\n+                ? false : historySteps.add(historyStep);\n     }\n \n     public boolean removeHistoryStep(final JPAHistoryStep historyStep) {"},{"sha":"bc5314d21c6ea405634be816bb531239c315754b","filename":"core/src/main/java/jpasymphony/workflow/spi/jpa/JPAWorkflowStore.java","status":"modified","additions":4,"deletions":4,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/608ce92a56826888f308c17c1f4bb1b8d1d38485/core%2Fsrc%2Fmain%2Fjava%2Fjpasymphony%2Fworkflow%2Fspi%2Fjpa%2FJPAWorkflowStore.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/608ce92a56826888f308c17c1f4bb1b8d1d38485/core%2Fsrc%2Fmain%2Fjava%2Fjpasymphony%2Fworkflow%2Fspi%2Fjpa%2FJPAWorkflowStore.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Fjpasymphony%2Fworkflow%2Fspi%2Fjpa%2FJPAWorkflowStore.java?ref=608ce92a56826888f308c17c1f4bb1b8d1d38485","patch":"@@ -171,7 +171,7 @@ public Step markFinished(final Step step,\n             final String caller)\n             throws StoreException {\n \n-        JPACurrentStep currentStep = (JPACurrentStep) step;\n+        final JPACurrentStep currentStep = (JPACurrentStep) step;\n \n         currentStep.setActionId(actionId);\n         currentStep.setFinishDate(finishDate);\n@@ -187,10 +187,10 @@ public Step markFinished(final Step step,\n     public void moveToHistory(final Step step)\n             throws StoreException {\n \n-        JPACurrentStep currentStep = (JPACurrentStep) step;\n+        final JPACurrentStep currentStep = (JPACurrentStep) step;\n         JPAWorkflowEntry entry = currentStep.getWorkflowEntry();\n \n-        JPAHistoryStep historyStep = new JPAHistoryStep();\n+        final JPAHistoryStep historyStep = new JPAHistoryStep();\n         historyStep.setActionId(currentStep.getActionId());\n         historyStep.setCaller(currentStep.getCaller());\n         historyStep.setDueDate(currentStep.getDueDate());\n@@ -205,7 +205,7 @@ public void moveToHistory(final Step step)\n         workflowEntryDAO.deleteCurrentStep(currentStep.getId());\n \n         entry.addHistoryStep(historyStep);\n-        workflowEntryDAO.save(entry);\n+        entry = workflowEntryDAO.save(entry);\n     }\n \n     @Override"}]}