{"sha":"2c4d5b4d3a73c0f8d999e5eb5de77360b920d669","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjJjNGQ1YjRkM2E3M2MwZjhkOTk5ZTVlYjVkZTc3MzYwYjkyMGQ2Njk=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2020-03-23T13:59:58Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2020-03-23T13:59:58Z"},"message":"Reverting SMTP server changes in Build Tools to avoid error with JDK 11+","tree":{"sha":"abe039dfb7b970d364d26bc7097624d516b06290","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/abe039dfb7b970d364d26bc7097624d516b06290"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/2c4d5b4d3a73c0f8d999e5eb5de77360b920d669","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/2c4d5b4d3a73c0f8d999e5eb5de77360b920d669","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/2c4d5b4d3a73c0f8d999e5eb5de77360b920d669","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/2c4d5b4d3a73c0f8d999e5eb5de77360b920d669/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"35cf1651fb5eef015cf79103264136979d8d5222","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/35cf1651fb5eef015cf79103264136979d8d5222","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/35cf1651fb5eef015cf79103264136979d8d5222"}],"stats":{"total":67,"additions":60,"deletions":7},"files":[{"sha":"5a1d2b3b41dbdce2ce0a12f1b1693a554ccc8a7d","filename":"fit/build-tools/src/main/java/com/icegreen/greenmail/smtp/InterruptableSmtpServer.java","status":"renamed","additions":1,"deletions":2,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/2c4d5b4d3a73c0f8d999e5eb5de77360b920d669/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fjava%2Fcom%2Ficegreen%2Fgreenmail%2Fsmtp%2FInterruptableSmtpServer.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/2c4d5b4d3a73c0f8d999e5eb5de77360b920d669/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fjava%2Fcom%2Ficegreen%2Fgreenmail%2Fsmtp%2FInterruptableSmtpServer.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fjava%2Fcom%2Ficegreen%2Fgreenmail%2Fsmtp%2FInterruptableSmtpServer.java?ref=2c4d5b4d3a73c0f8d999e5eb5de77360b920d669","patch":"@@ -16,11 +16,10 @@\n  * specific language governing permissions and limitations\n  * under the License.\n  */\n-package org.apache.syncope.fit.buildtools;\n+package com.icegreen.greenmail.smtp;\n \n import com.icegreen.greenmail.Managers;\n import com.icegreen.greenmail.server.ProtocolHandler;\n-import com.icegreen.greenmail.smtp.SmtpServer;\n import com.icegreen.greenmail.util.ServerSetup;\n import java.io.IOException;\n import java.net.Socket;","previous_filename":"fit/build-tools/src/main/java/org/apache/syncope/fit/buildtools/InterruptableSmtpServer.java"},{"sha":"cc70c3452625ba15ab134a0e43ecc68955058593","filename":"fit/build-tools/src/main/java/com/icegreen/greenmail/util/InterruptableGreenMail.java","status":"added","additions":54,"deletions":0,"changes":54,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/2c4d5b4d3a73c0f8d999e5eb5de77360b920d669/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fjava%2Fcom%2Ficegreen%2Fgreenmail%2Futil%2FInterruptableGreenMail.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/2c4d5b4d3a73c0f8d999e5eb5de77360b920d669/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fjava%2Fcom%2Ficegreen%2Fgreenmail%2Futil%2FInterruptableGreenMail.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fjava%2Fcom%2Ficegreen%2Fgreenmail%2Futil%2FInterruptableGreenMail.java?ref=2c4d5b4d3a73c0f8d999e5eb5de77360b920d669","patch":"@@ -0,0 +1,54 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package com.icegreen.greenmail.util;\n+\n+import com.icegreen.greenmail.Managers;\n+import com.icegreen.greenmail.imap.ImapServer;\n+import com.icegreen.greenmail.pop3.Pop3Server;\n+import com.icegreen.greenmail.server.AbstractServer;\n+import com.icegreen.greenmail.smtp.InterruptableSmtpServer;\n+import java.util.HashMap;\n+import java.util.Map;\n+\n+public class InterruptableGreenMail extends GreenMail {\n+\n+    public InterruptableGreenMail(final ServerSetup[] config) {\n+        super(config);\n+    }\n+\n+    @Override\n+    protected Map<String, AbstractServer> createServices(final ServerSetup[] config, final Managers mgr) {\n+        Map<String, AbstractServer> srvc = new HashMap<>();\n+        for (ServerSetup setup : config) {\n+            if (srvc.containsKey(setup.getProtocol())) {\n+                throw new IllegalArgumentException(\"Server '\" + setup.getProtocol()\n+                        + \"' was found at least twice in the array\");\n+            }\n+            final String protocol = setup.getProtocol();\n+            if (protocol.startsWith(ServerSetup.PROTOCOL_SMTP)) {\n+                srvc.put(protocol, new InterruptableSmtpServer(setup, mgr));\n+            } else if (protocol.startsWith(ServerSetup.PROTOCOL_POP3)) {\n+                srvc.put(protocol, new Pop3Server(setup, mgr));\n+            } else if (protocol.startsWith(ServerSetup.PROTOCOL_IMAP)) {\n+                srvc.put(protocol, new ImapServer(setup, mgr));\n+            }\n+        }\n+        return srvc;\n+    }\n+}"},{"sha":"ce2acbdcb2d252c6fb9a803cc94a735cf1824d27","filename":"fit/build-tools/src/main/java/org/apache/syncope/fit/buildtools/GreenMailStartStopListener.java","status":"modified","additions":4,"deletions":4,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/2c4d5b4d3a73c0f8d999e5eb5de77360b920d669/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fbuildtools%2FGreenMailStartStopListener.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/2c4d5b4d3a73c0f8d999e5eb5de77360b920d669/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fbuildtools%2FGreenMailStartStopListener.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fbuildtools%2FGreenMailStartStopListener.java?ref=2c4d5b4d3a73c0f8d999e5eb5de77360b920d669","patch":"@@ -18,7 +18,7 @@\n  */\n package org.apache.syncope.fit.buildtools;\n \n-import com.icegreen.greenmail.util.GreenMail;\n+import com.icegreen.greenmail.util.InterruptableGreenMail;\n import com.icegreen.greenmail.util.ServerSetup;\n import javax.servlet.ServletContext;\n import javax.servlet.ServletContextEvent;\n@@ -44,7 +44,7 @@ public void contextInitialized(final ServletContextEvent sce) {\n         ServletContext sc = sce.getServletContext();\n         WebApplicationContext ctx = WebApplicationContextUtils.getWebApplicationContext(sc);\n \n-        GreenMail greenMail = (GreenMail) sc.getAttribute(GREENMAIL);\n+        InterruptableGreenMail greenMail = (InterruptableGreenMail) sc.getAttribute(GREENMAIL);\n         if (greenMail == null) {\n             ServerSetup[] config = new ServerSetup[2];\n             config[0] = new ServerSetup(\n@@ -53,7 +53,7 @@ public void contextInitialized(final ServletContextEvent sce) {\n             config[1] = new ServerSetup(\n                     ctx.getEnvironment().getProperty(\"testmail.pop3port\", Integer.class),\n                     \"localhost\", ServerSetup.PROTOCOL_POP3);\n-            greenMail = new GreenMail(config);\n+            greenMail = new InterruptableGreenMail(config);\n             greenMail.start();\n \n             sc.setAttribute(GREENMAIL, greenMail);\n@@ -66,7 +66,7 @@ public void contextInitialized(final ServletContextEvent sce) {\n     public void contextDestroyed(final ServletContextEvent sce) {\n         ServletContext sc = sce.getServletContext();\n \n-        GreenMail greenMail = (GreenMail) sc.getAttribute(GREENMAIL);\n+        InterruptableGreenMail greenMail = (InterruptableGreenMail) sc.getAttribute(GREENMAIL);\n         if (greenMail != null) {\n             greenMail.stop();\n "},{"sha":"b4a455e98f2adac080c41c88fa3b4c78b5c39ebe","filename":"fit/build-tools/src/main/java/org/apache/syncope/fit/buildtools/cxf/GreenMailServiceImpl.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/2c4d5b4d3a73c0f8d999e5eb5de77360b920d669/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fbuildtools%2Fcxf%2FGreenMailServiceImpl.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/2c4d5b4d3a73c0f8d999e5eb5de77360b920d669/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fbuildtools%2Fcxf%2FGreenMailServiceImpl.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fbuildtools%2Fcxf%2FGreenMailServiceImpl.java?ref=2c4d5b4d3a73c0f8d999e5eb5de77360b920d669","patch":"@@ -18,11 +18,11 @@\n  */\n package org.apache.syncope.fit.buildtools.cxf;\n \n+import com.icegreen.greenmail.smtp.InterruptableSmtpServer;\n import com.icegreen.greenmail.util.GreenMail;\n import javax.ws.rs.core.Context;\n import org.apache.cxf.jaxrs.ext.MessageContext;\n import org.apache.syncope.fit.buildtools.GreenMailStartStopListener;\n-import org.apache.syncope.fit.buildtools.InterruptableSmtpServer;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n import org.springframework.stereotype.Service;"}]}