{"sha":"7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjdiYjNkMGFmM2M3ZDQ0Y2ZkMzUxZjQxYmQ1YmVmYzRhNGZmOTJhMjg=","commit":{"author":{"name":"Fabio Martelli","email":"fmartelli@apache.org","date":"2012-02-29T10:02:57Z"},"committer":{"name":"Fabio Martelli","email":"fmartelli@apache.org","date":"2012-02-29T10:02:57Z"},"message":"managed attribute limitation during external sync and search\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/syncope/trunk@1295049 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"685c021979878018fd73887f543b85f405a3a2e4","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/685c021979878018fd73887f543b85f405a3a2e4"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28/comments","author":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"committer":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"parents":[{"sha":"9e0d199b898bf7bcec61330ec695f785b0da8cdb","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/9e0d199b898bf7bcec61330ec695f785b0da8cdb","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/9e0d199b898bf7bcec61330ec695f785b0da8cdb"}],"stats":{"total":81,"additions":72,"deletions":9},"files":[{"sha":"4ce781400b4b7123e03985b74ef1a4657bf82d42","filename":"console/src/main/java/org/syncope/console/pages/ResourceModalPage.java","status":"modified","additions":1,"deletions":2,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FResourceModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FResourceModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FResourceModalPage.java?ref=7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28","patch":"@@ -30,7 +30,6 @@\n import org.apache.wicket.spring.injection.annot.SpringBean;\n import org.syncope.client.to.ResourceTO;\n import org.syncope.client.to.SchemaMappingTO;\n-import org.syncope.client.validation.SyncopeClientCompositeErrorException;\n import org.syncope.console.pages.panels.ResourceConnConfPanel;\n import org.syncope.console.pages.panels.ResourceDetailsPanel;\n import org.syncope.console.pages.panels.ResourceMappingPanel;\n@@ -119,7 +118,7 @@ protected void onSubmit(\n                         ((Resources) pageref.getPage()).setModalResult(true);\n                         window.close(target);\n \n-                    } catch (SyncopeClientCompositeErrorException e) {\n+                    } catch (Exception e) {\n                         LOG.error(\"Failuer managing resource {}\", resourceTO);\n                         error(new ResourceModel(\"error\", \"error\").getObject()\n                                 + \":\" + e.getMessage());"},{"sha":"41e1670b71121fa5551224e1d91efcfc3feb9bc3","filename":"core/src/main/java/org/syncope/core/propagation/ConnectorFacadeProxy.java","status":"modified","additions":39,"deletions":2,"changes":41,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpropagation%2FConnectorFacadeProxy.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpropagation%2FConnectorFacadeProxy.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpropagation%2FConnectorFacadeProxy.java?ref=7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28","patch":"@@ -20,6 +20,7 @@\n \n import java.io.File;\n import java.net.URI;\n+import java.util.Arrays;\n import java.util.Collection;\n import java.util.HashSet;\n import java.util.List;\n@@ -40,6 +41,7 @@\n import org.identityconnectors.framework.common.objects.ObjectClass;\n import org.identityconnectors.framework.common.objects.ObjectClassInfo;\n import org.identityconnectors.framework.common.objects.OperationOptions;\n+import org.identityconnectors.framework.common.objects.OperationOptionsBuilder;\n import org.identityconnectors.framework.common.objects.OperationalAttributes;\n import org.identityconnectors.framework.common.objects.ResultsHandler;\n import org.identityconnectors.framework.common.objects.Schema;\n@@ -51,7 +53,10 @@\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n import org.springframework.util.ClassUtils;\n+import org.springframework.util.StringUtils;\n import org.syncope.core.persistence.beans.ConnInstance;\n+import org.syncope.core.persistence.beans.ExternalResource;\n+import org.syncope.core.persistence.beans.SchemaMapping;\n import org.syncope.core.persistence.dao.MissingConfKeyException;\n import org.syncope.core.util.ConnBundleManager;\n import org.syncope.types.ConnConfProperty;\n@@ -368,11 +373,14 @@ public void delete(final PropagationMode propagationMode,\n      * @param token to be passed to the underlying connector\n      * @param handler to be used to handle deltas.\n      */\n-    public void sync(final SyncToken token, final SyncResultsHandler handler) {\n+    public void sync(\n+            final SyncToken token,\n+            final SyncResultsHandler handler,\n+            final OperationOptions options) {\n \n         if (activeConnInstance.getCapabilities().contains(\n                 ConnectorCapability.SYNC)) {\n-            connector.sync(ObjectClass.ACCOUNT, token, handler, null);\n+            connector.sync(ObjectClass.ACCOUNT, token, handler, options);\n         } else {\n             LOG.info(\"Sync was attempted, although the \"\n                     + \"connector only has these capabilities: {}. No action.\",\n@@ -638,4 +646,33 @@ public String toString() {\n     public ConnInstance getActiveConnInstance() {\n         return activeConnInstance;\n     }\n+\n+    public OperationOptions getOperationOptions(\n+            final ExternalResource resource) {\n+\n+        // -------------------------------------\n+        // Ask just for mapped attributes\n+        // -------------------------------------\n+        final OperationOptionsBuilder oob = new OperationOptionsBuilder();\n+\n+        final Set<String> attributesToGet = new HashSet<String>(\n+                Arrays.asList(new String[]{\n+                    Name.NAME,\n+                    Uid.NAME,\n+                    OperationalAttributes.ENABLE_NAME\n+                }));\n+\n+        for (SchemaMapping mapping : resource.getMappings()) {\n+            if (StringUtils.hasText(mapping.getExtAttrName())) {\n+                attributesToGet.add(mapping.getExtAttrName());\n+            }\n+        }\n+\n+        attributesToGet.add(OperationalAttributes.ENABLE_NAME);\n+\n+        oob.setAttributesToGet(attributesToGet);\n+        // -------------------------------------\n+\n+        return oob.build();\n+    }\n }"},{"sha":"8f25c5092f9ad6ce8c59d27ac55b6e1f7ec27fb7","filename":"core/src/main/java/org/syncope/core/propagation/PropagationManager.java","status":"modified","additions":3,"deletions":1,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpropagation%2FPropagationManager.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpropagation%2FPropagationManager.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpropagation%2FPropagationManager.java?ref=7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28","patch":"@@ -1144,14 +1144,16 @@ private ConnectorObject getRemoteObject(\n             final PropagationTask task,\n             final boolean latest) {\n         try {\n+\n             return connector.getObject(\n                     task.getPropagationMode(),\n                     task.getPropagationOperation(),\n                     ObjectClass.ACCOUNT,\n                     new Uid(latest || task.getOldAccountId() == null\n                     ? task.getAccountId()\n                     : task.getOldAccountId()),\n-                    null);\n+                    connector.getOperationOptions(task.getResource()));\n+            \n         } catch (RuntimeException ignore) {\n             LOG.debug(\"Resolving username\", ignore);\n             return null;"},{"sha":"ae2d59abe9fad73341661ca72c5a16f0e5530844","filename":"core/src/main/java/org/syncope/core/rest/controller/ResourceController.java","status":"modified","additions":4,"deletions":1,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fcontroller%2FResourceController.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fcontroller%2FResourceController.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fcontroller%2FResourceController.java?ref=7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28","patch":"@@ -283,7 +283,10 @@ public ConnObjectTO getObject(final HttpServletResponse response,\n         final ConnectorFacadeProxy connector = connLoader.getConnector(resource);\n \n         final ConnectorObject connectorObject =\n-                connector.getObject(ObjectClass.ACCOUNT, new Uid(objectId), null);\n+                connector.getObject(\n+                ObjectClass.ACCOUNT, \n+                new Uid(objectId), \n+                connector.getOperationOptions(resource));\n \n         if (connectorObject == null) {\n             throw new NotFoundException("},{"sha":"07091a3522949163dad411f468049cb0c3f8f17c","filename":"core/src/main/java/org/syncope/core/scheduling/SyncJob.java","status":"modified","additions":3,"deletions":2,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fscheduling%2FSyncJob.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fscheduling%2FSyncJob.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fscheduling%2FSyncJob.java?ref=7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28","patch":"@@ -1016,7 +1016,7 @@ public boolean handle(final SyncDelta delta) {\n                                 }\n                             }\n                         },\n-                        null);\n+                        connector.getOperationOptions(syncTask.getResource()));\n             } else {\n                 connector.sync(\n                         syncTask.getResource().getSyncToken(),\n@@ -1037,7 +1037,8 @@ public boolean handle(final SyncDelta delta) {\n                                     return false;\n                                 }\n                             }\n-                        });\n+                        },\n+                        connector.getOperationOptions(syncTask.getResource()));\n             }\n \n             if (!dryRun && !syncTask.isFullReconciliation()) {"},{"sha":"6fac13e057ec17569803cbe8d1944f05744a75d2","filename":"parent/src/site/resources/images/apache-syncope-logo.svg","status":"modified","additions":22,"deletions":1,"changes":23,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28/parent%2Fsrc%2Fsite%2Fresources%2Fimages%2Fapache-syncope-logo.svg","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28/parent%2Fsrc%2Fsite%2Fresources%2Fimages%2Fapache-syncope-logo.svg","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/parent%2Fsrc%2Fsite%2Fresources%2Fimages%2Fapache-syncope-logo.svg?ref=7bb3d0af3c7d44cfd351f41bd5befc4a4ff92a28","patch":"@@ -1,4 +1,25 @@\n+\n <?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+\n+-->\n+\n <!-- Created with Inkscape (http://www.inkscape.org/) -->\n \n <svg\n@@ -814,4 +835,4 @@ znAJwnyu3wAAAABJRU5ErkJggg==\n            width=\"356\"\n            height=\"130\"\n            transform=\"scale(1,-1)\"\n-           id=\"image3087\" /></g></g></g></svg>\n\\ No newline at end of file\n+           id=\"image3087\" /></g></g></g></svg>"}]}