{"sha":"a61f603634eb10a131b03b18696487f05ee199f3","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmE2MWY2MDM2MzRlYjEwYTEzMWIwM2IxODY5NjQ4N2YwNWVlMTk5ZjM=","commit":{"author":{"name":"massi","email":"massimiliano.perrone@tirasa.net","date":"2015-11-06T16:57:11Z"},"committer":{"name":"massi","email":"massimiliano.perrone@tirasa.net","date":"2015-11-06T16:57:22Z"},"message":"Fixed SYNCOPE-723, tested on Windows environment, added zip plugin, SYNCOPE-158","tree":{"sha":"903d27b57c8b8f3bfe3ec11a8436b03262de9050","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/903d27b57c8b8f3bfe3ec11a8436b03262de9050"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/a61f603634eb10a131b03b18696487f05ee199f3","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/a61f603634eb10a131b03b18696487f05ee199f3","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/a61f603634eb10a131b03b18696487f05ee199f3","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/a61f603634eb10a131b03b18696487f05ee199f3/comments","author":{"login":"massx1","id":1792923,"node_id":"MDQ6VXNlcjE3OTI5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/1792923?v=4","gravatar_id":"","url":"https://api.github.com/users/massx1","html_url":"https://github.com/massx1","followers_url":"https://api.github.com/users/massx1/followers","following_url":"https://api.github.com/users/massx1/following{/other_user}","gists_url":"https://api.github.com/users/massx1/gists{/gist_id}","starred_url":"https://api.github.com/users/massx1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massx1/subscriptions","organizations_url":"https://api.github.com/users/massx1/orgs","repos_url":"https://api.github.com/users/massx1/repos","events_url":"https://api.github.com/users/massx1/events{/privacy}","received_events_url":"https://api.github.com/users/massx1/received_events","type":"User","site_admin":false},"committer":{"login":"massx1","id":1792923,"node_id":"MDQ6VXNlcjE3OTI5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/1792923?v=4","gravatar_id":"","url":"https://api.github.com/users/massx1","html_url":"https://github.com/massx1","followers_url":"https://api.github.com/users/massx1/followers","following_url":"https://api.github.com/users/massx1/following{/other_user}","gists_url":"https://api.github.com/users/massx1/gists{/gist_id}","starred_url":"https://api.github.com/users/massx1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massx1/subscriptions","organizations_url":"https://api.github.com/users/massx1/orgs","repos_url":"https://api.github.com/users/massx1/repos","events_url":"https://api.github.com/users/massx1/events{/privacy}","received_events_url":"https://api.github.com/users/massx1/received_events","type":"User","site_admin":false},"parents":[{"sha":"474e7327444d3d9e0e472f355446f0b90deb8c9a","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/474e7327444d3d9e0e472f355446f0b90deb8c9a","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/474e7327444d3d9e0e472f355446f0b90deb8c9a"}],"stats":{"total":291,"additions":259,"deletions":32},"files":[{"sha":"d63f679b613ac092fa07cc6077319befd954c438","filename":"client/cli/pom.xml","status":"modified","additions":67,"deletions":3,"changes":70,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fpom.xml?ref=a61f603634eb10a131b03b18696487f05ee199f3","patch":"@@ -37,6 +37,8 @@ under the License.\n \n   <properties>\n     <rootpom.basedir>${basedir}/../..</rootpom.basedir>\n+    \n+    <work.dir>${project.build.directory}/cli</work.dir>\n   </properties>\n   \n   <dependencies>\n@@ -150,6 +152,51 @@ under the License.\n           <resourceIncludes>src/main/resources/**/*.properties</resourceIncludes>\n         </configuration>\n       </plugin>\n+      \n+      <plugin>\n+        <groupId>org.apache.maven.plugins</groupId>\n+        <artifactId>maven-antrun-plugin</artifactId>\n+        <executions>\n+          <execution>\n+            <id>prepare-cli</id>\n+            <goals>\n+              <goal>run</goal>\n+            </goals>\n+              <phase>verify</phase>\n+            <configuration>\n+              <target>\n+                <mkdir dir=\"${work.dir}\" />\n+\n+                <copy file=\"LICENSE\" todir=\"${work.dir}\" />\n+                <copy file=\"NOTICE\" todir=\"${work.dir}\" />\n+                \n+                <copy file=\"target/syncope-client-cli-${project.version}.jar\" todir=\"${work.dir}\" />\n+                <copy file=\"target/classes/syncopeadm.bat\" todir=\"${work.dir}\" />\n+                <copy file=\"target/classes/syncopeadm.sh\" todir=\"${work.dir}\" />\n+              </target>\n+            </configuration>\n+          </execution>\n+        </executions>\n+      </plugin>\n+      \n+      <plugin>\n+        <groupId>org.apache.maven.plugins</groupId>\n+        <artifactId>maven-assembly-plugin</artifactId>\n+        <configuration>\n+          <descriptors>\n+            <descriptor>src/assemble/cli-zip.xml</descriptor>\n+          </descriptors>\n+        </configuration>\n+        <executions>\n+          <execution>\n+            <id>make-cli-zip</id>\n+            <phase>verify</phase>\n+            <goals>\n+              <goal>single</goal>\n+            </goals>\n+          </execution>\n+        </executions>\n+      </plugin>\n     </plugins>\n      \n     <resources>\n@@ -173,16 +220,33 @@ under the License.\n   <profiles>\n     <profile>\n       <id>apache-release</id>\n-      \n+\n       <build>\n-        <plugins>      \n+        <plugins>\n           <plugin>\n             <groupId>org.apache.maven.plugins</groupId>\n             <artifactId>maven-deploy-plugin</artifactId>\n             <configuration>\n               <skip>true</skip>\n             </configuration>\n-          </plugin>           \n+          </plugin>\n+        </plugins>\n+      </build>\n+    </profile>\n+    \n+    <profile>\n+      <id>doc</id>\n+\n+      <build>\n+        <plugins>\n+          <plugin>\n+            <groupId>org.asciidoctor</groupId>\n+            <artifactId>asciidoctor-maven-plugin</artifactId>\n+            <inherited>false</inherited>\n+            <configuration>\n+              <skip>true</skip>\n+            </configuration>\n+          </plugin>\n         </plugins>\n       </build>\n     </profile>"},{"sha":"be2a2541f3a75f454eb2e902c89d3568a77c6dca","filename":"client/cli/src/assemble/cli-zip.xml","status":"added","additions":36,"deletions":0,"changes":36,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fassemble%2Fcli-zip.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fassemble%2Fcli-zip.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fsrc%2Fassemble%2Fcli-zip.xml?ref=a61f603634eb10a131b03b18696487f05ee199f3","patch":"@@ -0,0 +1,36 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+<assembly xmlns=\"http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2\"\n+          xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+          xsi:schemaLocation=\"http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.2 \n+                              http://maven.apache.org/xsd/assembly-1.1.2.xsd\">\n+\n+  <id>cli</id>\n+  <formats>\n+    <format>zip</format>\n+  </formats>\n+  <includeBaseDirectory>false</includeBaseDirectory>\n+  <fileSets>\n+    <fileSet>\n+      <directory>${work.dir}</directory>\n+      <outputDirectory>${project.build.finalName}</outputDirectory>\n+    </fileSet>\n+  </fileSets>\n+</assembly>"},{"sha":"3ec222a9a0eef8a0ff1b2f3b1365de4b22422bdd","filename":"client/cli/src/main/java/org/apache/syncope/client/cli/ArgsManager.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2FArgsManager.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2FArgsManager.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2FArgsManager.java?ref=a61f603634eb10a131b03b18696487f05ee199f3","patch":"@@ -27,7 +27,7 @@ public static void validator(final String[] args) throws IllegalArgumentExceptio\n         if (args.length == 0) {\n             throw new IllegalArgumentException(\"Syntax error: no options\");\n         } else if (!\"install\".equalsIgnoreCase(args[0])) {\n-            final File configFile = new File(InstallConfigFileTemplate.FILE_PATH);\n+            final File configFile = new File(InstallConfigFileTemplate.configurationFilePath());\n             if (!configFile.exists()) {\n                 throw new IllegalArgumentException(\n                         \"It seems you need to setup the CLI client before. Run install --setup.\");"},{"sha":"a5f4fe59983458a16ed5d9026967ccfb64e7b3e0","filename":"client/cli/src/main/java/org/apache/syncope/client/cli/Input.java","status":"modified","additions":14,"deletions":0,"changes":14,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2FInput.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2FInput.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2FInput.java?ref=a61f603634eb10a131b03b18696487f05ee199f3","patch":"@@ -18,6 +18,7 @@\n  */\n package org.apache.syncope.client.cli;\n \n+import java.util.ArrayList;\n import java.util.Arrays;\n import java.util.List;\n import org.apache.syncope.client.cli.commands.AbstractCommand;\n@@ -31,19 +32,24 @@ public class Input {\n \n     private final String[] parameters;\n \n+    private final List<String> commandFields = new ArrayList<>();\n+\n     public Input(final String[] args)\n             throws InstantiationException, IllegalAccessException, IllegalArgumentException {\n \n         command = CommandUtils.fromArgs(args[0]);\n+        commandFields.add(args[0]);\n \n         if (args.length > 1) {\n             option = args[1];\n+            commandFields.add(args[1]);\n         }\n \n         if (args.length > 2) {\n             parameters = new String[args.length - 2];\n             for (int i = 0; i < parameters.length; i++) {\n                 parameters[i] = args[i + 2];\n+                commandFields.add(args[i + 2]);\n             }\n         } else {\n             parameters = new String[0];\n@@ -98,6 +104,14 @@ public PairParameter toPairParameter(final String parameter) throws IllegalArgum\n         return new PairParameter(pairParameterArray[0], pairParameterArray[1]);\n     }\n \n+    public String printCommandFields() {\n+        final StringBuilder commandBuilder = new StringBuilder();\n+        for (String commandField : commandFields) {\n+            commandBuilder.append(commandField).append(\" \");\n+        }\n+        return commandBuilder.toString();\n+    }\n+\n     public class PairParameter {\n \n         private final String key;"},{"sha":"5c7ef206b7765cf640df771344337fc6c7b4e00c","filename":"client/cli/src/main/java/org/apache/syncope/client/cli/SyncopeAdm.java","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2FSyncopeAdm.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2FSyncopeAdm.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2FSyncopeAdm.java?ref=a61f603634eb10a131b03b18696487f05ee199f3","patch":"@@ -45,6 +45,8 @@ public static void main(final String[] args) {\n                 LOG.debug(\"   > \" + parameter);\n             }\n \n+            System.out.println(\"\");\n+            System.out.println(\"You are runnig: \" + input.printCommandFields());\n             command.execute(input);\n         } catch (final IllegalAccessException | InstantiationException e) {\n             System.out.println(helpMessage());"},{"sha":"5cfcefa7c45caf3341adde1da98b89271e0bffbf","filename":"client/cli/src/main/java/org/apache/syncope/client/cli/SyncopeServices.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2FSyncopeServices.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2FSyncopeServices.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2FSyncopeServices.java?ref=a61f603634eb10a131b03b18696487f05ee199f3","patch":"@@ -37,7 +37,7 @@ public final class SyncopeServices {\n     public static <T> T get(final Class<T> claz) {\n         final Properties properties = new Properties();\n         try {\n-            properties.load(new FileInputStream(InstallConfigFileTemplate.FILE_PATH));\n+            properties.load(new FileInputStream(InstallConfigFileTemplate.configurationFilePath()));\n         } catch (final IOException e) {\n             LOG.error(\"Error opening properties file\", e);\n         }"},{"sha":"b2882d3090823beb1498269afe4eedca105962d1","filename":"client/cli/src/main/java/org/apache/syncope/client/cli/commands/info/InfoCommand.java","status":"modified","additions":1,"deletions":2,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Finfo%2FInfoCommand.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Finfo%2FInfoCommand.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Finfo%2FInfoCommand.java?ref=a61f603634eb10a131b03b18696487f05ee199f3","patch":"@@ -29,10 +29,9 @@\n @Command(name = \"info\")\n public class InfoCommand extends AbstractCommand {\n \n-    private final Info info = new Info();\n-\n     @Override\n     public void execute(final Input input) {\n+        final Info info = new Info();\n         if (StringUtils.isBlank(input.getOption())) {\n             input.setOption(Options.HELP.getOptionName());\n         }"},{"sha":"6da4e8e9fd78fc0c15a572efd71c4daa20fb6589","filename":"client/cli/src/main/java/org/apache/syncope/client/cli/commands/install/InstallConfigFileTemplate.java","status":"modified","additions":27,"deletions":7,"changes":34,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Finstall%2FInstallConfigFileTemplate.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Finstall%2FInstallConfigFileTemplate.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Finstall%2FInstallConfigFileTemplate.java?ref=a61f603634eb10a131b03b18696487f05ee199f3","patch":"@@ -19,26 +19,22 @@\n package org.apache.syncope.client.cli.commands.install;\n \n import java.util.ResourceBundle;\n+import org.apache.syncope.client.cli.util.FileSystemUtils;\n \n public final class InstallConfigFileTemplate {\n \n     private static final ResourceBundle CONF = ResourceBundle.getBundle(\"configuration\");\n \n-    public static final String DIR_PATH\n-            = CONF.getString(\"cli.installation.directory\");\n-\n-    public static final String FILE_NAME\n+    public static final String CONFIGURATION_FILE_NAME\n             = CONF.getString(\"cli.installation.filename\");\n \n-    public static final String FILE_PATH = DIR_PATH + FILE_NAME;\n-\n     private static final String SYNCOPE_REST_SERVICES = \"syncope.rest.services=%s://%s:%s%s\";\n \n     private static final String SYNCOPE_ADMIN_USER = \"syncope.admin.user=%s\";\n \n     private static final String SYNCOPE_ADMIN_PASSWORD = \"syncope.admin.password=%s\";\n \n-    public static String createFile(\n+    public static String cliPropertiesFile(\n             final String schema,\n             final String hostname,\n             final String port,\n@@ -52,6 +48,30 @@ public static String createFile(\n         return syncopeRestServices + \"\\n\" + syncopeAdminUser + \"\\n\" + syncopeAdminPassword;\n     }\n \n+    public static String dirPath() {\n+        if (FileSystemUtils.isWindows()) {\n+            return CONF.getString(\"cli.installation.directory.windows\");\n+        } else {\n+            return CONF.getString(\"cli.installation.directory.linux\");\n+        }\n+    }\n+\n+    public static String configurationFilePath() {\n+        return dirPath() + CONFIGURATION_FILE_NAME;\n+    }\n+\n+    private static String scriptFileName() {\n+        if (FileSystemUtils.isWindows()) {\n+            return CONF.getString(\"script.file.name.windows\");\n+        } else {\n+            return CONF.getString(\"script.file.name.linux\");\n+        }\n+    }\n+\n+    public static String scriptFilePath() {\n+        return dirPath() + scriptFileName();\n+    }\n+\n     private InstallConfigFileTemplate() {\n     }\n }"},{"sha":"32b6cf2b4045eadb6e94f8512ee7b368f5d11ddd","filename":"client/cli/src/main/java/org/apache/syncope/client/cli/commands/install/InstallResultManager.java","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Finstall%2FInstallResultManager.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Finstall%2FInstallResultManager.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Finstall%2FInstallResultManager.java?ref=a61f603634eb10a131b03b18696487f05ee199f3","patch":"@@ -95,6 +95,8 @@ public void manageException(final Exception e) {\n             System.out.println(\"#                                             #\");\n             System.out.println(\"###############################################\");\n             System.out.println(\"\");\n+            System.out.println(e.getMessage());\n+            System.out.println(\"\");\n         }\n     }\n }"},{"sha":"716f60fdcdf5455ffea71b618680ef2381cf238a","filename":"client/cli/src/main/java/org/apache/syncope/client/cli/commands/install/InstallSetup.java","status":"modified","additions":9,"deletions":15,"changes":24,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Finstall%2FInstallSetup.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Finstall%2FInstallSetup.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Finstall%2FInstallSetup.java?ref=a61f603634eb10a131b03b18696487f05ee199f3","patch":"@@ -20,7 +20,6 @@\n \n import java.io.FileNotFoundException;\n import java.io.IOException;\n-import java.io.UnsupportedEncodingException;\n import java.util.Scanner;\n import javax.ws.rs.ProcessingException;\n import org.apache.commons.lang3.StringUtils;\n@@ -53,14 +52,14 @@ public void setup() throws FileNotFoundException, IllegalAccessException {\n         installResultManager.printWelcome();\n \n         System.out.println(\"Path to config files of Syncope CLI client will be: \"\n-                + InstallConfigFileTemplate.DIR_PATH);\n+                + InstallConfigFileTemplate.dirPath());\n \n-        if (!FileSystemUtils.exists(InstallConfigFileTemplate.DIR_PATH)) {\n-            throw new FileNotFoundException(\"Directory: \" + InstallConfigFileTemplate.DIR_PATH + \" does not exists!\");\n+        if (!FileSystemUtils.exists(InstallConfigFileTemplate.dirPath())) {\n+            throw new FileNotFoundException(\"Directory: \" + InstallConfigFileTemplate.dirPath() + \" does not exists!\");\n         }\n \n-        if (!FileSystemUtils.canWrite(InstallConfigFileTemplate.DIR_PATH)) {\n-            throw new IllegalAccessException(\"Permission denied on \" + InstallConfigFileTemplate.DIR_PATH);\n+        if (!FileSystemUtils.canWrite(InstallConfigFileTemplate.dirPath())) {\n+            throw new IllegalAccessException(\"Permission denied on \" + InstallConfigFileTemplate.dirPath());\n         }\n         System.out.println(\"- File system permission checked\");\n         System.out.println(\"\");\n@@ -154,31 +153,26 @@ public void setup() throws FileNotFoundException, IllegalAccessException {\n \n         final JasyptUtils jasyptUtils = JasyptUtils.getJasyptUtils();\n         try {\n-            FileSystemUtils.createNewDirectory(InstallConfigFileTemplate.DIR_PATH);\n-            final String contentCliPropertiesFile = InstallConfigFileTemplate.createFile(\n+\n+            final String contentCliPropertiesFile = InstallConfigFileTemplate.cliPropertiesFile(\n                     syncopeServerSchema,\n                     syncopeServerHostname,\n                     syncopeServerPort,\n                     syncopeServerRestContext,\n                     syncopeAdminUser,\n                     jasyptUtils.encrypt(syncopeAdminPassword));\n-            FileSystemUtils.createFileWith(InstallConfigFileTemplate.FILE_PATH, contentCliPropertiesFile);\n-\n-        } catch (final FileNotFoundException | UnsupportedEncodingException ex) {\n+            FileSystemUtils.createFileWith(InstallConfigFileTemplate.configurationFilePath(), contentCliPropertiesFile);\n+        } catch (final IOException ex) {\n             System.out.println(ex.getMessage());\n         }\n \n         try {\n             final SyncopeService syncopeService = SyncopeServices.get(SyncopeService.class);\n             final String syncopeVersion = syncopeService.info().getVersion();\n-            FileSystemUtils.createScriptFile();\n             installResultManager.installationSuccessful(syncopeVersion);\n         } catch (final ProcessingException ex) {\n             LOG.error(\"Error installing CLI\", ex);\n             installResultManager.manageProcessingException(ex);\n-        } catch (final FileNotFoundException | UnsupportedEncodingException e) {\n-            LOG.error(\"Error writing script file\", e);\n-            installResultManager.manageException(e);\n         } catch (final Exception e) {\n             LOG.error(\"Error installing CLI\", e);\n             installResultManager.manageException(e);"},{"sha":"8fc779c1f64490b4bc9b92577b51b7cd37e53e0f","filename":"client/cli/src/main/java/org/apache/syncope/client/cli/util/FileSystemUtils.java","status":"modified","additions":39,"deletions":0,"changes":39,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Futil%2FFileSystemUtils.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Futil%2FFileSystemUtils.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Futil%2FFileSystemUtils.java?ref=a61f603634eb10a131b03b18696487f05ee199f3","patch":"@@ -18,13 +18,25 @@\n  */\n package org.apache.syncope.client.cli.util;\n \n+import java.io.BufferedWriter;\n import java.io.File;\n import java.io.FileNotFoundException;\n+import java.io.FileWriter;\n+import java.io.IOException;\n import java.io.PrintWriter;\n import java.io.UnsupportedEncodingException;\n+import java.nio.file.Files;\n+import java.nio.file.Paths;\n+import java.nio.file.attribute.PosixFilePermission;\n+import java.util.HashSet;\n+import java.util.ResourceBundle;\n+import java.util.Set;\n+import org.apache.syncope.client.cli.commands.install.InstallConfigFileTemplate;\n \n public final class FileSystemUtils {\n \n+    private static final ResourceBundle CONF = ResourceBundle.getBundle(\"configuration\");\n+\n     public static void createNewDirectory(final String directoryToCreate) {\n         final File directory = new File(directoryToCreate);\n         directory.mkdirs();\n@@ -47,6 +59,33 @@ public static boolean exists(final String path) {\n         return installationDirectory.exists();\n     }\n \n+    public static void createScriptFile() throws FileNotFoundException, UnsupportedEncodingException, IOException {\n+        final File file = new File(InstallConfigFileTemplate.scriptFilePath());\n+        file.setExecutable(true);\n+        file.setReadable(true);\n+        file.setWritable(true);\n+        file.createNewFile();\n+        final FileWriter fw = new FileWriter(file.getAbsoluteFile());\n+        final BufferedWriter bw = new BufferedWriter(fw);\n+        if (isWindows()) {\n+            bw.write(CONF.getString(\"script.file.windows\"));\n+        } else {\n+            bw.write(CONF.getString(\"script.file.linux\"));\n+            final Set<PosixFilePermission> perms = new HashSet<>();\n+            perms.add(PosixFilePermission.OWNER_READ);\n+            perms.add(PosixFilePermission.OWNER_WRITE);\n+            perms.add(PosixFilePermission.OWNER_EXECUTE);\n+            perms.add(PosixFilePermission.GROUP_READ);\n+            perms.add(PosixFilePermission.OTHERS_READ);\n+            Files.setPosixFilePermissions(Paths.get(file.getAbsolutePath()), perms);\n+        }\n+        bw.close();\n+    }\n+\n+    public static boolean isWindows() {\n+        return (System.getProperty(\"os.name\").toLowerCase().contains(\"win\"));\n+    }\n+\n     private FileSystemUtils() {\n \n     }"},{"sha":"e6592e253a1e7800fa0441d233c8cd43bfc14884","filename":"client/cli/src/main/java/org/apache/syncope/client/cli/view/Messages.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fview%2FMessages.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fview%2FMessages.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fview%2FMessages.java?ref=a61f603634eb10a131b03b18696487f05ee199f3","patch":"@@ -97,7 +97,7 @@ public static void printUnnecessaryParameters(final List<String> parameters, fin\n         printMessage(\"Unnecessary parameter: \" + parameters, \"Usage: \" + helpMessage);\n     }\n \n-    public static String commandHelpMessage(String name) {\n+    public static String commandHelpMessage(final String name) {\n         return MESSAGES.getString(name + \".help.message\");\n     }\n "},{"sha":"bfee69cc2eccbece7a74b8b078186630ee2d9b34","filename":"client/cli/src/main/resources/configuration.properties","status":"modified","additions":5,"deletions":2,"changes":7,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fresources%2Fconfiguration.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fresources%2Fconfiguration.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fsrc%2Fmain%2Fresources%2Fconfiguration.properties?ref=a61f603634eb10a131b03b18696487f05ee199f3","patch":"@@ -14,5 +14,8 @@\n # KIND, either express or implied.  See the License for the\n # specific language governing permissions and limitations\n # under the License.\n-cli.installation.directory=/var/tmp/syncope/conf/\n-cli.installation.filename=cli.properties\n+#cli.installation.directory.linux=/var/tmp/syncope/conf/\n+#cli.installation.directory.windows=c:\\\\Windows\\\\syncope\\\\conf\\\\\n+cli.installation.directory.linux=./\n+cli.installation.directory.windows=.\\\\\n+cli.installation.filename=cli.properties\n\\ No newline at end of file"},{"sha":"82bca55a7fc822a439cc1d4a193637c0a5cfe094","filename":"client/cli/src/main/resources/messages.properties","status":"modified","additions":16,"deletions":0,"changes":16,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fresources%2Fmessages.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fresources%2Fmessages.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fsrc%2Fmain%2Fresources%2Fmessages.properties?ref=a61f603634eb10a131b03b18696487f05ee199f3","patch":"@@ -1,3 +1,19 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n any.help.message=\\nUsage: any [options]\\n   Options:\\n     --help \\n     --details \\n     --list \\n     --read \\n        Syntax: --read {ANY-ID} {ANY-ID} [...]\\n     --read-attr-by-schema-type {ANY-ID} {SCHEMA-TYPE}\\n        Schema type: PLAIN / DERIVED / VIRTUAL\\n     --read-attr-by-schema {ANY-ID} {SCHEMA-TYPE} {SCHEMA-NAME}\\n        Schema type: PLAIN / DERIVED / VIRTUAL\\n     --delete \\n        Syntax: --delete {ANY-ID} {ANY-ID} [...]\\n\n configuration.help.message=\\nUsage: configuration [options]\\n  Options:\\n    --help \\n    --get \\n    --read \\n       Syntax: --read {CONF-NAME} {CONF-NAME} [...] \\n    --update \\n       Syntax: --update {CONF-NAME}={CONF-VALUE} {CONF-NAME}={CONF-VALUE} [...]\\n    --delete \\n       Syntax: --delete {CONF-NAME} {CONF-NAME} [...]\\n    --export \\n       Syntax: --export {WHERE-DIR}\\n\n connector.help.message=\\nUsage: connector [options]\\n  Options:\\n    --help \\n    --details \\n    --list \\n    --list-bundles \\n    --list-configuration-properties\\n       Syntax: --list-configuration-properties {CONNECTOR-ID} {CONNECTOR-ID} [...]\\n    --read \\n       Syntax: --read {CONNECTOR-ID} {CONNECTOR-ID} [...]\\n    --delete \\n       Syntax: --delete {CONNECTOR-ID} {CONNECTOR-ID} [...]\\n"},{"sha":"98dfbaacb8d86d8be46634f971191dcb96a8ee3c","filename":"client/cli/src/main/resources/syncopeadm.bat","status":"added","additions":19,"deletions":0,"changes":19,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fresources%2Fsyncopeadm.bat","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fresources%2Fsyncopeadm.bat","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fsrc%2Fmain%2Fresources%2Fsyncopeadm.bat?ref=a61f603634eb10a131b03b18696487f05ee199f3","patch":"@@ -0,0 +1,19 @@\n+rem Licensed to the Apache Software Foundation (ASF) under one\n+rem or more contributor license agreements.  See the NOTICE file\n+rem distributed with this work for additional information\n+rem regarding copyright ownership.  The ASF licenses this file\n+rem to you under the Apache License, Version 2.0 (the\n+rem \"License\"); you may not use this file except in compliance\n+rem with the License.  You may obtain a copy of the License at\n+rem\n+rem   http://www.apache.org/licenses/LICENSE-2.0\n+rem\n+rem Unless required by applicable law or agreed to in writing,\n+rem software distributed under the License is distributed on an\n+rem \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+rem KIND, either express or implied.  See the License for the\n+rem specific language governing permissions and limitations\n+rem under the License.\n+\n+@ECHO OFF\n+java -jar -Xms256m -Xmx512m syncope-client-cli-${project.version}.jar %*\n\\ No newline at end of file"},{"sha":"4889a25211d3dc2ffa4285f3568d3ed93733bec6","filename":"client/cli/src/main/resources/syncopeadm.sh","status":"added","additions":19,"deletions":0,"changes":19,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fresources%2Fsyncopeadm.sh","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a61f603634eb10a131b03b18696487f05ee199f3/client%2Fcli%2Fsrc%2Fmain%2Fresources%2Fsyncopeadm.sh","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fsrc%2Fmain%2Fresources%2Fsyncopeadm.sh?ref=a61f603634eb10a131b03b18696487f05ee199f3","patch":"@@ -0,0 +1,19 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+#!/bin/bash\n+args=`echo $@`\n+java -jar -Xms256m -Xmx512m syncope-client-cli-${project.version}.jar $args\n\\ No newline at end of file"}]}