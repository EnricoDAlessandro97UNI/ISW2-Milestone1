{"sha":"cb34368513af1912152851192fa6e9cb38d00896","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmNiMzQzNjg1MTNhZjE5MTIxNTI4NTExOTJmYTZlOWNiMzhkMDA4OTY=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2021-05-11T07:34:00Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2021-05-11T07:34:00Z"},"message":"Upgrading CAS + fixing dependencies","tree":{"sha":"d1962f2edc2a30678f0b802220083d66f165075b","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/d1962f2edc2a30678f0b802220083d66f165075b"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/cb34368513af1912152851192fa6e9cb38d00896","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/cb34368513af1912152851192fa6e9cb38d00896","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/cb34368513af1912152851192fa6e9cb38d00896","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/cb34368513af1912152851192fa6e9cb38d00896/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"87852caf522bef8056e8b6bbbccaecf5472cc157","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/87852caf522bef8056e8b6bbbccaecf5472cc157","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/87852caf522bef8056e8b6bbbccaecf5472cc157"}],"stats":{"total":114,"additions":72,"deletions":42},"files":[{"sha":"ff8ca74bed5ab3e6e8c2bac56b888a7e5f5d88fd","filename":"fit/wa-reference/src/main/webapp/WEB-INF/web.xml","status":"modified","additions":3,"deletions":0,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/cb34368513af1912152851192fa6e9cb38d00896/fit%2Fwa-reference%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/cb34368513af1912152851192fa6e9cb38d00896/fit%2Fwa-reference%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fwa-reference%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml?ref=cb34368513af1912152851192fa6e9cb38d00896","patch":"@@ -26,4 +26,7 @@ under the License.\n \n   <display-name>Apache Syncope ${syncope.version} WA</display-name>\n \n+  <session-config>\n+    <tracking-mode>COOKIE</tracking-mode>\n+  </session-config>\n </web-app>"},{"sha":"7b31e090d48768691b9f851dfb6e195a47a525d9","filename":"pom.xml","status":"modified","additions":41,"deletions":1,"changes":42,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/cb34368513af1912152851192fa6e9cb38d00896/pom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/cb34368513af1912152851192fa6e9cb38d00896/pom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/pom.xml?ref=cb34368513af1912152851192fa6e9cb38d00896","patch":"@@ -451,7 +451,7 @@ under the License.\n \n     <pac4j.version>5.0.1</pac4j.version>\n \n-    <cas.version>6.4.0-SNAPSHOT</cas.version>\n+    <cas.version>6.4.0-RC4</cas.version>\n     <cas-client.version>3.6.2</cas-client.version>\n \n     <h2.version>1.4.200</h2.version>\n@@ -1653,6 +1653,18 @@ under the License.\n             <groupId>org.glassfish.jersey.containers</groupId>\n             <artifactId>jersey-container-servlet-core</artifactId>\n           </exclusion>\n+          <exclusion>\n+            <groupId>com.yubico</groupId>\n+            <artifactId>webauthn-server-core</artifactId>\n+          </exclusion>\n+          <exclusion>\n+            <groupId>com.yubico</groupId>\n+            <artifactId>webauthn-server-attestation</artifactId>\n+          </exclusion>\n+          <exclusion>\n+            <groupId>com.yubico</groupId>\n+            <artifactId>yubico-util</artifactId>\n+          </exclusion>\n         </exclusions>\n       </dependency>\n       <dependency>\n@@ -1676,8 +1688,36 @@ under the License.\n             <groupId>com.google.code.findbugs</groupId>\n             <artifactId>jsr305</artifactId>\n           </exclusion>\n+          <exclusion>\n+            <groupId>com.yubico</groupId>\n+            <artifactId>webauthn-server-core</artifactId>\n+          </exclusion>\n+          <exclusion>\n+            <groupId>com.yubico</groupId>\n+            <artifactId>webauthn-server-attestation</artifactId>\n+          </exclusion>\n+          <exclusion>\n+            <groupId>com.yubico</groupId>\n+            <artifactId>yubico-util</artifactId>\n+          </exclusion>\n         </exclusions>\n       </dependency>\n+      <!-- TMP until CAS 6.4.0-RC5 -->\n+      <dependency>\n+        <groupId>com.yubico</groupId>\n+        <artifactId>webauthn-server-core</artifactId>\n+        <version>1.9.1-RC2</version>\n+      </dependency>\n+      <dependency>\n+        <groupId>com.yubico</groupId>\n+        <artifactId>webauthn-server-attestation</artifactId>\n+        <version>1.9.1-RC2</version>\n+      </dependency>\n+      <dependency>\n+        <groupId>com.yubico</groupId>\n+        <artifactId>yubico-util</artifactId>\n+        <version>1.9.1-RC2</version>\n+      </dependency>      \n       <dependency>\n         <groupId>org.apereo.cas</groupId>\n         <artifactId>cas-server-support-gauth</artifactId>"},{"sha":"09defb8d0ce74b0496f0ecb6ce8a662a77d03d36","filename":"wa/starter/pom.xml","status":"modified","additions":14,"deletions":0,"changes":14,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/cb34368513af1912152851192fa6e9cb38d00896/wa%2Fstarter%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/cb34368513af1912152851192fa6e9cb38d00896/wa%2Fstarter%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fstarter%2Fpom.xml?ref=cb34368513af1912152851192fa6e9cb38d00896","patch":"@@ -218,6 +218,7 @@ under the License.\n       <groupId>org.apereo.cas</groupId>\n       <artifactId>cas-server-support-aup-webflow</artifactId>\n     </dependency>\n+\n     <dependency>\n       <groupId>org.apereo.cas</groupId>\n       <artifactId>cas-server-support-webauthn</artifactId>\n@@ -226,6 +227,19 @@ under the License.\n       <groupId>org.apereo.cas</groupId>\n       <artifactId>cas-server-support-webauthn-core</artifactId>\n     </dependency>\n+    <!-- TMP until CAS 6.4.0-RC5 -->\n+    <dependency>\n+      <groupId>com.yubico</groupId>\n+      <artifactId>webauthn-server-core</artifactId>\n+    </dependency>\n+    <dependency>\n+      <groupId>com.yubico</groupId>\n+      <artifactId>webauthn-server-attestation</artifactId>\n+    </dependency>\n+    <dependency>\n+      <groupId>com.yubico</groupId>\n+      <artifactId>yubico-util</artifactId>\n+    </dependency>\n     <dependency>\n       <groupId>org.apereo.cas</groupId>\n       <artifactId>cas-server-support-u2f</artifactId>"},{"sha":"a181c47b5d1eddd57968bcb659e4cc3d6ec8f05a","filename":"wa/starter/src/main/java/org/apache/syncope/wa/starter/SyncopeWAApplication.java","status":"modified","additions":5,"deletions":29,"changes":34,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/cb34368513af1912152851192fa6e9cb38d00896/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2FSyncopeWAApplication.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/cb34368513af1912152851192fa6e9cb38d00896/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2FSyncopeWAApplication.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2FSyncopeWAApplication.java?ref=cb34368513af1912152851192fa6e9cb38d00896","patch":"@@ -18,10 +18,12 @@\n  */\n package org.apache.syncope.wa.starter;\n \n+import java.time.LocalDateTime;\n+import java.time.ZoneId;\n+import java.util.Date;\n+import org.apache.syncope.wa.starter.config.SyncopeWARefreshContextJob;\n import org.apereo.cas.configuration.CasConfigurationProperties;\n import org.apereo.cas.configuration.CasConfigurationPropertiesValidator;\n-\n-import org.apache.syncope.wa.starter.config.SyncopeWARefreshContextJob;\n import org.quartz.JobBuilder;\n import org.quartz.JobDetail;\n import org.quartz.JobKey;\n@@ -45,28 +47,17 @@\n import org.springframework.boot.autoconfigure.jmx.JmxAutoConfiguration;\n import org.springframework.boot.autoconfigure.mongo.MongoAutoConfiguration;\n import org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration;\n-import org.springframework.boot.autoconfigure.web.ServerProperties;\n import org.springframework.boot.builder.SpringApplicationBuilder;\n import org.springframework.boot.context.event.ApplicationReadyEvent;\n import org.springframework.boot.context.properties.EnableConfigurationProperties;\n import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;\n-import org.springframework.context.annotation.Bean;\n import org.springframework.context.annotation.EnableAspectJAutoProxy;\n import org.springframework.context.annotation.PropertySource;\n import org.springframework.context.event.EventListener;\n import org.springframework.scheduling.annotation.EnableAsync;\n import org.springframework.scheduling.annotation.EnableScheduling;\n import org.springframework.scheduling.quartz.SchedulerFactoryBean;\n import org.springframework.transaction.annotation.EnableTransactionManagement;\n-import org.springframework.web.WebApplicationInitializer;\n-\n-import javax.servlet.SessionTrackingMode;\n-\n-import java.time.LocalDateTime;\n-import java.time.ZoneId;\n-import java.util.Date;\n-import java.util.Set;\n-import java.util.stream.Collectors;\n \n @PropertySource(\"classpath:wa.properties\")\n @PropertySource(value = \"file:${conf.directory}/wa.properties\", ignoreResourceNotFound = true)\n@@ -84,7 +75,7 @@\n     DataSourceTransactionManagerAutoConfiguration.class,\n     RedisRepositoriesAutoConfiguration.class\n })\n-@EnableConfigurationProperties({CasConfigurationProperties.class, ServerProperties.class})\n+@EnableConfigurationProperties({ CasConfigurationProperties.class })\n @EnableAsync\n @EnableAspectJAutoProxy(proxyTargetClass = true)\n @EnableTransactionManagement(proxyTargetClass = true)\n@@ -96,9 +87,6 @@ public class SyncopeWAApplication extends SpringBootServletInitializer {\n     @Autowired\n     private SchedulerFactoryBean scheduler;\n \n-    @Autowired\n-    private ServerProperties serverProperties;\n-\n     @Value(\"${contextRefreshDelay:15}\")\n     private long contextRefreshDelay;\n \n@@ -121,18 +109,6 @@ public void handleApplicationReadyEvent(final ApplicationReadyEvent event) {\n         scheduleJobToRefreshContext();\n     }\n \n-    @Bean\n-    public WebApplicationInitializer syncopeWebApplicationInitializer() {\n-        return servletContext -> {\n-            Set<SessionTrackingMode> trackingModes = serverProperties.getServlet().getSession().getTrackingModes().\n-                stream().\n-                map(mode -> SessionTrackingMode.valueOf(mode.name())).\n-                collect(Collectors.toSet());\n-            servletContext.setSessionTrackingModes(trackingModes);\n-            LOG.debug(\"Set session tracking modes to {}\", trackingModes);\n-        };\n-    }\n-\n     private void scheduleJobToRefreshContext() {\n         try {\n             Date date = Date.from(LocalDateTime.now().plusSeconds(this.contextRefreshDelay)."},{"sha":"52aab5cc618ef6301c9255bd97509f2b7708a0e9","filename":"wa/starter/src/main/java/org/apache/syncope/wa/starter/webauthn/SyncopeWAWebAuthnCredentialRepository.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/cb34368513af1912152851192fa6e9cb38d00896/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fwebauthn%2FSyncopeWAWebAuthnCredentialRepository.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/cb34368513af1912152851192fa6e9cb38d00896/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fwebauthn%2FSyncopeWAWebAuthnCredentialRepository.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fwebauthn%2FSyncopeWAWebAuthnCredentialRepository.java?ref=cb34368513af1912152851192fa6e9cb38d00896","patch":"@@ -65,7 +65,7 @@ public boolean removeAllRegistrations(final String username) {\n     }\n \n     @Override\n-    protected Stream<CredentialRegistration> load() {\n+    public Stream<? extends CredentialRegistration> stream() {\n         return getService().list().\n                 stream().\n                 map(WebAuthnAccount::getCredentials)."},{"sha":"7c4b798ead6f38afbfc35f4238439ed34fc6ca58","filename":"wa/starter/src/test/java/org/apache/syncope/wa/starter/AbstractTest.java","status":"modified","additions":8,"deletions":11,"changes":19,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/cb34368513af1912152851192fa6e9cb38d00896/wa%2Fstarter%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2FAbstractTest.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/cb34368513af1912152851192fa6e9cb38d00896/wa%2Fstarter%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2FAbstractTest.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fstarter%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2FAbstractTest.java?ref=cb34368513af1912152851192fa6e9cb38d00896","patch":"@@ -19,9 +19,6 @@\n package org.apache.syncope.wa.starter;\n \n import java.util.UUID;\n-\n-import org.springframework.boot.autoconfigure.web.ServerProperties;\n-import org.springframework.boot.context.properties.EnableConfigurationProperties;\n import org.springframework.boot.test.context.SpringBootTest;\n import org.springframework.boot.test.context.TestConfiguration;\n import org.springframework.boot.web.server.LocalServerPort;\n@@ -30,15 +27,14 @@\n import org.springframework.test.context.ContextConfiguration;\n \n @SpringBootTest(\n-    classes = AbstractTest.SyncopeTestConfiguration.class,\n-    webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT,\n-    properties = {\n-        \"cas.authn.accept.users=mrossi::password\",\n-        \"cas.authn.syncope.url=http://localhost:8080\",\n-        \"cas.sso.allow-missing-service-parameter=true\"\n-})\n+        classes = AbstractTest.SyncopeTestConfiguration.class,\n+        webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT,\n+        properties = {\n+            \"cas.authn.accept.users=mrossi::password\",\n+            \"cas.authn.syncope.url=http://localhost:8080\",\n+            \"cas.sso.allow-missing-service-parameter=true\"\n+        })\n @ContextConfiguration(initializers = ZookeeperTestingServer.class)\n-@EnableConfigurationProperties(ServerProperties.class)\n public abstract class AbstractTest {\n \n     @LocalServerPort\n@@ -51,6 +47,7 @@ protected static String getUUIDString() {\n     @TestConfiguration\n     @ComponentScan(\"org.apache.syncope.wa.starter\")\n     public static class SyncopeTestConfiguration {\n+\n         @Bean\n         public SyncopeCoreTestingServer syncopeCoreTestingServer() {\n             return new SyncopeCoreTestingServer();"}]}