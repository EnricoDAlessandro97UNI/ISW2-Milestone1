{"sha":"49c5eaecc69db9d4bb29959945dc83d7f102beb8","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjQ5YzVlYWVjYzY5ZGI5ZDRiYjI5OTU5OTQ1ZGM4M2Q3ZjEwMmJlYjg=","commit":{"author":{"name":"Unknown","email":"unknown@apache.org","date":"2011-03-16T10:45:02Z"},"committer":{"name":"Unknown","email":"unknown@apache.org","date":"2011-03-16T10:45:02Z"},"message":"Fixing task execution Id before execution\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/syncope/trunk@1246814 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"1e2b79cb9b18008c94da55bf012a6d6ca514dfc2","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/1e2b79cb9b18008c94da55bf012a6d6ca514dfc2"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/49c5eaecc69db9d4bb29959945dc83d7f102beb8","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/49c5eaecc69db9d4bb29959945dc83d7f102beb8","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/49c5eaecc69db9d4bb29959945dc83d7f102beb8","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/49c5eaecc69db9d4bb29959945dc83d7f102beb8/comments","author":null,"committer":null,"parents":[{"sha":"c76a50a5aeeb43405fe0894faf6d68431f03b45d","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/c76a50a5aeeb43405fe0894faf6d68431f03b45d","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/c76a50a5aeeb43405fe0894faf6d68431f03b45d"}],"stats":{"total":14,"additions":11,"deletions":3},"files":[{"sha":"c340202301bf667bbf6cd807b5c7068bf1a29127","filename":"core/src/main/java/org/syncope/core/persistence/propagation/PropagationManager.java","status":"modified","additions":11,"deletions":3,"changes":14,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/49c5eaecc69db9d4bb29959945dc83d7f102beb8/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fpropagation%2FPropagationManager.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/49c5eaecc69db9d4bb29959945dc83d7f102beb8/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fpropagation%2FPropagationManager.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fpropagation%2FPropagationManager.java?ref=49c5eaecc69db9d4bb29959945dc83d7f102beb8","patch":"@@ -246,12 +246,14 @@ private void provision(\n                 task.setAttributes(\n                         preparedAttributes.values().iterator().next());\n \n-                LOG.debug(\"Execution started for {}\", task);\n+                execution = new TaskExecution();\n+                execution.setTask(task);\n \n+                task.addExecution(execution);\n                 task = taskDAO.save(task);\n \n-                execution = new TaskExecution();\n-                execution.setTask(task);\n+                // Re-read execution to get the unique id\n+                execution = task.getExecutions().iterator().next();\n \n                 try {\n                     workflowId = workflow.initialize(\n@@ -262,6 +264,8 @@ private void provision(\n                             execution, e);\n                 }\n \n+                LOG.debug(\"Execution started for {}\", task);\n+\n                 propagate(execution);\n \n                 LOG.debug(\"Execution finished for {}\", task);\n@@ -585,6 +589,10 @@ public void propagate(final TaskExecution execution) {\n                 taskExecutionDAO.save(execution);\n \n                 LOG.debug(\"Execution finished: {}\", execution);\n+            } else {\n+                taskExecutionDAO.delete(execution);\n+\n+                LOG.debug(\"Execution removed: {}\", execution);\n             }\n         }\n     }"}]}