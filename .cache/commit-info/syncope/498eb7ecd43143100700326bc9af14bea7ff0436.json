{"sha":"498eb7ecd43143100700326bc9af14bea7ff0436","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjQ5OGViN2VjZDQzMTQzMTAwNzAwMzI2YmM5YWYxNGJlYTdmZjA0MzY=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2015-02-06T17:45:23Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2015-02-06T17:45:23Z"},"message":"[SYNCOPE-620] Added IT profiles for MySQL and PostgreSQL","tree":{"sha":"bef154cfd6c17fe3749497f0dd3d6f5240071cd5","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/bef154cfd6c17fe3749497f0dd3d6f5240071cd5"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/498eb7ecd43143100700326bc9af14bea7ff0436","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/498eb7ecd43143100700326bc9af14bea7ff0436","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/498eb7ecd43143100700326bc9af14bea7ff0436","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/498eb7ecd43143100700326bc9af14bea7ff0436/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"61f6395a6decbdb2ea1b12a3f42324e402e36275","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/61f6395a6decbdb2ea1b12a3f42324e402e36275","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/61f6395a6decbdb2ea1b12a3f42324e402e36275"}],"stats":{"total":162,"additions":160,"deletions":2},"files":[{"sha":"034fe693af146f4de1cb59c766127d3cd4bc6ab6","filename":"syncope620/fit/server-reference/pom.xml","status":"modified","additions":66,"deletions":0,"changes":66,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/498eb7ecd43143100700326bc9af14bea7ff0436/syncope620%2Ffit%2Fserver-reference%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/498eb7ecd43143100700326bc9af14bea7ff0436/syncope620%2Ffit%2Fserver-reference%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/syncope620%2Ffit%2Fserver-reference%2Fpom.xml?ref=498eb7ecd43143100700326bc9af14bea7ff0436","patch":"@@ -349,6 +349,72 @@ under the License.\n   </build>\n   \n   <profiles>\n+    <profile>\n+      <id>postgres-it</id>\n+\n+      <properties>\n+        <jdbcdriver.groupId>org.postgresql</jdbcdriver.groupId>\n+        <jdbcdriver.artifactId>postgresql</jdbcdriver.artifactId>\n+      </properties>\n+\n+      <dependencies>\n+        <dependency>\n+          <groupId>org.postgresql</groupId>\n+          <artifactId>postgresql</artifactId>\n+          <version>9.4-1200-jdbc41</version>\n+          <scope>test</scope>\n+        </dependency>\n+      </dependencies>\n+\n+      <build>\n+        <defaultGoal>clean verify</defaultGoal>\n+\n+        <resources>\n+          <resource>\n+            <directory>src/main/resources</directory>\n+            <filtering>true</filtering>\n+          </resource>\n+          <resource>\n+            <directory>src/main/resources/postgres</directory>\n+            <filtering>true</filtering>\n+          </resource>\n+        </resources>\n+      </build>\n+    </profile>\n+    \n+    <profile>\n+      <id>mysql-it</id>\n+\n+      <properties>\n+        <jdbcdriver.groupId>mysql</jdbcdriver.groupId>\n+        <jdbcdriver.artifactId>mysql-connector-java</jdbcdriver.artifactId>\n+      </properties>\n+\n+      <dependencies>\n+        <dependency>\n+          <groupId>mysql</groupId>\n+          <artifactId>mysql-connector-java</artifactId>\n+          <version>5.1.34</version>\n+          <scope>test</scope>\n+        </dependency>\n+      </dependencies>\n+      \n+      <build>\n+        <defaultGoal>clean verify</defaultGoal>\n+\n+        <resources>\n+          <resource>\n+            <directory>src/main/resources</directory>\n+            <filtering>true</filtering>\n+          </resource>\n+          <resource>\n+            <directory>src/main/resources/mysql</directory>\n+            <filtering>true</filtering>\n+          </resource>\n+        </resources>\n+      </build>\n+    </profile>\n+    \n     <profile>\n       <id>debug</id>\n "},{"sha":"b5be6b73ef58cd4b821971833121b3adf1a9a54b","filename":"syncope620/fit/server-reference/src/main/resources/mysql/persistence.properties","status":"added","additions":29,"deletions":0,"changes":29,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/498eb7ecd43143100700326bc9af14bea7ff0436/syncope620%2Ffit%2Fserver-reference%2Fsrc%2Fmain%2Fresources%2Fmysql%2Fpersistence.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/498eb7ecd43143100700326bc9af14bea7ff0436/syncope620%2Ffit%2Fserver-reference%2Fsrc%2Fmain%2Fresources%2Fmysql%2Fpersistence.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/syncope620%2Ffit%2Fserver-reference%2Fsrc%2Fmain%2Fresources%2Fmysql%2Fpersistence.properties?ref=498eb7ecd43143100700326bc9af14bea7ff0436","patch":"@@ -0,0 +1,29 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+content.directory=${conf.directory}\n+jpa.driverClassName=com.mysql.jdbc.Driver\n+jpa.url=jdbc:mysql://localhost:3306/syncope?characterEncoding=UTF-8\n+jpa.username=syncope\n+jpa.password=syncope\n+jpa.dialect=org.apache.openjpa.jdbc.sql.MySQLDictionary\n+jpa.pool.validationQuery=SELECT 1\n+#note: other connection pool settings can also be configured here, see persistenceContext.xml\n+quartz.jobstore=org.quartz.impl.jdbcjobstore.StdJDBCDelegate\n+quartz.scheduler.idleWaitTime=5000\n+quartz.sql=tables_mysql.sql\n+audit.sql=audit.sql\n+database.schema="},{"sha":"664afd0f41efc1e4c365f4d97c46b7b925ea4f27","filename":"syncope620/fit/server-reference/src/main/resources/postgres/persistence.properties","status":"added","additions":28,"deletions":0,"changes":28,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/498eb7ecd43143100700326bc9af14bea7ff0436/syncope620%2Ffit%2Fserver-reference%2Fsrc%2Fmain%2Fresources%2Fpostgres%2Fpersistence.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/498eb7ecd43143100700326bc9af14bea7ff0436/syncope620%2Ffit%2Fserver-reference%2Fsrc%2Fmain%2Fresources%2Fpostgres%2Fpersistence.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/syncope620%2Ffit%2Fserver-reference%2Fsrc%2Fmain%2Fresources%2Fpostgres%2Fpersistence.properties?ref=498eb7ecd43143100700326bc9af14bea7ff0436","patch":"@@ -0,0 +1,28 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+content.directory=${conf.directory}\n+jpa.driverClassName=org.postgresql.Driver\n+jpa.url=jdbc:postgresql://localhost:5432/syncope\n+jpa.username=syncope\n+jpa.password=syncope\n+jpa.dialect=org.apache.openjpa.jdbc.sql.PostgresDictionary\n+jpa.pool.validationQuery=SELECT 1\n+#note: other connection pool settings can also be configured here, see persistenceContext.xml\n+quartz.jobstore=org.quartz.impl.jdbcjobstore.PostgreSQLDelegate\n+quartz.sql=tables_postgres.sql\n+audit.sql=audit.sql\n+database.schema="},{"sha":"8d2d0fb43c0a1e5c6a63e9f48ebe3543321924a9","filename":"syncope620/fit/server-reference/src/test/java/org/apache/syncope/fit/server/reference/ConfigurationITCase.java","status":"modified","additions":37,"deletions":2,"changes":39,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/498eb7ecd43143100700326bc9af14bea7ff0436/syncope620%2Ffit%2Fserver-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fserver%2Freference%2FConfigurationITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/498eb7ecd43143100700326bc9af14bea7ff0436/syncope620%2Ffit%2Fserver-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fserver%2Freference%2FConfigurationITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/syncope620%2Ffit%2Fserver-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fserver%2Freference%2FConfigurationITCase.java?ref=498eb7ecd43143100700326bc9af14bea7ff0436","patch":"@@ -18,6 +18,7 @@\n  */\n package org.apache.syncope.fit.server.reference;\n \n+import static org.apache.commons.lang3.StringUtils.isEmpty;\n import static org.junit.Assert.assertEquals;\n import static org.junit.Assert.assertFalse;\n import static org.junit.Assert.assertNotNull;\n@@ -27,10 +28,13 @@\n import java.io.IOException;\n import java.io.InputStream;\n import java.io.UnsupportedEncodingException;\n+import java.util.ArrayList;\n+import java.util.List;\n import javax.ws.rs.core.HttpHeaders;\n import javax.ws.rs.core.MediaType;\n import javax.ws.rs.core.Response;\n import org.apache.commons.io.IOUtils;\n+import org.apache.commons.lang3.ArrayUtils;\n import org.apache.commons.lang3.StringUtils;\n import org.apache.syncope.common.lib.SyncopeClientException;\n import org.apache.syncope.common.lib.SyncopeConstants;\n@@ -152,6 +156,37 @@ public void issueSYNCOPE418() {\n         }\n     }\n \n+    private static String[] substringsBetween(final String str, final String open, final String close) {\n+        if (str == null || isEmpty(open) || isEmpty(close)) {\n+            return null;\n+        }\n+        final int strLen = str.length();\n+        if (strLen == 0) {\n+            return ArrayUtils.EMPTY_STRING_ARRAY;\n+        }\n+        final int closeLen = close.length();\n+        final int openLen = open.length();\n+        final List<String> list = new ArrayList<>();\n+        int pos = 0;\n+        while (pos < strLen - closeLen) {\n+            int start = StringUtils.indexOfIgnoreCase(str, open, pos);\n+            if (start < 0) {\n+                break;\n+            }\n+            start += openLen;\n+            final int end = StringUtils.indexOfIgnoreCase(str, close, start);\n+            if (end < 0) {\n+                break;\n+            }\n+            list.add(str.substring(start, end));\n+            pos = end + closeLen;\n+        }\n+        if (list.isEmpty()) {\n+            return null;\n+        }\n+        return list.toArray(new String[list.size()]);\n+    }\n+\n     @Test\n     public void issueSYNCOPE629() throws IOException {\n         PlainSchemaTO membershipKey = new PlainSchemaTO();\n@@ -184,7 +219,7 @@ public void issueSYNCOPE629() throws IOException {\n             assertFalse(configExport.isEmpty());\n             assertTrue(configExport.length() > 1000);\n \n-            String[] result = StringUtils.substringsBetween(configExport, \"<RPLAINATTRTEMPLATE\", \"/>\");\n+            String[] result = substringsBetween(configExport, \"<RPLAINATTRTEMPLATE\", \"/>\");\n             assertNotNull(result);\n             boolean rattrExists = false;\n             for (String entry : result) {\n@@ -194,7 +229,7 @@ public void issueSYNCOPE629() throws IOException {\n             }\n             assertTrue(rattrExists);\n \n-            result = StringUtils.substringsBetween(configExport, \"<MPLAINATTRTEMPLATE\", \"/>\");\n+            result = substringsBetween(configExport, \"<MPLAINATTRTEMPLATE\", \"/>\");\n             assertNotNull(result);\n             boolean mattrExists = false;\n             for (String entry : result) {"}]}