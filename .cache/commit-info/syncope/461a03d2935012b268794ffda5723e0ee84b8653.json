{"sha":"461a03d2935012b268794ffda5723e0ee84b8653","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjQ2MWEwM2QyOTM1MDEyYjI2ODc5NGZmZGE1NzIzZTBlZTg0Yjg2NTM=","commit":{"author":{"name":"skylark17","email":"matteo.alessandroni@tirasa.net","date":"2017-12-11T11:53:52Z"},"committer":{"name":"skylark17","email":"matteo.alessandroni@tirasa.net","date":"2017-12-11T11:54:52Z"},"message":"[SYNCOPE-1237] Fix for copy-to-clipboard feature in multiple-opened toggle menus - full compatibility for Firefox and Chrome browsers","tree":{"sha":"5554c6f5649d02af17facd5282056cd3ac005045","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/5554c6f5649d02af17facd5282056cd3ac005045"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/461a03d2935012b268794ffda5723e0ee84b8653","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/461a03d2935012b268794ffda5723e0ee84b8653","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/461a03d2935012b268794ffda5723e0ee84b8653","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/461a03d2935012b268794ffda5723e0ee84b8653/comments","author":{"login":"mat-ale","id":25547301,"node_id":"MDQ6VXNlcjI1NTQ3MzAx","avatar_url":"https://avatars.githubusercontent.com/u/25547301?v=4","gravatar_id":"","url":"https://api.github.com/users/mat-ale","html_url":"https://github.com/mat-ale","followers_url":"https://api.github.com/users/mat-ale/followers","following_url":"https://api.github.com/users/mat-ale/following{/other_user}","gists_url":"https://api.github.com/users/mat-ale/gists{/gist_id}","starred_url":"https://api.github.com/users/mat-ale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mat-ale/subscriptions","organizations_url":"https://api.github.com/users/mat-ale/orgs","repos_url":"https://api.github.com/users/mat-ale/repos","events_url":"https://api.github.com/users/mat-ale/events{/privacy}","received_events_url":"https://api.github.com/users/mat-ale/received_events","type":"User","site_admin":false},"committer":{"login":"mat-ale","id":25547301,"node_id":"MDQ6VXNlcjI1NTQ3MzAx","avatar_url":"https://avatars.githubusercontent.com/u/25547301?v=4","gravatar_id":"","url":"https://api.github.com/users/mat-ale","html_url":"https://github.com/mat-ale","followers_url":"https://api.github.com/users/mat-ale/followers","following_url":"https://api.github.com/users/mat-ale/following{/other_user}","gists_url":"https://api.github.com/users/mat-ale/gists{/gist_id}","starred_url":"https://api.github.com/users/mat-ale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mat-ale/subscriptions","organizations_url":"https://api.github.com/users/mat-ale/orgs","repos_url":"https://api.github.com/users/mat-ale/repos","events_url":"https://api.github.com/users/mat-ale/events{/privacy}","received_events_url":"https://api.github.com/users/mat-ale/received_events","type":"User","site_admin":false},"parents":[{"sha":"d784ae297c79df8e7d9a7c5dec1677d716422ef2","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/d784ae297c79df8e7d9a7c5dec1677d716422ef2","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/d784ae297c79df8e7d9a7c5dec1677d716422ef2"}],"stats":{"total":19,"additions":16,"deletions":3},"files":[{"sha":"ab85e1c3eeb23a5b762a02477e595437d18ef1fc","filename":"client/console/src/main/resources/META-INF/resources/js/copyToClipboard.js","status":"modified","additions":16,"deletions":3,"changes":19,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/461a03d2935012b268794ffda5723e0ee84b8653/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fjs%2FcopyToClipboard.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/461a03d2935012b268794ffda5723e0ee84b8653/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fjs%2FcopyToClipboard.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fjs%2FcopyToClipboard.js?ref=461a03d2935012b268794ffda5723e0ee84b8653","patch":"@@ -29,16 +29,29 @@ if (typeof copyToClipboard === 'undefined') {\n     temp.style.height = 0;\n \n     // Append it to the page somewhere, in this case <body>\n-    $(document.body).append(temp);\n+    $elem.append(temp);\n \n     // Copy whatever is in the div to our new textarea\n     temp.value = $elem.attr(tag_value_to_copy);\n+    $(temp).text(temp.value);\n \n     // Copy whatever inside the textarea to clipboard\n     $(temp).focus().select();\n-\n     document.execCommand('SelectAll');\n-    document.execCommand(\"Copy\", false, null);\n+    document.execCommand(\"copy\", false, null);\n+\n+    if ($.browser.mozilla && !$.browser.chrome) {\n+      try {\n+        var range = document.createRange();\n+        range.selectNodeContents(temp);\n+        var selection = window.getSelection();\n+        selection.removeAllRanges();\n+        selection.addRange(range);\n+\n+        document.execCommand(\"Copy\", false, null);\n+      } catch (e) {\n+      }\n+    }\n \n     // Remove the textarea\n     $(temp).remove();"}]}