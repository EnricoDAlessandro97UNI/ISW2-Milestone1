{"sha":"c0205e00aeb5e22ebbe95a08a0e13cb42be91591","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmMwMjA1ZTAwYWViNWUyMmViYmU5NWEwOGEwZTEzY2I0MmJlOTE1OTE=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2012-11-29T17:46:27Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2012-11-29T17:46:27Z"},"message":"Fixing buggy quartz init SQL script (MySQL)\n\ngit-svn-id: https://svn.apache.org/repos/asf/syncope/trunk@1415301 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"c58ee2b8b101fc5c93b920ac015e7311633e1e10","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/c58ee2b8b101fc5c93b920ac015e7311633e1e10"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/c0205e00aeb5e22ebbe95a08a0e13cb42be91591","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/c0205e00aeb5e22ebbe95a08a0e13cb42be91591","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/c0205e00aeb5e22ebbe95a08a0e13cb42be91591","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/c0205e00aeb5e22ebbe95a08a0e13cb42be91591/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"64191e39f080634e63c7f04047ad5443e46fe489","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/64191e39f080634e63c7f04047ad5443e46fe489","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/64191e39f080634e63c7f04047ad5443e46fe489"}],"stats":{"total":86,"additions":66,"deletions":20},"files":[{"sha":"fac0276ea48f593390e3171e27182d219008f332","filename":"core/src/main/resources/quartz/tables_mysql.sql","status":"modified","additions":32,"deletions":11,"changes":43,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/c0205e00aeb5e22ebbe95a08a0e13cb42be91591/core%2Fsrc%2Fmain%2Fresources%2Fquartz%2Ftables_mysql.sql","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/c0205e00aeb5e22ebbe95a08a0e13cb42be91591/core%2Fsrc%2Fmain%2Fresources%2Fquartz%2Ftables_mysql.sql","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fresources%2Fquartz%2Ftables_mysql.sql?ref=c0205e00aeb5e22ebbe95a08a0e13cb42be91591","patch":"@@ -15,15 +15,16 @@\n -- specific language governing permissions and limitations\n -- under the License.\n \n-#\n-# Quartz seems to work best with the driver mm.mysql-2.0.7-bin.jar\n-#\n-# PLEASE consider using mysql with innodb tables to avoid locking issues\n-#\n-# In your Quartz properties file, you'll need to set \n-# org.quartz.jobStore.driverDelegateClass = org.quartz.impl.jdbcjobstore.StdJDBCDelegate\n-#\n+--\n+-- Quartz seems to work best with the driver mm.mysql-2.0.7-bin.jar\n+--\n+-- PLEASE consider using mysql with innodb tables to avoid locking issues\n+--\n+-- In your Quartz properties file, you'll need to set \n+-- org.quartz.jobStore.driverDelegateClass = org.quartz.impl.jdbcjobstore.StdJDBCDelegate\n+--\n \n+BEGIN;\n DROP TABLE IF EXISTS QRTZ_FIRED_TRIGGERS;\n DROP TABLE IF EXISTS QRTZ_PAUSED_TRIGGER_GRPS;\n DROP TABLE IF EXISTS QRTZ_SCHEDULER_STATE;\n@@ -35,8 +36,10 @@ DROP TABLE IF EXISTS QRTZ_BLOB_TRIGGERS;\n DROP TABLE IF EXISTS QRTZ_TRIGGERS;\n DROP TABLE IF EXISTS QRTZ_JOB_DETAILS;\n DROP TABLE IF EXISTS QRTZ_CALENDARS;\n+COMMIT;\n \n \n+BEGIN;\n CREATE TABLE QRTZ_JOB_DETAILS\n   (\n     SCHED_NAME VARCHAR(120) NOT NULL,\n@@ -51,7 +54,9 @@ CREATE TABLE QRTZ_JOB_DETAILS\n     JOB_DATA BLOB NULL,\n     PRIMARY KEY (SCHED_NAME,JOB_NAME,JOB_GROUP)\n );\n+COMMIT;\n \n+BEGIN;\n CREATE TABLE QRTZ_TRIGGERS\n   (\n     SCHED_NAME VARCHAR(120) NOT NULL,\n@@ -74,7 +79,9 @@ CREATE TABLE QRTZ_TRIGGERS\n     FOREIGN KEY (SCHED_NAME,JOB_NAME,JOB_GROUP)\n         REFERENCES QRTZ_JOB_DETAILS(SCHED_NAME,JOB_NAME,JOB_GROUP)\n );\n+COMMIT;\n \n+BEGIN;\n CREATE TABLE QRTZ_SIMPLE_TRIGGERS\n   (\n     SCHED_NAME VARCHAR(120) NOT NULL,\n@@ -87,7 +94,9 @@ CREATE TABLE QRTZ_SIMPLE_TRIGGERS\n     FOREIGN KEY (SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP)\n         REFERENCES QRTZ_TRIGGERS(SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP)\n );\n+COMMIT;\n \n+BEGIN;\n CREATE TABLE QRTZ_CRON_TRIGGERS\n   (\n     SCHED_NAME VARCHAR(120) NOT NULL,\n@@ -99,7 +108,9 @@ CREATE TABLE QRTZ_CRON_TRIGGERS\n     FOREIGN KEY (SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP)\n         REFERENCES QRTZ_TRIGGERS(SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP)\n );\n+COMMIT;\n \n+BEGIN;\n CREATE TABLE QRTZ_SIMPROP_TRIGGERS\n   (          \n     SCHED_NAME VARCHAR(120) NOT NULL,\n@@ -120,7 +131,9 @@ CREATE TABLE QRTZ_SIMPROP_TRIGGERS\n     FOREIGN KEY (SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP) \n     REFERENCES QRTZ_TRIGGERS(SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP)\n );\n+COMMIT;\n \n+BEGIN;\n CREATE TABLE QRTZ_BLOB_TRIGGERS\n   (\n     SCHED_NAME VARCHAR(120) NOT NULL,\n@@ -131,22 +144,28 @@ CREATE TABLE QRTZ_BLOB_TRIGGERS\n     FOREIGN KEY (SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP)\n         REFERENCES QRTZ_TRIGGERS(SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP)\n );\n+COMMIT;\n \n+BEGIN;\n CREATE TABLE QRTZ_CALENDARS\n   (\n     SCHED_NAME VARCHAR(120) NOT NULL,\n     CALENDAR_NAME  VARCHAR(200) NOT NULL,\n     CALENDAR BLOB NOT NULL,\n     PRIMARY KEY (SCHED_NAME,CALENDAR_NAME)\n );\n+COMMIT;\n \n+BEGIN;\n CREATE TABLE QRTZ_PAUSED_TRIGGER_GRPS\n   (\n     SCHED_NAME VARCHAR(120) NOT NULL,\n     TRIGGER_GROUP  VARCHAR(200) NOT NULL, \n     PRIMARY KEY (SCHED_NAME,TRIGGER_GROUP)\n );\n+COMMIT;\n \n+BEGIN;\n CREATE TABLE QRTZ_FIRED_TRIGGERS\n   (\n     SCHED_NAME VARCHAR(120) NOT NULL,\n@@ -163,7 +182,9 @@ CREATE TABLE QRTZ_FIRED_TRIGGERS\n     REQUESTS_RECOVERY VARCHAR(1) NULL,\n     PRIMARY KEY (SCHED_NAME,ENTRY_ID)\n );\n+COMMIT;\n \n+BEGIN;\n CREATE TABLE QRTZ_SCHEDULER_STATE\n   (\n     SCHED_NAME VARCHAR(120) NOT NULL,\n@@ -172,13 +193,13 @@ CREATE TABLE QRTZ_SCHEDULER_STATE\n     CHECKIN_INTERVAL BIGINT(13) NOT NULL,\n     PRIMARY KEY (SCHED_NAME,INSTANCE_NAME)\n );\n+COMMIT;\n \n+BEGIN;\n CREATE TABLE QRTZ_LOCKS\n   (\n     SCHED_NAME VARCHAR(120) NOT NULL,\n     LOCK_NAME  VARCHAR(40) NOT NULL, \n     PRIMARY KEY (SCHED_NAME,LOCK_NAME)\n );\n-\n-\n-commit;\n+COMMIT;"},{"sha":"97f286e55bd8a098ab38d952cb8603e57e2df4ea","filename":"core/src/main/resources/quartz/tables_mysql_innodb.sql","status":"modified","additions":34,"deletions":9,"changes":43,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/c0205e00aeb5e22ebbe95a08a0e13cb42be91591/core%2Fsrc%2Fmain%2Fresources%2Fquartz%2Ftables_mysql_innodb.sql","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/c0205e00aeb5e22ebbe95a08a0e13cb42be91591/core%2Fsrc%2Fmain%2Fresources%2Fquartz%2Ftables_mysql_innodb.sql","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fresources%2Fquartz%2Ftables_mysql_innodb.sql?ref=c0205e00aeb5e22ebbe95a08a0e13cb42be91591","patch":"@@ -15,14 +15,16 @@\n -- specific language governing permissions and limitations\n -- under the License.\n \n-#\n-# In your Quartz properties file, you'll need to set \n-# org.quartz.jobStore.driverDelegateClass = org.quartz.impl.jdbcjobstore.StdJDBCDelegate\n-#\n-#\n-# By: Ron Cordell - roncordell\n-#  I didn't see this anywhere, so I thought I'd post it here. This is the script from Quartz to create the tables in a MySQL database, modified to use INNODB instead of MYISAM.\n+--\n+-- In your Quartz properties file, you'll need to set \n+-- org.quartz.jobStore.driverDelegateClass = org.quartz.impl.jdbcjobstore.StdJDBCDelegate\n+--\n+--\n+-- By: Ron Cordell - roncordell\n+-- I didn't see this anywhere, so I thought I'd post it here. This is the script from Quartz to create the tables in a MySQL database, modified to use INNODB instead of MYISAM.\n+--\n \n+BEGIN;\n DROP TABLE IF EXISTS QRTZ_FIRED_TRIGGERS;\n DROP TABLE IF EXISTS QRTZ_PAUSED_TRIGGER_GRPS;\n DROP TABLE IF EXISTS QRTZ_SCHEDULER_STATE;\n@@ -34,7 +36,9 @@ DROP TABLE IF EXISTS QRTZ_BLOB_TRIGGERS;\n DROP TABLE IF EXISTS QRTZ_TRIGGERS;\n DROP TABLE IF EXISTS QRTZ_JOB_DETAILS;\n DROP TABLE IF EXISTS QRTZ_CALENDARS;\n+COMMIT;\n \n+BEGIN;\n CREATE TABLE QRTZ_JOB_DETAILS(\n SCHED_NAME VARCHAR(120) NOT NULL,\n JOB_NAME VARCHAR(200) NOT NULL,\n@@ -48,7 +52,9 @@ REQUESTS_RECOVERY VARCHAR(1) NOT NULL,\n JOB_DATA BLOB NULL,\n PRIMARY KEY (SCHED_NAME,JOB_NAME,JOB_GROUP))\n TYPE=InnoDB;\n+COMMIT;\n \n+BEGIN;\n CREATE TABLE QRTZ_TRIGGERS (\n SCHED_NAME VARCHAR(120) NOT NULL,\n TRIGGER_NAME VARCHAR(200) NOT NULL,\n@@ -71,7 +77,9 @@ INDEX (SCHED_NAME,JOB_NAME, JOB_GROUP),\n FOREIGN KEY (SCHED_NAME,JOB_NAME,JOB_GROUP)\n REFERENCES QRTZ_JOB_DETAILS(SCHED_NAME,JOB_NAME,JOB_GROUP))\n TYPE=InnoDB;\n+COMMIT;\n \n+BEGIN;\n CREATE TABLE QRTZ_SIMPLE_TRIGGERS (\n SCHED_NAME VARCHAR(120) NOT NULL,\n TRIGGER_NAME VARCHAR(200) NOT NULL,\n@@ -84,7 +92,9 @@ INDEX (SCHED_NAME,TRIGGER_NAME, TRIGGER_GROUP),\n FOREIGN KEY (SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP)\n REFERENCES QRTZ_TRIGGERS(SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP))\n TYPE=InnoDB;\n+COMMIT;\n \n+BEGIN;\n CREATE TABLE QRTZ_CRON_TRIGGERS (\n SCHED_NAME VARCHAR(120) NOT NULL,\n TRIGGER_NAME VARCHAR(200) NOT NULL,\n@@ -96,7 +106,9 @@ INDEX (SCHED_NAME,TRIGGER_NAME, TRIGGER_GROUP),\n FOREIGN KEY (SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP)\n REFERENCES QRTZ_TRIGGERS(SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP))\n TYPE=InnoDB;\n+COMMIT;\n \n+BEGIN;\n CREATE TABLE QRTZ_SIMPROP_TRIGGERS\n   (          \n     SCHED_NAME VARCHAR(120) NOT NULL,\n@@ -117,7 +129,9 @@ CREATE TABLE QRTZ_SIMPROP_TRIGGERS\n     FOREIGN KEY (SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP) \n     REFERENCES QRTZ_TRIGGERS(SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP))\n TYPE=InnoDB;\n+COMMIT;\n \n+BEGIN;\n CREATE TABLE QRTZ_BLOB_TRIGGERS (\n SCHED_NAME VARCHAR(120) NOT NULL,\n TRIGGER_NAME VARCHAR(200) NOT NULL,\n@@ -128,20 +142,26 @@ INDEX (SCHED_NAME,TRIGGER_NAME, TRIGGER_GROUP),\n FOREIGN KEY (SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP)\n REFERENCES QRTZ_TRIGGERS(SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP))\n TYPE=InnoDB;\n+COMMIT;\n \n+BEGIN;\n CREATE TABLE QRTZ_CALENDARS (\n SCHED_NAME VARCHAR(120) NOT NULL,\n CALENDAR_NAME VARCHAR(200) NOT NULL,\n CALENDAR BLOB NOT NULL,\n PRIMARY KEY (SCHED_NAME,CALENDAR_NAME))\n TYPE=InnoDB;\n+COMMIT;\n \n+BEGIN;\n CREATE TABLE QRTZ_PAUSED_TRIGGER_GRPS (\n SCHED_NAME VARCHAR(120) NOT NULL,\n TRIGGER_GROUP VARCHAR(200) NOT NULL,\n PRIMARY KEY (SCHED_NAME,TRIGGER_GROUP))\n TYPE=InnoDB;\n+COMMIT;\n \n+BEGIN;\n CREATE TABLE QRTZ_FIRED_TRIGGERS (\n SCHED_NAME VARCHAR(120) NOT NULL,\n ENTRY_ID VARCHAR(95) NOT NULL,\n@@ -157,21 +177,27 @@ IS_NONCONCURRENT VARCHAR(1) NULL,\n REQUESTS_RECOVERY VARCHAR(1) NULL,\n PRIMARY KEY (SCHED_NAME,ENTRY_ID))\n TYPE=InnoDB;\n+COMMIT;\n \n+BEGIN;\n CREATE TABLE QRTZ_SCHEDULER_STATE (\n SCHED_NAME VARCHAR(120) NOT NULL,\n INSTANCE_NAME VARCHAR(200) NOT NULL,\n LAST_CHECKIN_TIME BIGINT(13) NOT NULL,\n CHECKIN_INTERVAL BIGINT(13) NOT NULL,\n PRIMARY KEY (SCHED_NAME,INSTANCE_NAME))\n TYPE=InnoDB;\n+COMMIT;\n \n+BEGIN;\n CREATE TABLE QRTZ_LOCKS (\n SCHED_NAME VARCHAR(120) NOT NULL,\n LOCK_NAME VARCHAR(40) NOT NULL,\n PRIMARY KEY (SCHED_NAME,LOCK_NAME))\n TYPE=InnoDB;\n+COMMIT;\n \n+BEGIN;\n CREATE INDEX IDX_QRTZ_J_REQ_RECOVERY ON QRTZ_JOB_DETAILS(SCHED_NAME,REQUESTS_RECOVERY);\n CREATE INDEX IDX_QRTZ_J_GRP ON QRTZ_JOB_DETAILS(SCHED_NAME,JOB_GROUP);\n \n@@ -194,5 +220,4 @@ CREATE INDEX IDX_QRTZ_FT_J_G ON QRTZ_FIRED_TRIGGERS(SCHED_NAME,JOB_NAME,JOB_GROU\n CREATE INDEX IDX_QRTZ_FT_JG ON QRTZ_FIRED_TRIGGERS(SCHED_NAME,JOB_GROUP);\n CREATE INDEX IDX_QRTZ_FT_T_G ON QRTZ_FIRED_TRIGGERS(SCHED_NAME,TRIGGER_NAME,TRIGGER_GROUP);\n CREATE INDEX IDX_QRTZ_FT_TG ON QRTZ_FIRED_TRIGGERS(SCHED_NAME,TRIGGER_GROUP);\n-\n-commit; \n+COMMIT;"}]}