{"sha":"b822bd75f4205db8458be6e97aac8e8af3273d31","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmI4MjJiZDc1ZjQyMDVkYjg0NThiZTZlOTdhYWM4ZThhZjMyNzNkMzE=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2016-05-12T08:29:00Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2016-05-12T08:29:00Z"},"message":"[SYNCOPE-156] FastDateFormat everywhere","tree":{"sha":"1caa25f37c126a7f8e318d7c5b6eb533865a2d15","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/1caa25f37c126a7f8e318d7c5b6eb533865a2d15"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/b822bd75f4205db8458be6e97aac8e8af3273d31","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/b822bd75f4205db8458be6e97aac8e8af3273d31","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/b822bd75f4205db8458be6e97aac8e8af3273d31","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/b822bd75f4205db8458be6e97aac8e8af3273d31/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"34dad8da77de5a3f34d2e7a87bc0233a86004c5e","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/34dad8da77de5a3f34d2e7a87bc0233a86004c5e","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/34dad8da77de5a3f34d2e7a87bc0233a86004c5e"}],"stats":{"total":30,"additions":10,"deletions":20},"files":[{"sha":"4ae788ea434e90abb3c4e1e3a5a85ba10aec32c1","filename":"client/console/src/main/java/org/apache/syncope/client/console/wicket/markup/html/form/DateFieldPanel.java","status":"modified","additions":10,"deletions":20,"changes":30,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b822bd75f4205db8458be6e97aac8e8af3273d31/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FDateFieldPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b822bd75f4205db8458be6e97aac8e8af3273d31/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FDateFieldPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FDateFieldPanel.java?ref=b822bd75f4205db8458be6e97aac8e8af3273d31","patch":"@@ -20,11 +20,10 @@\n \n import java.io.Serializable;\n import java.text.ParseException;\n-import java.text.SimpleDateFormat;\n import java.util.Date;\n import java.util.List;\n-import java.util.Locale;\n-import org.apache.syncope.common.lib.SyncopeConstants;\n+import org.apache.commons.lang3.time.FastDateFormat;\n+import org.apache.syncope.client.console.SyncopeConsoleSession;\n import org.apache.wicket.markup.html.list.ListItem;\n import org.apache.wicket.model.IModel;\n import org.apache.wicket.model.Model;\n@@ -34,22 +33,17 @@ public class DateFieldPanel extends FieldPanel<Date> {\n \n     private static final long serialVersionUID = -428975732068281726L;\n \n-    protected final String name;\n-\n-    protected final String datePattern;\n+    protected final FastDateFormat fmt;\n \n     protected DateFieldPanel(final String id, final String name, final IModel<Date> model, final String datePattern) {\n         super(id, name, model);\n-        this.name = name;\n-        this.datePattern = datePattern;\n+        fmt = datePattern == null\n+                ? SyncopeConsoleSession.get().getDateFormat()\n+                : FastDateFormat.getInstance(datePattern);\n     }\n \n     @Override\n     public FieldPanel<Date> setNewModel(final List<Serializable> list) {\n-        final SimpleDateFormat formatter = datePattern == null\n-                ? new SimpleDateFormat(SyncopeConstants.DEFAULT_DATE_PATTERN, Locale.getDefault())\n-                : new SimpleDateFormat(datePattern, Locale.getDefault());\n-\n         setNewModel(new Model<Date>() {\n \n             private static final long serialVersionUID = 527651414610325237L;\n@@ -61,7 +55,7 @@ public Date getObject() {\n                 if (list != null && !list.isEmpty() && StringUtils.hasText(list.get(0).toString())) {\n                     try {\n                         // Parse string using datePattern\n-                        date = formatter.parse(list.get(0).toString());\n+                        date = fmt.parse(list.get(0).toString());\n                     } catch (ParseException e) {\n                         LOG.error(\"invalid parse exception\", e);\n                     }\n@@ -74,7 +68,7 @@ public Date getObject() {\n             public void setObject(final Date object) {\n                 list.clear();\n                 if (object != null) {\n-                    list.add(formatter.format(object));\n+                    list.add(fmt.format(object));\n                 }\n             }\n         });\n@@ -85,10 +79,6 @@ public void setObject(final Date object) {\n     @SuppressWarnings(\"rawtypes\")\n     @Override\n     public FieldPanel<Date> setNewModel(final ListItem item) {\n-        final SimpleDateFormat formatter = datePattern == null\n-                ? new SimpleDateFormat(SyncopeConstants.DEFAULT_DATE_PATTERN, Locale.getDefault())\n-                : new SimpleDateFormat(datePattern, Locale.getDefault());\n-\n         IModel<Date> model = new Model<Date>() {\n \n             private static final long serialVersionUID = 6799404673615637845L;\n@@ -103,7 +93,7 @@ public Date getObject() {\n                     if (obj instanceof String) {\n                         // Parse string using datePattern\n                         try {\n-                            date = formatter.parse(obj.toString());\n+                            date = fmt.parse(obj.toString());\n                         } catch (ParseException e) {\n                             LOG.error(\"While parsing date\", e);\n                         }\n@@ -122,7 +112,7 @@ public Date getObject() {\n             @Override\n             @SuppressWarnings(\"unchecked\")\n             public void setObject(final Date object) {\n-                item.setModelObject(object != null ? formatter.format(object) : null);\n+                item.setModelObject(object != null ? fmt.format(object) : null);\n             }\n         };\n "}]}