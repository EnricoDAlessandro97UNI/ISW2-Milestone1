{"sha":"a82bfcf7a6b3686c67073d5e62845be57fa71a66","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmE4MmJmY2Y3YTZiMzY4NmM2NzA3M2Q1ZTYyODQ1YmU1N2ZhNzFhNjY=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2021-05-19T15:58:36Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2021-05-19T15:58:36Z"},"message":"[SYNCOPE-1545] Fix Binary Previewer","tree":{"sha":"8fbe357dac6ef4fd1d11bdf0d8e16987f0e4d80f","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/8fbe357dac6ef4fd1d11bdf0d8e16987f0e4d80f"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/a82bfcf7a6b3686c67073d5e62845be57fa71a66","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/a82bfcf7a6b3686c67073d5e62845be57fa71a66","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/a82bfcf7a6b3686c67073d5e62845be57fa71a66","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/a82bfcf7a6b3686c67073d5e62845be57fa71a66/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"1a7229230e6e058cbc2152530491e8c98fc5f433","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/1a7229230e6e058cbc2152530491e8c98fc5f433","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/1a7229230e6e058cbc2152530491e8c98fc5f433"}],"stats":{"total":75,"additions":48,"deletions":27},"files":[{"sha":"3a8cd2b18eade9f885cdd6daa39db543a12df3b6","filename":"client/idrepo/common-ui/pom.xml","status":"modified","additions":26,"deletions":1,"changes":27,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a82bfcf7a6b3686c67073d5e62845be57fa71a66/client%2Fidrepo%2Fcommon-ui%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a82bfcf7a6b3686c67073d5e62845be57fa71a66/client%2Fidrepo%2Fcommon-ui%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fcommon-ui%2Fpom.xml?ref=a82bfcf7a6b3686c67073d5e62845be57fa71a66","patch":"@@ -147,6 +147,31 @@ under the License.\n         </configuration>\n       </plugin>\n     </plugins>\n+\n+    <resources>\n+      <resource>\n+        <directory>src/main/resources</directory>\n+        <filtering>true</filtering>\n+        <excludes>\n+          <exclude>org/apache/syncope/**/*.properties</exclude>\n+        </excludes>\n+      </resource>\n+      <resource>\n+        <directory>src/main/resources</directory>\n+        <filtering>false</filtering>\n+        <includes>\n+          <include>org/apache/syncope/**/*.properties</include>\n+        </includes>\n+      </resource>\n+\n+      <resource>\n+        <directory>${basedir}</directory>\n+        <targetPath>META-INF</targetPath>\n+        <includes>\n+          <include>LICENSE</include>\n+          <include>NOTICE</include>\n+        </includes>\n+      </resource>\n+    </resources>\n   </build>\n-  \n </project>"},{"sha":"d77da3da8580c70e45b39a4bec1864bac9b1017b","filename":"client/idrepo/common-ui/src/main/resources/org/apache/syncope/client/ui/commons/markup/html/form/preview/BinaryCertPreviewer.html","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a82bfcf7a6b3686c67073d5e62845be57fa71a66/client%2Fidrepo%2Fcommon-ui%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fui%2Fcommons%2Fmarkup%2Fhtml%2Fform%2Fpreview%2FBinaryCertPreviewer.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a82bfcf7a6b3686c67073d5e62845be57fa71a66/client%2Fidrepo%2Fcommon-ui%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fui%2Fcommons%2Fmarkup%2Fhtml%2Fform%2Fpreview%2FBinaryCertPreviewer.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fcommon-ui%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fui%2Fcommons%2Fmarkup%2Fhtml%2Fform%2Fpreview%2FBinaryCertPreviewer.html?ref=a82bfcf7a6b3686c67073d5e62845be57fa71a66","previous_filename":"client/idrepo/console/src/main/resources/org/apache/syncope/client/console/wicket/markup/html/form/preview/BinaryCertPreviewer.html"},{"sha":"3b891b01f5f6231f54bd88abb5b4949c43c857c6","filename":"client/idrepo/common-ui/src/main/resources/org/apache/syncope/client/ui/commons/markup/html/form/preview/BinaryImagePreviewer.html","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a82bfcf7a6b3686c67073d5e62845be57fa71a66/client%2Fidrepo%2Fcommon-ui%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fui%2Fcommons%2Fmarkup%2Fhtml%2Fform%2Fpreview%2FBinaryImagePreviewer.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a82bfcf7a6b3686c67073d5e62845be57fa71a66/client%2Fidrepo%2Fcommon-ui%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fui%2Fcommons%2Fmarkup%2Fhtml%2Fform%2Fpreview%2FBinaryImagePreviewer.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fcommon-ui%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fui%2Fcommons%2Fmarkup%2Fhtml%2Fform%2Fpreview%2FBinaryImagePreviewer.html?ref=a82bfcf7a6b3686c67073d5e62845be57fa71a66","previous_filename":"client/idrepo/console/src/main/resources/org/apache/syncope/client/console/wicket/markup/html/form/preview/BinaryImagePreviewer.html"},{"sha":"1eb231f19d7c22512a07bcdac08e77855612e1ec","filename":"client/idrepo/common-ui/src/main/resources/org/apache/syncope/client/ui/commons/markup/html/form/preview/BinaryPDFPreviewer.html","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a82bfcf7a6b3686c67073d5e62845be57fa71a66/client%2Fidrepo%2Fcommon-ui%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fui%2Fcommons%2Fmarkup%2Fhtml%2Fform%2Fpreview%2FBinaryPDFPreviewer.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a82bfcf7a6b3686c67073d5e62845be57fa71a66/client%2Fidrepo%2Fcommon-ui%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fui%2Fcommons%2Fmarkup%2Fhtml%2Fform%2Fpreview%2FBinaryPDFPreviewer.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fcommon-ui%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fui%2Fcommons%2Fmarkup%2Fhtml%2Fform%2Fpreview%2FBinaryPDFPreviewer.html?ref=a82bfcf7a6b3686c67073d5e62845be57fa71a66","previous_filename":"client/idrepo/console/src/main/resources/org/apache/syncope/client/console/wicket/markup/html/form/preview/BinaryPDFPreviewer.html"},{"sha":"249ac512e874e819005c45c192ebd06d76a2bb2a","filename":"client/idrepo/common-ui/src/main/resources/org/apache/syncope/client/ui/commons/markup/html/form/preview/BinaryPreviewer.html","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a82bfcf7a6b3686c67073d5e62845be57fa71a66/client%2Fidrepo%2Fcommon-ui%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fui%2Fcommons%2Fmarkup%2Fhtml%2Fform%2Fpreview%2FBinaryPreviewer.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a82bfcf7a6b3686c67073d5e62845be57fa71a66/client%2Fidrepo%2Fcommon-ui%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fui%2Fcommons%2Fmarkup%2Fhtml%2Fform%2Fpreview%2FBinaryPreviewer.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fcommon-ui%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fui%2Fcommons%2Fmarkup%2Fhtml%2Fform%2Fpreview%2FBinaryPreviewer.html?ref=a82bfcf7a6b3686c67073d5e62845be57fa71a66","previous_filename":"client/idrepo/common-ui/src/main/resources/org/apache/syncope/client/ui/commons/markup/html/form/preview/AbstractBinaryPreviewer.html"},{"sha":"aa730cf69444b8e0f9d1fc4bf1539c4b5698417d","filename":"client/idrepo/common-ui/src/main/resources/org/apache/syncope/client/ui/commons/markup/html/form/preview/BinaryTextPreviewer.html","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a82bfcf7a6b3686c67073d5e62845be57fa71a66/client%2Fidrepo%2Fcommon-ui%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fui%2Fcommons%2Fmarkup%2Fhtml%2Fform%2Fpreview%2FBinaryTextPreviewer.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a82bfcf7a6b3686c67073d5e62845be57fa71a66/client%2Fidrepo%2Fcommon-ui%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fui%2Fcommons%2Fmarkup%2Fhtml%2Fform%2Fpreview%2FBinaryTextPreviewer.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fcommon-ui%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fui%2Fcommons%2Fmarkup%2Fhtml%2Fform%2Fpreview%2FBinaryTextPreviewer.html?ref=a82bfcf7a6b3686c67073d5e62845be57fa71a66","previous_filename":"client/idrepo/console/src/main/resources/org/apache/syncope/client/console/wicket/markup/html/form/preview/BinaryTextPreviewer.html"},{"sha":"f39ce1f895238e9cae57aa9127096b96ce1bda8b","filename":"wa/starter/src/main/java/org/apache/syncope/wa/starter/config/SyncopeWAConfiguration.java","status":"modified","additions":22,"deletions":26,"changes":48,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a82bfcf7a6b3686c67073d5e62845be57fa71a66/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fconfig%2FSyncopeWAConfiguration.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a82bfcf7a6b3686c67073d5e62845be57fa71a66/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fconfig%2FSyncopeWAConfiguration.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fconfig%2FSyncopeWAConfiguration.java?ref=a82bfcf7a6b3686c67073d5e62845be57fa71a66","patch":"@@ -20,22 +20,28 @@\n \n import com.github.benmanes.caffeine.cache.Caffeine;\n import com.github.benmanes.caffeine.cache.LoadingCache;\n+import com.warrenstrange.googleauth.IGoogleAuthenticator;\n import io.swagger.v3.oas.models.OpenAPI;\n import io.swagger.v3.oas.models.info.Contact;\n import io.swagger.v3.oas.models.info.Info;\n-import org.apache.commons.lang3.StringUtils;\n-import com.warrenstrange.googleauth.IGoogleAuthenticator;\n import io.swagger.v3.oas.models.security.SecurityScheme;\n+import java.time.LocalDate;\n+import java.time.ZoneId;\n+import java.util.Collection;\n+import java.util.HashMap;\n+import java.util.Map;\n+import org.apache.commons.lang3.StringUtils;\n import org.apache.syncope.common.keymaster.client.api.model.NetworkService;\n import org.apache.syncope.common.keymaster.client.api.startstop.KeymasterStart;\n import org.apache.syncope.common.keymaster.client.api.startstop.KeymasterStop;\n import org.apache.syncope.common.lib.types.JWSAlgorithm;\n import org.apache.syncope.wa.bootstrap.WARestClient;\n import org.apache.syncope.wa.starter.audit.SyncopeWAAuditTrailManager;\n+import org.apache.syncope.wa.starter.events.SyncopeWAEventRepository;\n import org.apache.syncope.wa.starter.gauth.SyncopeWAGoogleMfaAuthCredentialRepository;\n+import org.apache.syncope.wa.starter.gauth.SyncopeWAGoogleMfaAuthTokenRepository;\n import org.apache.syncope.wa.starter.mapping.AccessMapFor;\n import org.apache.syncope.wa.starter.mapping.AccessMapper;\n-import org.apache.syncope.wa.starter.mapping.DefaultAttrReleaseMapper;\n import org.apache.syncope.wa.starter.mapping.AttrReleaseMapFor;\n import org.apache.syncope.wa.starter.mapping.AttrReleaseMapper;\n import org.apache.syncope.wa.starter.mapping.AuthMapFor;\n@@ -44,6 +50,7 @@\n import org.apache.syncope.wa.starter.mapping.ClientAppMapFor;\n import org.apache.syncope.wa.starter.mapping.ClientAppMapper;\n import org.apache.syncope.wa.starter.mapping.DefaultAccessMapper;\n+import org.apache.syncope.wa.starter.mapping.DefaultAttrReleaseMapper;\n import org.apache.syncope.wa.starter.mapping.DefaultAuthMapper;\n import org.apache.syncope.wa.starter.mapping.OIDCRPClientAppTOMapper;\n import org.apache.syncope.wa.starter.mapping.RegisteredServiceMapper;\n@@ -55,6 +62,7 @@\n import org.apache.syncope.wa.starter.services.SyncopeWAServiceRegistry;\n import org.apache.syncope.wa.starter.surrogate.SyncopeWASurrogateAuthenticationService;\n import org.apache.syncope.wa.starter.u2f.SyncopeWAU2FDeviceRepository;\n+import org.apache.syncope.wa.starter.webauthn.SyncopeWAWebAuthnCredentialRepository;\n import org.apereo.cas.adaptors.u2f.storage.U2FDeviceRepository;\n import org.apereo.cas.audit.AuditTrailExecutionPlanConfigurer;\n import org.apereo.cas.authentication.surrogate.SurrogateAuthenticationService;\n@@ -65,44 +73,28 @@\n import org.apereo.cas.otp.repository.token.OneTimeTokenRepository;\n import org.apereo.cas.services.ServiceRegistryExecutionPlanConfigurer;\n import org.apereo.cas.services.ServiceRegistryListener;\n+import org.apereo.cas.support.events.CasEventRepository;\n+import org.apereo.cas.support.events.CasEventRepositoryFilter;\n import org.apereo.cas.support.pac4j.authentication.DelegatedClientFactoryCustomizer;\n import org.apereo.cas.support.saml.idp.metadata.generator.SamlIdPMetadataGenerator;\n import org.apereo.cas.support.saml.idp.metadata.generator.SamlIdPMetadataGeneratorConfigurationContext;\n import org.apereo.cas.support.saml.idp.metadata.locator.SamlIdPMetadataLocator;\n-import org.apereo.cas.support.saml.idp.metadata.writer.SamlIdPCertificateAndKeyWriter;\n import org.apereo.cas.util.DateTimeUtils;\n import org.apereo.cas.util.crypto.CipherExecutor;\n-\n-import org.apache.syncope.wa.starter.webauthn.SyncopeWAWebAuthnCredentialRepository;\n+import org.apereo.cas.webauthn.storage.WebAuthnCredentialRepository;\n import org.pac4j.core.client.Client;\n-import org.springframework.beans.factory.ObjectProvider;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.beans.factory.annotation.Qualifier;\n import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;\n import org.springframework.cloud.context.config.annotation.RefreshScope;\n import org.springframework.context.ConfigurableApplicationContext;\n import org.springframework.context.annotation.Bean;\n \n-import java.time.LocalDate;\n-import java.time.ZoneId;\n-import java.util.Collection;\n-import java.util.HashMap;\n-import java.util.Map;\n-import org.apache.syncope.wa.starter.events.SyncopeWAEventRepository;\n-import org.apache.syncope.wa.starter.gauth.SyncopeWAGoogleMfaAuthTokenRepository;\n-import org.apereo.cas.support.events.CasEventRepository;\n-import org.apereo.cas.support.events.CasEventRepositoryFilter;\n-import org.apereo.cas.webauthn.storage.WebAuthnCredentialRepository;\n-\n public class SyncopeWAConfiguration {\n \n     @Autowired\n     private CasConfigurationProperties casProperties;\n \n-    @Autowired\n-    @Qualifier(\"samlSelfSignedCertificateWriter\")\n-    private ObjectProvider<SamlIdPCertificateAndKeyWriter> samlSelfSignedCertificateWriter;\n-\n     @Autowired\n     private ConfigurableApplicationContext ctx;\n \n@@ -223,16 +215,20 @@ public ServiceRegistryExecutionPlanConfigurer syncopeServiceRegistryConfigurer(\n \n     @Autowired\n     @Bean\n-    public SamlIdPMetadataGenerator samlIdPMetadataGenerator(final WARestClient restClient,\n-                                                         final SamlIdPMetadataGeneratorConfigurationContext context) {\n+    public SamlIdPMetadataGenerator samlIdPMetadataGenerator(\n+            final WARestClient restClient,\n+            final SamlIdPMetadataGeneratorConfigurationContext context) {\n+\n         return new RestfulSamlIdPMetadataGenerator(context, restClient);\n     }\n \n     @Autowired\n     @Bean\n     public SamlIdPMetadataLocator samlIdPMetadataLocator(final WARestClient restClient) {\n-        return new RestfulSamlIdPMetadataLocator(CipherExecutor.noOpOfStringToString(),\n-                Caffeine.newBuilder().build(), restClient);\n+        return new RestfulSamlIdPMetadataLocator(\n+                CipherExecutor.noOpOfStringToString(),\n+                Caffeine.newBuilder().build(),\n+                restClient);\n     }\n \n     @Autowired"}]}