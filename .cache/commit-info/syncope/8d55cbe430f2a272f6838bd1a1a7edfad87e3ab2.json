{"sha":"8d55cbe430f2a272f6838bd1a1a7edfad87e3ab2","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjhkNTVjYmU0MzBmMmEyNzJmNjgzOGJkMWExYTdlZGZhZDg3ZTNhYjI=","commit":{"author":{"name":"Matteo Di Carlo","email":"matteo.dicarlo@tirasa.net","date":"2016-10-03T07:16:33Z"},"committer":{"name":"Matteo Di Carlo","email":"matteo.dicarlo@tirasa.net","date":"2016-10-03T07:26:42Z"},"message":"[SYNCOPE-942] fixes bug in changing security answer in enduser","tree":{"sha":"1452600667fcb7e4c6d7cd86843ab050df7ed546","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/1452600667fcb7e4c6d7cd86843ab050df7ed546"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/8d55cbe430f2a272f6838bd1a1a7edfad87e3ab2","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/8d55cbe430f2a272f6838bd1a1a7edfad87e3ab2","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/8d55cbe430f2a272f6838bd1a1a7edfad87e3ab2","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/8d55cbe430f2a272f6838bd1a1a7edfad87e3ab2/comments","author":null,"committer":null,"parents":[{"sha":"b85e14b857b3c0a640073bcbcd23d692b5ae5e53","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/b85e14b857b3c0a640073bcbcd23d692b5ae5e53","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/b85e14b857b3c0a640073bcbcd23d692b5ae5e53"}],"stats":{"total":27,"additions":14,"deletions":13},"files":[{"sha":"5e38b82f2bdb6a6ac685112e9ed96302b1bb3522","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/controllers/UserController.js","status":"modified","additions":9,"deletions":7,"changes":16,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/8d55cbe430f2a272f6838bd1a1a7edfad87e3ab2/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/8d55cbe430f2a272f6838bd1a1a7edfad87e3ab2/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js?ref=8d55cbe430f2a272f6838bd1a1a7edfad87e3ab2","patch":"@@ -37,7 +37,7 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n     $scope.availableRealms = [];\n     $scope.availableSecurityQuestions = [];\n \n-    $scope.initialSecurityQuestion = undefined;\n+    $scope.initialSecurityQuestion = '';\n     $scope.captchaInput = {\n       value: \"\"\n     };\n@@ -198,7 +198,7 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n             return x < y ? -1 : x > y ? 1 : 0;\n           });\n         }, function (e) {\n-          $scope.showError(\"An error occur during retrieving groups \" + e, $scope.notification)\n+          $scope.showError(\"An error occur during retrieving groups \" + e, $scope.notification);\n         });\n       };\n \n@@ -243,9 +243,11 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n         UserSelfService.read().then(function (response) {\n           $scope.user = UserUtil.getUnwrappedUser(response);\n           $scope.user.password = undefined;\n+          \n           $scope.initialSecurityQuestion = $scope.user.securityQuestion;\n           // initialize already assigned resources\n           $scope.dynamicForm.selectedResources = $scope.user.resources;\n+ \n           // initialize already assigned groups -- keeping the same structure of groups       \n           for (var index in $scope.user.memberships) {\n             $scope.dynamicForm.selectedGroups.push(\n@@ -296,9 +298,8 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n \n         //removing derived schemas\n         for (var i = 0; i < $scope.dynamicForm.derSchemas.length; i++) {\n-          if ((anyTypeClass && $scope.dynamicForm.derSchemas[i].anyTypeClass == anyTypeClass)\n+          if ((anyTypeClass && $scope.dynamicForm.derSchemas[i].anyTypeClass === anyTypeClass)\n                   || (group && $scope.dynamicForm.derSchemas[i].key.includes(group + '#'))) {\n-\n             //cleaning both form and user model\n             delete $scope.user.derAttrs[$scope.dynamicForm.derSchemas[i].key];\n             $scope.dynamicForm.derSchemas.splice(i, 1);\n@@ -307,9 +308,8 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n         }\n         //removing virtual schemas\n         for (var i = 0; i < $scope.dynamicForm.virSchemas.length; i++) {\n-          if ((anyTypeClass && $scope.dynamicForm.virSchemas[i].anyTypeClass == anyTypeClass)\n+          if ((anyTypeClass && $scope.dynamicForm.virSchemas[i].anyTypeClass === anyTypeClass)\n                   || (group && $scope.dynamicForm.virSchemas[i].key.includes(group + '#'))) {\n-\n             //cleaning both form and user model\n             delete $scope.user.virAttrs[$scope.dynamicForm.virSchemas[i].key];\n             $scope.dynamicForm.virSchemas.splice(i, 1);\n@@ -344,7 +344,7 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n           username: '',\n           password: '',\n           realm: '/',\n-          securityQuestion: undefined,\n+          securityQuestion: '',\n           securityAnswer: '',\n           plainAttrs: {},\n           derAttrs: {},\n@@ -410,6 +410,7 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n         });\n       }\n     };\n+    \n     $scope.retrieveSecurityQuestion = function (user) {\n       if ($rootScope.pwdResetRequiringSecurityQuestions) {\n         if (user && user.username && user.username.length) {\n@@ -431,6 +432,7 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n         }\n       }\n     };\n+    \n     $scope.resetPassword = function (user) {\n       if (user && user.username) {\n         $scope.retrieveSecurityQuestion(user);"},{"sha":"59d0e7fadb5bad740fecad5d4a2815f347896563","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/services/groupService.js","status":"modified","additions":0,"deletions":2,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/8d55cbe430f2a272f6838bd1a1a7edfad87e3ab2/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fservices%2FgroupService.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/8d55cbe430f2a272f6838bd1a1a7edfad87e3ab2/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fservices%2FgroupService.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fservices%2FgroupService.js?ref=8d55cbe430f2a272f6838bd1a1a7edfad87e3ab2","patch":"@@ -22,9 +22,7 @@\n angular.module('self')\n         .factory('GroupService', ['$resource', '$q', '$http',\n           function ($group, $q, $http) {\n-\n             var groupService = {};\n-\n             groupService.getGroups = function (realm) {\n               return  $http.get(\"/syncope-enduser/api/groups?realm=\" + encodeURI(realm))\n                       .then(function (response) {"},{"sha":"dd5ff3a6a9e2d3b5a532f815fbfdee897afef0b0","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/services/schemaService.js","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/8d55cbe430f2a272f6838bd1a1a7edfad87e3ab2/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fservices%2FschemaService.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/8d55cbe430f2a272f6838bd1a1a7edfad87e3ab2/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fservices%2FschemaService.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fservices%2FschemaService.js?ref=8d55cbe430f2a272f6838bd1a1a7edfad87e3ab2","patch":"@@ -26,9 +26,9 @@ angular.module('self')\n             var schemaService = {};\n \n             schemaService.getUserSchemas = function (anyTypeClass) {\n-              var param = anyTypeClass ? \"?anyTypeClass=\" + encodeURI(anyTypeClass) : \"\";\n+              var classParam = anyTypeClass ? \"?anyTypeClass=\" + encodeURI(anyTypeClass) : \"\";\n \n-              return  $http.get(\"/syncope-enduser/api/schemas\" + param)\n+              return  $http.get(\"/syncope-enduser/api/schemas\" + classParam)\n                       .then(function (response) {\n                         return response.data;\n                       }, function (response) {"},{"sha":"9932f8bfa4e83cbe801510ad68f11582b27e7458","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/dynamicPlainAttributes.html","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/8d55cbe430f2a272f6838bd1a1a7edfad87e3ab2/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicPlainAttributes.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/8d55cbe430f2a272f6838bd1a1a7edfad87e3ab2/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicPlainAttributes.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicPlainAttributes.html?ref=8d55cbe430f2a272f6838bd1a1a7edfad87e3ab2","patch":"@@ -16,18 +16,19 @@\n specific language governing permissions and limitations\n under the License.\n -->\n-\n <div ng-repeat=\"groupSchema in dynamicForm.groupSchemas\">\n   <uib-accordion ng-if=\"getByGroup(groupSchema).length > 0\">\n     <div uib-accordion-group heading=\"{{groupSchema| translate}}\"\n          ng-init=\"status = {isOpen: (groupSchema == 'own')}\" is-open=\"status.isOpen\"\n          class=\"breadcrumb-header\">\n+\n       <div id=\"attribute\" class=\"form-group\" ng-repeat=\"plainSchema in getByGroup(groupSchema) track by $index\">\n         <label for=\"plainSchema.key\">{{plainSchema.simpleKey| translate}} <span ng-if=\"plainSchema.mandatoryCondition === 'true'\">*</span></label>\n         <div ng-if=\"!plainSchema.multivalue\">\n           <dynamic-plain-attribute schema=\"plainSchema\" user=\"user\" index=\"0\"></dynamic-plain-attribute>\n           <validation-message name=\"{{plainSchema.key| translate}}\"/>\n         </div>\n+        \n         <div ng-if=\"plainSchema.multivalue\">\n           <div ng-repeat=\"field in dynamicForm.attributeTable[plainSchema.key].fields track by $index\" \n                ng-model='dynamicForm.attributeTable[plainSchema.key].fields[$index]'>"},{"sha":"06cfe392219d5341a003c6c6f6d8f1de386d6148","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/user-credentials.html","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/8d55cbe430f2a272f6838bd1a1a7edfad87e3ab2/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-credentials.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/8d55cbe430f2a272f6838bd1a1a7edfad87e3ab2/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-credentials.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-credentials.html?ref=8d55cbe430f2a272f6838bd1a1a7edfad87e3ab2","patch":"@@ -56,7 +56,7 @@\n \n <div id=\"attribute\" class=\"form-group\">\n   <label for=\"securityAnswer\">{{'SECURITYANSWER' | translate}}</label>\n-  <input ng-disabled=\"user.securityQuestion === initialSecurityQuestion\" name=\"securityAnswer\" type=\"text\" class=\"form-control\" \n+  <input ng-disabled=\"user.securityQuestion === null || user.securityQuestion === ''\" name=\"securityAnswer\" type=\"text\" class=\"form-control\" \n          ng-model=\"user.securityAnswer\"\n          placeholder=\"security answer\">\n </div>"}]}