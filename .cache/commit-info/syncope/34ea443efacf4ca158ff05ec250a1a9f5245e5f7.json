{"sha":"34ea443efacf4ca158ff05ec250a1a9f5245e5f7","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjM0ZWE0NDNlZmFjZjRjYTE1OGZmMDVlYzI1MGExYTlmNTI0NWU1Zjc=","commit":{"author":{"name":"Colm O Heigeartaigh","email":"coheigea@apache.org","date":"2014-06-19T09:52:12Z"},"committer":{"name":"Colm O Heigeartaigh","email":"coheigea@apache.org","date":"2014-06-19T09:52:12Z"},"message":"[SYNCOPE-505] - Updating the DB Propagation Actions class\n\ngit-svn-id: https://svn.apache.org/repos/asf/syncope/trunk@1603800 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"3388d393866adcc6e9e7d8cf30faaf3d908f378b","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/3388d393866adcc6e9e7d8cf30faaf3d908f378b"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/34ea443efacf4ca158ff05ec250a1a9f5245e5f7","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/34ea443efacf4ca158ff05ec250a1a9f5245e5f7","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/34ea443efacf4ca158ff05ec250a1a9f5245e5f7","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/34ea443efacf4ca158ff05ec250a1a9f5245e5f7/comments","author":{"login":"coheigea","id":472162,"node_id":"MDQ6VXNlcjQ3MjE2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/472162?v=4","gravatar_id":"","url":"https://api.github.com/users/coheigea","html_url":"https://github.com/coheigea","followers_url":"https://api.github.com/users/coheigea/followers","following_url":"https://api.github.com/users/coheigea/following{/other_user}","gists_url":"https://api.github.com/users/coheigea/gists{/gist_id}","starred_url":"https://api.github.com/users/coheigea/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coheigea/subscriptions","organizations_url":"https://api.github.com/users/coheigea/orgs","repos_url":"https://api.github.com/users/coheigea/repos","events_url":"https://api.github.com/users/coheigea/events{/privacy}","received_events_url":"https://api.github.com/users/coheigea/received_events","type":"User","site_admin":false},"committer":{"login":"coheigea","id":472162,"node_id":"MDQ6VXNlcjQ3MjE2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/472162?v=4","gravatar_id":"","url":"https://api.github.com/users/coheigea","html_url":"https://github.com/coheigea","followers_url":"https://api.github.com/users/coheigea/followers","following_url":"https://api.github.com/users/coheigea/following{/other_user}","gists_url":"https://api.github.com/users/coheigea/gists{/gist_id}","starred_url":"https://api.github.com/users/coheigea/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coheigea/subscriptions","organizations_url":"https://api.github.com/users/coheigea/orgs","repos_url":"https://api.github.com/users/coheigea/repos","events_url":"https://api.github.com/users/coheigea/events{/privacy}","received_events_url":"https://api.github.com/users/coheigea/received_events","type":"User","site_admin":false},"parents":[{"sha":"d04b3e2b1ec80bba07f840325a836da196ac58b1","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/d04b3e2b1ec80bba07f840325a836da196ac58b1","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/d04b3e2b1ec80bba07f840325a836da196ac58b1"}],"stats":{"total":17,"additions":10,"deletions":7},"files":[{"sha":"02cb63c16bb73c0509ab63c2965db1d99a7dc364","filename":"core/src/main/java/org/apache/syncope/core/propagation/impl/DBPasswordPropagationActions.java","status":"modified","additions":10,"deletions":7,"changes":17,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/34ea443efacf4ca158ff05ec250a1a9f5245e5f7/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpropagation%2Fimpl%2FDBPasswordPropagationActions.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/34ea443efacf4ca158ff05ec250a1a9f5245e5f7/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpropagation%2Fimpl%2FDBPasswordPropagationActions.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpropagation%2Fimpl%2FDBPasswordPropagationActions.java?ref=34ea443efacf4ca158ff05ec250a1a9f5245e5f7","patch":"@@ -33,32 +33,28 @@\n import org.identityconnectors.framework.common.objects.AttributeUtil;\n import org.identityconnectors.framework.common.objects.ConnectorObject;\n import org.identityconnectors.framework.common.objects.OperationalAttributes;\n-import org.slf4j.Logger;\n-import org.slf4j.LoggerFactory;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.transaction.annotation.Transactional;\n \n /**\n  * Propagate a non-cleartext password out to a resource, if the PropagationManager has not already\n- * added a password.\n+ * added a password. \n  */\n public class DBPasswordPropagationActions extends DefaultPropagationActions {\n \n-    private static final Logger LOG = LoggerFactory.getLogger(DBPasswordPropagationActions.class);\n-\n     @Autowired\n     private UserDAO userDAO;\n \n     @Transactional(readOnly = true)\n     @Override\n     public void before(final PropagationTask task, final ConnectorObject beforeObj) {\n         super.before(task, beforeObj);\n-\n+        \n         if (AttributableType.USER == task.getSubjectType()) {\n             SyncopeUser user = userDAO.find(task.getSubjectId());\n             if (user != null && user.getPassword() != null) {\n                 Attribute missing = AttributeUtil.find(\n-                        AttributeUtil.createSpecialName(PropagationTaskExecutor.MANDATORY_MISSING_ATTR_NAME),\n+                        PropagationTaskExecutor.MANDATORY_MISSING_ATTR_NAME,\n                         task.getAttributes());\n                 if (missing != null && missing.getValue() != null && missing.getValue().size() == 1\n                         && missing.getValue().get(0).equals(OperationalAttributes.PASSWORD_NAME)) {\n@@ -69,9 +65,16 @@ public void before(final PropagationTask task, final ConnectorObject beforeObj)\n                     Set<Attribute> attributes = new HashSet<Attribute>(task.getAttributes());\n                     attributes.add(passwordAttribute);\n                     attributes.remove(missing);\n+                    \n+                    Attribute hashedPasswordAttribute = \n+                        AttributeBuilder.build(\n+                            AttributeUtil.createSpecialName(\"HASHED_PASSWORD\"), Boolean.TRUE);\n+                    attributes.add(hashedPasswordAttribute);\n+                    \n                     task.setAttributes(attributes);\n                 }\n             }\n         }\n     }\n+    \n }"}]}