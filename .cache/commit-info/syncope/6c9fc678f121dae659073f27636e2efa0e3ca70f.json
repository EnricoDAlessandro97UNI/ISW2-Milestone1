{"sha":"6c9fc678f121dae659073f27636e2efa0e3ca70f","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjZjOWZjNjc4ZjEyMWRhZTY1OTA3M2YyNzYzNmUyZWZhMGUzY2E3MGY=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2020-01-14T08:37:47Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2020-01-14T08:38:06Z"},"message":"[SYNCOPE-1532] Extending the set of allowed characters for Realms name and path","tree":{"sha":"0bc1759c651c414d72d314b9e0dc7a15af8b84db","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/0bc1759c651c414d72d314b9e0dc7a15af8b84db"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/6c9fc678f121dae659073f27636e2efa0e3ca70f","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/6c9fc678f121dae659073f27636e2efa0e3ca70f","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/6c9fc678f121dae659073f27636e2efa0e3ca70f","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/6c9fc678f121dae659073f27636e2efa0e3ca70f/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"3b4755e5f5640ef0debe371ff11700686138d7b0","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/3b4755e5f5640ef0debe371ff11700686138d7b0","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/3b4755e5f5640ef0debe371ff11700686138d7b0"}],"stats":{"total":25,"additions":19,"deletions":6},"files":[{"sha":"800b49394dd6c18513654feb6253a4ba1ba2b253","filename":"core/persistence-api/src/main/java/org/apache/syncope/core/persistence/api/dao/RealmDAO.java","status":"modified","additions":3,"deletions":1,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/6c9fc678f121dae659073f27636e2efa0e3ca70f/core%2Fpersistence-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fapi%2Fdao%2FRealmDAO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/6c9fc678f121dae659073f27636e2efa0e3ca70f/core%2Fpersistence-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fapi%2Fdao%2FRealmDAO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fapi%2Fdao%2FRealmDAO.java?ref=6c9fc678f121dae659073f27636e2efa0e3ca70f","patch":"@@ -27,7 +27,9 @@\n \n public interface RealmDAO extends DAO<Realm> {\n \n-    Pattern PATH_PATTERN = Pattern.compile(\"^(/[A-Za-z0-9]+)+\");\n+    Pattern NAME_PATTERN = Pattern.compile(\"^[A-Za-z0-9~]+\");\n+\n+    Pattern PATH_PATTERN = Pattern.compile(\"^(/[A-Za-z0-9~]+)+\");\n \n     Realm getRoot();\n "},{"sha":"a4d51f107491976b90001cc544811044b7f965e0","filename":"core/persistence-jpa/src/main/java/org/apache/syncope/core/persistence/jpa/validation/entity/RealmValidator.java","status":"modified","additions":2,"deletions":4,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/6c9fc678f121dae659073f27636e2efa0e3ca70f/core%2Fpersistence-jpa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fvalidation%2Fentity%2FRealmValidator.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/6c9fc678f121dae659073f27636e2efa0e3ca70f/core%2Fpersistence-jpa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fvalidation%2Fentity%2FRealmValidator.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fvalidation%2Fentity%2FRealmValidator.java?ref=6c9fc678f121dae659073f27636e2efa0e3ca70f","patch":"@@ -18,16 +18,14 @@\n  */\n package org.apache.syncope.core.persistence.jpa.validation.entity;\n \n-import java.util.regex.Pattern;\n import javax.validation.ConstraintValidatorContext;\n import org.apache.syncope.common.lib.SyncopeConstants;\n import org.apache.syncope.common.lib.types.EntityViolationType;\n+import org.apache.syncope.core.persistence.api.dao.RealmDAO;\n import org.apache.syncope.core.persistence.api.entity.Realm;\n \n public class RealmValidator extends AbstractValidator<RealmCheck, Realm> {\n \n-    private static final Pattern REALM_NAME_PATTERN = Pattern.compile(\"^[A-Za-z0-9]+\");\n-\n     @Override\n     public boolean isValid(final Realm realm, final ConstraintValidatorContext context) {\n         context.disableDefaultConstraintViolation();\n@@ -51,7 +49,7 @@ public boolean isValid(final Realm realm, final ConstraintValidatorContext conte\n                         addPropertyNode(\"parent\").addConstraintViolation();\n             }\n \n-            if (!REALM_NAME_PATTERN.matcher(realm.getName()).matches()) {\n+            if (!RealmDAO.NAME_PATTERN.matcher(realm.getName()).matches()) {\n                 isValid = false;\n \n                 context.buildConstraintViolationWithTemplate("},{"sha":"134e0bba7d0656a1478eabca8fc2e010ade4d14d","filename":"fit/core-reference/src/test/java/org/apache/syncope/fit/core/RealmITCase.java","status":"modified","additions":14,"deletions":1,"changes":15,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/6c9fc678f121dae659073f27636e2efa0e3ca70f/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FRealmITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/6c9fc678f121dae659073f27636e2efa0e3ca70f/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FRealmITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FRealmITCase.java?ref=6c9fc678f121dae659073f27636e2efa0e3ca70f","patch":"@@ -72,7 +72,7 @@ public void list() {\n \n     @Test\n     public void createUpdate() {\n-        final RealmTO realm = new RealmTO();\n+        RealmTO realm = new RealmTO();\n         realm.setName(\"last\");\n \n         // 1. create\n@@ -125,6 +125,19 @@ public void createUpdate() {\n         }\n     }\n \n+    @Test\n+    public void createWithTilde() {\n+        RealmTO realm = new RealmTO();\n+        realm.setName(\"73~1~19534\");\n+\n+        Response response = realmService.create(\"/even/two\", realm);\n+        assertEquals(Response.Status.CREATED.getStatusCode(), response.getStatus());\n+\n+        List<RealmTO> realms = realmService.list(\"/even/two/73~1~19534\");\n+        assertEquals(1, realms.size());\n+        assertEquals(realm.getName(), realms.get(0).getName());\n+    }\n+\n     @Test\n     public void deletingAccountPolicy() {\n         // 1. create account policy"}]}