{"sha":"d6c3d83d3970be55f9fd959e7dae3ab43b7ee740","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmQ2YzNkODNkMzk3MGJlNTVmOWZkOTU5ZTdkYWUzYWI0M2I3ZWU3NDA=","commit":{"author":{"name":"Unknown","email":"unknown@apache.org","date":"2010-09-28T10:49:41Z"},"committer":{"name":"Unknown","email":"unknown@apache.org","date":"2010-09-28T10:49:41Z"},"message":"(Fixes issue #31)\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/syncope/trunk@1246543 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"fbdf1f7ede25016dfb243c6f42649e2ec453e40e","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/fbdf1f7ede25016dfb243c6f42649e2ec453e40e"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740/comments","author":null,"committer":null,"parents":[{"sha":"ebd46be016b551802bac52ef34d38e7f9e302bb2","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/ebd46be016b551802bac52ef34d38e7f9e302bb2","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/ebd46be016b551802bac52ef34d38e7f9e302bb2"}],"stats":{"total":444,"additions":428,"deletions":16},"files":[{"sha":"5f338e7c07fa1eb4ceeacd459de51ca1a0d5c975","filename":"core/pom.xml","status":"modified","additions":20,"deletions":0,"changes":20,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740/core%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740/core%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpom.xml?ref=d6c3d83d3970be55f9fd959e7dae3ab43b7ee740","patch":"@@ -42,6 +42,7 @@\n         <logfile.rest>/tmp/syncope-core-rest.log</logfile.rest>\n         <logfile.identityconnectors>/tmp/syncope-core-identityconnectors.log</logfile.identityconnectors>\n         <logfile.test>/tmp/syncope-core-test.log</logfile.test>\n+        <logfile.monitor>/tmp/syncope-core-monitor.log</logfile.monitor>\n \n         <bundles.directory>/tmp/bundles</bundles.directory>\n     </properties>\n@@ -150,10 +151,27 @@\n             <artifactId>xstream</artifactId>\n         </dependency>\n \n+        <dependency>\n+            <groupId>org.aspectj</groupId>\n+            <artifactId>aspectjrt</artifactId>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.aspectj</groupId>\n+            <artifactId>aspectjweaver</artifactId>\n+        </dependency>\n+\n         <dependency>\n             <groupId>org.hibernate</groupId>\n             <artifactId>hibernate-entitymanager</artifactId>\n         </dependency>\n+        <dependency>\n+            <groupId>org.hibernate</groupId>\n+            <artifactId>hibernate-jbosscache2</artifactId>\n+        </dependency>\n+        <dependency>\n+            <groupId>org.jboss.cache</groupId>\n+            <artifactId>jbosscache-core</artifactId>\n+        </dependency>\n \n         <dependency>\n             <groupId>org.dbunit</groupId>\n@@ -345,6 +363,7 @@\n                             <includes>\n                                 <include>**/db.properties</include>\n                                 <include>**/content.xml</include>\n+                                <include>**/treecache.xml</include>\n                             </includes>\n                         </configuration>\n                     </execution>\n@@ -369,6 +388,7 @@\n                             <packagingExcludes>\n                                 WEB-INF/classes/org/syncope/core/persistence/db.properties,\n                                 WEB-INF/classes/org/syncope/core/persistence/content.xml,\n+                                WEB-INF/classes/treecache.xml,\n                                 WEB-INF/classes/beans.xml\n                             </packagingExcludes>\n                         </configuration>"},{"sha":"31b7d9d429899d64e918d7e40f23e2d735505290","filename":"core/src/main/java/org/syncope/core/monitor/CacheMonitor.java","status":"added","additions":80,"deletions":0,"changes":80,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fmonitor%2FCacheMonitor.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fmonitor%2FCacheMonitor.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fmonitor%2FCacheMonitor.java?ref=d6c3d83d3970be55f9fd959e7dae3ab43b7ee740","patch":"@@ -0,0 +1,80 @@\n+/*\n+ *  Licensed under the Apache License, Version 2.0 (the \"License\");\n+ *  you may not use this file except in compliance with the License.\n+ *  You may obtain a copy of the License at\n+ * \n+ *       http://www.apache.org/licenses/LICENSE-2.0\n+ * \n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ *  under the License.\n+ */\n+package org.syncope.core.monitor;\n+\n+import java.text.DecimalFormat;\n+import java.text.NumberFormat;\n+import javax.persistence.EntityManager;\n+import org.aspectj.lang.ProceedingJoinPoint;\n+import org.aspectj.lang.annotation.Around;\n+import org.aspectj.lang.annotation.Aspect;\n+import org.hibernate.Session;\n+import org.hibernate.stat.Statistics;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+import org.springframework.beans.factory.annotation.Autowired;\n+\n+@Aspect\n+public class CacheMonitor {\n+\n+    /**\n+     * Logger.\n+     */\n+    private static final Logger LOG = LoggerFactory.getLogger(\n+            CacheMonitor.class);\n+    private static final NumberFormat NF = new DecimalFormat(\"0.0###\");\n+    @Autowired\n+    private EntityManager entityManager;\n+\n+    @Around(\"execution(* org.syncope.core.persistence.dao..*.*(..))\")\n+    public final Object log(final ProceedingJoinPoint pjp) throws Throwable {\n+        Object result;\n+        if (!LOG.isDebugEnabled()) {\n+            result = pjp.proceed();\n+        } else {\n+            Statistics statistics =\n+                    ((Session) entityManager.getDelegate()).getSessionFactory().\n+                    getStatistics();\n+            //statistics.logSummary();\n+\n+            long hit0 = statistics.getQueryCacheHitCount();\n+            long miss0 = statistics.getQueryCacheMissCount();\n+\n+            result = pjp.proceed();\n+\n+            long hit1 = statistics.getQueryCacheHitCount();\n+            long miss1 = statistics.getQueryCacheMissCount();\n+\n+            String ratio;\n+            synchronized (NF) {\n+                ratio = NF.format((double) hit1 / (hit1 + miss1));\n+            }\n+\n+            if (hit1 > hit0) {\n+                LOG.debug(\n+                        String.format(\"CACHE HIT; Ratio=%s; Signature=%s#%s()\",\n+                        ratio, pjp.getTarget().getClass().getName(),\n+                        pjp.getSignature().toShortString()));\n+            } else if (miss1 > miss0) {\n+                LOG.debug(\n+                        String.format(\"CACHE MISS; Ratio=%s; Signature=%s#%s()\",\n+                        ratio, pjp.getTarget().getClass().getName(),\n+                        pjp.getSignature().toShortString()));\n+            }\n+        }\n+\n+        return result;\n+    }\n+}"},{"sha":"e865cfabbe67c2a39bae2f51eb17fbdaad8ed5cc","filename":"core/src/main/java/org/syncope/core/persistence/beans/user/SyncopeUser.java","status":"modified","additions":18,"deletions":0,"changes":18,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fbeans%2Fuser%2FSyncopeUser.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fbeans%2Fuser%2FSyncopeUser.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fbeans%2Fuser%2FSyncopeUser.java?ref=d6c3d83d3970be55f9fd959e7dae3ab43b7ee740","patch":"@@ -31,12 +31,17 @@\n import javax.persistence.GenerationType;\n import javax.persistence.Id;\n import javax.persistence.Lob;\n+import javax.persistence.NamedQueries;\n+import javax.persistence.NamedQuery;\n import javax.persistence.OneToMany;\n+import javax.persistence.QueryHint;\n import javax.persistence.TableGenerator;\n import javax.persistence.Temporal;\n import javax.persistence.TemporalType;\n import org.apache.commons.lang.RandomStringUtils;\n import org.bouncycastle.jce.provider.BouncyCastleProvider;\n+import org.hibernate.annotations.Cache;\n+import org.hibernate.annotations.CacheConcurrencyStrategy;\n import org.syncope.core.persistence.security.AsymmetricCipher;\n import org.syncope.core.persistence.beans.AbstractAttributable;\n import org.syncope.core.persistence.beans.AbstractAttribute;\n@@ -46,6 +51,19 @@\n import org.syncope.core.persistence.beans.role.SyncopeRole;\n \n @Entity\n+@Cache(usage = CacheConcurrencyStrategy.TRANSACTIONAL)\n+@NamedQueries({\n+    @NamedQuery(name = \"SyncopeUser.find\",\n+    query = \"SELECT e FROM SyncopeUser e WHERE e.id = :id\",\n+    hints = {\n+        @QueryHint(name = \"org.hibernate.cacheable\", value = \"true\")\n+    }),\n+    @NamedQuery(name = \"SyncopeUser.findByWorkflowId\",\n+    query = \"SELECT e FROM SyncopeUser e WHERE e.workflowId = :workflowId\",\n+    hints = {\n+        @QueryHint(name = \"org.hibernate.cacheable\", value = \"true\")\n+    })\n+})\n public class SyncopeUser extends AbstractAttributable {\n \n     static {"},{"sha":"daa0956cf515758d053090bbfaf9efff711447c4","filename":"core/src/main/java/org/syncope/core/persistence/dao/impl/SyncopeUserDAOImpl.java","status":"modified","additions":13,"deletions":5,"changes":18,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fdao%2Fimpl%2FSyncopeUserDAOImpl.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fdao%2Fimpl%2FSyncopeUserDAOImpl.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fdao%2Fimpl%2FSyncopeUserDAOImpl.java?ref=d6c3d83d3970be55f9fd959e7dae3ab43b7ee740","patch":"@@ -16,6 +16,7 @@\n \n import java.util.Collections;\n import java.util.List;\n+import javax.persistence.NoResultException;\n import javax.persistence.Query;\n import org.springframework.stereotype.Repository;\n import org.springframework.transaction.annotation.Transactional;\n@@ -32,16 +33,23 @@ public class SyncopeUserDAOImpl extends AbstractDAOImpl\n     @Override\n     @Transactional(readOnly = true)\n     public final SyncopeUser find(final Long id) {\n-        return entityManager.find(SyncopeUser.class, id);\n+        Query query = entityManager.createNamedQuery(\"SyncopeUser.find\");\n+        query.setParameter(\"id\", id);\n+\n+        try {\n+            return (SyncopeUser) query.getSingleResult();\n+        } catch (NoResultException e) {\n+            return null;\n+        }\n     }\n \n     @Override\n     @Transactional(readOnly = true)\n     public final SyncopeUser findByWorkflowId(final Long workflowId) {\n-        Query query = entityManager.createQuery(\"SELECT e FROM SyncopeUser e \"\n-                + \"WHERE e.workflowId = :workflowId\");\n+        Query query = entityManager.createNamedQuery(\n+                \"SyncopeUser.findByWorkflowId\");\n         query.setParameter(\"workflowId\", workflowId);\n-        \n+\n         return (SyncopeUser) query.getSingleResult();\n     }\n \n@@ -84,7 +92,7 @@ public final List<SyncopeUser> findAll() {\n     @Transactional(readOnly = true)\n     public final List<SyncopeUser> search(\n             final NodeSearchCondition searchCondition) {\n-        \n+\n         String queryString = QueryUtils.getUserSearchQuery(searchCondition);\n         if (LOG.isDebugEnabled()) {\n             LOG.debug(\"About to execute query\\n\\t\" + queryString + \"\\n\");"},{"sha":"3a6ad765bb88c87597c130eb1e47688f245d3f6f","filename":"core/src/main/resources/log4j.xml","status":"modified","additions":20,"deletions":0,"changes":20,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740/core%2Fsrc%2Fmain%2Fresources%2Flog4j.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740/core%2Fsrc%2Fmain%2Fresources%2Flog4j.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fresources%2Flog4j.xml?ref=d6c3d83d3970be55f9fd959e7dae3ab43b7ee740","patch":"@@ -64,6 +64,16 @@\n         </layout>\n     </appender>\n \n+    <appender name=\"monitor\" class=\"org.apache.log4j.RollingFileAppender\">\n+        <param name=\"File\" value=\"${logfile.monitor}\"/>\n+        <param name=\"Append\" value=\"true\"/>\n+        <param name=\"MaxFileSize\" value=\"10240KB\" />\n+        <param name=\"MaxBackupIndex\" value=\"10\" />\n+        <layout class=\"org.apache.log4j.PatternLayout\">\n+            <param name=\"ConversionPattern\" value=\"%-5p %d %C.%M:%L %m%n\"/>\n+        </layout>\n+    </appender>\n+\n     <logger name=\"org.syncope.core.persistence\" additivity=\"false\">\n         <level value=\"INFO\"/>\n         <appender-ref ref=\"persistence\"/>\n@@ -84,6 +94,16 @@\n         <appender-ref ref=\"test\"/>\n     </logger>\n \n+    <logger name=\"org.syncope.core.monitor\" additivity=\"false\">\n+        <level value=\"DEBUG\"/>\n+        <appender-ref ref=\"monitor\"/>\n+    </logger>\n+\n+    <logger name=\"org.hibernate.cache\" additivity=\"false\">\n+        <level value=\"DEBUG\"/>\n+        <appender-ref ref=\"monitor\"/>\n+    </logger>\n+\n     <logger name=\"org.springframework\" additivity=\"false\">\n         <level value=\"INFO\"/>\n         <appender-ref ref=\"main\"/>"},{"sha":"d1980b95ebc5622cf4109d0a586e3196da2b30f7","filename":"core/src/main/resources/org/syncope/core/persistence/db.properties","status":"modified","additions":9,"deletions":9,"changes":18,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740/core%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fdb.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740/core%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fdb.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fdb.properties?ref=d6c3d83d3970be55f9fd959e7dae3ab43b7ee740","patch":"@@ -9,16 +9,16 @@\n #  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n #  See the License for the specific language governing permissions and\n #  limitations under the License.\n-hibernate.connection.driver_class=org.postgresql.Driver\n-#hibernate.connection.driver_class=oracle.jdbc.driver.OracleDriver\n-hibernate.connection.url=jdbc:postgresql://localhost:5432/syncope\n-#hibernate.connection.url=jdbc:oracle:thin:@localhost:1521:orcl\n+#hibernate.connection.driver_class=org.postgresql.Driver\n+hibernate.connection.driver_class=oracle.jdbc.driver.OracleDriver\n+#hibernate.connection.url=jdbc:postgresql://localhost:5432/syncope\n+hibernate.connection.url=jdbc:oracle:thin:@brandy:1521:orcl\n hibernate.connection.username=syncope\n hibernate.connection.password=syncope\n-hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect\n-#hibernate.dialect=org.hibernate.dialect.Oracle10gDialect\n-dbUnitDataTypeFactory=org.dbunit.ext.postgresql.PostgresqlDataTypeFactory\n-#dbUnitDataTypeFactory=org.dbunit.ext.oracle.Oracle10DataTypeFactory\n-#database.schema=SYNCOPE\n+#hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect\n+hibernate.dialect=org.hibernate.dialect.Oracle10gDialect\n+#dbUnitDataTypeFactory=org.dbunit.ext.postgresql.PostgresqlDataTypeFactory\n+dbUnitDataTypeFactory=org.dbunit.ext.oracle.Oracle10DataTypeFactory\n+database.schema=SYNCOPE\n jtaMode=true\n transactionManagerLookupValue=org.hibernate.transaction.SunONETransactionManagerLookup"},{"sha":"3a8e2f124dea2531f2f78c2b2ed930b96fa4dc47","filename":"core/src/main/resources/persistenceContext.xml","status":"modified","additions":19,"deletions":2,"changes":21,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740/core%2Fsrc%2Fmain%2Fresources%2FpersistenceContext.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740/core%2Fsrc%2Fmain%2Fresources%2FpersistenceContext.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fresources%2FpersistenceContext.xml?ref=d6c3d83d3970be55f9fd959e7dae3ab43b7ee740","patch":"@@ -17,22 +17,28 @@\n        xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n        xmlns:p=\"http://www.springframework.org/schema/p\"\n        xmlns:tx=\"http://www.springframework.org/schema/tx\"\n+       xmlns:aop=\"http://www.springframework.org/schema/aop\"\n        xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n        http://www.springframework.org/schema/beans/spring-beans.xsd\n        http://www.springframework.org/schema/context\n        http://www.springframework.org/schema/context/spring-context.xsd\n        http://www.springframework.org/schema/p\n        http://www.springframework.org/schema/p/spring-p.xsd\n        http://www.springframework.org/schema/tx\n-       http://www.springframework.org/schema/tx/spring-tx.xsd\">\n+       http://www.springframework.org/schema/tx/spring-tx.xsd\n+       http://www.springframework.org/schema/aop\n+       http://www.springframework.org/schema/aop/spring-aop.xsd\">\n \n     <context:annotation-config/>\n     <context:component-scan base-package=\"org.syncope.core.persistence\"/>\n     <context:component-scan base-package=\"org.syncope.core.rest.data\"/>\n \n+    <aop:aspectj-autoproxy/>\n+    <bean class=\"org.syncope.core.monitor.CacheMonitor\"/>\n+    \n     <bean id=\"contextApplicationContextProvider\"\n           class=\"org.syncope.core.persistence.util.ApplicationContextProvider\"/>\n-          \n+\n     <bean id=\"propertyConfigurer\"\n           class=\"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer\">\n         <property name=\"locations\">\n@@ -70,6 +76,17 @@\n                 <property name=\"databasePlatform\" value=\"${hibernate.dialect}\"/>\n             </bean>\n         </property>\n+        <property name=\"jpaPropertyMap\">\n+            <map>\n+                <entry key=\"hibernate.cache.use_second_level_cache\" value=\"true\"/>\n+                <entry key=\"hibernate.cache.use_query_cache\" value=\"true\"/>\n+                <entry key=\"hibernate.cache.region.factory_class\"\n+                       value=\"org.hibernate.cache.jbc2.SharedJBossCacheRegionFactory\"/>\n+                <entry key=\"hibernate.cache.region_prefix\"\n+                       value=\"syncopecache\"/>\n+                <entry key=\"hibernate.generate_statistics\" value=\"true\"/>\n+            </map>\n+        </property>\n         <property name=\"persistenceUnitPostProcessors\">\n             <list>\n                 <bean class=\"org.syncope.core.persistence.transaction.JTAPersistenceUnitPostProcessor\">"},{"sha":"a33e76d9cef7bcd91a9b12a135c01187abe15750","filename":"core/src/main/resources/treecache.xml","status":"added","additions":109,"deletions":0,"changes":109,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740/core%2Fsrc%2Fmain%2Fresources%2Ftreecache.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740/core%2Fsrc%2Fmain%2Fresources%2Ftreecache.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fresources%2Ftreecache.xml?ref=d6c3d83d3970be55f9fd959e7dae3ab43b7ee740","patch":"@@ -0,0 +1,109 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<server>\n+ \t\n+ \t<!-- ==================================================================== -->\n+ \t<!-- Defines TreeCache configuration -->\n+ \t<!-- ==================================================================== -->\n+ \t\n+    <mbean code=\"org.jboss.cache.TreeCache\" name=\"jboss.cache:service=TreeCache\">\n+ \t\n+        <!--\n+        <depends>jboss:service=Naming</depends>\n+ \t<depends>jboss:service=TransactionManager</depends>\n+        -->\n+ \t\n+ \t<!--\n+ \tTransactionManager configuration not required for Hibernate!\n+ \t-->\n+ \t\n+ \t<!--\n+ \tNode isolation level : SERIALIZABLE\n+ \tREPEATABLE_READ (default)\n+ \tREAD_COMMITTED\n+ \tREAD_UNCOMMITTED\n+ \tNONE\n+ \t-->\n+        <attribute name=\"IsolationLevel\">REPEATABLE_READ</attribute>\n+\n+        <!--\n+            Node locking scheme:\n+                OPTIMISTIC\n+                PESSIMISTIC (default)\n+        -->\n+        <attribute name=\"NodeLockingScheme\">OPTIMISTIC</attribute>\n+        \n+ \t<!--\n+ \tValid modes are LOCAL\n+ \tREPL_ASYNC\n+ \tREPL_SYNC\n+ \t-->\n+        <attribute name=\"CacheMode\">REPL_ASYNC</attribute>\n+ \t\n+ \t<!-- Name of cluster. Needs to be the same for all clusters, in order\n+ \tto find each other\n+ \t-->\n+        <attribute name=\"ClusterName\">SyncopeCache-Cluster</attribute>\n+ \t\n+ \t<!-- JGroups protocol stack properties. Can also be a URL,\n+ \te.g. file:/home/bela/default.xml\n+ \t<attribute name=\"ClusterProperties\"></attribute>\n+ \t-->\n+ \t\n+        <attribute name=\"ClusterConfig\">\n+            <config>\n+ \t<!-- UDP: if you have a multihomed machine,\n+ \tset the bind_addr attribute to the appropriate NIC IP address -->\n+ \t<!-- UDP: On Windows machines, because of the media sense feature\n+ \tbeing broken with multicast (even after disabling media sense)\n+ \tset the loopback attribute to true -->\n+                <UDP mcast_addr=\"228.1.2.3\" mcast_port=\"45566\"\n+ \t             ip_ttl=\"64\" ip_mcast=\"true\"\n+ \t             mcast_send_buf_size=\"150000\" mcast_recv_buf_size=\"80000\"\n+\t             ucast_send_buf_size=\"150000\" ucast_recv_buf_size=\"80000\"\n+ \t             loopback=\"false\" enable_bundling=\"true\"/>\n+                <PING timeout=\"2000\" num_initial_members=\"3\"/>\n+                <MERGE2 min_interval=\"10000\" max_interval=\"20000\"/>\n+                <FD shun=\"true\"/>\n+                <VERIFY_SUSPECT timeout=\"1500\"/>\n+                <pbcast.NAKACK gc_lag=\"50\" retransmit_timeout=\"600,1200,2400,4800\"/>\n+                <pbcast.STABLE desired_avg_gossip=\"20000\"/>\n+                <UNICAST timeout=\"600,1200,2400\"/>\n+                <FRAG frag_size=\"8192\"/>\n+                <pbcast.GMS join_timeout=\"5000\"\n+ \t                    shun=\"true\" print_local_addr=\"true\"/>\n+                <pbcast.STATE_TRANSFER/>\n+            </config>\n+        </attribute>\n+ \t\n+\t<!--\n+ \tMax number of entries in the cache. If this is exceeded, the\n+ \teviction policy will kick some entries out in order to make\n+ \tmore room\n+\t-->\n+        <attribute name=\"MaxCapacity\">20000</attribute>\n+\t\n+\t<!--\n+\tThe max amount of time (in milliseconds) we wait until the\n+\tinitial state (ie. the contents of the cache) are retrieved from\n+\texisting members in a clustered environment\n+\t-->\n+        <attribute name=\"InitialStateRetrievalTimeout\">20000</attribute>\n+ \t\n+ \t<!--\n+ \tNumber of milliseconds to wait until all responses for a\n+ \tsynchronous call have been received.\n+ \t-->\n+        <attribute name=\"SyncReplTimeout\">10000</attribute>\n+ \t\n+ \t<!-- Max number of milliseconds to wait for a lock acquisition -->\n+        <attribute name=\"LockAcquisitionTimeout\">15000</attribute>\n+ \t\n+ \t<!-- Max number of milliseconds we hold a lock (not currently\n+ \timplemented) -->\n+        <attribute name=\"LockLeaseTimeout\">60000</attribute>\n+ \t\n+ \t<!-- Name of the eviction policy class. Not supported now. -->\n+        <attribute name=\"EvictionPolicyClass\"></attribute>\n+    </mbean>\n+ \t\n+</server>"},{"sha":"d41f965d12bf4bbaae2394886fd663f307e53e63","filename":"core/src/test/resources/treecache.xml","status":"added","additions":111,"deletions":0,"changes":111,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740/core%2Fsrc%2Ftest%2Fresources%2Ftreecache.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740/core%2Fsrc%2Ftest%2Fresources%2Ftreecache.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Ftest%2Fresources%2Ftreecache.xml?ref=d6c3d83d3970be55f9fd959e7dae3ab43b7ee740","patch":"@@ -0,0 +1,111 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<server>\n+ \t\n+ \t<!-- ==================================================================== -->\n+ \t<!-- Defines TreeCache configuration -->\n+ \t<!-- ==================================================================== -->\n+ \t\n+    <mbean code=\"org.jboss.cache.TreeCache\" name=\"jboss.cache:service=TreeCache\">\n+ \t\n+        <!--\n+        <depends>jboss:service=Naming</depends>\n+ \t<depends>jboss:service=TransactionManager</depends>\n+        -->\n+ \t\n+ \t<!--\n+        Configure the TransactionManager - No matter since  Hibernate will\n+        plug in   an \"adapter\" to its own TransactionManagerLookup strategy here\n+        -->\n+        <attribute name=\"TransactionManagerLookupClass\">org.jboss.cache.transaction.DummyTransactionManagerLookup</attribute>\n+\n+ \t<!--\n+ \tNode isolation level : SERIALIZABLE\n+ \tREPEATABLE_READ (default)\n+ \tREAD_COMMITTED\n+ \tREAD_UNCOMMITTED\n+ \tNONE\n+ \t-->\n+        <attribute name=\"IsolationLevel\">REPEATABLE_READ</attribute>\n+\n+        <!--\n+            Node locking scheme:\n+                OPTIMISTIC\n+                PESSIMISTIC (default)\n+        -->\n+        <attribute name=\"NodeLockingScheme\">PESSIMISTIC</attribute>\n+        \n+ \t<!--\n+ \tValid modes are LOCAL\n+ \tREPL_ASYNC\n+ \tREPL_SYNC\n+ \t-->\n+        <attribute name=\"CacheMode\">LOCAL</attribute>\n+ \t\n+ \t<!-- Name of cluster. Needs to be the same for all clusters, in order\n+ \tto find each other\n+ \t-->\n+        <attribute name=\"ClusterName\">SyncopeCache-Cluster</attribute>\n+ \t\n+ \t<!-- JGroups protocol stack properties. Can also be a URL,\n+ \te.g. file:/home/bela/default.xml\n+ \t<attribute name=\"ClusterProperties\"></attribute>\n+ \t-->\n+ \t\n+        <attribute name=\"ClusterConfig\">\n+            <config>\n+ \t<!-- UDP: if you have a multihomed machine,\n+ \tset the bind_addr attribute to the appropriate NIC IP address -->\n+ \t<!-- UDP: On Windows machines, because of the media sense feature\n+ \tbeing broken with multicast (even after disabling media sense)\n+ \tset the loopback attribute to true -->\n+                <UDP mcast_addr=\"228.1.2.3\" mcast_port=\"45566\"\n+ \t             ip_ttl=\"64\" ip_mcast=\"true\"\n+ \t             mcast_send_buf_size=\"150000\" mcast_recv_buf_size=\"80000\"\n+\t             ucast_send_buf_size=\"150000\" ucast_recv_buf_size=\"80000\"\n+ \t             loopback=\"false\" enable_bundling=\"true\"/>\n+                <PING timeout=\"2000\" num_initial_members=\"3\"/>\n+                <MERGE2 min_interval=\"10000\" max_interval=\"20000\"/>\n+                <FD shun=\"true\"/>\n+                <VERIFY_SUSPECT timeout=\"1500\"/>\n+                <pbcast.NAKACK gc_lag=\"50\" retransmit_timeout=\"600,1200,2400,4800\"/>\n+                <pbcast.STABLE desired_avg_gossip=\"20000\"/>\n+                <UNICAST timeout=\"600,1200,2400\"/>\n+                <FRAG frag_size=\"8192\"/>\n+                <pbcast.GMS join_timeout=\"5000\"\n+ \t                    shun=\"true\" print_local_addr=\"true\"/>\n+                <pbcast.STATE_TRANSFER/>\n+            </config>\n+        </attribute>\n+ \t\n+\t<!--\n+ \tMax number of entries in the cache. If this is exceeded, the\n+ \teviction policy will kick some entries out in order to make\n+ \tmore room\n+\t-->\n+        <attribute name=\"MaxCapacity\">20000</attribute>\n+\t\n+\t<!--\n+\tThe max amount of time (in milliseconds) we wait until the\n+\tinitial state (ie. the contents of the cache) are retrieved from\n+\texisting members in a clustered environment\n+\t-->\n+        <attribute name=\"InitialStateRetrievalTimeout\">20000</attribute>\n+ \t\n+ \t<!--\n+ \tNumber of milliseconds to wait until all responses for a\n+ \tsynchronous call have been received.\n+ \t-->\n+        <attribute name=\"SyncReplTimeout\">10000</attribute>\n+ \t\n+ \t<!-- Max number of milliseconds to wait for a lock acquisition -->\n+        <attribute name=\"LockAcquisitionTimeout\">15000</attribute>\n+ \t\n+ \t<!-- Max number of milliseconds we hold a lock (not currently\n+ \timplemented) -->\n+        <attribute name=\"LockLeaseTimeout\">60000</attribute>\n+ \t\n+ \t<!-- Name of the eviction policy class. Not supported now. -->\n+        <attribute name=\"EvictionPolicyClass\"></attribute>\n+    </mbean>\n+ \t\n+</server>"},{"sha":"6f6df76ed485d11901b2eca8cf02a8ee7660ce29","filename":"pom.xml","status":"modified","additions":29,"deletions":0,"changes":29,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740/pom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/d6c3d83d3970be55f9fd959e7dae3ab43b7ee740/pom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/pom.xml?ref=d6c3d83d3970be55f9fd959e7dae3ab43b7ee740","patch":"@@ -110,8 +110,11 @@\n         <cglib.version>2.2</cglib.version>\n         <jackson.version>1.5.3</jackson.version>\n         <xstream.version>1.3.1</xstream.version>\n+        <aspectj.version>1.6.9</aspectj.version>\n \n         <hibernate.version>3.4.0.GA</hibernate.version>\n+        <hibernate-jbosscache.version>3.3.2.GA</hibernate-jbosscache.version>\n+        <jbosscache.version>3.2.6.GA</jbosscache.version>\n \n         <wicket.version>1.4.10</wicket.version>\n \n@@ -209,6 +212,16 @@\n                     </exclusion>\n                 </exclusions>\n             </dependency>\n+            <dependency>\n+                <groupId>org.hibernate</groupId>\n+                <artifactId>hibernate-jbosscache2</artifactId>\n+                <version>${hibernate-jbosscache.version}</version>\n+            </dependency>\n+            <dependency>\n+                <groupId>org.jboss.cache</groupId>\n+                <artifactId>jbosscache-core</artifactId>\n+                <version>${jbosscache.version}</version>\n+            </dependency>\n \n             <dependency>\n                 <groupId>org.dbunit</groupId>\n@@ -290,6 +303,17 @@\n                 <version>${xstream.version}</version>\n             </dependency>\n \n+            <dependency>\n+                <groupId>org.aspectj</groupId>\n+                <artifactId>aspectjweaver</artifactId>\n+                <version>${aspectj.version}</version>\n+            </dependency>\n+            <dependency>\n+                <groupId>org.aspectj</groupId>\n+                <artifactId>aspectjrt</artifactId>\n+                <version>${aspectj.version}</version>\n+            </dependency>\n+\n             <dependency>\n                 <groupId>org.apache.wicket</groupId>\n                 <artifactId>wicket</artifactId>\n@@ -369,6 +393,11 @@\n             <url>http://repo1.maven.org/maven2/</url>\n         </repository>\n \n+        <repository>\n+            <id>jboss</id>\n+            <url>http://repository.jboss.org/nexus/content/groups/public-jboss/</url>\n+        </repository>\n+\n         <repository>\n             <id>forgerock</id>\n             <url>http://repo.forgerock.org</url>"}]}