{"sha":"6c3876be1fbde6fb687df3f8d6ea7b103c71778b","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjZjMzg3NmJlMWZiZGU2ZmI2ODdkZjNmOGQ2ZWE3YjEwM2M3MTc3OGI=","commit":{"author":{"name":"Unknown","email":"unknown@apache.org","date":"2011-12-13T09:38:32Z"},"committer":{"name":"Unknown","email":"unknown@apache.org","date":"2011-12-13T09:38:32Z"},"message":"Fixes issue 243\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/syncope/trunk@1247248 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"0ed9acefde3c988171f00c329faa7ebfcf979c1b","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/0ed9acefde3c988171f00c329faa7ebfcf979c1b"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/6c3876be1fbde6fb687df3f8d6ea7b103c71778b","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/6c3876be1fbde6fb687df3f8d6ea7b103c71778b","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/6c3876be1fbde6fb687df3f8d6ea7b103c71778b","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/6c3876be1fbde6fb687df3f8d6ea7b103c71778b/comments","author":null,"committer":null,"parents":[{"sha":"197336147dbce6a394778b9d3dc947b7b8dd9919","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/197336147dbce6a394778b9d3dc947b7b8dd9919","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/197336147dbce6a394778b9d3dc947b7b8dd9919"}],"stats":{"total":109,"additions":72,"deletions":37},"files":[{"sha":"c10c0b6e369bd634187db73c511aa819f2f8ab88","filename":"core/src/main/java/org/syncope/core/persistence/beans/ExternalResource.java","status":"modified","additions":5,"deletions":1,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/6c3876be1fbde6fb687df3f8d6ea7b103c71778b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fbeans%2FExternalResource.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/6c3876be1fbde6fb687df3f8d6ea7b103c71778b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fbeans%2FExternalResource.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fbeans%2FExternalResource.java?ref=6c3876be1fbde6fb687df3f8d6ea7b103c71778b","patch":"@@ -257,15 +257,19 @@ public SchemaMapping getAccountIdMapping() {\n     }\n \n     public boolean removeMapping(SchemaMapping mapping) {\n-        return mappings == null || mappings.remove(mapping);\n+        return mappings.remove(mapping);\n     }\n \n     public boolean addMapping(SchemaMapping mapping) {\n         return mappings.contains(mapping) || mappings.add(mapping);\n     }\n \n     public void setMappings(List<SchemaMapping> mappings) {\n+        for (SchemaMapping mapping : this.mappings) {\n+            mapping.setResource(null);\n+        }\n         this.mappings.clear();\n+\n         if (mappings != null) {\n             this.mappings.addAll(mappings);\n         }"},{"sha":"cb800ea7f7528159fa66faa1350131d788ac547f","filename":"core/src/main/java/org/syncope/core/persistence/beans/SchemaMapping.java","status":"modified","additions":3,"deletions":1,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/6c3876be1fbde6fb687df3f8d6ea7b103c71778b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fbeans%2FSchemaMapping.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/6c3876be1fbde6fb687df3f8d6ea7b103c71778b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fbeans%2FSchemaMapping.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fbeans%2FSchemaMapping.java?ref=6c3876be1fbde6fb687df3f8d6ea7b103c71778b","patch":"@@ -25,6 +25,7 @@\n import javax.persistence.ManyToOne;\n import javax.validation.constraints.Max;\n import javax.validation.constraints.Min;\n+import javax.validation.constraints.NotNull;\n import org.syncope.core.persistence.validation.entity.SchemaMappingCheck;\n import org.syncope.types.IntMappingType;\n \n@@ -46,9 +47,10 @@ public class SchemaMapping extends AbstractBaseBean {\n     private IntMappingType intMappingType;\n \n     /**\n-     * Target resource that has fields to be mapped over user attribute schemas.\n+     * Resource that has fields to be mapped over user attribute schemas.\n      */\n     @ManyToOne\n+    @NotNull\n     private ExternalResource resource;\n \n     /**"},{"sha":"a76e9c6e93fcd84ce27da0c3bde5073661e0f63b","filename":"core/src/main/java/org/syncope/core/rest/controller/ConnInstanceController.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/6c3876be1fbde6fb687df3f8d6ea7b103c71778b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fcontroller%2FConnInstanceController.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/6c3876be1fbde6fb687df3f8d6ea7b103c71778b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fcontroller%2FConnInstanceController.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fcontroller%2FConnInstanceController.java?ref=6c3876be1fbde6fb687df3f8d6ea7b103c71778b","patch":"@@ -360,7 +360,7 @@ public List<String> getSchemaNames(\n             throws NotFoundException {\n \n         return getSchemaNames(\n-                resourceDataBinder.getResource(resourceTO), false);\n+                resourceDataBinder.create(resourceTO), false);\n     }\n \n     @PreAuthorize(\"hasRole('CONNECTOR_READ')\")\n@@ -371,7 +371,7 @@ public List<String> getAllSchemaNames(\n             throws NotFoundException {\n \n         return getSchemaNames(\n-                resourceDataBinder.getResource(resourceTO), true);\n+                resourceDataBinder.create(resourceTO), true);\n     }\n \n     @PreAuthorize(\"hasRole('CONNECTOR_READ')\")"},{"sha":"2fe4e45f210e99d7a272e5347d12b1e69683a2dd","filename":"core/src/main/java/org/syncope/core/rest/controller/ResourceController.java","status":"modified","additions":5,"deletions":10,"changes":15,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/6c3876be1fbde6fb687df3f8d6ea7b103c71778b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fcontroller%2FResourceController.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/6c3876be1fbde6fb687df3f8d6ea7b103c71778b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fcontroller%2FResourceController.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fcontroller%2FResourceController.java?ref=6c3876be1fbde6fb687df3f8d6ea7b103c71778b","patch":"@@ -84,7 +84,7 @@ public ResourceTO create(final HttpServletResponse response,\n             throw scce;\n         }\n \n-        ExternalResource resource = binder.getResource(resourceTO);\n+        ExternalResource resource = binder.create(resourceTO);\n         if (resource == null) {\n             LOG.error(\"Resource creation failed\");\n \n@@ -121,18 +121,13 @@ public ResourceTO update(final HttpServletResponse response,\n                     \"Resource '\" + resourceTO.getName() + \"'\");\n         }\n \n-        SyncopeClientCompositeErrorException scce =\n-                new SyncopeClientCompositeErrorException(\n-                HttpStatus.BAD_REQUEST);\n-\n-        LOG.debug(\"Removing old mappings ..\");\n-        // remove old mappings\n-        resource.getMappings().clear();\n-\n-        resource = binder.getResource(resource, resourceTO);\n+        resource = binder.update(resource, resourceTO);\n         if (resource == null) {\n             LOG.error(\"Resource update failed\");\n \n+            SyncopeClientCompositeErrorException scce =\n+                    new SyncopeClientCompositeErrorException(\n+                    HttpStatus.BAD_REQUEST);\n             SyncopeClientException ex = new SyncopeClientException(\n                     SyncopeClientExceptionType.Unknown);\n             scce.addException(ex);"},{"sha":"148cd59d86386afaaefbcbb2d8985d45420b565f","filename":"core/src/main/java/org/syncope/core/rest/data/ResourceDataBinder.java","status":"modified","additions":7,"deletions":5,"changes":12,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/6c3876be1fbde6fb687df3f8d6ea7b103c71778b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fdata%2FResourceDataBinder.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/6c3876be1fbde6fb687df3f8d6ea7b103c71778b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fdata%2FResourceDataBinder.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fdata%2FResourceDataBinder.java?ref=6c3876be1fbde6fb687df3f8d6ea7b103c71778b","patch":"@@ -62,13 +62,13 @@ public class ResourceDataBinder {\n     @Autowired\n     private PolicyDAO policyDAO;\n \n-    public ExternalResource getResource(final ResourceTO resourceTO)\n+    public ExternalResource create(final ResourceTO resourceTO)\n             throws SyncopeClientCompositeErrorException {\n \n-        return getResource(new ExternalResource(), resourceTO);\n+        return update(new ExternalResource(), resourceTO);\n     }\n \n-    public ExternalResource getResource(final ExternalResource resource,\n+    public ExternalResource update(final ExternalResource resource,\n             final ResourceTO resourceTO)\n             throws SyncopeClientCompositeErrorException {\n \n@@ -124,10 +124,11 @@ public ExternalResource getResource(final ExternalResource resource,\n         resource.setConnectorConfigurationProperties(\n                 new HashSet<ConnConfProperty>(\n                 resourceTO.getConnectorConfigurationProperties()));\n-        \n+\n         if (resourceTO.getSyncToken() == null) {\n             resource.setSerializedSyncToken(null);\n         }\n+\n         return resource;\n     }\n \n@@ -195,7 +196,7 @@ public ResourceTO getResourceTO(ExternalResource resource) {\n         resourceTO.setConnectorConfigurationProperties(\n                 resource.getConfiguration());\n         resourceTO.setSyncToken(resource.getSerializedSyncToken());\n-        \n+\n         return resourceTO;\n     }\n \n@@ -271,6 +272,7 @@ private SchemaMapping getSchemaMapping(ExternalResource resource,\n         if (!jexlUtil.isExpressionValid(\n                 mappingTO.getMandatoryCondition() != null\n                 ? mappingTO.getMandatoryCondition() : \"false\")) {\n+\n             SyncopeClientException invalidMandatoryCondition =\n                     new SyncopeClientException(\n                     SyncopeClientExceptionType.InvalidValues);"},{"sha":"ec2a99ad80220677bb73be58054b1358297c0cfd","filename":"core/src/main/resources/content.xml","status":"modified","additions":6,"deletions":3,"changes":9,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/6c3876be1fbde6fb687df3f8d6ea7b103c71778b/core%2Fsrc%2Fmain%2Fresources%2Fcontent.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/6c3876be1fbde6fb687df3f8d6ea7b103c71778b/core%2Fsrc%2Fmain%2Fresources%2Fcontent.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fresources%2Fcontent.xml?ref=6c3876be1fbde6fb687df3f8d6ea7b103c71778b","patch":"@@ -22,9 +22,12 @@\n     <SyncopeConf confKey=\"password.cipher.algorithm\" confValue=\"MD5\"/>\n     <SyncopeConf confKey=\"createRequest.allowed\" confValue=\"false\"/>\n     \n-    <Policy DTYPE=\"SyncPolicy\" id=\"1\" description=\"Global Sync Policy\" type=\"GLOBBAL SYNC\" specification=\"%3Corg.syncope.types.SyncPolicySpec%2F%3E\"/>\n-    <Policy DTYPE=\"PasswordPolicy\" id=\"2\" description=\"Global Password Policy\" type=\"GLOBAL_PASSWORD\" specification=\"%3Corg.syncope.types.PasswordPolicySpec%3E%0A++%3ChistoryLength%3E0%3C%2FhistoryLength%3E%0A++%3CmaxLength%3E0%3C%2FmaxLength%3E%0A++%3CminLength%3E0%3C%2FminLength%3E%0A++%3CnonAlphanumericRequired%3Efalse%3C%2FnonAlphanumericRequired%3E%0A++%3CalphanumericRequired%3Efalse%3C%2FalphanumericRequired%3E%0A++%3CdigitRequired%3Efalse%3C%2FdigitRequired%3E%0A++%3ClowercaseRequired%3Efalse%3C%2FlowercaseRequired%3E%0A++%3CuppercaseRequired%3Efalse%3C%2FuppercaseRequired%3E%0A++%3CmustStartWithDigit%3Efalse%3C%2FmustStartWithDigit%3E%0A++%3CmustntStartWithDigit%3Efalse%3C%2FmustntStartWithDigit%3E%0A++%3CmustEndWithDigit%3Efalse%3C%2FmustEndWithDigit%3E%0A++%3CmustntEndWithDigit%3Efalse%3C%2FmustntEndWithDigit%3E%0A++%3CmustStartWithNonAlpha%3Efalse%3C%2FmustStartWithNonAlpha%3E%0A++%3CmustStartWithAlpha%3Efalse%3C%2FmustStartWithAlpha%3E%0A++%3CmustntStartWithNonAlpha%3Efalse%3C%2FmustntStartWithNonAlpha%3E%0A++%3CmustntStartWithAlpha%3Efalse%3C%2FmustntStartWithAlpha%3E%0A++%3CmustEndWithNonAlpha%3Efalse%3C%2FmustEndWithNonAlpha%3E%0A++%3CmustEndWithAlpha%3Efalse%3C%2FmustEndWithAlpha%3E%0A++%3CmustntEndWithNonAlpha%3Efalse%3C%2FmustntEndWithNonAlpha%3E%0A++%3CmustntEndWithAlpha%3Efalse%3C%2FmustntEndWithAlpha%3E%0A%3C%2Forg.syncope.types.PasswordPolicySpec%3E\"/>\n-    <Policy DTYPE=\"AccountPolicy\" id=\"3\" description=\"Global Account Policy\" type=\"GLOBAL_ACCOUNT\" specification=\"%3Corg.syncope.types.AccountPolicySpec%3E%0A++%3CmaxLength%3E0%3C%2FmaxLength%3E%0A++%3CminLength%3E0%3C%2FminLength%3E%0A++%3CallUpperCase%3Efalse%3C%2FallUpperCase%3E%0A++%3CallLowerCase%3Efalse%3C%2FallLowerCase%3E%0A++%3CpropagateSuspension%3Efalse%3C%2FpropagateSuspension%3E%0A++%3CpermittedLoginRetries%3E0%3C%2FpermittedLoginRetries%3E%0A%3C%2Forg.syncope.types.AccountPolicySpec%3E\"/>\n+    <Policy DTYPE=\"SyncPolicy\" id=\"1\" description=\"Global Sync Policy\" type=\"GLOBAL_SYNC\"\n+            specification=\"%3Corg.syncope.types.SyncPolicySpec%2F%3E\"/>\n+    <Policy DTYPE=\"PasswordPolicy\" id=\"2\" description=\"Global Password Policy\" type=\"GLOBAL_PASSWORD\"\n+            specification=\"%3Corg.syncope.types.PasswordPolicySpec%3E%0A++%3ChistoryLength%3E0%3C%2FhistoryLength%3E%0A++%3CmaxLength%3E0%3C%2FmaxLength%3E%0A++%3CminLength%3E0%3C%2FminLength%3E%0A++%3CnonAlphanumericRequired%3Efalse%3C%2FnonAlphanumericRequired%3E%0A++%3CalphanumericRequired%3Efalse%3C%2FalphanumericRequired%3E%0A++%3CdigitRequired%3Efalse%3C%2FdigitRequired%3E%0A++%3ClowercaseRequired%3Efalse%3C%2FlowercaseRequired%3E%0A++%3CuppercaseRequired%3Efalse%3C%2FuppercaseRequired%3E%0A++%3CmustStartWithDigit%3Efalse%3C%2FmustStartWithDigit%3E%0A++%3CmustntStartWithDigit%3Efalse%3C%2FmustntStartWithDigit%3E%0A++%3CmustEndWithDigit%3Efalse%3C%2FmustEndWithDigit%3E%0A++%3CmustntEndWithDigit%3Efalse%3C%2FmustntEndWithDigit%3E%0A++%3CmustStartWithNonAlpha%3Efalse%3C%2FmustStartWithNonAlpha%3E%0A++%3CmustStartWithAlpha%3Efalse%3C%2FmustStartWithAlpha%3E%0A++%3CmustntStartWithNonAlpha%3Efalse%3C%2FmustntStartWithNonAlpha%3E%0A++%3CmustntStartWithAlpha%3Efalse%3C%2FmustntStartWithAlpha%3E%0A++%3CmustEndWithNonAlpha%3Efalse%3C%2FmustEndWithNonAlpha%3E%0A++%3CmustEndWithAlpha%3Efalse%3C%2FmustEndWithAlpha%3E%0A++%3CmustntEndWithNonAlpha%3Efalse%3C%2FmustntEndWithNonAlpha%3E%0A++%3CmustntEndWithAlpha%3Efalse%3C%2FmustntEndWithAlpha%3E%0A%3C%2Forg.syncope.types.PasswordPolicySpec%3E\"/>\n+    <Policy DTYPE=\"AccountPolicy\" id=\"3\" description=\"Global Account Policy\" type=\"GLOBAL_ACCOUNT\"\n+            specification=\"%3Corg.syncope.types.AccountPolicySpec%3E%0A++%3CmaxLength%3E0%3C%2FmaxLength%3E%0A++%3CminLength%3E0%3C%2FminLength%3E%0A++%3CallUpperCase%3Efalse%3C%2FallUpperCase%3E%0A++%3CallLowerCase%3Efalse%3C%2FallLowerCase%3E%0A++%3CpropagateSuspension%3Efalse%3C%2FpropagateSuspension%3E%0A++%3CpermittedLoginRetries%3E0%3C%2FpermittedLoginRetries%3E%0A%3C%2Forg.syncope.types.AccountPolicySpec%3E\"/>\n     \n     <USchema name=\"surname\" type=\"String\"\n              mandatoryCondition=\"true\" multivalue=\"0\" uniqueConstraint=\"0\" readonly=\"0\"/>"},{"sha":"e4e5901f94441b48f771ff49feab808ee1e7467c","filename":"core/src/test/java/org/syncope/core/persistence/relationships/ResourceTest.java","status":"modified","additions":32,"deletions":3,"changes":35,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/6c3876be1fbde6fb687df3f8d6ea7b103c71778b/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Frelationships%2FResourceTest.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/6c3876be1fbde6fb687df3f8d6ea7b103c71778b/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Frelationships%2FResourceTest.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Frelationships%2FResourceTest.java?ref=6c3876be1fbde6fb687df3f8d6ea7b103c71778b","patch":"@@ -130,7 +130,7 @@ public final void issue42() {\n         resourceTO.setPropagationMode(PropagationMode.SYNC);\n         resourceTO.setForceMandatoryConstraint(true);\n \n-        ExternalResource resource = resourceDataBinder.getResource(resourceTO);\n+        ExternalResource resource = resourceDataBinder.create(resourceTO);\n         resource = resourceDAO.save(resource);\n         resourceDAO.flush();\n \n@@ -175,20 +175,20 @@ public final void save()\n         for (int i = 0; i < 3; i++) {\n             mapping = new SchemaMapping();\n             mapping.setExtAttrName(\"test\" + i);\n-\n             mapping.setIntAttrName(userSchema.getName());\n             mapping.setIntMappingType(IntMappingType.UserSchema);\n             mapping.setMandatoryCondition(\"false\");\n \n+            mapping.setResource(resource);\n             resource.addMapping(mapping);\n         }\n         SchemaMapping accountId = new SchemaMapping();\n-        accountId.setResource(resource);\n         accountId.setAccountid(true);\n         accountId.setExtAttrName(\"username\");\n         accountId.setIntAttrName(userSchema.getName());\n         accountId.setIntMappingType(IntMappingType.SyncopeUserId);\n \n+        accountId.setResource(resource);\n         resource.addMapping(accountId);\n \n         // search for the derived attribute schema\n@@ -319,4 +319,33 @@ public final void delete() {\n             assertNull(taskDAO.find(task.getId()));\n         }\n     }\n+\n+    @Test\n+    public void issue243() {\n+        ExternalResource csv = resourceDAO.find(\"resource-csv\");\n+        assertNotNull(csv);\n+        int origMappings = csv.getMappings().size();\n+\n+        SchemaMapping newMapping = new SchemaMapping();\n+        newMapping.setIntMappingType(IntMappingType.Username);\n+        newMapping.setExtAttrName(\"TEST\");\n+        newMapping.setResource(csv);\n+        csv.addMapping(newMapping);\n+\n+        resourceDAO.save(csv);\n+        resourceDAO.flush();\n+\n+        csv = resourceDAO.find(\"resource-csv\");\n+        assertNotNull(csv);\n+        assertEquals(origMappings + 1, csv.getMappings().size());\n+\n+        int currentMappings = 0;\n+        List<SchemaMapping> allMappings = resourceDAO.findAllMappings();\n+        for (SchemaMapping mapping : allMappings) {\n+            if (\"resource-csv\".equals(mapping.getResource().getName())) {\n+                currentMappings++;\n+            }\n+        }\n+        assertEquals(csv.getMappings().size(), currentMappings);\n+    }\n }"},{"sha":"af21451b64f4b9404a199aa6d5622a335fa67cdf","filename":"core/src/test/java/org/syncope/core/rest/ResourceTestITCase.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/6c3876be1fbde6fb687df3f8d6ea7b103c71778b/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2FResourceTestITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/6c3876be1fbde6fb687df3f8d6ea7b103c71778b/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2FResourceTestITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2FResourceTestITCase.java?ref=6c3876be1fbde6fb687df3f8d6ea7b103c71778b","patch":"@@ -14,14 +14,14 @@\n  */\n package org.syncope.core.rest;\n \n+import static org.junit.Assert.*;\n+\n import java.util.ArrayList;\n import java.util.Arrays;\n import java.util.Collections;\n import java.util.HashSet;\n import java.util.List;\n import java.util.Set;\n-import static org.junit.Assert.*;\n-\n import org.junit.Test;\n import org.springframework.http.HttpStatus;\n import org.springframework.test.annotation.ExpectedException;"},{"sha":"93c6df2213a6b6dc96aa40d647836aeac48f9e46","filename":"core/src/test/resources/content.xml","status":"modified","additions":10,"deletions":10,"changes":20,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/6c3876be1fbde6fb687df3f8d6ea7b103c71778b/core%2Fsrc%2Ftest%2Fresources%2Fcontent.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/6c3876be1fbde6fb687df3f8d6ea7b103c71778b/core%2Fsrc%2Ftest%2Fresources%2Fcontent.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Ftest%2Fresources%2Fcontent.xml?ref=6c3876be1fbde6fb687df3f8d6ea7b103c71778b","patch":"@@ -23,7 +23,7 @@\n     <SyncopeConf confKey=\"createRequest.allowed\" confValue=\"true\"/>\n \n     <!-- sample policies -->\n-    <Policy DTYPE=\"SyncPolicy\" id=\"1\" description=\"sync policy 1\" type=\"SYNC\" specification=\"%3Corg.syncope.types.SyncPolicySpec%2F%3E\"/>\n+    <Policy DTYPE=\"SyncPolicy\" id=\"1\" description=\"sync policy 1\" type=\"GLOBAL_SYNC\" specification=\"%3Corg.syncope.types.SyncPolicySpec%2F%3E\"/>\n     <Policy DTYPE=\"PasswordPolicy\" id=\"2\" description=\"global password policy\" type=\"GLOBAL_PASSWORD\" specification=\"%3Corg.syncope.types.PasswordPolicySpec%3E%0A++%3ChistoryLength%3E1%3C%2FhistoryLength%3E%0A++%3CmaxLength%3E0%3C%2FmaxLength%3E%0A++%3CminLength%3E8%3C%2FminLength%3E%0A++%3CnonAlphanumericRequired%3Efalse%3C%2FnonAlphanumericRequired%3E%0A++%3CalphanumericRequired%3Efalse%3C%2FalphanumericRequired%3E%0A++%3CdigitRequired%3Efalse%3C%2FdigitRequired%3E%0A++%3ClowercaseRequired%3Efalse%3C%2FlowercaseRequired%3E%0A++%3CuppercaseRequired%3Efalse%3C%2FuppercaseRequired%3E%0A++%3CmustStartWithDigit%3Efalse%3C%2FmustStartWithDigit%3E%0A++%3CmustntStartWithDigit%3Efalse%3C%2FmustntStartWithDigit%3E%0A++%3CmustEndWithDigit%3Efalse%3C%2FmustEndWithDigit%3E%0A++%3CmustntEndWithDigit%3Efalse%3C%2FmustntEndWithDigit%3E%0A++%3CmustStartWithNonAlpha%3Efalse%3C%2FmustStartWithNonAlpha%3E%0A++%3CmustStartWithAlpha%3Efalse%3C%2FmustStartWithAlpha%3E%0A++%3CmustntStartWithNonAlpha%3Efalse%3C%2FmustntStartWithNonAlpha%3E%0A++%3CmustntStartWithAlpha%3Efalse%3C%2FmustntStartWithAlpha%3E%0A++%3CmustEndWithNonAlpha%3Efalse%3C%2FmustEndWithNonAlpha%3E%0A++%3CmustEndWithAlpha%3Efalse%3C%2FmustEndWithAlpha%3E%0A++%3CmustntEndWithNonAlpha%3Efalse%3C%2FmustntEndWithNonAlpha%3E%0A++%3CmustntEndWithAlpha%3Efalse%3C%2FmustntEndWithAlpha%3E%0A++%3CprefixesNotPermitted%3E%0A++++%3Cstring%3Enotpermitted1%3C%2Fstring%3E%0A++++%3Cstring%3Enotpermitted2%3C%2Fstring%3E%0A++%3C%2FprefixesNotPermitted%3E%0A%3C%2Forg.syncope.types.PasswordPolicySpec%3E\"/>\n     <Policy DTYPE=\"SyncPolicy\" id=\"3\" description=\"sync policy 2\" type=\"SYNC\" specification=\"%3Corg.syncope.types.SyncPolicySpec%3E%0A++%3CalternativeSearchAttrs%3E%0A++++%3Cstring%3Eusername%3C%2Fstring%3E%0A++++%3Cstring%3Efirstname%3C%2Fstring%3E%0A++%3C%2FalternativeSearchAttrs%3E%0A++%3CconflictResolutionAction%3EALL%3C%2FconflictResolutionAction%3E%0A%3C%2Forg.syncope.types.SyncPolicySpec%3E\"/>\n     <Policy DTYPE=\"PasswordPolicy\" id=\"4\" description=\"sample password policy\" type=\"PASSWORD\" specification=\"%3Corg.syncope.types.PasswordPolicySpec%3E%0A++%3ChistoryLength%3E0%3C%2FhistoryLength%3E%0A++%3CmaxLength%3E0%3C%2FmaxLength%3E%0A++%3CminLength%3E10%3C%2FminLength%3E%0A++%3CnonAlphanumericRequired%3Efalse%3C%2FnonAlphanumericRequired%3E%0A++%3CalphanumericRequired%3Efalse%3C%2FalphanumericRequired%3E%0A++%3CdigitRequired%3Efalse%3C%2FdigitRequired%3E%0A++%3ClowercaseRequired%3Efalse%3C%2FlowercaseRequired%3E%0A++%3CuppercaseRequired%3Efalse%3C%2FuppercaseRequired%3E%0A++%3CmustStartWithDigit%3Efalse%3C%2FmustStartWithDigit%3E%0A++%3CmustntStartWithDigit%3Efalse%3C%2FmustntStartWithDigit%3E%0A++%3CmustEndWithDigit%3Efalse%3C%2FmustEndWithDigit%3E%0A++%3CmustntEndWithDigit%3Efalse%3C%2FmustntEndWithDigit%3E%0A++%3CmustStartWithNonAlpha%3Efalse%3C%2FmustStartWithNonAlpha%3E%0A++%3CmustStartWithAlpha%3Efalse%3C%2FmustStartWithAlpha%3E%0A++%3CmustntStartWithNonAlpha%3Efalse%3C%2FmustntStartWithNonAlpha%3E%0A++%3CmustntStartWithAlpha%3Efalse%3C%2FmustntStartWithAlpha%3E%0A++%3CmustEndWithNonAlpha%3Efalse%3C%2FmustEndWithNonAlpha%3E%0A++%3CmustEndWithAlpha%3Efalse%3C%2FmustEndWithAlpha%3E%0A++%3CmustntEndWithNonAlpha%3Efalse%3C%2FmustntEndWithNonAlpha%3E%0A++%3CmustntEndWithAlpha%3Efalse%3C%2FmustntEndWithAlpha%3E%0A++%3CprefixesNotPermitted%3E%0A++++%3Cstring%3Enotpermitted1%3C%2Fstring%3E%0A++++%3Cstring%3Enotpermitted2%3C%2Fstring%3E%0A++%3C%2FprefixesNotPermitted%3E%0A%3C%2Forg.syncope.types.PasswordPolicySpec%3E\"/>\n@@ -374,41 +374,41 @@\n                    intAttrName=\"fullname\" intMappingType=\"UserSchema\" mandatoryCondition=\"true\"\n                    accountid=\"1\" password=\"0\"/>\n                    \n-    <SchemaMapping id=\"116\" extAttrName=\"id\"\n+    <SchemaMapping id=\"116\" extAttrName=\"ID\"\n                    resource_name=\"resource-testdb\"\n                    intMappingType=\"SyncopeUserId\" mandatoryCondition=\"true\"\n                    accountid=\"1\" password=\"0\"/>\n                    \n-    <SchemaMapping id=\"117\" extAttrName=\"password\"\n+    <SchemaMapping id=\"117\" extAttrName=\"PASSWORD\"\n                    resource_name=\"resource-testdb\"\n                    intMappingType=\"Password\" mandatoryCondition=\"true\"\n                    accountid=\"0\" password=\"1\"/>\n                    \n-    <SchemaMapping id=\"200\" extAttrName=\"id\"\n+    <SchemaMapping id=\"200\" extAttrName=\"ID\"\n                    resource_name=\"resource-csv\"\n                    intMappingType=\"Username\" mandatoryCondition=\"true\"\n                    accountid=\"0\" password=\"0\"/>\n-    <SchemaMapping id=\"201\" extAttrName=\"id\"\n+    <SchemaMapping id=\"201\" extAttrName=\"ID\"\n                    resource_name=\"resource-csv\"\n                    intAttrName=\"fullname\" intMappingType=\"UserSchema\" mandatoryCondition=\"true\"\n                    accountid=\"0\" password=\"0\"/>\n-    <SchemaMapping id=\"202\" extAttrName=\"password\"\n+    <SchemaMapping id=\"202\" extAttrName=\"PASSWORD\"\n                    resource_name=\"resource-csv\"\n                    intMappingType=\"Password\" mandatoryCondition=\"true\"\n                    accountid=\"0\" password=\"1\"/>\n-    <SchemaMapping id=\"203\" extAttrName=\"name\"\n+    <SchemaMapping id=\"203\" extAttrName=\"NAME\"\n                    resource_name=\"resource-csv\"\n                    intAttrName=\"firstname\" intMappingType=\"UserSchema\" mandatoryCondition=\"false\"\n                    accountid=\"0\" password=\"0\"/>\n-    <SchemaMapping id=\"204\" extAttrName=\"surname\"\n+    <SchemaMapping id=\"204\" extAttrName=\"SURNAME\"\n                    resource_name=\"resource-csv\"\n                    intAttrName=\"surname\" intMappingType=\"UserSchema\" mandatoryCondition=\"false\"\n                    accountid=\"0\" password=\"0\"/>\n-    <SchemaMapping id=\"205\" extAttrName=\"email\"\n+    <SchemaMapping id=\"205\" extAttrName=\"EMAIL\"\n                    resource_name=\"resource-csv\"\n                    intAttrName=\"userId\" intMappingType=\"UserSchema\" mandatoryCondition=\"true\"\n                    accountid=\"0\" password=\"0\"/>\n-    <SchemaMapping id=\"206\" extAttrName=\"email\"\n+    <SchemaMapping id=\"206\" extAttrName=\"EMAIL\"\n                    resource_name=\"resource-csv\"\n                    intAttrName=\"email\" intMappingType=\"UserSchema\" mandatoryCondition=\"true\"\n                    accountid=\"0\" password=\"0\"/>"}]}