{"sha":"abc55641cf6f1adb088ef143ac042ab38cac0134","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmFiYzU1NjQxY2Y2ZjFhZGIwODhlZjE0M2FjMDQyYWIzOGNhYzAxMzQ=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2020-01-21T12:42:39Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2020-01-21T12:42:39Z"},"message":"Fixing EnduserITCase","tree":{"sha":"6361f5a494cbbbc7860016c3df033fb1536eb9f9","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/6361f5a494cbbbc7860016c3df033fb1536eb9f9"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/abc55641cf6f1adb088ef143ac042ab38cac0134","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/abc55641cf6f1adb088ef143ac042ab38cac0134","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/abc55641cf6f1adb088ef143ac042ab38cac0134","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/abc55641cf6f1adb088ef143ac042ab38cac0134/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"f9b4dd0e31c7298eb35e70d4a0b4ec6971148803","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/f9b4dd0e31c7298eb35e70d4a0b4ec6971148803","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/f9b4dd0e31c7298eb35e70d4a0b4ec6971148803"}],"stats":{"total":400,"additions":128,"deletions":272},"files":[{"sha":"2a8ad07f9d05ecddf8547a68e74d995ae58c1471","filename":"client/idrepo/common-ui/src/main/java/org/apache/syncope/client/ui/commons/BaseLogin.java","status":"modified","additions":14,"deletions":4,"changes":18,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fcommon-ui%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fui%2Fcommons%2FBaseLogin.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fcommon-ui%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fui%2Fcommons%2FBaseLogin.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fcommon-ui%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fui%2Fcommons%2FBaseLogin.java?ref=abc55641cf6f1adb088ef143ac042ab38cac0134","patch":"@@ -22,6 +22,7 @@\n import de.agilecoders.wicket.extensions.markup.html.bootstrap.form.select.BootstrapSelect;\n import java.security.AccessControlException;\n import java.util.ArrayList;\n+import java.util.Collection;\n import java.util.List;\n import java.util.Locale;\n import java.util.stream.Collectors;\n@@ -31,6 +32,7 @@\n import javax.ws.rs.core.HttpHeaders;\n import org.apache.commons.lang3.StringUtils;\n import org.apache.syncope.common.lib.SyncopeConstants;\n+import org.apache.wicket.Component;\n import org.apache.wicket.ajax.AjaxRequestTarget;\n import org.apache.wicket.ajax.form.AjaxFormComponentUpdatingBehavior;\n import org.apache.wicket.ajax.markup.html.form.AjaxButton;\n@@ -129,15 +131,15 @@ public BaseLogin(final PageParameters parameters) {\n \n             @Override\n             protected void onUpdate(final AjaxRequestTarget target) {\n-                target.add(form);\n+                getLanguageOnChangeComponents().forEach(target::add);\n             }\n         }).add(new AjaxFormComponentUpdatingBehavior(Constants.ON_CHANGE) {\n \n             private static final long serialVersionUID = -1107858522700306810L;\n \n             @Override\n             protected void onUpdate(final AjaxRequestTarget target) {\n-                target.add(form);\n+                getLanguageOnChangeComponents().forEach(target::add);\n             }\n         });\n         form.add(languageSelect.setOutputMarkupId(true));\n@@ -149,15 +151,15 @@ protected void onUpdate(final AjaxRequestTarget target) {\n \n             @Override\n             protected void onUpdate(final AjaxRequestTarget target) {\n-                target.add(form);\n+                getDomainOnChangeComponents().forEach(target::add);\n             }\n         }).add(new AjaxFormComponentUpdatingBehavior(Constants.ON_CHANGE) {\n \n             private static final long serialVersionUID = -1107858522700306810L;\n \n             @Override\n             protected void onUpdate(final AjaxRequestTarget target) {\n-                target.add(form);\n+                getDomainOnChangeComponents().forEach(target::add);\n             }\n         });\n         form.add(domainSelect.setOutputMarkupId(true));\n@@ -191,6 +193,14 @@ protected void populateItem(final ListItem<Panel> item) {\n         add(form);\n     }\n \n+    protected Collection<Component> getLanguageOnChangeComponents() {\n+        return List.of(form);\n+    }\n+\n+    protected Collection<Component> getDomainOnChangeComponents() {\n+        return List.of(form);\n+    }\n+\n     @Override\n     public void renderHead(final IHeaderResponse response) {\n         super.renderHead(response);"},{"sha":"c0f9c47d52cc8d2b849650a2b4c827aefd3274e0","filename":"client/idrepo/enduser/src/main/java/org/apache/syncope/client/enduser/SyncopeEnduserSession.java","status":"modified","additions":5,"deletions":1,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeEnduserSession.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeEnduserSession.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeEnduserSession.java?ref=abc55641cf6f1adb088ef143ac042ab38cac0134","patch":"@@ -44,6 +44,7 @@\n import org.apache.syncope.common.lib.SyncopeClientException;\n import org.apache.syncope.common.lib.SyncopeConstants;\n import org.apache.syncope.common.lib.to.UserTO;\n+import org.apache.syncope.common.lib.types.ClientExceptionType;\n import org.apache.syncope.common.lib.types.IdRepoEntitlement;\n import org.apache.syncope.common.rest.api.RESTHeaders;\n import org.apache.wicket.Session;\n@@ -104,7 +105,10 @@ public void onException(final Exception e) {\n \n         if (root instanceof SyncopeClientException) {\n             SyncopeClientException sce = (SyncopeClientException) root;\n-            if (!sce.isComposite()) {\n+            if (sce.getType() == ClientExceptionType.InvalidSecurityAnswer) {\n+                message = getApplication().getResourceSettings().getLocalizer().\n+                        getString(\"invalid.security.answer\", null);\n+            } else if (!sce.isComposite()) {\n                 message = sce.getElements().stream().collect(Collectors.joining(\", \"));\n             }\n         } else if (root instanceof AccessControlException || root instanceof ForbiddenException) {"},{"sha":"5599a4578a2ade165ffeb0a24bc9766329c35fb2","filename":"client/idrepo/enduser/src/main/java/org/apache/syncope/client/enduser/markup/html/form/AjaxCaptchaFieldPanel.java","status":"removed","additions":0,"deletions":78,"changes":78,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/f9b4dd0e31c7298eb35e70d4a0b4ec6971148803/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fmarkup%2Fhtml%2Fform%2FAjaxCaptchaFieldPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/f9b4dd0e31c7298eb35e70d4a0b4ec6971148803/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fmarkup%2Fhtml%2Fform%2FAjaxCaptchaFieldPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fmarkup%2Fhtml%2Fform%2FAjaxCaptchaFieldPanel.java?ref=f9b4dd0e31c7298eb35e70d4a0b4ec6971148803","patch":"@@ -1,78 +0,0 @@\n-/*\n- * Licensed to the Apache Software Foundation (ASF) under one\n- * or more contributor license agreements.  See the NOTICE file\n- * distributed with this work for additional information\n- * regarding copyright ownership.  The ASF licenses this file\n- * to you under the Apache License, Version 2.0 (the\n- * \"License\"); you may not use this file except in compliance\n- * with the License.  You may obtain a copy of the License at\n- *\n- *   http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing,\n- * software distributed under the License is distributed on an\n- * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n- * KIND, either express or implied.  See the License for the\n- * specific language governing permissions and limitations\n- * under the License.\n- */\n-package org.apache.syncope.client.enduser.markup.html.form;\n-\n-import org.apache.syncope.client.ui.commons.ajax.form.IndicatorAjaxFormComponentUpdatingBehavior;\n-import org.apache.syncope.client.ui.commons.Constants;\n-import org.apache.wicket.ajax.AjaxRequestTarget;\n-import org.apache.wicket.markup.ComponentTag;\n-import org.apache.wicket.markup.html.form.RequiredTextField;\n-import org.apache.wicket.markup.html.panel.Panel;\n-import org.apache.wicket.model.IModel;\n-import org.apache.wicket.model.ResourceModel;\n-import org.apache.wicket.validation.IValidator;\n-\n-public class AjaxCaptchaFieldPanel extends Panel {\n-\n-    private static final long serialVersionUID = 238940918106696068L;\n-\n-    private RequiredTextField<String> field;\n-\n-    public AjaxCaptchaFieldPanel(final String id, final String name, final IModel<String> model) {\n-        this(id, name, model, true);\n-    }\n-\n-    public AjaxCaptchaFieldPanel(\n-            final String id, final String name, final IModel<String> model, final boolean enableOnChange) {\n-\n-        super(id, model);\n-\n-        field = new RequiredTextField<String>(\"textField\", model, String.class) {\n-\n-            private static final long serialVersionUID = -8751221833502425836L;\n-\n-            @Override\n-            protected void onComponentTag(final ComponentTag tag) {\n-                super.onComponentTag(tag);\n-                // clear the field after each render\n-                tag.put(\"value\", \"\");\n-            }\n-        };\n-        field.setLabel(new ResourceModel(name, name));\n-\n-        add(field.setOutputMarkupId(true));\n-\n-        if (enableOnChange && !field.isEnabled()) {\n-            field.add(new IndicatorAjaxFormComponentUpdatingBehavior(Constants.ON_CHANGE) {\n-\n-                private static final long serialVersionUID = -1107858522700306810L;\n-\n-                @Override\n-                protected void onUpdate(final AjaxRequestTarget target) {\n-                    // nothing to do\n-                }\n-            });\n-        }\n-    }\n-\n-    public void addValidator(final IValidator<? super String> validator) {\n-        this.field.add(validator);\n-    }\n-\n-}"},{"sha":"c9f9a91b38be71aecac382bf3bcb7f747e6add67","filename":"client/idrepo/enduser/src/main/java/org/apache/syncope/client/enduser/pages/Login.java","status":"modified","additions":23,"deletions":4,"changes":27,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FLogin.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FLogin.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FLogin.java?ref=abc55641cf6f1adb088ef143ac042ab38cac0134","patch":"@@ -20,13 +20,17 @@\n \n import java.security.AccessControlException;\n import java.util.ArrayList;\n+import java.util.Collection;\n import java.util.List;\n import java.util.Locale;\n+import java.util.stream.Collectors;\n+import java.util.stream.Stream;\n import org.apache.syncope.client.enduser.SyncopeWebApplication;\n import org.apache.syncope.client.enduser.SyncopeEnduserSession;\n import org.apache.syncope.client.enduser.init.ClassPathScanImplementationLookup;\n import org.apache.syncope.client.ui.commons.BaseLogin;\n import org.apache.syncope.client.ui.commons.BaseSession;\n+import org.apache.wicket.Component;\n import org.apache.wicket.ajax.AjaxRequestTarget;\n import org.apache.wicket.markup.html.link.BookmarkablePageLink;\n import org.apache.wicket.markup.html.panel.Panel;\n@@ -40,11 +44,26 @@ public class Login extends BaseLogin {\n     @SpringBean\n     private ClassPathScanImplementationLookup lookup;\n \n+    private final BookmarkablePageLink<Void> selfRegistration;\n+\n+    private final BookmarkablePageLink<Void> selfPwdReset;\n+\n     public Login(final PageParameters parameters) {\n         super(parameters);\n \n-        add(new BookmarkablePageLink<>(\"self-registration\", Self.class).setOutputMarkupId(true));\n-        add(new BookmarkablePageLink<>(\"self-pwd-reset\", SelfPasswordReset.class).setOutputMarkupId(true));\n+        selfRegistration = new BookmarkablePageLink<>(\"self-registration\", Self.class);\n+        add(selfRegistration.setOutputMarkupId(true));\n+\n+        selfPwdReset = new BookmarkablePageLink<>(\"self-pwd-reset\", SelfPasswordReset.class);\n+        add(selfPwdReset.setOutputMarkupId(true));\n+    }\n+\n+    @Override\n+    protected Collection<Component> getLanguageOnChangeComponents() {\n+        return Stream.concat(\n+                super.getLanguageOnChangeComponents().stream(),\n+                List.of(selfRegistration, selfPwdReset).stream()).\n+                collect(Collectors.toList());\n     }\n \n     @Override\n@@ -57,8 +76,8 @@ protected List<Panel> getSSOLoginFormPanels() {\n         List<Panel> ssoLoginFormPanels = new ArrayList<>();\n         lookup.getSSOLoginFormPanels().forEach(ssoLoginFormPanel -> {\n             try {\n-                ssoLoginFormPanels.add(ssoLoginFormPanel.getConstructor(String.class, BaseSession.class).newInstance(\n-                        \"ssoLogin\", SyncopeEnduserSession.get()));\n+                ssoLoginFormPanels.add(ssoLoginFormPanel.getConstructor(String.class, BaseSession.class).\n+                        newInstance(\"ssoLogin\", SyncopeEnduserSession.get()));\n             } catch (Exception e) {\n                 LOG.error(\"Could not initialize the provided SSO login form panel\", e);\n             }"},{"sha":"595ff0c3805fc37e0213d7b65e50f7c4ca520edf","filename":"client/idrepo/enduser/src/main/java/org/apache/syncope/client/enduser/panels/SelfPwdResetPanel.java","status":"modified","additions":3,"deletions":5,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpanels%2FSelfPwdResetPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpanels%2FSelfPwdResetPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpanels%2FSelfPwdResetPanel.java?ref=abc55641cf6f1adb088ef143ac042ab38cac0134","patch":"@@ -24,6 +24,7 @@\n import org.apache.syncope.client.enduser.SyncopeEnduserSession;\n import org.apache.syncope.client.enduser.SyncopeWebApplication;\n import org.apache.syncope.client.enduser.pages.BaseEnduserWebPage;\n+import org.apache.syncope.client.enduser.rest.UserSelfRestClient;\n import org.apache.syncope.client.enduser.wizards.any.CaptchaPanel;\n import org.apache.syncope.client.ui.commons.Constants;\n import org.apache.syncope.client.ui.commons.DomainDropDown;\n@@ -33,7 +34,6 @@\n import org.apache.syncope.common.lib.SyncopeConstants;\n import org.apache.syncope.common.lib.to.SecurityQuestionTO;\n import org.apache.syncope.common.rest.api.service.SecurityQuestionService;\n-import org.apache.syncope.common.rest.api.service.UserSelfService;\n import org.apache.wicket.PageReference;\n import org.apache.wicket.ajax.AjaxRequestTarget;\n import org.apache.wicket.ajax.form.AjaxFormComponentUpdatingBehavior;\n@@ -162,17 +162,15 @@ protected void onUpdate(final AjaxRequestTarget target) {\n             protected void onSubmit(final AjaxRequestTarget target) {\n                 boolean checked = true;\n                 if (SyncopeWebApplication.get().isCaptchaEnabled()) {\n-                    // captcha check\n                     checked = captcha.captchaCheck();\n                 }\n                 if (!checked) {\n                     SyncopeEnduserSession.get().error(getString(Constants.CAPTCHA_ERROR));\n                     ((BaseEnduserWebPage) pageRef.getPage()).getNotificationPanel().refresh(target);\n                 } else {\n                     try {\n-                        SyncopeEnduserSession.get().getService(UserSelfService.class).\n-                                requestPasswordReset(usernameText, securityAnswerText);\n-                        final PageParameters parameters = new PageParameters();\n+                        UserSelfRestClient.requestPasswordReset(usernameText, securityAnswerText);\n+                        PageParameters parameters = new PageParameters();\n                         parameters.add(Constants.NOTIFICATION_MSG_PARAM, getString(\"self.pwd.reset.success\"));\n                         setResponsePage(getApplication().getHomePage(), parameters);\n                     } catch (SyncopeClientException sce) {"},{"sha":"95a35ce0556992b2a15621706e5a4f22d92902a5","filename":"client/idrepo/enduser/src/main/java/org/apache/syncope/client/enduser/rest/UserSelfRestClient.java","status":"modified","additions":3,"deletions":0,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Frest%2FUserSelfRestClient.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Frest%2FUserSelfRestClient.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Frest%2FUserSelfRestClient.java?ref=abc55641cf6f1adb088ef143ac042ab38cac0134","patch":"@@ -62,4 +62,7 @@ public static void changePassword(final String password) {\n         getService(UserSelfService.class).mustChangePassword(password);\n     }\n \n+    public static void requestPasswordReset(final String username, final String securityAnswer) {\n+        getService(UserSelfService.class).requestPasswordReset(username, securityAnswer);\n+    }\n }"},{"sha":"0d510e2f19810907da9726c206106089cd6cae19","filename":"client/idrepo/enduser/src/main/java/org/apache/syncope/client/enduser/wizards/any/AbstractCaptchaPanel.java","status":"removed","additions":0,"deletions":72,"changes":72,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/f9b4dd0e31c7298eb35e70d4a0b4ec6971148803/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FAbstractCaptchaPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/f9b4dd0e31c7298eb35e70d4a0b4ec6971148803/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FAbstractCaptchaPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FAbstractCaptchaPanel.java?ref=f9b4dd0e31c7298eb35e70d4a0b4ec6971148803","patch":"@@ -1,72 +0,0 @@\n-/*\n- * Licensed to the Apache Software Foundation (ASF) under one\n- * or more contributor license agreements.  See the NOTICE file\n- * distributed with this work for additional information\n- * regarding copyright ownership.  The ASF licenses this file\n- * to you under the Apache License, Version 2.0 (the\n- * \"License\"); you may not use this file except in compliance\n- * with the License.  You may obtain a copy of the License at\n- *\n- *   http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing,\n- * software distributed under the License is distributed on an\n- * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n- * KIND, either express or implied.  See the License for the\n- * specific language governing permissions and limitations\n- * under the License.\n- */\n-package org.apache.syncope.client.enduser.wizards.any;\n-\n-import org.apache.syncope.client.enduser.markup.html.form.AjaxCaptchaFieldPanel;\n-import org.apache.wicket.ajax.AjaxRequestTarget;\n-import org.apache.wicket.ajax.markup.html.form.AjaxButton;\n-import org.apache.wicket.extensions.markup.html.captcha.CaptchaImageResource;\n-import org.apache.wicket.markup.html.image.Image;\n-import org.apache.wicket.markup.html.panel.Panel;\n-import org.apache.wicket.model.Model;\n-\n-public abstract class AbstractCaptchaPanel<T> extends Panel {\n-\n-    private static final long serialVersionUID = -4310189409064713307L;\n-\n-    protected String randomText;\n-\n-    protected final Model<String> captchaText = new Model<>();\n-\n-    protected final CaptchaImageResource captchaImageResource;\n-\n-    public AbstractCaptchaPanel(final String id) {\n-        super(id);\n-        this.setOutputMarkupId(true);\n-\n-        captchaImageResource = createCaptchaImageResource();\n-        final Image captchaImage = new Image(\"image\", captchaImageResource);\n-        captchaImage.setOutputMarkupId(true);\n-        add(captchaImage);\n-\n-        AjaxButton reloadCaptchaButton = new AjaxButton(\"reloadButton\") {\n-\n-            private static final long serialVersionUID = -957948639666058749L;\n-\n-            @Override\n-            protected void onSubmit(final AjaxRequestTarget target) {\n-                captchaImageResource.invalidate();\n-                target.add(captchaImage);\n-            }\n-\n-        };\n-        reloadCaptchaButton.setDefaultFormProcessing(false);\n-        add(reloadCaptchaButton);\n-\n-        add(new AjaxCaptchaFieldPanel(\"captcha\", \"captcha\", captchaText)\n-                .setOutputMarkupId(true)\n-                .setOutputMarkupPlaceholderTag(true));\n-    }\n-\n-    protected abstract CaptchaImageResource createCaptchaImageResource();\n-\n-    protected abstract void reload();\n-\n-    public abstract boolean captchaCheck();\n-}"},{"sha":"c46755c9dca138e9faa49fbb52d472fd9de0b3d4","filename":"client/idrepo/enduser/src/main/java/org/apache/syncope/client/enduser/wizards/any/Captcha.java","status":"modified","additions":0,"deletions":1,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptcha.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptcha.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptcha.java?ref=abc55641cf6f1adb088ef143ac042ab38cac0134","patch":"@@ -46,5 +46,4 @@ public void reload() {\n     public boolean evaluate() {\n         return SyncopeWebApplication.get().isCaptchaEnabled();\n     }\n-\n }"},{"sha":"4b886bffc48b34d8e858edd666f295dddca64f33","filename":"client/idrepo/enduser/src/main/java/org/apache/syncope/client/enduser/wizards/any/CaptchaPanel.java","status":"modified","additions":35,"deletions":9,"changes":44,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptchaPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptchaPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptchaPanel.java?ref=abc55641cf6f1adb088ef143ac042ab38cac0134","patch":"@@ -21,9 +21,15 @@\n import java.security.SecureRandom;\n import org.apache.commons.lang3.StringUtils;\n import org.apache.commons.text.RandomStringGenerator;\n+import org.apache.syncope.client.ui.commons.markup.html.form.AjaxTextFieldPanel;\n+import org.apache.wicket.ajax.AjaxRequestTarget;\n+import org.apache.wicket.ajax.markup.html.form.AjaxButton;\n import org.apache.wicket.extensions.markup.html.captcha.CaptchaImageResource;\n+import org.apache.wicket.markup.html.image.Image;\n+import org.apache.wicket.markup.html.panel.Panel;\n+import org.apache.wicket.model.Model;\n \n-public class CaptchaPanel<T> extends AbstractCaptchaPanel<T> {\n+public class CaptchaPanel<T> extends Panel {\n \n     private static final long serialVersionUID = 1169850573252481471L;\n \n@@ -34,13 +40,16 @@\n             withinRange('a', 'z').\n             build();\n \n+    private String randomText;\n+\n+    private final Model<String> captchaText = new Model<>();\n+\n+    private final CaptchaImageResource captchaImageResource;\n+\n     public CaptchaPanel(final String id) {\n         super(id);\n-    }\n \n-    @Override\n-    protected CaptchaImageResource createCaptchaImageResource() {\n-        return new CaptchaImageResource() {\n+        captchaImageResource = new CaptchaImageResource() {\n \n             private static final long serialVersionUID = 2436829189992948005L;\n \n@@ -51,18 +60,35 @@ protected byte[] render() {\n                 return super.render();\n             }\n         };\n+        Image captchaImage = new Image(\"image\", captchaImageResource);\n+        captchaImage.setOutputMarkupId(true);\n+        add(captchaImage);\n+\n+        add(new AjaxButton(\"reloadButton\") {\n+\n+            private static final long serialVersionUID = -957948639666058749L;\n+\n+            @Override\n+            protected void onSubmit(final AjaxRequestTarget target) {\n+                captchaImageResource.invalidate();\n+                target.add(captchaImage);\n+            }\n+\n+        }.setDefaultFormProcessing(false));\n+\n+        add(new AjaxTextFieldPanel(\"captcha\", \"captcha\", captchaText).\n+                hideLabel().\n+                setOutputMarkupId(true).\n+                setOutputMarkupPlaceholderTag(true));\n     }\n \n-    @Override\n-    protected void reload() {\n+    public void reload() {\n         this.captchaImageResource.invalidate();\n     }\n \n-    @Override\n     public boolean captchaCheck() {\n         return StringUtils.isBlank(captchaText.getObject()) || StringUtils.isBlank(randomText)\n                 ? false\n                 : captchaText.getObject().equals(randomText);\n     }\n-\n }"},{"sha":"7d49574ee566c42faf0663060bf90eea7a48fca1","filename":"client/idrepo/enduser/src/main/resources/org/apache/syncope/client/enduser/SyncopeWebApplication.properties","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication.properties?ref=abc55641cf6f1adb088ef143ac042ab38cac0134","patch":"@@ -79,3 +79,4 @@ after=After\n \n captcha_error=Captcha entered does not match\n \n+invalid.security.answer=Invalid security answer"},{"sha":"862b6c4af0a3c81ca4fec795657be8f915f78df6","filename":"client/idrepo/enduser/src/main/resources/org/apache/syncope/client/enduser/SyncopeWebApplication_it.properties","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication_it.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication_it.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication_it.properties?ref=abc55641cf6f1adb088ef143ac042ab38cac0134","patch":"@@ -48,7 +48,6 @@ jexl_syntax_url=Sintassi JEXL completa\n create=Crea\n key=Chiave\n types=Tipi\n-dashboard=Cruscotto\n realms=Realm\n roles=Ruoli\n policies=Politiche\n@@ -77,3 +76,4 @@ after=Dopo\n \n captcha_error=Il Captcha inserito non \\u00e8 corretto\n \n+invalid.security.answer=Risposta di sicurezza non valida"},{"sha":"8bc5b4edc6631d47ad80ddc7a9681d90f0e1d76b","filename":"client/idrepo/enduser/src/main/resources/org/apache/syncope/client/enduser/SyncopeWebApplication_ja.properties","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication_ja.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication_ja.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication_ja.properties?ref=abc55641cf6f1adb088ef143ac042ab38cac0134","patch":"@@ -47,7 +47,6 @@ jexl_syntax_url=\\u5b8c\\u5168 JEXL \\u53c2\\u7167\n create=\\u4f5c\\u6210\n key=\\u30ad\\u30fc\n types=\\u30bf\\u30a4\\u30d7\n-dashboard=\\u30c0\\u30c3\\u30b7\\u30e5\\u30dc\\u30fc\\u30c9\n realms=\\u30ec\\u30eb\\u30e0\n roles=\\u30ed\\u30fc\\u30eb\n policies=\\u30dd\\u30ea\\u30b7\\u30fc\n@@ -74,3 +73,4 @@ before=\\u524d\n after=\\u5f8c\n \n captcha_error=\\u5165\\u529b\\u3055\\u308c\\u305f\\u30ad\\u30e3\\u30d7\\u30c1\\u30e3\\u304c\\u4e00\\u81f4\\u3057\\u307e\\u305b\\u3093\n+invalid.security.answer=Invalid security answer"},{"sha":"3e9c35c54f2f7406c8bd05215929db47a19dcfed","filename":"client/idrepo/enduser/src/main/resources/org/apache/syncope/client/enduser/SyncopeWebApplication_pt_BR.properties","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication_pt_BR.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication_pt_BR.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication_pt_BR.properties?ref=abc55641cf6f1adb088ef143ac042ab38cac0134","patch":"@@ -48,7 +48,6 @@ jexl_syntax_url=Refer\\u00eancia JEXL completa\n create=Criar\n key=Chave\n types=Tipos\n-dashboard=Painel de instrumentos\n realms=Realm\n roles=\\t\\nFun\\u00e7\\u00e3o\\n\\t\n policies=Pol\\u00edticas\n@@ -76,3 +75,4 @@ before=Before\n after=After\n \n captcha_error=Captcha entered does not match\n+invalid.security.answer=Invalid security answer"},{"sha":"aed3730b359b34c06e2b6a36de828e44ab191a43","filename":"client/idrepo/enduser/src/main/resources/org/apache/syncope/client/enduser/SyncopeWebApplication_ru.properties","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication_ru.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication_ru.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication_ru.properties?ref=abc55641cf6f1adb088ef143ac042ab38cac0134","patch":"@@ -47,7 +47,6 @@ jexl_syntax_url=\\u0421\\u043f\\u0440\\u0430\\u0432\\u043a\\u0430 \\u043f\\u043e JEXL\n create=\\u0421\\u043e\\u0437\\u0434\\u0430\\u0442\\u044c\n key=\\u0418\\u0434\\u0435\\u043d\\u0442\\u0438\\u0444\\u0438\\u043a\\u0430\\u0442\\u043e\\u0440\n types=\\u0422\\u0438\\u043f\\u044b \\u043e\\u0431\\u044a\\u0435\\u043a\\u0442\\u043e\\u0432\n-dashboard=\\u041f\\u0430\\u043d\\u0435\\u043b\\u044c \\u0443\\u043f\\u0440\\u0430\\u0432\\u043b\\u0435\\u043d\\u0438\\u044f\n realms=\\u041e\\u0431\\u043b\\u0430\\u0441\\u0442\\u0438\n roles=\\u0420\\u043e\\u043b\\u0438\n policies=\\u041f\\u043e\\u043b\\u0438\\u0442\\u0438\\u043a\\u0438\n@@ -75,3 +74,4 @@ before=Before\n after=After\n \n captcha_error=Captcha entered does not match\n+invalid.security.answer=Invalid security answer"},{"sha":"e71b390c3445023aae8a172e30c8d7262ea06fd6","filename":"client/idrepo/enduser/src/main/resources/org/apache/syncope/client/enduser/markup/html/form/AjaxCaptchaFieldPanel.html","status":"removed","additions":0,"deletions":30,"changes":30,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/f9b4dd0e31c7298eb35e70d4a0b4ec6971148803/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fmarkup%2Fhtml%2Fform%2FAjaxCaptchaFieldPanel.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/f9b4dd0e31c7298eb35e70d4a0b4ec6971148803/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fmarkup%2Fhtml%2Fform%2FAjaxCaptchaFieldPanel.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fmarkup%2Fhtml%2Fform%2FAjaxCaptchaFieldPanel.html?ref=f9b4dd0e31c7298eb35e70d4a0b4ec6971148803","patch":"@@ -1,30 +0,0 @@\n-<!--\n-Licensed to the Apache Software Foundation (ASF) under one\n-or more contributor license agreements.  See the NOTICE file\n-distributed with this work for additional information\n-regarding copyright ownership.  The ASF licenses this file\n-to you under the Apache License, Version 2.0 (the\n-\"License\"); you may not use this file except in compliance\n-with the License.  You may obtain a copy of the License at\n-\n-  http://www.apache.org/licenses/LICENSE-2.0\n-\n-Unless required by applicable law or agreed to in writing,\n-software distributed under the License is distributed on an\n-\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n-KIND, either express or implied.  See the License for the\n-specific language governing permissions and limitations\n-under the License.\n--->\n-<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:wicket=\"http://wicket.apache.org\">\n-  <wicket:panel>\n-    <fieldset class=\"input-group\">\n-      <div id=\"captcha_text\" class=\"captcha_elem\">\n-        <input type=\"text\" size=\"27\" wicket:id=\"textField\" placeholder=\"\"/>\n-      </div>\n-      <div id=\"captcha_message\" class=\"captcha_elem\">\n-        <wicket:message key=\"captcha.message\">[CAPTCHA_MESSAGE]</wicket:message>\n-      </div>\n-    </fieldset>\n-  </wicket:panel>\n-</html>"},{"sha":"c3164b100a6827f43a8e16acc5951c1ae1393872","filename":"client/idrepo/enduser/src/main/resources/org/apache/syncope/client/enduser/wizards/any/AbstractCaptchaPanel.html","status":"removed","additions":0,"deletions":24,"changes":24,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/f9b4dd0e31c7298eb35e70d4a0b4ec6971148803/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FAbstractCaptchaPanel.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/f9b4dd0e31c7298eb35e70d4a0b4ec6971148803/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FAbstractCaptchaPanel.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FAbstractCaptchaPanel.html?ref=f9b4dd0e31c7298eb35e70d4a0b4ec6971148803","patch":"@@ -1,24 +0,0 @@\n-<!DOCTYPE html>\n-<!--\n-Licensed to the Apache Software Foundation (ASF) under one\n-or more contributor license agreements.  See the NOTICE file\n-distributed with this work for additional information\n-regarding copyright ownership.  The ASF licenses this file\n-to you under the Apache License, Version 2.0 (the\n-\"License\"); you may not use this file except in compliance\n-with the License.  You may obtain a copy of the License at\n-\n-  http://www.apache.org/licenses/LICENSE-2.0\n-\n-Unless required by applicable law or agreed to in writing,\n-software distributed under the License is distributed on an\n-\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n-KIND, either express or implied.  See the License for the\n-specific language governing permissions and limitations\n-under the License.\n--->\n-<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:wicket=\"http://wicket.apache.org\">\n-  <wicket:panel>\n-    <wicket:child/>\n-  </wicket:panel>\n-</html>\n\\ No newline at end of file"},{"sha":"f6a845b1643f2b94960b0ebed96593aab8495a1b","filename":"client/idrepo/enduser/src/main/resources/org/apache/syncope/client/enduser/wizards/any/CaptchaPanel.html","status":"modified","additions":14,"deletions":15,"changes":29,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptchaPanel.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptchaPanel.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptchaPanel.html?ref=abc55641cf6f1adb088ef143ac042ab38cac0134","patch":"@@ -19,21 +19,20 @@\n -->\n <html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:wicket=\"http://wicket.apache.org\">\n   <wicket:panel>\n-    <wicket:extend>\n-      <div class=\"captcha_block\">\n-        <div id=\"captcha_buttons\">\n-          <img wicket:id=\"image\" />\n-        </div>\n-        <div id=\"captcha_image\" class=\"captcha_elem\">\n-          <button wicket:id=\"reloadButton\" id=\"refresh\" type=\"button\" class=\"btn btn-default btn-xs fa fa-refresh\" \n-                  title=\"Refresh Captcha\"></button>\n-          <button id=\"infoLink\" class=\"btn btn-default btn-xs fa fa-question-circle\" title=\"What is this?\"\n-                  onclick=\"window.open('https://it.wikipedia.org/wiki/CAPTCHA')\"></button>\n-        </div>\n-        <div>\n-          <span wicket:id=\"captcha\">[CAPTCHA]</span>\n-        </div>\n+    <div class=\"captcha_block\">\n+      <div id=\"captcha_buttons\">\n+        <img wicket:id=\"image\" />\n       </div>\n-    </wicket:extend>\n+      <div id=\"captcha_image\" class=\"captcha_elem\">\n+        <button wicket:id=\"reloadButton\" id=\"refresh\" type=\"button\" class=\"btn btn-default btn-xs fa fa-refresh\" \n+                title=\"Refresh Captcha\"></button>\n+        <button id=\"infoLink\" class=\"btn btn-default btn-xs fa fa-question-circle\" title=\"What is this?\"\n+                onclick=\"window.open('https://it.wikipedia.org/wiki/CAPTCHA')\"></button>\n+      </div>\n+      <div>\n+        <label for=\"captcha\"><wicket:message key=\"captcha.message\"/></label>\n+        <span wicket:id=\"captcha\">[CAPTCHA]</span>\n+      </div>\n+    </div>\n   </wicket:panel>\n </html>"},{"sha":"f75bf083c66664238821a3eda5b63f755c6fddc6","filename":"client/idrepo/enduser/src/main/resources/org/apache/syncope/client/enduser/wizards/any/CaptchaPanel.properties","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptchaPanel.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptchaPanel.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptchaPanel.properties?ref=abc55641cf6f1adb088ef143ac042ab38cac0134","previous_filename":"client/idrepo/enduser/src/main/resources/org/apache/syncope/client/enduser/wizards/any/AbstractCaptchaPanel.properties"},{"sha":"eab994e7c6dcc82d19301faedc2ec8b78570c7d0","filename":"client/idrepo/enduser/src/main/resources/org/apache/syncope/client/enduser/wizards/any/CaptchaPanel_it.properties","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptchaPanel_it.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptchaPanel_it.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptchaPanel_it.properties?ref=abc55641cf6f1adb088ef143ac042ab38cac0134","previous_filename":"client/idrepo/enduser/src/main/resources/org/apache/syncope/client/enduser/wizards/any/AbstractCaptchaPanel_it.properties"},{"sha":"0399f3d73645a965f9b42ed5df9d05803da03f6c","filename":"client/idrepo/enduser/src/main/resources/org/apache/syncope/client/enduser/wizards/any/CaptchaPanel_ja.properties","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptchaPanel_ja.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptchaPanel_ja.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptchaPanel_ja.properties?ref=abc55641cf6f1adb088ef143ac042ab38cac0134","previous_filename":"client/idrepo/enduser/src/main/resources/org/apache/syncope/client/enduser/wizards/any/AbstractCaptchaPanel_ja.properties"},{"sha":"d21fb6bb35c1d92cfdc4021639504cb4ca506cf7","filename":"client/idrepo/enduser/src/main/resources/org/apache/syncope/client/enduser/wizards/any/CaptchaPanel_pt_BR.properties","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptchaPanel_pt_BR.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptchaPanel_pt_BR.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptchaPanel_pt_BR.properties?ref=abc55641cf6f1adb088ef143ac042ab38cac0134","previous_filename":"client/idrepo/enduser/src/main/resources/org/apache/syncope/client/enduser/wizards/any/AbstractCaptchaPanel_pt_BR.properties"},{"sha":"9a077bdd6a0d11de72cf95441c45f8bc50becefb","filename":"client/idrepo/enduser/src/main/resources/org/apache/syncope/client/enduser/wizards/any/CaptchaPanel_ru.properties","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptchaPanel_ru.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/abc55641cf6f1adb088ef143ac042ab38cac0134/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptchaPanel_ru.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FCaptchaPanel_ru.properties?ref=abc55641cf6f1adb088ef143ac042ab38cac0134","previous_filename":"client/idrepo/enduser/src/main/resources/org/apache/syncope/client/enduser/wizards/any/AbstractCaptchaPanel_ru.properties"},{"sha":"bc4b1fe0c6da5489ba8970b327297d6c0b42457b","filename":"fit/core-reference/src/test/java/org/apache/syncope/fit/enduser/AbstractEnduserITCase.java","status":"modified","additions":8,"deletions":1,"changes":9,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/abc55641cf6f1adb088ef143ac042ab38cac0134/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fenduser%2FAbstractEnduserITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/abc55641cf6f1adb088ef143ac042ab38cac0134/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fenduser%2FAbstractEnduserITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fenduser%2FAbstractEnduserITCase.java?ref=abc55641cf6f1adb088ef143ac042ab38cac0134","patch":"@@ -25,6 +25,7 @@\n import com.giffing.wicket.spring.boot.starter.configuration.extensions.external.spring.boot.actuator.WicketEndpointRepositoryDefault;\n import java.util.Date;\n import java.util.List;\n+import java.util.Locale;\n import org.apache.commons.lang3.StringUtils;\n import org.apache.commons.lang3.time.DateFormatUtils;\n import org.apache.syncope.client.enduser.SyncopeWebApplication;\n@@ -108,6 +109,8 @@ public PreviewUtils previewUtils() {\n \n     @BeforeAll\n     public static void setUp() {\n+        Locale.setDefault(Locale.ENGLISH);\n+\n         AnnotationConfigApplicationContext ctx = new AnnotationConfigApplicationContext();\n         ctx.register(SyncopeEnduserWebApplicationTestConfig.class);\n         ctx.register(SyncopeWebApplication.class);\n@@ -133,7 +136,7 @@ public static void restSetup() {\n         adminClient = clientFactory.create(ADMIN_UNAME, ADMIN_PWD);\n \n         userService = adminClient.getService(UserService.class);\n-        securityQuestionService = adminClient.getService(SecurityQuestionService.class);\n+\n         // create test user for must change password\n         userService.create(new UserCR.Builder(SyncopeConstants.ROOT_REALM, \"mustchangepassword\").\n                 password(\"password123\").\n@@ -146,6 +149,7 @@ public static void restSetup() {\n                 plainAttr(attr(\"email\", \"mustchangepassword@apache.org\")).\n                 plainAttr(attr(\"loginDate\", DateFormatUtils.ISO_8601_EXTENDED_DATETIME_FORMAT.format(new Date()))).\n                 build());\n+\n         // create test user for self password reset\n         userService.create(new UserCR.Builder(SyncopeConstants.ROOT_REALM, \"selfpwdreset\").\n                 password(\"password123\").\n@@ -157,6 +161,7 @@ public static void restSetup() {\n                 plainAttr(attr(\"email\", \"selfpwdreset@apache.org\")).\n                 plainAttr(attr(\"loginDate\", DateFormatUtils.ISO_8601_EXTENDED_DATETIME_FORMAT.format(new Date()))).\n                 build());\n+\n         // create test user for self update\n         userService.create(new UserCR.Builder(SyncopeConstants.ROOT_REALM, \"selfupdate\").\n                 password(\"password123\").\n@@ -166,6 +171,8 @@ public static void restSetup() {\n                 plainAttr(attr(\"ctype\", \"a type\")).\n                 plainAttr(attr(\"userId\", \"selfupdate@apache.org\")).\n                 build());\n+\n+        securityQuestionService = adminClient.getService(SecurityQuestionService.class);\n     }\n \n     protected void doLogin(final String user, final String passwd) {"},{"sha":"082f4789e15b2b427e76aeaccfc1e934242e0c2b","filename":"fit/core-reference/src/test/java/org/apache/syncope/fit/enduser/EnduserITCase.java","status":"modified","additions":18,"deletions":24,"changes":42,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/abc55641cf6f1adb088ef143ac042ab38cac0134/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fenduser%2FEnduserITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/abc55641cf6f1adb088ef143ac042ab38cac0134/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fenduser%2FEnduserITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fenduser%2FEnduserITCase.java?ref=abc55641cf6f1adb088ef143ac042ab38cac0134","patch":"@@ -34,7 +34,6 @@\n import org.apache.syncope.common.lib.request.UserUR;\n import org.apache.syncope.common.lib.to.SecurityQuestionTO;\n import org.apache.syncope.common.lib.to.UserTO;\n-import org.apache.syncope.common.lib.types.PatchOperation;\n import org.apache.syncope.common.rest.api.beans.AnyQuery;\n import org.apache.wicket.extensions.markup.html.form.palette.component.Choices;\n import org.apache.wicket.markup.html.basic.Label;\n@@ -140,19 +139,14 @@ public void selfCreate() {\n     @Test\n     public void selfPasswordReset() {\n         SecurityQuestionTO question = securityQuestionService.read(\"887028ea-66fc-41e7-b397-620d7ea6dfbb\");\n+\n         UserTO selfpwdreset = userService.read(\"selfpwdreset\");\n-        userService.update(new UserUR.Builder(selfpwdreset.getKey())\n-                .securityQuestion(new StringReplacePatchItem.Builder()\n-                        .operation(PatchOperation.ADD_REPLACE)\n-                        .value(question.getKey())\n-                        .build())\n-                .securityAnswer(new StringReplacePatchItem.Builder()\n-                        .operation(PatchOperation.ADD_REPLACE)\n-                        .value(\"ananswer\")\n-                        .build())\n-                .build());\n-\n-        final String pwdResetForm = \"body:content:selfPwdResetForm\";\n+        userService.update(new UserUR.Builder(selfpwdreset.getKey()).\n+                securityQuestion(new StringReplacePatchItem.Builder().value(question.getKey()).build()).\n+                securityAnswer(new StringReplacePatchItem.Builder().value(\"ananswer\").build()).\n+                build());\n+\n+        String pwdResetForm = \"body:content:selfPwdResetForm\";\n         TESTER.startPage(Login.class);\n         TESTER.assertRenderedPage(Login.class);\n \n@@ -165,27 +159,29 @@ public void selfPasswordReset() {\n \n         FormTester formTester = TESTER.newFormTester(pwdResetForm);\n         assertNotNull(formTester);\n+\n         // 1. set username to selfpwdreset\n-        formTester.setValue(findComponentById(pwdResetForm + \":selfPwdResetPanel\", \"username\"),\n-                \"selfpwdreset\");\n+        formTester.setValue(findComponentById(pwdResetForm + \":selfPwdResetPanel\", \"username\"), \"selfpwdreset\");\n+\n         // 2. check that the question has been populated\n         TESTER.executeAjaxEvent(pwdResetForm + \":selfPwdResetPanel:username\", Constants.ON_BLUR);\n-        TESTER.assertModelValue(pwdResetForm + \":selfPwdResetPanel:securityQuestion\", question.\n-                getContent());\n+        TESTER.assertModelValue(pwdResetForm + \":selfPwdResetPanel:securityQuestion\", question.getContent());\n+\n         // 3. submit form and receive an error\n         formTester = TESTER.newFormTester(pwdResetForm);\n         assertNotNull(formTester);\n         TESTER.executeAjaxEvent(pwdResetForm + \":selfPwdResetPanel:submit\", Constants.ON_CLICK);\n-        TESTER.assertErrorMessages(\"InvalidSecurityAnswer []\");\n+        TESTER.assertErrorMessages(\"Invalid security answer\");\n         TESTER.cleanupFeedbackMessages();\n+\n         // 3.1 set the correct answer\n         formTester = TESTER.newFormTester(pwdResetForm);\n         assertNotNull(formTester);\n         TESTER.assertComponent(pwdResetForm + \":selfPwdResetPanel:securityAnswer\", TextField.class);\n         formTester.setValue(\"selfPwdResetPanel:securityAnswer\", \"ananswer\");\n         TESTER.executeAjaxEvent(pwdResetForm + \":selfPwdResetPanel:securityAnswer\", Constants.ON_CHANGE);\n-        TESTER.assertComponent(pwdResetForm + \":selfPwdResetPanel:securityAnswer\",\n-                TextField.class);\n+        TESTER.assertComponent(pwdResetForm + \":selfPwdResetPanel:securityAnswer\", TextField.class);\n+\n         // 4. submit form\n         TESTER.assertNoFeedbackMessage(0);\n         TESTER.assertNoErrorMessage();\n@@ -200,10 +196,8 @@ public void selfPasswordReset() {\n     @Test\n     public void mustChangePassword() {\n         UserTO mustchangepassword = userService.read(\"mustchangepassword\");\n-        userService.update(new UserUR.Builder(mustchangepassword.getKey())\n-                .mustChangePassword(new BooleanReplacePatchItem.Builder()\n-                        .operation(PatchOperation.ADD_REPLACE)\n-                        .value(Boolean.TRUE).build()).build());\n+        userService.update(new UserUR.Builder(mustchangepassword.getKey()).\n+                mustChangePassword(new BooleanReplacePatchItem.Builder().value(Boolean.TRUE).build()).build());\n \n         TESTER.startPage(Login.class);\n         doLogin(\"mustchangepassword\", \"password123\");"}]}