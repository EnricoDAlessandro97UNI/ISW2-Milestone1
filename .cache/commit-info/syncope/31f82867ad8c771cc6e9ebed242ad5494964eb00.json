{"sha":"31f82867ad8c771cc6e9ebed242ad5494964eb00","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjMxZjgyODY3YWQ4Yzc3MWNjNmU5ZWJlZDI0MmFkNTQ5NDk2NGViMDA=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2014-11-03T18:35:24Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2014-11-03T18:35:24Z"},"message":"Merge branch '1_2_X'","tree":{"sha":"7aff5013b6f2d132aae9b6c18a2a9b2df8113043","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/7aff5013b6f2d132aae9b6c18a2a9b2df8113043"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/31f82867ad8c771cc6e9ebed242ad5494964eb00","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/31f82867ad8c771cc6e9ebed242ad5494964eb00","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/31f82867ad8c771cc6e9ebed242ad5494964eb00","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/31f82867ad8c771cc6e9ebed242ad5494964eb00/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"ae52953b0598ca573457e6214eb1483882224f42","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/ae52953b0598ca573457e6214eb1483882224f42","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/ae52953b0598ca573457e6214eb1483882224f42"},{"sha":"f1607400c4556a0d5581c37ac73a3401c3770311","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/f1607400c4556a0d5581c37ac73a3401c3770311","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/f1607400c4556a0d5581c37ac73a3401c3770311"}],"stats":{"total":275,"additions":147,"deletions":128},"files":[{"sha":"c06831b3100b37f5b4b6761bab59d2adaa8ab9ae","filename":"console/src/main/java/org/apache/syncope/console/SyncopeApplication.java","status":"modified","additions":8,"deletions":8,"changes":16,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2FSyncopeApplication.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2FSyncopeApplication.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2FSyncopeApplication.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -161,47 +161,47 @@ public void onClick(final AjaxRequestTarget target) {\n \n         BookmarkablePageLink<Page> schemaLink = new BookmarkablePageLink<Page>(\"schema\", Schema.class);\n         MetaDataRoleAuthorizationStrategy.authorize(\n-                schemaLink, WebPage.ENABLE, xmlRolesReader.getAllAllowedRoles(\"Schema\", \"list\"));\n+                schemaLink, WebPage.ENABLE, xmlRolesReader.getEntitlement(\"Schema\", \"list\"));\n         page.add(schemaLink);\n         schemaLink.add(new Image(\"schemaIcon\", new ContextRelativeResource(IMG_PREFIX + (notsel\n                 ? IMG_NOTSEL\n                 : \"\") + \"schema\" + Constants.PNG_EXT)));\n \n         BookmarkablePageLink<Page> usersLink = new BookmarkablePageLink<Page>(\"users\", Users.class);\n         MetaDataRoleAuthorizationStrategy.authorize(\n-                usersLink, WebPage.ENABLE, xmlRolesReader.getAllAllowedRoles(\"Users\", \"list\"));\n+                usersLink, WebPage.ENABLE, xmlRolesReader.getEntitlement(\"Users\", \"list\"));\n         page.add(usersLink);\n         usersLink.add(new Image(\"usersIcon\", new ContextRelativeResource(IMG_PREFIX + (notsel\n                 ? IMG_NOTSEL\n                 : \"\") + \"users\" + Constants.PNG_EXT)));\n \n         BookmarkablePageLink<Page> rolesLink = new BookmarkablePageLink<Page>(\"roles\", Roles.class);\n         MetaDataRoleAuthorizationStrategy.authorize(\n-                rolesLink, WebPage.ENABLE, xmlRolesReader.getAllAllowedRoles(\"Roles\", \"list\"));\n+                rolesLink, WebPage.ENABLE, xmlRolesReader.getEntitlement(\"Roles\", \"list\"));\n         page.add(rolesLink);\n         rolesLink.add(new Image(\"rolesIcon\", new ContextRelativeResource(IMG_PREFIX + (notsel\n                 ? IMG_NOTSEL\n                 : \"\") + \"roles\" + Constants.PNG_EXT)));\n \n         BookmarkablePageLink<Page> resourcesLink = new BookmarkablePageLink<Page>(\"resources\", Resources.class);\n         MetaDataRoleAuthorizationStrategy.authorize(\n-                resourcesLink, WebPage.ENABLE, xmlRolesReader.getAllAllowedRoles(\"Resources\", \"list\"));\n+                resourcesLink, WebPage.ENABLE, xmlRolesReader.getEntitlement(\"Resources\", \"list\"));\n         page.add(resourcesLink);\n         resourcesLink.add(new Image(\"resourcesIcon\", new ContextRelativeResource(IMG_PREFIX + (notsel\n                 ? IMG_NOTSEL\n                 : \"\") + \"resources\" + Constants.PNG_EXT)));\n \n         BookmarkablePageLink<Page> todoLink = new BookmarkablePageLink<Page>(\"todo\", Todo.class);\n         MetaDataRoleAuthorizationStrategy.authorize(\n-                todoLink, WebPage.ENABLE, xmlRolesReader.getAllAllowedRoles(\"Approval\", \"list\"));\n+                todoLink, WebPage.ENABLE, xmlRolesReader.getEntitlement(\"Approval\", \"list\"));\n         page.add(todoLink);\n         todoLink.add(new Image(\"todoIcon\", new ContextRelativeResource(IMG_PREFIX + (notsel\n                 ? IMG_NOTSEL\n                 : \"\") + \"todo\" + Constants.PNG_EXT)));\n \n         BookmarkablePageLink<Page> reportLink = new BookmarkablePageLink<Page>(\"reports\", Reports.class);\n         MetaDataRoleAuthorizationStrategy.authorize(\n-                reportLink, WebPage.ENABLE, xmlRolesReader.getAllAllowedRoles(\"Reports\", \"list\"));\n+                reportLink, WebPage.ENABLE, xmlRolesReader.getEntitlement(\"Reports\", \"list\"));\n         page.add(reportLink);\n         reportLink.add(new Image(\"reportsIcon\", new ContextRelativeResource(IMG_PREFIX + (notsel\n                 ? IMG_NOTSEL\n@@ -210,15 +210,15 @@ public void onClick(final AjaxRequestTarget target) {\n         BookmarkablePageLink<Page> configurationLink = new BookmarkablePageLink<Page>(\"configuration\",\n                 Configuration.class);\n         MetaDataRoleAuthorizationStrategy.authorize(\n-                configurationLink, WebPage.ENABLE, xmlRolesReader.getAllAllowedRoles(\"Configuration\", \"list\"));\n+                configurationLink, WebPage.ENABLE, xmlRolesReader.getEntitlement(\"Configuration\", \"list\"));\n         page.add(configurationLink);\n         configurationLink.add(new Image(\"configurationIcon\", new ContextRelativeResource(IMG_PREFIX + (notsel\n                 ? IMG_NOTSEL\n                 : \"\") + \"configuration\" + Constants.PNG_EXT)));\n \n         BookmarkablePageLink<Page> taskLink = new BookmarkablePageLink<Page>(\"tasks\", Tasks.class);\n         MetaDataRoleAuthorizationStrategy.authorize(\n-                taskLink, WebPage.ENABLE, xmlRolesReader.getAllAllowedRoles(\"Tasks\", \"list\"));\n+                taskLink, WebPage.ENABLE, xmlRolesReader.getEntitlement(\"Tasks\", \"list\"));\n         page.add(taskLink);\n         taskLink.add(new Image(\"tasksIcon\", new ContextRelativeResource(IMG_PREFIX + (notsel\n                 ? IMG_NOTSEL"},{"sha":"69cf4ecf299190b26e74ab5fddaf4f02370495d3","filename":"console/src/main/java/org/apache/syncope/console/commons/XMLRolesReader.java","status":"modified","additions":60,"deletions":37,"changes":97,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fcommons%2FXMLRolesReader.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fcommons%2FXMLRolesReader.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fcommons%2FXMLRolesReader.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -18,17 +18,17 @@\n  */\n package org.apache.syncope.console.commons;\n \n+import java.util.HashMap;\n+import java.util.Map;\n import javax.xml.parsers.DocumentBuilder;\n import javax.xml.parsers.DocumentBuilderFactory;\n-import javax.xml.xpath.XPath;\n-import javax.xml.xpath.XPathConstants;\n-import javax.xml.xpath.XPathExpression;\n-import javax.xml.xpath.XPathExpressionException;\n-import javax.xml.xpath.XPathFactory;\n import org.apache.commons.lang3.StringUtils;\n+import org.apache.commons.lang3.tuple.ImmutablePair;\n+import org.apache.commons.lang3.tuple.Pair;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n import org.w3c.dom.Document;\n+import org.w3c.dom.Node;\n import org.w3c.dom.NodeList;\n \n /**\n@@ -41,55 +41,78 @@ public class XMLRolesReader {\n      */\n     private static final Logger LOG = LoggerFactory.getLogger(XMLRolesReader.class);\n \n-    private Document doc;\n+    private String authorizations;\n+\n+    private Map<Pair<String, String>, String> authMap;\n \n     public void setAuthorizations(final String authorizations) {\n+        this.authorizations = authorizations;\n+    }\n+\n+    private void init() {\n+        authMap = new HashMap<Pair<String, String>, String>();\n+\n         DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\n         dbf.setNamespaceAware(true);\n         try {\n             DocumentBuilder db = dbf.newDocumentBuilder();\n-            doc = db.parse(getClass().getResource(\"/\" + authorizations).openStream());\n+            Document doc = db.parse(getClass().getResource(\"/\" + authorizations).openStream());\n             doc.getDocumentElement().normalize();\n+\n+            Node authNode = null;\n+            NodeList root = doc.getChildNodes();\n+            for (int i = 0; i < root.getLength() && authNode == null; i++) {\n+                if (\"auth\".equals(root.item(i).getNodeName())) {\n+                    authNode = root.item(i);\n+                }\n+            }\n+            if (authNode == null) {\n+                throw new IllegalArgumentException(\"Could not find root <auth> node\");\n+            }\n+\n+            NodeList pages = authNode.getChildNodes();\n+            for (int i = 0; i < pages.getLength(); i++) {\n+                if (\"page\".equals(pages.item(i).getNodeName())) {\n+                    String page = pages.item(i).getAttributes().getNamedItem(\"id\").getTextContent();\n+\n+                    NodeList actions = pages.item(i).getChildNodes();\n+                    for (int j = 0; j < actions.getLength(); j++) {\n+                        if (\"action\".equals(actions.item(j).getNodeName())) {\n+                            String action = actions.item(j).getAttributes().getNamedItem(\"id\").getTextContent();\n+\n+                            NodeList entitlements = actions.item(j).getChildNodes();\n+                            for (int k = 0; k < entitlements.getLength(); k++) {\n+                                if (\"entitlement\".equals(entitlements.item(k).getNodeName())) {\n+                                    String entitlement = entitlements.item(k).getTextContent();\n+                                    authMap.put(new ImmutablePair<String, String>(page, action), entitlement);\n+                                }\n+                            }\n+                        }\n+                    }\n+                }\n+            }\n         } catch (Exception e) {\n             LOG.error(\"While initializing parsing of {}\", authorizations, e);\n-            doc = null;\n         }\n     }\n \n     /**\n-     * Get all roles allowed for specific page and action requested.\n+     * Get entitlement required for page / action.\n      *\n-     * @param pageId\n-     * @param actionId\n-     * @return roles list comma separated\n+     * @param pageId page\n+     * @param actionId action\n+     * @return entitlement required\n      */\n-    public String getAllAllowedRoles(final String pageId, final String actionId) {\n-        if (doc == null) {\n-            return StringUtils.EMPTY;\n-        }\n-\n-        final StringBuilder roles = new StringBuilder();\n-        try {\n-            XPathFactory factory = XPathFactory.newInstance();\n-            XPath xpath = factory.newXPath();\n-            XPathExpression expr = xpath.compile(\"//page[@id='\" + pageId + \"']/\" + \"action[@id='\" + actionId + \"']/\"\n-                    + \"entitlement/text()\");\n-            Object result = expr.evaluate(doc, XPathConstants.NODESET);\n-\n-            NodeList nodes = (NodeList) result;\n-\n-            for (int i = 0; i < nodes.getLength(); i++) {\n-                if (i > 0) {\n-                    roles.append(\",\");\n-                }\n-                roles.append(nodes.item(i).getNodeValue());\n+    public String getEntitlement(final String pageId, final String actionId) {\n+        synchronized (this) {\n+            if (authMap == null) {\n+                init();\n             }\n-        } catch (XPathExpressionException e) {\n-            LOG.error(\"While parsing authorizations file\", e);\n         }\n \n-        LOG.debug(\"Authorizations found: {}\", roles);\n-\n-        return roles.toString();\n+        Pair<String, String> key = new ImmutablePair<String, String>(pageId, actionId);\n+        return authMap.containsKey(key)\n+                ? authMap.get(key)\n+                : StringUtils.EMPTY;\n     }\n }"},{"sha":"490e62f6632acea4ab78d32108ed8aab83fe01c3","filename":"console/src/main/java/org/apache/syncope/console/pages/AbstractSchedTaskModalPage.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FAbstractSchedTaskModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FAbstractSchedTaskModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FAbstractSchedTaskModalPage.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -116,10 +116,10 @@ protected void onSubmit(final AjaxRequestTarget target, final Form<?> form) {\n         cancel.setDefaultFormProcessing(false);\n \n         if (taskTO.getId() > 0) {\n-            MetaDataRoleAuthorizationStrategy.authorize(submit, RENDER, xmlRolesReader.getAllAllowedRoles(TASKS,\n+            MetaDataRoleAuthorizationStrategy.authorize(submit, RENDER, xmlRolesReader.getEntitlement(TASKS,\n                     \"update\"));\n         } else {\n-            MetaDataRoleAuthorizationStrategy.authorize(submit, RENDER, xmlRolesReader.getAllAllowedRoles(TASKS,\n+            MetaDataRoleAuthorizationStrategy.authorize(submit, RENDER, xmlRolesReader.getEntitlement(TASKS,\n                     \"create\"));\n         }\n "},{"sha":"20e57ade61c76e8e56e3426596b724a0db9228ae","filename":"console/src/main/java/org/apache/syncope/console/pages/ApprovalModalPage.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FApprovalModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FApprovalModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FApprovalModalPage.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -191,7 +191,7 @@ protected void closeAction(final AjaxRequestTarget target, final Form form) {\n                     }\n                 };\n         MetaDataRoleAuthorizationStrategy.authorize(userDetails, ENABLE,\n-                xmlRolesReader.getAllAllowedRoles(\"Users\", \"read\"));\n+                xmlRolesReader.getEntitlement(\"Users\", \"read\"));\n \n         final AjaxButton submit = new IndicatingAjaxButton(APPLY, new Model<String>(getString(SUBMIT))) {\n \n@@ -270,7 +270,7 @@ protected void onError(final AjaxRequestTarget target, final Form form) {\n         form.add(submit);\n         form.add(cancel);\n \n-        MetaDataRoleAuthorizationStrategy.authorize(form, ENABLE, xmlRolesReader.getAllAllowedRoles(\"Approval\",\n+        MetaDataRoleAuthorizationStrategy.authorize(form, ENABLE, xmlRolesReader.getEntitlement(\"Approval\",\n                 SUBMIT));\n \n         editUserWin = new ModalWindow(\"editUserWin\");"},{"sha":"99fcac6c98d00031e4b35849edced6b51fe9e9f1","filename":"console/src/main/java/org/apache/syncope/console/pages/ConfModalPage.java","status":"modified","additions":3,"deletions":3,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FConfModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FConfModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FConfModalPage.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -44,7 +44,7 @@ public ConfModalPage(final PageReference pageRef, final ModalWindow window, fina\n         super();\n \n         MetaDataRoleAuthorizationStrategy.authorize(\n-                parameters, ENABLE, xmlRolesReader.getAllAllowedRoles(\"Configuration\", \"list\"));\n+                parameters, ENABLE, xmlRolesReader.getEntitlement(\"Configuration\", \"list\"));\n         final ConfTO conf = confRestClient.list();\n \n         final Form<ConfTO> form = new Form<ConfTO>(\"confForm\");\n@@ -88,9 +88,9 @@ protected void onError(final AjaxRequestTarget target, final Form<?> form) {\n             }\n         };\n         MetaDataRoleAuthorizationStrategy.authorize(\n-                submit, ENABLE, xmlRolesReader.getAllAllowedRoles(\"Configuration\", \"set\"));\n+                submit, ENABLE, xmlRolesReader.getEntitlement(\"Configuration\", \"set\"));\n         MetaDataRoleAuthorizationStrategy.authorize(\n-                submit, ENABLE, xmlRolesReader.getAllAllowedRoles(\"Configuration\", \"delete\"));\n+                submit, ENABLE, xmlRolesReader.getEntitlement(\"Configuration\", \"delete\"));\n         form.add(submit);\n         form.setDefaultButton(submit);\n "},{"sha":"b2e5c070d4c464179bc98d6fc7b42c508cfccf05","filename":"console/src/main/java/org/apache/syncope/console/pages/Configuration.java","status":"modified","additions":11,"deletions":14,"changes":25,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FConfiguration.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FConfiguration.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FConfiguration.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -30,8 +30,6 @@\n import org.apache.logging.log4j.core.config.LoggerConfig;\n import org.apache.syncope.common.SyncopeClientException;\n import org.apache.syncope.common.SyncopeConstants;\n-import org.apache.syncope.common.to.AttributeTO;\n-import org.apache.syncope.common.to.ConfTO;\n import org.apache.syncope.common.to.LoggerTO;\n import org.apache.syncope.common.to.NotificationTO;\n import org.apache.syncope.common.to.SecurityQuestionTO;\n@@ -195,7 +193,7 @@ public Configuration() {\n                 new BookmarkablePageLink<Void>(\"activitiModeler\", ActivitiModelerPopupPage.class);\n         activitiModeler.setPopupSettings(new VeilPopupSettings().setHeight(600).setWidth(800));\n         MetaDataRoleAuthorizationStrategy.authorize(activitiModeler, ENABLE,\n-                xmlRolesReader.getAllAllowedRoles(\"Configuration\", \"workflowDefRead\"));\n+                xmlRolesReader.getEntitlement(\"Configuration\", \"workflowDefRead\"));\n         workflowDefContainer.add(activitiModeler);\n         // Check if Activiti Modeler directory is found\n         boolean activitiModelerEnabled = false;\n@@ -213,7 +211,7 @@ public Configuration() {\n                 new BookmarkablePageLink<Void>(\"xmlEditor\", XMLEditorPopupPage.class);\n         xmlEditor.setPopupSettings(new VeilPopupSettings().setHeight(480).setWidth(800));\n         MetaDataRoleAuthorizationStrategy.authorize(xmlEditor, ENABLE,\n-                xmlRolesReader.getAllAllowedRoles(\"Configuration\", \"workflowDefRead\"));\n+                xmlRolesReader.getEntitlement(\"Configuration\", \"workflowDefRead\"));\n         workflowDefContainer.add(xmlEditor);\n \n         Image workflowDefDiagram = new Image(\"workflowDefDiagram\", new Model()) {\n@@ -234,12 +232,11 @@ protected byte[] getImageData(final IResource.Attributes attributes) {\n                     }\n                 };\n             }\n-\n         };\n         workflowDefContainer.add(workflowDefDiagram);\n \n         MetaDataRoleAuthorizationStrategy.authorize(workflowDefContainer, ENABLE,\n-                xmlRolesReader.getAllAllowedRoles(\"Configuration\", \"workflowDefRead\"));\n+                xmlRolesReader.getEntitlement(\"Configuration\", \"workflowDefRead\"));\n         add(workflowDefContainer);\n \n         // Logger stuff\n@@ -249,7 +246,7 @@ protected byte[] getImageData(final IResource.Attributes attributes) {\n         coreLoggerContainer.add(coreLoggerList);\n         coreLoggerContainer.setOutputMarkupId(true);\n \n-        MetaDataRoleAuthorizationStrategy.authorize(coreLoggerContainer, ENABLE, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(coreLoggerContainer, ENABLE, xmlRolesReader.getEntitlement(\n                 \"Configuration\", \"logList\"));\n         add(coreLoggerContainer);\n \n@@ -260,7 +257,7 @@ protected byte[] getImageData(final IResource.Attributes attributes) {\n         consoleLoggerContainer.add(consoleLoggerList);\n         consoleLoggerContainer.setOutputMarkupId(true);\n \n-        MetaDataRoleAuthorizationStrategy.authorize(consoleLoggerContainer, ENABLE, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(consoleLoggerContainer, ENABLE, xmlRolesReader.getEntitlement(\n                 \"Configuration\", \"logList\"));\n         add(consoleLoggerContainer);\n \n@@ -320,8 +317,8 @@ public void onClick() {\n                 }\n             }\n         };\n-        MetaDataRoleAuthorizationStrategy.authorize(dbExportLink, ENABLE, xmlRolesReader.getAllAllowedRoles(\n-                \"Configuration\", \"export\"));\n+        MetaDataRoleAuthorizationStrategy.authorize(\n+                dbExportLink, ENABLE, xmlRolesReader.getEntitlement(\"Configuration\", \"export\"));\n         add(dbExportLink);\n     }\n \n@@ -438,7 +435,7 @@ public Page createPage() {\n             }\n         };\n \n-        MetaDataRoleAuthorizationStrategy.authorize(createNotificationLink, ENABLE, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(createNotificationLink, ENABLE, xmlRolesReader.getEntitlement(\n                 \"Notification\", \"create\"));\n         add(createNotificationLink);\n \n@@ -572,8 +569,8 @@ public Page createPage() {\n             }\n         };\n \n-        MetaDataRoleAuthorizationStrategy.authorize(createSecurityQuestionLink, ENABLE, xmlRolesReader.\n-                getAllAllowedRoles(\"SecurityQuestion\", \"create\"));\n+        MetaDataRoleAuthorizationStrategy.authorize(\n+                createSecurityQuestionLink, ENABLE, xmlRolesReader.getEntitlement(\"SecurityQuestion\", \"create\"));\n         add(createSecurityQuestionLink);\n     }\n \n@@ -719,7 +716,7 @@ protected void onUpdate(final AjaxRequestTarget target) {\n                 }\n             });\n \n-            MetaDataRoleAuthorizationStrategy.authorize(level, ENABLE, xmlRolesReader.getAllAllowedRoles(\n+            MetaDataRoleAuthorizationStrategy.authorize(level, ENABLE, xmlRolesReader.getEntitlement(\n                     \"Configuration\", \"logSetLevel\"));\n \n             item.add(level);"},{"sha":"a2a814ea6885611000e655300c18971ffb6e6a4e","filename":"console/src/main/java/org/apache/syncope/console/pages/ConnectorModalPage.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FConnectorModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FConnectorModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FConnectorModalPage.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -377,8 +377,8 @@ protected void onError(final AjaxRequestTarget target, final Form<?> form) {\n             }\n         };\n         String roles = connInstanceTO.getId() == 0\n-                ? xmlRolesReader.getAllAllowedRoles(\"Connectors\", \"create\")\n-                : xmlRolesReader.getAllAllowedRoles(\"Connectors\", \"update\");\n+                ? xmlRolesReader.getEntitlement(\"Connectors\", \"create\")\n+                : xmlRolesReader.getEntitlement(\"Connectors\", \"update\");\n         MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, roles);\n         connectorForm.add(submit);\n "},{"sha":"80a1b6cc591a29e8f34158a175cc26aeaeb6257a","filename":"console/src/main/java/org/apache/syncope/console/pages/DerSchemaModalPage.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FDerSchemaModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FDerSchemaModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FDerSchemaModalPage.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -122,8 +122,8 @@ protected void onSubmit(final AjaxRequestTarget target, final Form<?> form) {\n                 false);\n \n         String allowedRoles = createFlag\n-                ? xmlRolesReader.getAllAllowedRoles(\"Schema\", \"create\")\n-                : xmlRolesReader.getAllAllowedRoles(\"Schema\", \"update\");\n+                ? xmlRolesReader.getEntitlement(\"Schema\", \"create\")\n+                : xmlRolesReader.getEntitlement(\"Schema\", \"update\");\n \n         MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, allowedRoles);\n "},{"sha":"be9faf381408d13dd7dddc8d12e85ed5c4c9fd81","filename":"console/src/main/java/org/apache/syncope/console/pages/EditUserModalPage.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FEditUserModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FEditUserModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FEditUserModalPage.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -64,7 +64,7 @@ public EditUserModalPage(final PageReference pageRef, final ModalWindow window,\n             statusPanel = new StatusPanel(\"statuspanel\", userTO, new ArrayList<StatusBean>(), getPageReference());\n             statusPanel.setOutputMarkupId(true);\n             MetaDataRoleAuthorizationStrategy.authorize(\n-                    statusPanel, RENDER, xmlRolesReader.getAllAllowedRoles(\"Resources\", \"getConnectorObject\"));\n+                    statusPanel, RENDER, xmlRolesReader.getEntitlement(\"Resources\", \"getConnectorObject\"));\n             form.addOrReplace(statusPanel);\n \n             form.addOrReplace(new AccountInformationPanel(\"accountinformation\", userTO));"},{"sha":"a44d179e4b599e664ba59079307c2fd98125cb8a","filename":"console/src/main/java/org/apache/syncope/console/pages/NotificationModalPage.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FNotificationModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FNotificationModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FNotificationModalPage.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -396,8 +396,8 @@ protected void onSubmit(final AjaxRequestTarget target, final Form<?> form) {\n         cancel.setDefaultFormProcessing(false);\n \n         String allowedRoles = createFlag\n-                ? xmlRolesReader.getAllAllowedRoles(\"Notification\", \"create\")\n-                : xmlRolesReader.getAllAllowedRoles(\"Notification\", \"update\");\n+                ? xmlRolesReader.getEntitlement(\"Notification\", \"create\")\n+                : xmlRolesReader.getEntitlement(\"Notification\", \"update\");\n         MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, allowedRoles);\n \n         form.add(submit);"},{"sha":"ea73e9e91aaab4d3d4c3e784e07665dddb6b0ea5","filename":"console/src/main/java/org/apache/syncope/console/pages/ReportModalPage.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FReportModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FReportModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FReportModalPage.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -159,10 +159,10 @@ protected void onError(final AjaxRequestTarget target, final Form<?> form) {\n \n         if (reportTO.getId() > 0) {\n             MetaDataRoleAuthorizationStrategy.authorize(submit, RENDER,\n-                    xmlRolesReader.getAllAllowedRoles(\"Reports\", \"update\"));\n+                    xmlRolesReader.getEntitlement(\"Reports\", \"update\"));\n         } else {\n             MetaDataRoleAuthorizationStrategy.authorize(submit, RENDER,\n-                    xmlRolesReader.getAllAllowedRoles(\"Reports\", \"create\"));\n+                    xmlRolesReader.getEntitlement(\"Reports\", \"create\"));\n         }\n \n         form.add(submit);"},{"sha":"3f097629f5e3f9473239d15c4692341833bb936c","filename":"console/src/main/java/org/apache/syncope/console/pages/Reports.java","status":"modified","additions":10,"deletions":10,"changes":20,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FReports.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FReports.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FReports.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -110,7 +110,7 @@ private void setupReport() {\n         setWindowClosedCallback(window, reportContainer);\n \n         MetaDataRoleAuthorizationStrategy.authorize(reportContainer, RENDER,\n-                xmlRolesReader.getAllAllowedRoles(\"Reports\", \"list\"));\n+                xmlRolesReader.getEntitlement(\"Reports\", \"list\"));\n \n         paginatorRows = prefMan.getPaginatorRows(getRequest(), Constants.PREF_REPORT_PAGINATOR_ROWS);\n \n@@ -226,7 +226,7 @@ public void onClick(final AjaxRequestTarget target) {\n         Form paginatorForm = new Form(\"paginatorForm\");\n \n         MetaDataRoleAuthorizationStrategy.authorize(paginatorForm, RENDER,\n-                xmlRolesReader.getAllAllowedRoles(\"Reports\", \"list\"));\n+                xmlRolesReader.getEntitlement(\"Reports\", \"list\"));\n \n         @SuppressWarnings({ \"unchecked\", \"rawtypes\" })\n         final DropDownChoice rowsChooser = new DropDownChoice(\"rowsChooser\", new PropertyModel(this, \"paginatorRows\"),\n@@ -269,7 +269,7 @@ public Page createPage() {\n             }\n         };\n \n-        MetaDataRoleAuthorizationStrategy.authorize(createLink, RENDER, xmlRolesReader.getAllAllowedRoles(\"Reports\",\n+        MetaDataRoleAuthorizationStrategy.authorize(createLink, RENDER, xmlRolesReader.getEntitlement(\"Reports\",\n                 \"create\"));\n \n         add(createLink);\n@@ -282,7 +282,7 @@ private void setupAudit() {\n         add(auditContainer);\n \n         MetaDataRoleAuthorizationStrategy.authorize(\n-                auditContainer, RENDER, xmlRolesReader.getAllAllowedRoles(\"Audit\", \"list\"));\n+                auditContainer, RENDER, xmlRolesReader.getEntitlement(\"Audit\", \"list\"));\n \n         final Form form = new Form(\"auditForm\");\n         auditContainer.add(form);\n@@ -309,15 +309,15 @@ private void setupAudit() {\n                     @Override\n                     protected String[] getListRoles() {\n                         return new String[] {\n-                            xmlRolesReader.getAllAllowedRoles(\"Audit\", \"list\")\n+                            xmlRolesReader.getEntitlement(\"Audit\", \"list\")\n                         };\n                     }\n \n                     @Override\n                     protected String[] getChangeRoles() {\n                         return new String[] {\n-                            xmlRolesReader.getAllAllowedRoles(\"Audit\", \"enable\"),\n-                            xmlRolesReader.getAllAllowedRoles(\"Audit\", \"disable\")\n+                            xmlRolesReader.getEntitlement(\"Audit\", \"enable\"),\n+                            xmlRolesReader.getEntitlement(\"Audit\", \"disable\")\n                         };\n                     }\n \n@@ -338,7 +338,7 @@ public void onEventAction(final IEvent<?> event) {\n                                             eventCategory.getKey().getCategory(),\n                                             eventCategory.getKey().getSubcategory(),\n                                             CollectionUtils.isEmpty(eventCategory.getKey().getEvents())\n-                                            ? null : eventCategory.getKey().getEvents().iterator().next(),\n+                                                    ? null : eventCategory.getKey().getEvents().iterator().next(),\n                                             eventCategory.getValue());\n \n                                     loggerRestClient.disableAudit(auditLoggerName);\n@@ -356,7 +356,7 @@ public void onEventAction(final IEvent<?> event) {\n                                             eventCategory.getKey().getCategory(),\n                                             eventCategory.getKey().getSubcategory(),\n                                             CollectionUtils.isEmpty(eventCategory.getKey().getEvents())\n-                                            ? null : eventCategory.getKey().getEvents().iterator().next(),\n+                                                    ? null : eventCategory.getKey().getEvents().iterator().next(),\n                                             eventCategory.getValue());\n \n                                     loggerRestClient.enableAudit(auditLoggerName);\n@@ -385,7 +385,7 @@ public ReportProvider() {\n         @Override\n         public Iterator<ReportTO> iterator(final long first, final long count) {\n             final int page = ((int) first / paginatorRows);\n-            \n+\n             final List<ReportTO> list =\n                     reportRestClient.list((page < 0 ? 0 : page) + 1, paginatorRows, getSort());\n             Collections.sort(list, comparator);"},{"sha":"1c93fd1e4cc6026e71daab66d69171974f64ff3a","filename":"console/src/main/java/org/apache/syncope/console/pages/ResourceModalPage.java","status":"modified","additions":3,"deletions":3,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FResourceModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FResourceModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FResourceModalPage.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -84,8 +84,8 @@ public ResourceModalPage(final PageReference pageRef, final ModalWindow window,\n         // Resource connector configuration panel\n         //--------------------------------\n         ResourceConnConfPanel resourceConnConfPanel = new ResourceConnConfPanel(\"connconf\", resourceTO, createFlag);\n-        MetaDataRoleAuthorizationStrategy.authorize(resourceConnConfPanel, ENABLE,\n-                xmlRolesReader.getAllAllowedRoles(\"Connectors\", \"read\"));\n+        MetaDataRoleAuthorizationStrategy.authorize(\n+                resourceConnConfPanel, ENABLE, xmlRolesReader.getEntitlement(\"Connectors\", \"read\"));\n         form.add(resourceConnConfPanel);\n         //--------------------------------\n \n@@ -180,7 +180,7 @@ protected void onError(final AjaxRequestTarget target, final Form<?> form) {\n \n         add(form);\n \n-        MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, xmlRolesReader.getAllAllowedRoles(\"Resources\",\n+        MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, xmlRolesReader.getEntitlement(\"Resources\",\n                 createFlag\n                         ? \"create\"\n                         : \"update\"));"},{"sha":"f1bd39befe8010c3efc2d68500aecf7ed0b96b7b","filename":"console/src/main/java/org/apache/syncope/console/pages/Resources.java","status":"modified","additions":6,"deletions":7,"changes":13,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FResources.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FResources.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FResources.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -164,7 +164,7 @@ public CharSequence getPrecondition(final Component component) {\n                 attributes.getAjaxCallListeners().add(ajaxCallListener);\n             }\n         };\n-        MetaDataRoleAuthorizationStrategy.authorize(reloadLink, ENABLE, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(reloadLink, ENABLE, xmlRolesReader.getEntitlement(\n                 \"Connectors\", \"reload\"));\n         add(reloadLink);\n \n@@ -220,8 +220,7 @@ public Page createPage() {\n \n                         cellItem.add(editConnPanel);\n \n-                        MetaDataRoleAuthorizationStrategy.authorize(editConnPanel, ENABLE, xmlRolesReader.\n-                                getAllAllowedRoles(\n+                        MetaDataRoleAuthorizationStrategy.authorize(editConnPanel, ENABLE, xmlRolesReader.getEntitlement(\n                                         \"Connectors\", \"read\"));\n                     }\n                 });\n@@ -435,7 +434,7 @@ public Page createPage() {\n                     }\n                 };\n \n-        MetaDataRoleAuthorizationStrategy.authorize(createResourceLink, ENABLE, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(createResourceLink, ENABLE, xmlRolesReader.getEntitlement(\n                 \"Resources\", \"create\"));\n \n         add(createResourceLink);\n@@ -555,7 +554,7 @@ public void onClick(final AjaxRequestTarget target) {\n         connectorContainer.add(table);\n         connectorContainer.setOutputMarkupId(true);\n \n-        MetaDataRoleAuthorizationStrategy.authorize(connectorContainer, RENDER, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(connectorContainer, RENDER, xmlRolesReader.getEntitlement(\n                 \"Connectors\", \"list\"));\n \n         add(connectorContainer);\n@@ -596,15 +595,15 @@ public Page createPage() {\n                     }\n                 };\n \n-        MetaDataRoleAuthorizationStrategy.authorize(createConnectorLink, ENABLE, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(createConnectorLink, ENABLE, xmlRolesReader.getEntitlement(\n                 \"Connectors\", \"create\"));\n \n         add(createConnectorLink);\n \n         @SuppressWarnings(\"rawtypes\")\n         Form paginatorForm = new Form(\"connectorPaginatorForm\");\n \n-        MetaDataRoleAuthorizationStrategy.authorize(paginatorForm, RENDER, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(paginatorForm, RENDER, xmlRolesReader.getEntitlement(\n                 \"Connectors\", \"list\"));\n \n         final DropDownChoice<Integer> rowsChooser = new DropDownChoice<Integer>("},{"sha":"7ef25a618cf0c11d30a11580ffd983799bcc7e9b","filename":"console/src/main/java/org/apache/syncope/console/pages/RoleModalPage.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FRoleModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FRoleModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FRoleModalPage.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -125,7 +125,7 @@ protected void onSubmit(final AjaxRequestTarget target, final Form<?> form) {\n         cancel.setDefaultFormProcessing(false);\n         form.add(cancel);\n \n-        MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, xmlRolesReader.getAllAllowedRoles(\"Roles\",\n+        MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, xmlRolesReader.getEntitlement(\"Roles\",\n                 createFlag\n                         ? \"create\"\n                         : \"update\"));"},{"sha":"9796ea885223e50dba5598b2787f035b61fbd145","filename":"console/src/main/java/org/apache/syncope/console/pages/Schema.java","status":"modified","additions":3,"deletions":3,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FSchema.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FSchema.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FSchema.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -139,11 +139,11 @@ public class Schema extends BasePage {\n     @SpringBean\n     private PreferenceManager prefMan;\n \n-    private final String allowedCreateRoles = xmlRolesReader.getAllAllowedRoles(\"Schema\", \"create\");\n+    private final String allowedCreateRoles = xmlRolesReader.getEntitlement(\"Schema\", \"create\");\n \n-    private final String allowedReadRoles = xmlRolesReader.getAllAllowedRoles(\"Schema\", \"read\");\n+    private final String allowedReadRoles = xmlRolesReader.getEntitlement(\"Schema\", \"read\");\n \n-    private final String allowedDeleteRoles = xmlRolesReader.getAllAllowedRoles(\"Schema\", \"delete\");\n+    private final String allowedDeleteRoles = xmlRolesReader.getEntitlement(\"Schema\", \"delete\");\n \n     public Schema() {\n         super();"},{"sha":"1e634f05b512520603574b4051cc67621d33637c","filename":"console/src/main/java/org/apache/syncope/console/pages/SchemaModalPage.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FSchemaModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FSchemaModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FSchemaModalPage.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -290,8 +290,8 @@ protected void onSubmit(final AjaxRequestTarget target, final Form<?> form) {\n         schemaForm.add(cancel);\n \n         String allowedRoles = createFlag\n-                ? xmlRolesReader.getAllAllowedRoles(\"Schema\", \"create\")\n-                : xmlRolesReader.getAllAllowedRoles(\"Schema\", \"update\");\n+                ? xmlRolesReader.getEntitlement(\"Schema\", \"create\")\n+                : xmlRolesReader.getEntitlement(\"Schema\", \"update\");\n \n         MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, allowedRoles);\n "},{"sha":"c9cd4c7e33877bd0a0dcd100bb859ce99f368c1d","filename":"console/src/main/java/org/apache/syncope/console/pages/SecurityQuestionModalPage.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FSecurityQuestionModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FSecurityQuestionModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FSecurityQuestionModalPage.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -99,8 +99,8 @@ protected void onSubmit(final AjaxRequestTarget target, final Form<?> form) {\n         cancel.setDefaultFormProcessing(false);\n \n         String allowedRoles = createFlag\n-                ? xmlRolesReader.getAllAllowedRoles(\"SecurityQuestion\", \"create\")\n-                : xmlRolesReader.getAllAllowedRoles(\"SecurityQuestion\", \"update\");\n+                ? xmlRolesReader.getEntitlement(\"SecurityQuestion\", \"create\")\n+                : xmlRolesReader.getEntitlement(\"SecurityQuestion\", \"update\");\n         MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, allowedRoles);\n \n         form.add(submit);"},{"sha":"6ddbed9f8c96f703ca7985301a521247cad9d59a","filename":"console/src/main/java/org/apache/syncope/console/pages/Todo.java","status":"modified","additions":3,"deletions":3,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FTodo.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FTodo.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FTodo.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -82,8 +82,8 @@ public Todo(final PageParameters parameters) {\n \n         container = new WebMarkupContainer(\"approvalContainer\");\n \n-        MetaDataRoleAuthorizationStrategy.authorize(container, RENDER,\n-                xmlRolesReader.getAllAllowedRoles(\"Approval\", \"list\"));\n+        MetaDataRoleAuthorizationStrategy.authorize(\n+                container, RENDER, xmlRolesReader.getEntitlement(\"Approval\", \"list\"));\n \n         paginatorRows = prefMan.getPaginatorRows(getRequest(), Constants.PREF_TODO_PAGINATOR_ROWS);\n \n@@ -170,7 +170,7 @@ public Page createPage() {\n         Form approvalPaginatorForm = new Form(\"paginatorForm\");\n \n         MetaDataRoleAuthorizationStrategy.authorize(approvalPaginatorForm, RENDER,\n-                xmlRolesReader.getAllAllowedRoles(\"Approval\", \"list\"));\n+                xmlRolesReader.getEntitlement(\"Approval\", \"list\"));\n \n         @SuppressWarnings({ \"unchecked\", \"rawtypes\" })\n         final DropDownChoice rowsChooser = new DropDownChoice(\"rowsChooser\","},{"sha":"9135120c239a67a0da82a99b88ca088a6ad1c359","filename":"console/src/main/java/org/apache/syncope/console/pages/UserModalPage.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -164,8 +164,8 @@ protected Form setupEditPanel() {\n \n         if (mode == Mode.ADMIN) {\n             String allowedRoles = userTO.getId() == 0\n-                    ? xmlRolesReader.getAllAllowedRoles(\"Users\", \"create\")\n-                    : xmlRolesReader.getAllAllowedRoles(\"Users\", \"update\");\n+                    ? xmlRolesReader.getEntitlement(\"Users\", \"create\")\n+                    : xmlRolesReader.getEntitlement(\"Users\", \"update\");\n             MetaDataRoleAuthorizationStrategy.authorize(submit, RENDER, allowedRoles);\n         }\n "},{"sha":"d0fb3bdd74c61feef08c4ec52c4e10c89fcd588a","filename":"console/src/main/java/org/apache/syncope/console/pages/Users.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FUsers.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FUsers.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FUsers.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -90,7 +90,7 @@ public Page createPage() {\n             }\n         };\n         MetaDataRoleAuthorizationStrategy.authorize(\n-                createLink, ENABLE, xmlRolesReader.getAllAllowedRoles(\"Users\", \"create\"));\n+                createLink, ENABLE, xmlRolesReader.getEntitlement(\"Users\", \"create\"));\n         add(createLink);\n \n         setWindowClosedReloadCallback(editModalWin);"},{"sha":"9ca0c420cb84a6dca36c7a9ff933ae664a9ae333","filename":"console/src/main/java/org/apache/syncope/console/pages/VirSchemaModalPage.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FVirSchemaModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FVirSchemaModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FVirSchemaModalPage.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -110,8 +110,8 @@ protected void onSubmit(final AjaxRequestTarget target, final Form<?> form) {\n         cancel.setDefaultFormProcessing(false);\n \n         String allowedRoles = createFlag\n-                ? xmlRolesReader.getAllAllowedRoles(\"Schema\", \"create\")\n-                : xmlRolesReader.getAllAllowedRoles(\"Schema\", \"update\");\n+                ? xmlRolesReader.getEntitlement(\"Schema\", \"create\")\n+                : xmlRolesReader.getEntitlement(\"Schema\", \"update\");\n \n         MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, allowedRoles);\n "},{"sha":"c17351c78117431da6863fe4066498b6d5cb7eda","filename":"console/src/main/java/org/apache/syncope/console/pages/XMLEditorPopupPage.java","status":"modified","additions":3,"deletions":3,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FXMLEditorPopupPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FXMLEditorPopupPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FXMLEditorPopupPage.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -56,7 +56,7 @@ public XMLEditorPopupPage() {\n         wfForm.add(workflowDefArea);\n \n         AjaxButton submit =\n-                 new ClearIndicatingAjaxButton(APPLY, new Model<String>(getString(SUBMIT)), getPageReference()) {\n+                new ClearIndicatingAjaxButton(APPLY, new Model<String>(getString(SUBMIT)), getPageReference()) {\n \n                     private static final long serialVersionUID = -958724007591692537L;\n \n@@ -80,8 +80,8 @@ protected void onError(final AjaxRequestTarget target, final Form<?> form) {\n \n         final Button close = new Button(\"closePage\", new Model<String>(getString(CANCEL)));\n \n-        MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE,\n-                xmlRolesReader.getAllAllowedRoles(\"Configuration\", \"workflowDefUpdate\"));\n+        MetaDataRoleAuthorizationStrategy.authorize(\n+                submit, ENABLE, xmlRolesReader.getEntitlement(\"Configuration\", \"workflowDefUpdate\"));\n         wfForm.add(submit);\n         wfForm.add(close);\n         this.add(wfForm);"},{"sha":"e422305a9f51ac14436453680fe9e8bc0319f27d","filename":"console/src/main/java/org/apache/syncope/console/pages/panels/AbstractSyncTasksPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FAbstractSyncTasksPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FAbstractSyncTasksPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FAbstractSyncTasksPanel.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -149,7 +149,7 @@ public Page createPage() {\n         };\n \n         MetaDataRoleAuthorizationStrategy.authorize(\n-                createLink, RENDER, xmlRolesReader.getAllAllowedRoles(TASKS, \"create\"));\n+                createLink, RENDER, xmlRolesReader.getEntitlement(TASKS, \"create\"));\n \n         add(createLink);\n "},{"sha":"0e942093547d91cbf61347eb5ba7b99228b31da3","filename":"console/src/main/java/org/apache/syncope/console/pages/panels/PoliciesPanel.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FPoliciesPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FPoliciesPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FPoliciesPanel.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -229,8 +229,8 @@ public Page createPage() {\n \n         add(createButton);\n \n-        MetaDataRoleAuthorizationStrategy.authorize(createButton, ENABLE,\n-                xmlRolesReader.getAllAllowedRoles(\"Policies\", \"create\"));\n+        MetaDataRoleAuthorizationStrategy.authorize(\n+                createButton, ENABLE, xmlRolesReader.getEntitlement(\"Policies\", \"create\"));\n \n         @SuppressWarnings(\"rawtypes\")\n         final Form paginatorForm = new Form(\"PaginatorForm\");"},{"sha":"ee82b36455d8451dc47944d64b6c406835331ebc","filename":"console/src/main/java/org/apache/syncope/console/pages/panels/RolePanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRolePanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRolePanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRolePanel.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -107,7 +107,7 @@ private RolePanel(final Builder builder) {\n                     \"statuspanel\", builder.roleTO, new ArrayList<StatusBean>(), builder.pageReference);\n             statusPanel.setOutputMarkupId(true);\n             MetaDataRoleAuthorizationStrategy.authorize(\n-                    statusPanel, RENDER, xmlRolesReader.getAllAllowedRoles(\"Resources\", \"getConnectorObject\"));\n+                    statusPanel, RENDER, xmlRolesReader.getEntitlement(\"Resources\", \"getConnectorObject\"));\n             this.add(statusPanel);\n         }\n "},{"sha":"57894244f6b92a7baf10303631094edb58ff5d9a","filename":"console/src/main/java/org/apache/syncope/console/pages/panels/RoleSummaryPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleSummaryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleSummaryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleSummaryPanel.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -136,7 +136,7 @@ public Page createPage() {\n \n                         builder.window.show(target);\n                     }\n-                }, ActionLink.ActionType.CREATE, xmlRolesReader.getAllAllowedRoles(\"Roles\", \"create\"));\n+                }, ActionLink.ActionType.CREATE, xmlRolesReader.getEntitlement(\"Roles\", \"create\"));\n             } else {\n                 RoleTabPanel roleTabPanel =\n                         new RoleTabPanel(\"nodeViewPanel\", selectedNode, builder.window, builder.callerPageRef);"},{"sha":"10d739cdccf10be39728aa5c357b3e7b3d087bc9","filename":"console/src/main/java/org/apache/syncope/console/pages/panels/RoleTabPanel.java","status":"modified","additions":4,"deletions":4,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleTabPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleTabPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleTabPanel.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -90,7 +90,7 @@ public Page createPage() {\n \n                 window.show(target);\n             }\n-        }, ActionLink.ActionType.CREATE, xmlRolesReader.getAllAllowedRoles(\"Roles\", \"create\"));\n+        }, ActionLink.ActionType.CREATE, xmlRolesReader.getEntitlement(\"Roles\", \"create\"));\n         links.addWithRoles(new ActionLink() {\n \n             private static final long serialVersionUID = -3722207913631435501L;\n@@ -109,7 +109,7 @@ public Page createPage() {\n \n                 window.show(target);\n             }\n-        }, ActionLink.ActionType.MANAGE_RESOURCES, xmlRolesReader.getAllAllowedRoles(\"Roles\", \"update\"));\n+        }, ActionLink.ActionType.MANAGE_RESOURCES, xmlRolesReader.getEntitlement(\"Roles\", \"update\"));\n         links.addWithRoles(new ActionLink() {\n \n             private static final long serialVersionUID = -3722207913631435501L;\n@@ -129,7 +129,7 @@ public Page createPage() {\n \n                 window.show(target);\n             }\n-        }, ActionLink.ActionType.EDIT, xmlRolesReader.getAllAllowedRoles(\"Roles\", \"update\"));\n+        }, ActionLink.ActionType.EDIT, xmlRolesReader.getEntitlement(\"Roles\", \"update\"));\n         links.addWithRoles(new ActionLink() {\n \n             private static final long serialVersionUID = -3722207913631435501L;\n@@ -157,7 +157,7 @@ public Page createPage() {\n                     ((Roles) pageRef.getPage()).getFeedbackPanel().refresh(target);\n                 }\n             }\n-        }, ActionLink.ActionType.DELETE, xmlRolesReader.getAllAllowedRoles(\"Roles\", \"delete\"));\n+        }, ActionLink.ActionType.DELETE, xmlRolesReader.getEntitlement(\"Roles\", \"delete\"));\n \n         final Form form = new Form(\"roleForm\");\n         form.setModel(new CompoundPropertyModel(selectedNode));"},{"sha":"f092e5501d65d88231bccdc23dd2040ab84324f3","filename":"console/src/main/java/org/apache/syncope/console/pages/panels/SchedTasks.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FSchedTasks.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FSchedTasks.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FSchedTasks.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -144,7 +144,7 @@ public Page createPage() {\n         };\n \n         MetaDataRoleAuthorizationStrategy.authorize(\n-                createLink, RENDER, xmlRolesReader.getAllAllowedRoles(TASKS, \"create\"));\n+                createLink, RENDER, xmlRolesReader.getEntitlement(TASKS, \"create\"));\n \n         add(createLink);\n     }"},{"sha":"5e6e5eb16875be4c418ed867edc90a703c9a2abf","filename":"console/src/main/java/org/apache/syncope/console/wicket/markup/html/form/ActionLinksPanel.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FActionLinksPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FActionLinksPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FActionLinksPanel.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -79,7 +79,7 @@ public ActionLinksPanel(final String componentId, final IModel<?> model, final P\n     public void add(\n             final ActionLink link, final ActionLink.ActionType type, final String pageId, final String actionId) {\n \n-        addWithRoles(link, type, xmlRolesReader.getAllAllowedRoles(pageId, actionId), true);\n+        addWithRoles(link, type, xmlRolesReader.getEntitlement(pageId, actionId), true);\n     }\n \n     public void add(\n@@ -91,7 +91,7 @@ public void add(\n     public void add(\n             final ActionLink link, final ActionLink.ActionType type, final String pageId, final boolean enabled) {\n \n-        addWithRoles(link, type, xmlRolesReader.getAllAllowedRoles(pageId, type.getActionId()), enabled);\n+        addWithRoles(link, type, xmlRolesReader.getEntitlement(pageId, type.getActionId()), enabled);\n     }\n \n     public void addWithRoles("},{"sha":"d860880fb0fb71255fe361c8f5cdf8c93bbc4aba","filename":"console/src/main/java/org/apache/syncope/console/wicket/markup/html/tree/TreeRolePanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FTreeRolePanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FTreeRolePanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FTreeRolePanel.java?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -104,7 +104,7 @@ protected void onClick(final AjaxRequestTarget target) {\n \n         DefaultMutableTreeNodeExpansion.get().expandAll();\n \n-        MetaDataRoleAuthorizationStrategy.authorize(tree, ENABLE, xmlRolesReader.getAllAllowedRoles(\"Roles\", \"read\"));\n+        MetaDataRoleAuthorizationStrategy.authorize(tree, ENABLE, xmlRolesReader.getEntitlement(\"Roles\", \"read\"));\n \n         treeContainer.addOrReplace(tree);\n     }"},{"sha":"91c884b39bf224ae522c374bf94e53455bad6154","filename":"console/src/main/resources/consoleContext.xml","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fresources%2FconsoleContext.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/31f82867ad8c771cc6e9ebed242ad5494964eb00/console%2Fsrc%2Fmain%2Fresources%2FconsoleContext.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2FconsoleContext.xml?ref=31f82867ad8c771cc6e9ebed242ad5494964eb00","patch":"@@ -69,7 +69,7 @@ under the License.\n \n   <bean id=\"preferenceManager\" class=\"org.apache.syncope.console.commons.PreferenceManager\"/>\n \n-  <bean id=\"xmlRolesReader\" class=\"org.apache.syncope.console.commons.XMLRolesReader\">\n+  <bean id=\"xmlRolesReader\" class=\"org.apache.syncope.console.commons.XMLRolesReader\" scope=\"singleton\">\n     <property name=\"authorizations\" value=\"authorizations.xml\"/>\n   </bean>\n "}]}