{"sha":"34af1854f488f80a9969da8e3c833fee7c810b89","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjM0YWYxODU0ZjQ4OGY4MGE5OTY5ZGE4ZTNjODMzZmVlN2M4MTBiODk=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2015-11-10T16:16:00Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2015-11-10T16:16:00Z"},"message":"[SYNCOPE-718] installer","tree":{"sha":"67d42c964eca57412342888d4f18f72808d19477","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/67d42c964eca57412342888d4f18f72808d19477"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/34af1854f488f80a9969da8e3c833fee7c810b89","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/34af1854f488f80a9969da8e3c833fee7c810b89","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/34af1854f488f80a9969da8e3c833fee7c810b89","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/34af1854f488f80a9969da8e3c833fee7c810b89/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"02bd1e390d99962f1d7e9f574b94f1e2474b0d2d","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/02bd1e390d99962f1d7e9f574b94f1e2474b0d2d","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/02bd1e390d99962f1d7e9f574b94f1e2474b0d2d"}],"stats":{"total":106,"additions":105,"deletions":1},"files":[{"sha":"c677058a518cf683e5b7eff22d8187e6fcf6daff","filename":"installer/src/main/java/org/apache/syncope/installer/containers/AbstractContainer.java","status":"modified","additions":4,"deletions":0,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/34af1854f488f80a9969da8e3c833fee7c810b89/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FAbstractContainer.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/34af1854f488f80a9969da8e3c833fee7c810b89/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FAbstractContainer.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FAbstractContainer.java?ref=34af1854f488f80a9969da8e3c833fee7c810b89","patch":"@@ -26,6 +26,10 @@ public abstract class AbstractContainer {\n \n     protected static final String UNIX_CONSOLE_RELATIVE_PATH = \"%s/%s/console/target/syncope-console.war\";\n \n+    protected static final String UNIX_ENDUSER_RELATIVE_PATH = \"%s/%s/enduser/target/syncope-enduser.war\";\n+\n     protected static final String WIN_CONSOLE_RELATIVE_PATH = \"%s\\\\%s\\\\console\\\\target\\\\syncope-console.war\";\n \n+    protected static final String WIN_ENDUSER_RELATIVE_PATH = \"%s\\\\%s\\\\enduser\\\\target\\\\syncope-enduser.war\";\n+\n }"},{"sha":"234037793de553102da643b74c910fb0a4716abb","filename":"installer/src/main/java/org/apache/syncope/installer/containers/Glassfish.java","status":"modified","additions":4,"deletions":0,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/34af1854f488f80a9969da8e3c833fee7c810b89/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FGlassfish.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/34af1854f488f80a9969da8e3c833fee7c810b89/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FGlassfish.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FGlassfish.java?ref=34af1854f488f80a9969da8e3c833fee7c810b89","patch":"@@ -37,6 +37,10 @@ public String deployConsole() {\n         return deploy(UNIX_CONSOLE_RELATIVE_PATH);\n     }\n \n+    public String deployEnduser() {\n+        return deploy(UNIX_CONSOLE_RELATIVE_PATH);\n+    }\n+\n     public String deploy(final String what) {\n         return String.format(what, installPath, artifactId);\n     }"},{"sha":"94713125d0c21570c5d369e70614461122548b23","filename":"installer/src/main/java/org/apache/syncope/installer/containers/Tomcat.java","status":"modified","additions":14,"deletions":0,"changes":14,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/34af1854f488f80a9969da8e3c833fee7c810b89/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FTomcat.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/34af1854f488f80a9969da8e3c833fee7c810b89/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FTomcat.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FTomcat.java?ref=34af1854f488f80a9969da8e3c833fee7c810b89","patch":"@@ -31,6 +31,8 @@ public class Tomcat extends AbstractContainer {\n \n     private static final String DEPLOY_SYNCOPE_CONSOLE_QUERY = \"/manager/text/deploy?path=/syncope-console&war=file:\";\n \n+    private static final String DEPLOY_SYNCOPE_ENDUSER_QUERY = \"/manager/text/deploy?path=/syncope-enduser&war=file:\";\n+\n     private final String installPath;\n \n     private final String artifactId;\n@@ -69,6 +71,18 @@ public boolean deployConsole() {\n         return status == 200;\n     }\n \n+    public boolean deployEnduser() {\n+        int status;\n+        if (IS_WIN) {\n+            status = httpUtils.getWithBasicAuth(DEPLOY_SYNCOPE_ENDUSER_QUERY\n+                    + pathEncoded(String.format(WIN_ENDUSER_RELATIVE_PATH, installPath, artifactId)));\n+        } else {\n+            status = httpUtils.getWithBasicAuth(path(DEPLOY_SYNCOPE_ENDUSER_QUERY + UNIX_ENDUSER_RELATIVE_PATH));\n+        }\n+\n+        return status == 200;\n+    }\n+\n     private String pathEncoded(final String what) {\n         String path = \"\";\n         try {"},{"sha":"a08608c9ef556b366f464e0fae1449ba9be9b81f","filename":"installer/src/main/java/org/apache/syncope/installer/containers/jboss/JBoss.java","status":"modified","additions":4,"deletions":0,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/34af1854f488f80a9969da8e3c833fee7c810b89/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2Fjboss%2FJBoss.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/34af1854f488f80a9969da8e3c833fee7c810b89/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2Fjboss%2FJBoss.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2Fjboss%2FJBoss.java?ref=34af1854f488f80a9969da8e3c833fee7c810b89","patch":"@@ -63,6 +63,10 @@ public boolean deployConsole() {\n         return deploy(UNIX_CONSOLE_RELATIVE_PATH, \"syncope-console.war\");\n     }\n \n+    public boolean deployEnduser() {\n+        return deploy(UNIX_ENDUSER_RELATIVE_PATH, \"syncope-console.war\");\n+    }\n+\n     public boolean deploy(final String whatDeploy, final String warName) {\n         final String responseBodyAsString = httpUtils.postWithDigestAuth(\n                 String.format(addContentUrl, jbossHost, jbossManagementPort),"},{"sha":"26532f2d0683f6ae77551556ecca4b95f1699815","filename":"installer/src/main/java/org/apache/syncope/installer/files/ConsoleProperties.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/34af1854f488f80a9969da8e3c833fee7c810b89/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Ffiles%2FConsoleProperties.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/34af1854f488f80a9969da8e3c833fee7c810b89/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Ffiles%2FConsoleProperties.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Ffiles%2FConsoleProperties.java?ref=34af1854f488f80a9969da8e3c833fee7c810b89","patch":"@@ -29,6 +29,6 @@ public final class ConsoleProperties {\n             + \"port=%s\";\n \n     private ConsoleProperties() {\n-            // private constructor for static utility class\n+        // private constructor for static utility class\n     }\n }"},{"sha":"26dc3045c3062f42b0e61ee4f47a2d62575608a6","filename":"installer/src/main/java/org/apache/syncope/installer/files/EnduserProperties.java","status":"added","additions":34,"deletions":0,"changes":34,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/34af1854f488f80a9969da8e3c833fee7c810b89/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Ffiles%2FEnduserProperties.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/34af1854f488f80a9969da8e3c833fee7c810b89/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Ffiles%2FEnduserProperties.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Ffiles%2FEnduserProperties.java?ref=34af1854f488f80a9969da8e3c833fee7c810b89","patch":"@@ -0,0 +1,34 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.installer.files;\n+\n+public final class EnduserProperties {\n+\n+    public static final String PLACEHOLDER = \"scheme=http\\n\"\n+            + \"host=localhost\\n\"\n+            + \"port=8080\";\n+\n+    public static final String ENDUSER = \"scheme=%s\\n\"\n+            + \"host=%s\\n\"\n+            + \"port=%s\";\n+\n+    private EnduserProperties() {\n+        // private constructor for static utility class\n+    }\n+}"},{"sha":"d0a3f62501227702c4fe82dfb510331dd9871948","filename":"installer/src/main/java/org/apache/syncope/installer/processes/ArchetypeProcess.java","status":"modified","additions":11,"deletions":0,"changes":11,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/34af1854f488f80a9969da8e3c833fee7c810b89/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fprocesses%2FArchetypeProcess.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/34af1854f488f80a9969da8e3c833fee7c810b89/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fprocesses%2FArchetypeProcess.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fprocesses%2FArchetypeProcess.java?ref=34af1854f488f80a9969da8e3c833fee7c810b89","patch":"@@ -119,6 +119,17 @@ public void run(final AbstractUIProcessHandler handler, final String[] args) {\n                 + File.separator + PROPERTIES.getProperty(\"saveModel\"),\n                 modelerDirectory + File.separator + PROPERTIES.getProperty(\"saveModel\"));\n \n+        fileSystemUtils.copyFile(\n+                syncopeInstallDir\n+                + PROPERTIES.getProperty(\"enduserResDirectory\")\n+                + File.separator + PROPERTIES.getProperty(\"urlConfig\"),\n+                modelerDirectory + File.separator + PROPERTIES.getProperty(\"urlConfig\"));\n+        fileSystemUtils.copyFile(\n+                syncopeInstallDir\n+                + PROPERTIES.getProperty(\"enduserResDirectory\")\n+                + File.separator + PROPERTIES.getProperty(\"saveModel\"),\n+                modelerDirectory + File.separator + PROPERTIES.getProperty(\"saveModel\"));\n+\n         final Properties modelerProperties = new Properties();\n         modelerProperties.setProperty(\"modeler.directory\", modelerDirectory);\n         mavenUtils.mvnCleanPackageWithProperties(modelerDirectory, modelerProperties, customMavenProxySettings);"},{"sha":"9113c22f6e2d28a076c6b4e383de168696e2daab","filename":"installer/src/main/java/org/apache/syncope/installer/processes/ContainerProcess.java","status":"modified","additions":31,"deletions":0,"changes":31,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/34af1854f488f80a9969da8e3c833fee7c810b89/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fprocesses%2FContainerProcess.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/34af1854f488f80a9969da8e3c833fee7c810b89/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fprocesses%2FContainerProcess.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fprocesses%2FContainerProcess.java?ref=34af1854f488f80a9969da8e3c833fee7c810b89","patch":"@@ -30,6 +30,7 @@\n import org.apache.syncope.installer.containers.jboss.JBoss;\n import org.apache.syncope.installer.enums.Containers;\n import org.apache.syncope.installer.files.ConsoleProperties;\n+import org.apache.syncope.installer.files.EnduserProperties;\n import org.apache.syncope.installer.files.GlassfishCoreWebXml;\n import org.apache.syncope.installer.files.MasterDomainXml;\n import org.apache.syncope.installer.utilities.InstallLog;\n@@ -156,6 +157,10 @@ public void run(final AbstractUIProcessHandler handler, final String[] args) {\n                 + File.separator + PROPERTIES.getProperty(\"consolePropertiesFile\"));\n         String contentConsolePropertiesFile = fileSystemUtils.readFile(consolePropertiesFile);\n \n+        File enduserPropertiesFile = new File(syncopeInstallDir + PROPERTIES.getProperty(\"enduserResDirectory\")\n+                + File.separator + PROPERTIES.getProperty(\"enduserPropertiesFile\"));\n+        String contentEnduserPropertiesFile = fileSystemUtils.readFile(enduserPropertiesFile);\n+\n         final String scheme;\n         final String host;\n         final String port;\n@@ -186,6 +191,10 @@ public void run(final AbstractUIProcessHandler handler, final String[] args) {\n                 contentConsolePropertiesFile.replace(ConsoleProperties.PLACEHOLDER,\n                         String.format(ConsoleProperties.CONSOLE, scheme, host, port)));\n \n+        fileSystemUtils.writeToFile(enduserPropertiesFile,\n+                contentEnduserPropertiesFile.replace(EnduserProperties.PLACEHOLDER,\n+                        String.format(EnduserProperties.ENDUSER, scheme, host, port)));\n+\n         MavenUtils mavenUtils = new MavenUtils(mavenDir, handler);\n         File customMavenProxySettings = null;\n         try {\n@@ -249,6 +258,16 @@ public void run(final AbstractUIProcessHandler handler, final String[] args) {\n                     handler.emitError(messageError, messageError);\n                     InstallLog.getInstance().error(messageError);\n                 }\n+\n+                boolean deployEnduserResult = tomcat.deployEnduser();\n+                if (deployEnduserResult) {\n+                    handler.logOutput(\"Enduser successfully deployed \", true);\n+                    InstallLog.getInstance().info(\"Enduser successfully deployed \");\n+                } else {\n+                    final String messageError = \"Deploy console on Tomcat failed\";\n+                    handler.emitError(messageError, messageError);\n+                    InstallLog.getInstance().error(messageError);\n+                }\n                 break;\n \n             case JBOSS:\n@@ -275,6 +294,16 @@ public void run(final AbstractUIProcessHandler handler, final String[] args) {\n                     handler.emitError(messageError, messageError);\n                     InstallLog.getInstance().error(messageError);\n                 }\n+\n+                boolean deployEnduserJBoss = jBoss.deployEnduser();\n+                if (deployEnduserJBoss) {\n+                    handler.logOutput(\"Enduser successfully deployed \", true);\n+                    InstallLog.getInstance().info(\"Enduser successfully deployed \");\n+                } else {\n+                    final String messageError = \"Deploy console on JBoss failed\";\n+                    handler.emitError(messageError, messageError);\n+                    InstallLog.getInstance().error(messageError);\n+                }\n                 break;\n \n             case GLASSFISH:\n@@ -287,6 +316,8 @@ public void run(final AbstractUIProcessHandler handler, final String[] args) {\n                         + Glassfish.DEPLOY_COMMAND + glassfish.deployCore(), null);\n                 fileSystemUtils.exec(\"sh \" + glassfishDir\n                         + Glassfish.DEPLOY_COMMAND + glassfish.deployConsole(), null);\n+                fileSystemUtils.exec(\"sh \" + glassfishDir\n+                        + Glassfish.DEPLOY_COMMAND + glassfish.deployEnduser(), null);\n                 break;\n \n             default:"},{"sha":"55f1882d8ff7ab1bac60701e739ff13054fce8c2","filename":"installer/src/main/resources/installer.properties","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/34af1854f488f80a9969da8e3c833fee7c810b89/installer%2Fsrc%2Fmain%2Fresources%2Finstaller.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/34af1854f488f80a9969da8e3c833fee7c810b89/installer%2Fsrc%2Fmain%2Fresources%2Finstaller.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fresources%2Finstaller.properties?ref=34af1854f488f80a9969da8e3c833fee7c810b89","patch":"@@ -19,10 +19,12 @@ glassfishCoreWebXmlFile=core/src/main/webapp/WEB-INF/glassfish-web.xml\n urlConfig=url-config.js\n saveModel=save-model.html\n consoleResDirectory=console/src/main/resources\n+enduserResDirectory=endyser/src/main/resources\n pomFile=pom.xml\n masterDomainFile=core/src/main/resources/domains/MasterDomain.xml\n coreMetaInfDirectory=core/src/main/resources/META-INF\n provisioningPropertiesFile=core/src/main/resources/provisioning.properties\n masterPropertiesFile=core/src/main/resources/domains/Master.properties\n consolePropertiesFile=console.properties\n+enduserPropertiesFile=enduser.properties\n modelerPomFile=modelerPom.xml"}]}