{"sha":"129544844e25b982e17290ab34ddc4992b304e4a","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjEyOTU0NDg0NGUyNWI5ODJlMTcyOTBhYjM0ZGRjNDk5MmIzMDRlNGE=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2020-03-03T16:28:49Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2020-03-17T06:42:19Z"},"message":"[SYNCOPE-1545] fit/wa-reference + inclusion in standalone","tree":{"sha":"e23df3c6d6bd5d2e7bb7b188e9ee2fa9c2c8bb10","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/e23df3c6d6bd5d2e7bb7b188e9ee2fa9c2c8bb10"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/129544844e25b982e17290ab34ddc4992b304e4a","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/129544844e25b982e17290ab34ddc4992b304e4a","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/129544844e25b982e17290ab34ddc4992b304e4a","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/129544844e25b982e17290ab34ddc4992b304e4a/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"6381e9a7dec270b587924dee070a4aebd26d5617","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/6381e9a7dec270b587924dee070a4aebd26d5617","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/6381e9a7dec270b587924dee070a4aebd26d5617"}],"stats":{"total":2012,"additions":1820,"deletions":192},"files":[{"sha":"8e922ccab985c49a10389b5cc75e1f9f0edd78b0","filename":"client/idrepo/console/src/main/java/org/apache/syncope/client/console/SyncopeConsoleApplication.java","status":"modified","additions":14,"deletions":1,"changes":15,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/client%2Fidrepo%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2FSyncopeConsoleApplication.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/client%2Fidrepo%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2FSyncopeConsoleApplication.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2FSyncopeConsoleApplication.java?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -19,6 +19,7 @@\n package org.apache.syncope.client.console;\n \n import com.giffing.wicket.spring.boot.starter.web.config.WicketWebInitializerAutoConfig.WebSocketWicketWebInitializerAutoConfiguration;\n+import org.apache.syncope.client.console.commons.AnyDirectoryPanelAdditionalActionLinksProvider;\n import org.apache.syncope.client.console.commons.AnyDirectoryPanelAdditionalActionsProvider;\n import org.apache.syncope.client.console.commons.AnyWizardBuilderAdditionalSteps;\n import org.apache.syncope.client.console.commons.ExternalResourceProvider;\n@@ -36,6 +37,9 @@\n import org.apache.syncope.client.console.commons.VirSchemaDetailsPanelProvider;\n import org.apache.syncope.client.console.init.ClassPathScanImplementationLookup;\n import org.apache.syncope.client.console.init.MIMETypesLoader;\n+import org.apache.syncope.common.keymaster.client.api.model.NetworkService;\n+import org.apache.syncope.common.keymaster.client.api.startstop.KeymasterStart;\n+import org.apache.syncope.common.keymaster.client.api.startstop.KeymasterStop;\n import org.springframework.boot.SpringApplication;\n import org.springframework.boot.autoconfigure.SpringBootApplication;\n import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;\n@@ -44,7 +48,6 @@\n import org.springframework.boot.builder.SpringApplicationBuilder;\n import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;\n import org.springframework.context.annotation.Bean;\n-import org.apache.syncope.client.console.commons.AnyDirectoryPanelAdditionalActionLinksProvider;\n \n @SpringBootApplication(exclude = {\n     ErrorMvcAutoConfiguration.class,\n@@ -61,6 +64,16 @@ protected SpringApplicationBuilder configure(final SpringApplicationBuilder buil\n         return super.configure(builder);\n     }\n \n+    @Bean\n+    public KeymasterStart keymasterStart() {\n+        return new KeymasterStart(NetworkService.Type.CONSOLE);\n+    }\n+\n+    @Bean\n+    public KeymasterStop keymasterStop() {\n+        return new KeymasterStop(NetworkService.Type.CONSOLE);\n+    }\n+\n     @ConditionalOnMissingBean(name = \"classPathScanImplementationLookup\")\n     @Bean\n     public ClassPathScanImplementationLookup classPathScanImplementationLookup() {"},{"sha":"e015d034eb3481ce6c244f0fcc764c46304a6998","filename":"client/idrepo/console/src/main/java/org/apache/syncope/client/console/SyncopeWebApplication.java","status":"modified","additions":0,"deletions":20,"changes":20,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/client%2Fidrepo%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2FSyncopeWebApplication.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/client%2Fidrepo%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2FSyncopeWebApplication.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2FSyncopeWebApplication.java?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -76,7 +76,6 @@\n import org.apache.wicket.request.cycle.IRequestCycleListener;\n import org.apache.wicket.request.mapper.parameter.PageParameters;\n import org.springframework.beans.factory.annotation.Autowired;\n-import org.springframework.beans.factory.annotation.Value;\n import org.springframework.stereotype.Component;\n \n @Component\n@@ -100,9 +99,6 @@ public static SyncopeWebApplication get() {\n     @Autowired\n     private ServiceOps serviceOps;\n \n-    @Value(\"${service.discovery.address}\")\n-    private String address;\n-\n     private String anonymousUser;\n \n     private String anonymousKey;\n@@ -179,13 +175,6 @@ protected void setSecurityHeaders(final Properties props, final WebResponse resp\n         }\n     }\n \n-    private NetworkService getNetworkService() {\n-        NetworkService ns = new NetworkService();\n-        ns.setType(NetworkService.Type.CONSOLE);\n-        ns.setAddress(address);\n-        return ns;\n-    }\n-\n     @Override\n     protected void init() {\n         super.init();\n@@ -311,15 +300,6 @@ public IResource getResource() {\n         if (getDebugSettings().isAjaxDebugModeEnabled()) {\n             getDebugSettings().setComponentPathAttributeName(\"syncope-path\");\n         }\n-\n-        serviceOps.register(getNetworkService());\n-    }\n-\n-    @Override\n-    protected void onDestroy() {\n-        serviceOps.unregister(getNetworkService());\n-\n-        super.onDestroy();\n     }\n \n     @Override"},{"sha":"aaac232323610d0249c03d5e91f5086831afbbe7","filename":"client/idrepo/enduser/src/main/java/org/apache/syncope/client/enduser/SyncopeEnduserApplication.java","status":"modified","additions":13,"deletions":0,"changes":13,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeEnduserApplication.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeEnduserApplication.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeEnduserApplication.java?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -21,6 +21,9 @@\n import com.giffing.wicket.spring.boot.starter.web.config.WicketWebInitializerAutoConfig.WebSocketWicketWebInitializerAutoConfiguration;\n import org.apache.syncope.client.enduser.init.ClassPathScanImplementationLookup;\n import org.apache.syncope.client.enduser.init.MIMETypesLoader;\n+import org.apache.syncope.common.keymaster.client.api.model.NetworkService;\n+import org.apache.syncope.common.keymaster.client.api.startstop.KeymasterStart;\n+import org.apache.syncope.common.keymaster.client.api.startstop.KeymasterStop;\n import org.springframework.boot.SpringApplication;\n import org.springframework.boot.autoconfigure.SpringBootApplication;\n import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;\n@@ -45,6 +48,16 @@ protected SpringApplicationBuilder configure(final SpringApplicationBuilder buil\n         return super.configure(builder);\n     }\n \n+    @Bean\n+    public KeymasterStart keymasterStart() {\n+        return new KeymasterStart(NetworkService.Type.ENDUSER);\n+    }\n+\n+    @Bean\n+    public KeymasterStop keymasterStop() {\n+        return new KeymasterStop(NetworkService.Type.ENDUSER);\n+    }\n+\n     @ConditionalOnMissingBean(name = \"classPathScanImplementationLookup\")\n     @Bean\n     public ClassPathScanImplementationLookup classPathScanImplementationLookup() {"},{"sha":"176fa39c621f35b15234db69dda897329cccf529","filename":"client/idrepo/enduser/src/main/java/org/apache/syncope/client/enduser/SyncopeWebApplication.java","status":"modified","additions":0,"deletions":15,"changes":15,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication.java?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -83,7 +83,6 @@\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n import org.springframework.beans.factory.annotation.Autowired;\n-import org.springframework.beans.factory.annotation.Value;\n import org.springframework.stereotype.Component;\n \n @Component\n@@ -110,9 +109,6 @@ public static SyncopeWebApplication get() {\n     @Autowired\n     private ServiceOps serviceOps;\n \n-    @Value(\"${service.discovery.address}\")\n-    private String address;\n-\n     private boolean useGZIPCompression;\n \n     private String adminUser;\n@@ -148,13 +144,6 @@ protected void setSecurityHeaders(final Properties props, final WebResponse resp\n         }\n     }\n \n-    private NetworkService getNetworkService() {\n-        NetworkService ns = new NetworkService();\n-        ns.setType(NetworkService.Type.ENDUSER);\n-        ns.setAddress(address);\n-        return ns;\n-    }\n-\n     @Override\n     protected void init() {\n         super.init();\n@@ -355,14 +344,10 @@ public IResource getResource() {\n         if (getDebugSettings().isAjaxDebugModeEnabled()) {\n             getDebugSettings().setComponentPathAttributeName(\"syncope-path\");\n         }\n-\n-        serviceOps.register(getNetworkService());\n     }\n \n     @Override\n     protected void onDestroy() {\n-        serviceOps.unregister(getNetworkService());\n-\n         if (customFormAttributesMonitor != null) {\n             try {\n                 customFormAttributesMonitor.stop(0);"},{"sha":"37fdb6b924f5f1c27f5e38b3b1687ea0ff8818b0","filename":"common/keymaster/client-api/pom.xml","status":"modified","additions":5,"deletions":0,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/common%2Fkeymaster%2Fclient-api%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/common%2Fkeymaster%2Fclient-api%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/common%2Fkeymaster%2Fclient-api%2Fpom.xml?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -43,6 +43,11 @@ under the License.\n       <artifactId>syncope-common-idrepo-lib</artifactId>\n       <version>${project.version}</version>\n     </dependency>\n+\n+    <dependency>\n+      <groupId>org.springframework</groupId>\n+      <artifactId>spring-context</artifactId>\n+    </dependency>\n   </dependencies>\n \n   <build>"},{"sha":"f1648657636a95a40129425bcaae4f8969ec5d5a","filename":"common/keymaster/client-api/src/main/java/org/apache/syncope/common/keymaster/client/api/startstop/KeymasterStart.java","status":"renamed","additions":7,"deletions":4,"changes":11,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/common%2Fkeymaster%2Fclient-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Fkeymaster%2Fclient%2Fapi%2Fstartstop%2FKeymasterStart.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/common%2Fkeymaster%2Fclient-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Fkeymaster%2Fclient%2Fapi%2Fstartstop%2FKeymasterStart.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/common%2Fkeymaster%2Fclient-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Fkeymaster%2Fclient%2Fapi%2Fstartstop%2FKeymasterStart.java?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -16,16 +16,19 @@\n  * specific language governing permissions and limitations\n  * under the License.\n  */\n-package org.apache.syncope.sra;\n+package org.apache.syncope.common.keymaster.client.api.startstop;\n \n+import org.apache.syncope.common.keymaster.client.api.model.NetworkService;\n import org.springframework.context.ApplicationListener;\n import org.springframework.context.event.ContextRefreshedEvent;\n-import org.springframework.stereotype.Component;\n \n-@Component\n-public class SyncopeSRAStartup extends SyncopeSRAStartStop\n+public class KeymasterStart extends KeymasterStartStop\n         implements ApplicationListener<ContextRefreshedEvent> {\n \n+    public KeymasterStart(final NetworkService.Type networkServiceType) {\n+        super(networkServiceType);\n+    }\n+\n     @Override\n     public void onApplicationEvent(final ContextRefreshedEvent event) {\n         serviceOps.register(getNetworkService());","previous_filename":"sra/src/main/java/org/apache/syncope/sra/SyncopeSRAStartup.java"},{"sha":"29a161b795b9d241366dd7d735540b4a10311732","filename":"common/keymaster/client-api/src/main/java/org/apache/syncope/common/keymaster/client/api/startstop/KeymasterStartStop.java","status":"renamed","additions":9,"deletions":3,"changes":12,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/common%2Fkeymaster%2Fclient-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Fkeymaster%2Fclient%2Fapi%2Fstartstop%2FKeymasterStartStop.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/common%2Fkeymaster%2Fclient-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Fkeymaster%2Fclient%2Fapi%2Fstartstop%2FKeymasterStartStop.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/common%2Fkeymaster%2Fclient-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Fkeymaster%2Fclient%2Fapi%2Fstartstop%2FKeymasterStartStop.java?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -16,24 +16,30 @@\n  * specific language governing permissions and limitations\n  * under the License.\n  */\n-package org.apache.syncope.core.starter;\n+package org.apache.syncope.common.keymaster.client.api.startstop;\n \n import org.apache.syncope.common.keymaster.client.api.ServiceOps;\n import org.apache.syncope.common.keymaster.client.api.model.NetworkService;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.beans.factory.annotation.Value;\n \n-abstract class SyncopeCoreStartStop {\n+abstract class KeymasterStartStop {\n \n     @Autowired\n     protected ServiceOps serviceOps;\n \n+    protected final NetworkService.Type networkServiceType;\n+\n+    protected KeymasterStartStop(final NetworkService.Type networkServiceType) {\n+        this.networkServiceType = networkServiceType;\n+    }\n+\n     @Value(\"${service.discovery.address}\")\n     private String address;\n \n     protected NetworkService getNetworkService() {\n         NetworkService ns = new NetworkService();\n-        ns.setType(NetworkService.Type.CORE);\n+        ns.setType(networkServiceType);\n         ns.setAddress(address);\n         return ns;\n     }","previous_filename":"core/starter/src/main/java/org/apache/syncope/core/starter/SyncopeCoreStartStop.java"},{"sha":"7851a39c1ed689b0314650088bc4565f73c6e639","filename":"common/keymaster/client-api/src/main/java/org/apache/syncope/common/keymaster/client/api/startstop/KeymasterStop.java","status":"renamed","additions":7,"deletions":7,"changes":14,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/common%2Fkeymaster%2Fclient-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Fkeymaster%2Fclient%2Fapi%2Fstartstop%2FKeymasterStop.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/common%2Fkeymaster%2Fclient-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Fkeymaster%2Fclient%2Fapi%2Fstartstop%2FKeymasterStop.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/common%2Fkeymaster%2Fclient-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Fkeymaster%2Fclient%2Fapi%2Fstartstop%2FKeymasterStop.java?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -16,19 +16,19 @@\n  * specific language governing permissions and limitations\n  * under the License.\n  */\n-package org.apache.syncope.core.starter;\n+package org.apache.syncope.common.keymaster.client.api.startstop;\n \n+import org.apache.syncope.common.keymaster.client.api.model.NetworkService;\n import org.springframework.context.ApplicationListener;\n import org.springframework.context.event.ContextClosedEvent;\n-import org.springframework.stereotype.Component;\n \n-/**\n- * Take care of cleanup actions needed by Syncope Core.\n- */\n-@Component\n-public class SyncopeCoreShutdown extends SyncopeCoreStartStop\n+public class KeymasterStop extends KeymasterStartStop\n         implements ApplicationListener<ContextClosedEvent> {\n \n+    public KeymasterStop(final NetworkService.Type networkServiceType) {\n+        super(networkServiceType);\n+    }\n+\n     @Override\n     public void onApplicationEvent(final ContextClosedEvent event) {\n         serviceOps.unregister(getNetworkService());","previous_filename":"core/starter/src/main/java/org/apache/syncope/core/starter/SyncopeCoreShutdown.java"},{"sha":"8902bec300cf11fd8d5c1ee6a1f0aff4c942db60","filename":"core/starter/src/main/java/org/apache/syncope/core/starter/SyncopeCoreApplication.java","status":"modified","additions":12,"deletions":0,"changes":12,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/core%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fstarter%2FSyncopeCoreApplication.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/core%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fstarter%2FSyncopeCoreApplication.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fstarter%2FSyncopeCoreApplication.java?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -20,6 +20,8 @@\n \n import java.io.IOException;\n import org.apache.cxf.spring.boot.autoconfigure.openapi.OpenApiAutoConfiguration;\n+import org.apache.syncope.common.keymaster.client.api.model.NetworkService;\n+import org.apache.syncope.common.keymaster.client.api.startstop.KeymasterStop;\n import org.springframework.boot.SpringApplication;\n import org.springframework.boot.autoconfigure.SpringBootApplication;\n import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;\n@@ -57,4 +59,14 @@ public static PropertySourcesPlaceholderConfigurer propertySourcesPlaceholderCon\n         pspc.setIgnoreUnresolvablePlaceholders(true);\n         return pspc;\n     }\n+\n+    @Bean\n+    public SyncopeCoreStart keymasterStart() {\n+        return new SyncopeCoreStart();\n+    }\n+\n+    @Bean\n+    public KeymasterStop keymasterStop() {\n+        return new KeymasterStop(NetworkService.Type.CORE);\n+    }\n }"},{"sha":"515fa135f1f5dad033ddcf8b4830fdc691281afb","filename":"core/starter/src/main/java/org/apache/syncope/core/starter/SyncopeCoreStart.java","status":"renamed","additions":8,"deletions":4,"changes":12,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/core%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fstarter%2FSyncopeCoreStart.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/core%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fstarter%2FSyncopeCoreStart.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fstarter%2FSyncopeCoreStart.java?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -19,6 +19,8 @@\n package org.apache.syncope.core.starter;\n \n import java.util.Comparator;\n+import org.apache.syncope.common.keymaster.client.api.model.NetworkService;\n+import org.apache.syncope.common.keymaster.client.api.startstop.KeymasterStart;\n import org.apache.syncope.core.persistence.api.DomainHolder;\n import org.apache.syncope.core.persistence.api.SyncopeCoreLoader;\n import org.slf4j.Logger;\n@@ -28,20 +30,22 @@\n import org.springframework.context.ApplicationListener;\n import org.springframework.context.event.ContextRefreshedEvent;\n import org.springframework.core.Ordered;\n-import org.springframework.stereotype.Component;\n \n /**\n  * Take care of all initializations needed by Syncope Core to run up and safe.\n  */\n-@Component\n-public class SyncopeCoreStartup extends SyncopeCoreStartStop\n+public class SyncopeCoreStart extends KeymasterStart\n         implements ApplicationListener<ContextRefreshedEvent>, Ordered {\n \n-    private static final Logger LOG = LoggerFactory.getLogger(SyncopeCoreStartup.class);\n+    private static final Logger LOG = LoggerFactory.getLogger(SyncopeCoreStart.class);\n \n     @Autowired\n     private DomainHolder domainHolder;\n \n+    public SyncopeCoreStart() {\n+        super(NetworkService.Type.CORE);\n+    }\n+\n     @Override\n     public int getOrder() {\n         return 0;","previous_filename":"core/starter/src/main/java/org/apache/syncope/core/starter/SyncopeCoreStartup.java"},{"sha":"063d123b07e0fbc6408e915152204d131f14cf06","filename":"docker/core/src/main/resources/log4j2.xml","status":"modified","additions":4,"deletions":0,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fcore%2Fsrc%2Fmain%2Fresources%2Flog4j2.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fcore%2Fsrc%2Fmain%2Fresources%2Flog4j2.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fcore%2Fsrc%2Fmain%2Fresources%2Flog4j2.xml?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -108,6 +108,10 @@ under the License.\n       <appender-ref ref=\"console\"/>\n       <appender-ref ref=\"main\"/>\n     </asyncLogger>\n+    <asyncLogger name=\"liquibase\" additivity=\"false\" level=\"ERROR\">\n+      <appender-ref ref=\"console\"/>\n+      <appender-ref ref=\"main\"/>\n+    </asyncLogger>\n     <asyncLogger name=\"org.apache.cocoon\" additivity=\"false\" level=\"ERROR\">\n       <appender-ref ref=\"console\"/>\n       <appender-ref ref=\"main\"/>"},{"sha":"dd17d087c5e7dcf2bf64d7cfb8410abda463fcf2","filename":"docker/pom.xml","status":"modified","additions":8,"deletions":8,"changes":16,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fpom.xml?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -42,13 +42,6 @@ under the License.\n     <rootpom.basedir>${basedir}/..</rootpom.basedir>\n   </properties>\n \n-  <modules>\n-    <module>core</module>\n-    <module>console</module>\n-    <module>enduser</module>\n-    <module>sra</module>\n-  </modules>\n-\n   <build>\n     <resources>\n       <resource>\n@@ -120,5 +113,12 @@ under the License.\n       </build>\n     </profile>    \n   </profiles>\n-  \n+\n+  <modules>\n+    <module>core</module>\n+    <module>console</module>\n+    <module>enduser</module>\n+    <module>sra</module>\n+    <module>wa</module>\n+  </modules>\n </project>"},{"sha":"29d6918a6e2e1143995a8963c2b7e5edf2733ce5","filename":"docker/src/main/resources/docker-compose/docker-compose-all.yml","status":"modified","additions":16,"deletions":2,"changes":18,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fsrc%2Fmain%2Fresources%2Fdocker-compose%2Fdocker-compose-all.yml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fsrc%2Fmain%2Fresources%2Fdocker-compose%2Fdocker-compose-all.yml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fdocker-compose%2Fdocker-compose-all.yml?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -24,7 +24,7 @@ version: '3.3'\n \n services:\n    keymaster:\n-     image: zookeeper:3.4.14\n+     image: zookeeper:3.5.6\n      restart: always\n \n    db:\n@@ -84,13 +84,27 @@ services:\n        KEYMASTER_PASSWORD: ${KEYMASTER_PASSWORD:-}\n        SERVICE_DISCOVERY_ADDRESS: http://syncope-enduser:8080/syncope-enduser/\n \n+   syncope-wa:\n+     depends_on:\n+       - syncope\n+       - keymaster\n+     image: apache/syncope-wa:${SYNCOPE_VERSION}\n+     ports:\n+       - \"48080:8080\"\n+     restart: always\n+     environment:\n+       KEYMASTER_ADDRESS: keymaster:2181\n+       KEYMASTER_USERNAME: ${KEYMASTER_USERNAME:-}\n+       KEYMASTER_PASSWORD: ${KEYMASTER_PASSWORD:-}\n+       SERVICE_DISCOVERY_ADDRESS: http://syncope-wa:8080/syncope-wa/\n+\n    syncope-sra:\n      depends_on:\n        - syncope\n        - keymaster\n      image: apache/syncope-sra:${SYNCOPE_VERSION}\n      ports:\n-       - \"48080:8080\"\n+       - \"58080:8080\"\n      restart: always\n      environment:\n        KEYMASTER_ADDRESS: keymaster:2181"},{"sha":"d645695673349e3947e8e5ae42332d0ac3164cd7","filename":"docker/wa/LICENSE","status":"added","additions":202,"deletions":0,"changes":202,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fwa%2FLICENSE","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fwa%2FLICENSE","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fwa%2FLICENSE?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,202 @@\n+\n+                                 Apache License\n+                           Version 2.0, January 2004\n+                        http://www.apache.org/licenses/\n+\n+   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION\n+\n+   1. Definitions.\n+\n+      \"License\" shall mean the terms and conditions for use, reproduction,\n+      and distribution as defined by Sections 1 through 9 of this document.\n+\n+      \"Licensor\" shall mean the copyright owner or entity authorized by\n+      the copyright owner that is granting the License.\n+\n+      \"Legal Entity\" shall mean the union of the acting entity and all\n+      other entities that control, are controlled by, or are under common\n+      control with that entity. For the purposes of this definition,\n+      \"control\" means (i) the power, direct or indirect, to cause the\n+      direction or management of such entity, whether by contract or\n+      otherwise, or (ii) ownership of fifty percent (50%) or more of the\n+      outstanding shares, or (iii) beneficial ownership of such entity.\n+\n+      \"You\" (or \"Your\") shall mean an individual or Legal Entity\n+      exercising permissions granted by this License.\n+\n+      \"Source\" form shall mean the preferred form for making modifications,\n+      including but not limited to software source code, documentation\n+      source, and configuration files.\n+\n+      \"Object\" form shall mean any form resulting from mechanical\n+      transformation or translation of a Source form, including but\n+      not limited to compiled object code, generated documentation,\n+      and conversions to other media types.\n+\n+      \"Work\" shall mean the work of authorship, whether in Source or\n+      Object form, made available under the License, as indicated by a\n+      copyright notice that is included in or attached to the work\n+      (an example is provided in the Appendix below).\n+\n+      \"Derivative Works\" shall mean any work, whether in Source or Object\n+      form, that is based on (or derived from) the Work and for which the\n+      editorial revisions, annotations, elaborations, or other modifications\n+      represent, as a whole, an original work of authorship. For the purposes\n+      of this License, Derivative Works shall not include works that remain\n+      separable from, or merely link (or bind by name) to the interfaces of,\n+      the Work and Derivative Works thereof.\n+\n+      \"Contribution\" shall mean any work of authorship, including\n+      the original version of the Work and any modifications or additions\n+      to that Work or Derivative Works thereof, that is intentionally\n+      submitted to Licensor for inclusion in the Work by the copyright owner\n+      or by an individual or Legal Entity authorized to submit on behalf of\n+      the copyright owner. For the purposes of this definition, \"submitted\"\n+      means any form of electronic, verbal, or written communication sent\n+      to the Licensor or its representatives, including but not limited to\n+      communication on electronic mailing lists, source code control systems,\n+      and issue tracking systems that are managed by, or on behalf of, the\n+      Licensor for the purpose of discussing and improving the Work, but\n+      excluding communication that is conspicuously marked or otherwise\n+      designated in writing by the copyright owner as \"Not a Contribution.\"\n+\n+      \"Contributor\" shall mean Licensor and any individual or Legal Entity\n+      on behalf of whom a Contribution has been received by Licensor and\n+      subsequently incorporated within the Work.\n+\n+   2. Grant of Copyright License. Subject to the terms and conditions of\n+      this License, each Contributor hereby grants to You a perpetual,\n+      worldwide, non-exclusive, no-charge, royalty-free, irrevocable\n+      copyright license to reproduce, prepare Derivative Works of,\n+      publicly display, publicly perform, sublicense, and distribute the\n+      Work and such Derivative Works in Source or Object form.\n+\n+   3. Grant of Patent License. Subject to the terms and conditions of\n+      this License, each Contributor hereby grants to You a perpetual,\n+      worldwide, non-exclusive, no-charge, royalty-free, irrevocable\n+      (except as stated in this section) patent license to make, have made,\n+      use, offer to sell, sell, import, and otherwise transfer the Work,\n+      where such license applies only to those patent claims licensable\n+      by such Contributor that are necessarily infringed by their\n+      Contribution(s) alone or by combination of their Contribution(s)\n+      with the Work to which such Contribution(s) was submitted. If You\n+      institute patent litigation against any entity (including a\n+      cross-claim or counterclaim in a lawsuit) alleging that the Work\n+      or a Contribution incorporated within the Work constitutes direct\n+      or contributory patent infringement, then any patent licenses\n+      granted to You under this License for that Work shall terminate\n+      as of the date such litigation is filed.\n+\n+   4. Redistribution. You may reproduce and distribute copies of the\n+      Work or Derivative Works thereof in any medium, with or without\n+      modifications, and in Source or Object form, provided that You\n+      meet the following conditions:\n+\n+      (a) You must give any other recipients of the Work or\n+          Derivative Works a copy of this License; and\n+\n+      (b) You must cause any modified files to carry prominent notices\n+          stating that You changed the files; and\n+\n+      (c) You must retain, in the Source form of any Derivative Works\n+          that You distribute, all copyright, patent, trademark, and\n+          attribution notices from the Source form of the Work,\n+          excluding those notices that do not pertain to any part of\n+          the Derivative Works; and\n+\n+      (d) If the Work includes a \"NOTICE\" text file as part of its\n+          distribution, then any Derivative Works that You distribute must\n+          include a readable copy of the attribution notices contained\n+          within such NOTICE file, excluding those notices that do not\n+          pertain to any part of the Derivative Works, in at least one\n+          of the following places: within a NOTICE text file distributed\n+          as part of the Derivative Works; within the Source form or\n+          documentation, if provided along with the Derivative Works; or,\n+          within a display generated by the Derivative Works, if and\n+          wherever such third-party notices normally appear. The contents\n+          of the NOTICE file are for informational purposes only and\n+          do not modify the License. You may add Your own attribution\n+          notices within Derivative Works that You distribute, alongside\n+          or as an addendum to the NOTICE text from the Work, provided\n+          that such additional attribution notices cannot be construed\n+          as modifying the License.\n+\n+      You may add Your own copyright statement to Your modifications and\n+      may provide additional or different license terms and conditions\n+      for use, reproduction, or distribution of Your modifications, or\n+      for any such Derivative Works as a whole, provided Your use,\n+      reproduction, and distribution of the Work otherwise complies with\n+      the conditions stated in this License.\n+\n+   5. Submission of Contributions. Unless You explicitly state otherwise,\n+      any Contribution intentionally submitted for inclusion in the Work\n+      by You to the Licensor shall be under the terms and conditions of\n+      this License, without any additional terms or conditions.\n+      Notwithstanding the above, nothing herein shall supersede or modify\n+      the terms of any separate license agreement you may have executed\n+      with Licensor regarding such Contributions.\n+\n+   6. Trademarks. This License does not grant permission to use the trade\n+      names, trademarks, service marks, or product names of the Licensor,\n+      except as required for reasonable and customary use in describing the\n+      origin of the Work and reproducing the content of the NOTICE file.\n+\n+   7. Disclaimer of Warranty. Unless required by applicable law or\n+      agreed to in writing, Licensor provides the Work (and each\n+      Contributor provides its Contributions) on an \"AS IS\" BASIS,\n+      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or\n+      implied, including, without limitation, any warranties or conditions\n+      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A\n+      PARTICULAR PURPOSE. You are solely responsible for determining the\n+      appropriateness of using or redistributing the Work and assume any\n+      risks associated with Your exercise of permissions under this License.\n+\n+   8. Limitation of Liability. In no event and under no legal theory,\n+      whether in tort (including negligence), contract, or otherwise,\n+      unless required by applicable law (such as deliberate and grossly\n+      negligent acts) or agreed to in writing, shall any Contributor be\n+      liable to You for damages, including any direct, indirect, special,\n+      incidental, or consequential damages of any character arising as a\n+      result of this License or out of the use or inability to use the\n+      Work (including but not limited to damages for loss of goodwill,\n+      work stoppage, computer failure or malfunction, or any and all\n+      other commercial damages or losses), even if such Contributor\n+      has been advised of the possibility of such damages.\n+\n+   9. Accepting Warranty or Additional Liability. While redistributing\n+      the Work or Derivative Works thereof, You may choose to offer,\n+      and charge a fee for, acceptance of support, warranty, indemnity,\n+      or other liability obligations and/or rights consistent with this\n+      License. However, in accepting such obligations, You may act only\n+      on Your own behalf and on Your sole responsibility, not on behalf\n+      of any other Contributor, and only if You agree to indemnify,\n+      defend, and hold each Contributor harmless for any liability\n+      incurred by, or claims asserted against, such Contributor by reason\n+      of your accepting any such warranty or additional liability.\n+\n+   END OF TERMS AND CONDITIONS\n+\n+   APPENDIX: How to apply the Apache License to your work.\n+\n+      To apply the Apache License to your work, attach the following\n+      boilerplate notice, with the fields enclosed by brackets \"[]\"\n+      replaced with your own identifying information. (Don't include\n+      the brackets!)  The text should be enclosed in the appropriate\n+      comment syntax for the file format. We also recommend that a\n+      file or class name and description of purpose be included on the\n+      same \"printed page\" as the copyright notice for easier\n+      identification within third-party archives.\n+\n+   Copyright [yyyy] [name of copyright owner]\n+\n+   Licensed under the Apache License, Version 2.0 (the \"License\");\n+   you may not use this file except in compliance with the License.\n+   You may obtain a copy of the License at\n+\n+       http://www.apache.org/licenses/LICENSE-2.0\n+\n+   Unless required by applicable law or agreed to in writing, software\n+   distributed under the License is distributed on an \"AS IS\" BASIS,\n+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+   See the License for the specific language governing permissions and\n+   limitations under the License."},{"sha":"3db7985a1ba063c2dfb78e829fcd9bfe414a1a30","filename":"docker/wa/NOTICE","status":"added","additions":5,"deletions":0,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fwa%2FNOTICE","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fwa%2FNOTICE","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fwa%2FNOTICE?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,5 @@\n+Apache Syncope\n+Copyright 2012-2019 The Apache Software Foundation\n+\n+This product includes software developed by:\n+The Apache Software Foundation (http://www.apache.org/)."},{"sha":"13721b88f94574ff4cb9713b37db26a575c41036","filename":"docker/wa/pom.xml","status":"added","additions":177,"deletions":0,"changes":177,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fwa%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fwa%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fwa%2Fpom.xml?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,177 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+\n+  <modelVersion>4.0.0</modelVersion>\n+\n+  <parent>\n+    <groupId>org.apache.syncope</groupId>\n+    <artifactId>syncope-docker</artifactId>\n+    <version>3.0.0-SNAPSHOT</version>\n+  </parent>\n+\n+  <name>Apache Syncope Docker WA</name>\n+  <description>Apache Syncope Docker WA</description>\n+  <groupId>org.apache.syncope</groupId>\n+  <artifactId>syncope-docker-wa</artifactId>\n+  <packaging>war</packaging>\n+\n+  <properties>\n+    <guava.version>28.2-jre</guava.version>\n+    <opensaml.version>3.4.5</opensaml.version>\n+    <bootstrap.version>4.4.1</bootstrap.version>\n+    <slf4j.version>2.0.0-alpha1</slf4j.version>\n+\n+    <rootpom.basedir>${basedir}/../..</rootpom.basedir>\n+  </properties>\n+  \n+  <dependencies>\n+    <dependency>\n+      <groupId>org.springframework.boot</groupId>\n+      <artifactId>spring-boot-starter-undertow</artifactId>\n+    </dependency>\n+\n+    <dependency>\n+      <groupId>org.apache.syncope</groupId>\n+      <artifactId>syncope-wa</artifactId>\n+      <version>${project.version}</version>\n+    </dependency>\n+\n+    <dependency>\n+      <groupId>org.apache.syncope.ext.self-keymaster</groupId>\n+      <artifactId>syncope-ext-self-keymaster-client</artifactId>\n+      <version>${project.version}</version>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.apache.syncope.common.keymaster</groupId>\n+      <artifactId>syncope-common-keymaster-client-zookeeper</artifactId>\n+      <version>${project.version}</version>\n+    </dependency>\n+  </dependencies>\n+\n+  <build>\n+    <plugins>\n+      <plugin>\n+        <groupId>org.apache.maven.plugins</groupId>\n+        <artifactId>maven-war-plugin</artifactId>\n+        <inherited>false</inherited>\n+        <configuration>\n+          <webXml>${basedir}/../../fit/wa-reference/src/main/webapp/WEB-INF/web.xml</webXml>\n+          <webResources>\n+            <resource>\n+              <directory>${basedir}</directory>\n+              <targetPath>META-INF</targetPath>\n+              <includes>\n+                <include>LICENSE</include>\n+                <include>NOTICE</include>\n+              </includes>\n+            </resource>\n+          </webResources>\n+          <outputDirectory>${project.build.outputDirectory}</outputDirectory>\n+        </configuration>\n+      </plugin>\n+\n+      <plugin>\n+        <groupId>org.springframework.boot</groupId>\n+        <artifactId>spring-boot-maven-plugin</artifactId>\n+        <configuration>\n+          <mainClass>org.apache.syncope.wa.SyncopeWAApplication</mainClass>\n+          <layout>ZIP</layout>\n+        </configuration>\n+        <executions>\n+          <execution>\n+            <goals>\n+              <goal>repackage</goal>\n+            </goals>\n+            <configuration>\n+              <outputDirectory>${project.build.outputDirectory}</outputDirectory>\n+            </configuration>\n+          </execution>\n+        </executions>\n+      </plugin>\n+\n+      <plugin>\n+        <groupId>io.fabric8</groupId>\n+        <artifactId>docker-maven-plugin</artifactId>\n+        <configuration>\n+          <verbose>true</verbose>\n+          <images>\n+            <image>\n+              <name>apache/syncope-wa:%v</name>\n+              <build>\n+                <dockerFileDir>${project.build.outputDirectory}</dockerFileDir>\n+              </build>\n+            </image>\n+          </images>\n+        </configuration>\n+        <executions>\n+          <execution>\n+            <id>remove-syncope-wa</id>\n+            <phase>initialize</phase>\n+            <goals>\n+              <goal>remove</goal>\n+            </goals>\n+          </execution>\n+          <execution>\n+            <id>build-syncope-wa</id>\n+            <phase>package</phase>\n+            <goals>\n+              <goal>build</goal>\n+            </goals>\n+          </execution>\n+        </executions>\n+      </plugin>\n+    </plugins>\n+    \n+    <resources>\n+      <resource>\n+        <directory>src/main/resources</directory>\n+        <filtering>true</filtering>\n+      </resource>\n+    </resources>\n+  </build>\n+\n+  <profiles>\n+    <profile>\n+      <id>apache-release</id>\n+\n+      <build>\n+        <plugins>      \n+          <plugin>\n+            <groupId>org.apache.maven.plugins</groupId>\n+            <artifactId>maven-deploy-plugin</artifactId>\n+            <configuration>\n+              <skip>true</skip>\n+            </configuration>\n+          </plugin>           \n+          <plugin>\n+            <groupId>org.apache.maven.plugins</groupId>\n+            <artifactId>maven-source-plugin</artifactId>\n+            <inherited>false</inherited>\n+            <configuration>\n+              <skipSource>true</skipSource>\n+            </configuration>\n+          </plugin>\n+        </plugins>\n+      </build>\n+    </profile>\n+  </profiles>\n+\n+</project>"},{"sha":"7edf8dc428dc36808b16953ac4657a05d236a281","filename":"docker/wa/src/main/resources/Dockerfile","status":"added","additions":39,"deletions":0,"changes":39,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fwa%2Fsrc%2Fmain%2Fresources%2FDockerfile","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fwa%2Fsrc%2Fmain%2Fresources%2FDockerfile","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fwa%2Fsrc%2Fmain%2Fresources%2FDockerfile?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,39 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+# Cannot FROM adoptopenjdk/openjdk11-openj9:alpine-slim because it's headless, and fonts might be required\n+FROM openjdk:11\n+MAINTAINER dev@syncope.apache.org\n+\n+RUN set -x\n+\n+RUN mkdir /opt/syncope\n+RUN mkdir /opt/syncope/bin\n+RUN mkdir /opt/syncope/conf\n+RUN mkdir /opt/syncope/lib\n+RUN mkdir /opt/syncope/log\n+\n+COPY *.properties /opt/syncope/conf/\n+COPY log4j2.xml /opt/syncope/conf/\n+\n+COPY syncope-docker-wa-*war /opt/syncope/lib/syncope-wa.war\n+\n+COPY startup.sh /opt/syncope/bin\n+RUN chmod 755 /opt/syncope/bin/startup.sh\n+CMD [\"/opt/syncope/bin/startup.sh\"]\n+\n+EXPOSE 8080"},{"sha":"254b399d18f5b51e164ba77b6d96eea9639609a4","filename":"docker/wa/src/main/resources/application.properties","status":"added","additions":40,"deletions":0,"changes":40,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fwa%2Fsrc%2Fmain%2Fresources%2Fapplication.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fwa%2Fsrc%2Fmain%2Fresources%2Fapplication.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fwa%2Fsrc%2Fmain%2Fresources%2Fapplication.properties?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,40 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+spring.application.name=Apache Syncope ${syncope.version} WA\n+spring.groovy.template.check-template-location=false\n+spring.main.banner-mode=log\n+\n+server.port=8080\n+\n+spring.http.encoding.charset=UTF-8\n+spring.http.encoding.enabled=true\n+spring.http.encoding.force=true\n+\n+server.servlet.contextPath=/syncope-wa\n+\n+##\n+# Allow configuration classes to override bean definitions from Spring Boot\n+#\n+spring.main.allow-bean-definition-overriding=true\n+spring.main.lazy-initialization=false\n+\n+service.discovery.address=${SERVICE_DISCOVERY_ADDRESS}\n+\n+# Conf directories\n+conf.directory=${conf.directory}\n+cas.standalone.configurationDirectory=${conf.directory}\n+cas.authn.oidc.jwksFile=file:${conf.directory}/oidc.keystore"},{"sha":"14e8ca6cf0494f0e8e28d69cdfcd1d39b36603d5","filename":"docker/wa/src/main/resources/keymaster.properties","status":"added","additions":19,"deletions":0,"changes":19,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fwa%2Fsrc%2Fmain%2Fresources%2Fkeymaster.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fwa%2Fsrc%2Fmain%2Fresources%2Fkeymaster.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fwa%2Fsrc%2Fmain%2Fresources%2Fkeymaster.properties?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,19 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+keymaster.address=${KEYMASTER_ADDRESS}\n+keymaster.username=${KEYMASTER_USERNAME}\n+keymaster.password=${KEYMASTER_PASSWORD}"},{"sha":"269180caed1c7b995c2f5f3dd819a59e01a1c29e","filename":"docker/wa/src/main/resources/log4j2.xml","status":"added","additions":59,"deletions":0,"changes":59,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fwa%2Fsrc%2Fmain%2Fresources%2Flog4j2.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fwa%2Fsrc%2Fmain%2Fresources%2Flog4j2.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fwa%2Fsrc%2Fmain%2Fresources%2Flog4j2.xml?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,59 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+<configuration status=\"WARN\">\n+\n+  <appenders>\n+\n+    <Console name=\"console\" target=\"SYSTEM_OUT\" follow=\"true\">\n+      <PatternLayout pattern=\"%d{${LOG_DATEFORMAT_PATTERN:-yyyy-MM-dd HH:mm:ss.SSS}} %highlight{${LOG_LEVEL_PATTERN:-%5p}}{FATAL=red blink, ERROR=red, WARN=yellow bold, INFO=green, DEBUG=green bold, TRACE=blue} [%11.11t] %style{%-60.60c{60}}{cyan} : %m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}\"/>\n+    </Console>\n+    \n+  </appenders>\n+  \n+  <loggers>\n+    \n+    <asyncLogger name=\"org.apereo.cas\" additivity=\"false\" level=\"INFO\">\n+      <appender-ref ref=\"console\"/>\n+    </asyncLogger>\n+    <asyncLogger name=\"org.apereo.inspektr.audit.support\" additivity=\"false\" level=\"INFO\">\n+      <appender-ref ref=\"console\"/>\n+    </asyncLogger>\n+\n+    <asyncLogger name=\"org.springframework\" additivity=\"false\" level=\"INFO\">\n+      <appender-ref ref=\"console\"/>\n+    </asyncLogger>\n+\n+    <asyncLogger name=\"org.apache.syncope.client.lib\" additivity=\"false\" level=\"OFF\">\n+      <appender-ref ref=\"console\"/>\n+    </asyncLogger>\n+    <asyncLogger name=\"org.apache.syncope.wa\" additivity=\"false\" level=\"INFO\">\n+      <appender-ref ref=\"console\"/>\n+    </asyncLogger>\n+\n+    <asyncLogger name=\"org.apache.cxf\" additivity=\"false\" level=\"ERROR\">\n+      <appender-ref ref=\"console\"/>\n+    </asyncLogger>\n+\n+    <root level=\"INFO\">\n+      <appender-ref ref=\"console\"/>\n+    </root>\n+    \n+  </loggers>\n+</configuration>"},{"sha":"68c70da4ac0d9ac68778c09b92974277747f2c62","filename":"docker/wa/src/main/resources/startup.sh","status":"added","additions":22,"deletions":0,"changes":22,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fwa%2Fsrc%2Fmain%2Fresources%2Fstartup.sh","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fwa%2Fsrc%2Fmain%2Fresources%2Fstartup.sh","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fwa%2Fsrc%2Fmain%2Fresources%2Fstartup.sh?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,22 @@\n+#!/bin/sh\n+\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+export LOADER_PATH=\"/opt/syncope/conf,/opt/syncope/lib\"\n+java -Dfile.encoding=UTF-8 -server -Xms1536m -Xmx1536m -XX:NewSize=256m -XX:MaxNewSize=256m \\\n+ -XX:+DisableExplicitGC -Djava.security.egd=file:/dev/./urandom -jar /opt/syncope/lib/syncope-wa.war"},{"sha":"a2080750c4ccf2a88410878e64e1b373f1eff5fc","filename":"docker/wa/src/main/resources/wa.properties","status":"added","additions":25,"deletions":0,"changes":25,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fwa%2Fsrc%2Fmain%2Fresources%2Fwa.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/docker%2Fwa%2Fsrc%2Fmain%2Fresources%2Fwa.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fwa%2Fsrc%2Fmain%2Fresources%2Fwa.properties?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,25 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+anonymousUser=${anonymousUser}\n+anonymousKey=${anonymousKey}\n+\n+useGZIPCompression=true\n+\n+# Conf directories\n+conf.directory=${conf.directory}\n+cas.standalone.configurationDirectory=${conf.directory}\n+cas.authn.oidc.jwksFile=file:${conf.directory}/oidc.keystore"},{"sha":"554cb29d24324629e1aeddf973e5e3b0cc44cd02","filename":"ext/self-keymaster/logic/src/main/java/org/apache/syncope/core/logic/NetworkServiceLogic.java","status":"modified","additions":3,"deletions":3,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/ext%2Fself-keymaster%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FNetworkServiceLogic.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/ext%2Fself-keymaster%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FNetworkServiceLogic.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fself-keymaster%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FNetworkServiceLogic.java?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -43,8 +43,8 @@ public class NetworkServiceLogic extends AbstractTransactionalLogic<EntityTO> {\n     private SelfKeymasterEntityFactory entityFactory;\n \n     private static NetworkService toNetworkService(\n-        final NetworkService.Type serviceType,\n-        final NetworkServiceEntity service) {\n+            final NetworkService.Type serviceType,\n+            final NetworkServiceEntity service) {\n \n         NetworkService ns = new NetworkService();\n         ns.setType(serviceType);\n@@ -84,7 +84,7 @@ public void register(final NetworkService networkService) {\n     public void unregister(final NetworkService networkService) {\n         serviceDAO.findAll(networkService.getType()).stream().\n                 filter(service -> service.getAddress().equals(networkService.getAddress())).\n-                findFirst().ifPresent(service -> serviceDAO.delete(service));\n+                forEach(service -> serviceDAO.delete(service));\n     }\n \n     @Override"},{"sha":"9e4fca432fa105ba41d0506b4e1f06fe3174221d","filename":"fit/console-reference/pom.xml","status":"modified","additions":0,"deletions":5,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/fit%2Fconsole-reference%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/fit%2Fconsole-reference%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fconsole-reference%2Fpom.xml?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -56,11 +56,6 @@ under the License.\n       <artifactId>syncope-ext-self-keymaster-client</artifactId>\n       <version>${project.version}</version>\n     </dependency>\n-    <dependency>\n-      <groupId>org.apache.syncope.common.keymaster</groupId>\n-      <artifactId>syncope-common-keymaster-client-zookeeper</artifactId>\n-      <version>${project.version}</version>\n-    </dependency>\n \n     <dependency>\n       <groupId>org.apache.syncope.ext.flowable</groupId>"},{"sha":"29c34fdc8a4e9d0dd21269f489376f887c090feb","filename":"fit/enduser-reference/pom.xml","status":"modified","additions":0,"deletions":5,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/fit%2Fenduser-reference%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/fit%2Fenduser-reference%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fenduser-reference%2Fpom.xml?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -51,11 +51,6 @@ under the License.\n       <artifactId>syncope-ext-self-keymaster-client</artifactId>\n       <version>${project.version}</version>\n     </dependency>\n-    <dependency>\n-      <groupId>org.apache.syncope.common.keymaster</groupId>\n-      <artifactId>syncope-common-keymaster-client-zookeeper</artifactId>\n-      <version>${project.version}</version>\n-    </dependency>\n     \n     <dependency>\n       <groupId>org.apache.syncope.ext.flowable</groupId>"},{"sha":"30d9912e26aba4666f87bd45d4ae9381ef5457d2","filename":"fit/pom.xml","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/fit%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/fit%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fpom.xml?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -81,6 +81,7 @@ under the License.\n     <module>core-reference</module>\n     <module>console-reference</module>\n     <module>enduser-reference</module>\n+    <module>wa-reference</module>\n   </modules>\n \n </project>"},{"sha":"e0971964005a6417829af8a921b586b9c25581af","filename":"fit/wa-reference/pom.xml","status":"added","additions":322,"deletions":0,"changes":322,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/fit%2Fwa-reference%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/fit%2Fwa-reference%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fwa-reference%2Fpom.xml?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,322 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n+\n+  <modelVersion>4.0.0</modelVersion>\n+\n+  <parent>\n+    <groupId>org.apache.syncope</groupId>\n+    <artifactId>syncope-fit</artifactId>\n+    <version>3.0.0-SNAPSHOT</version>\n+  </parent>\n+\n+  <name>Apache Syncope FIT WA Reference</name>\n+  <description>Apache Syncope FIT WA Reference</description>\n+  <groupId>org.apache.syncope.fit</groupId>\n+  <artifactId>syncope-fit-wa-reference</artifactId>\n+  <packaging>war</packaging>\n+  \n+  <properties>\n+    <guava.version>28.2-jre</guava.version>\n+    <opensaml.version>3.4.5</opensaml.version>\n+    <bootstrap.version>4.4.1</bootstrap.version>\n+    <slf4j.version>2.0.0-alpha1</slf4j.version>\n+\n+    <ianal.skip>true</ianal.skip>\n+\n+    <rootpom.basedir>${basedir}/../..</rootpom.basedir>\n+  </properties>\n+\n+  <dependencies>\n+    <dependency>\n+      <groupId>org.apache.syncope</groupId>\n+      <artifactId>syncope-wa</artifactId>\n+      <version>${project.version}</version>\n+    </dependency>\n+\n+    <dependency>\n+      <groupId>org.apache.syncope.ext.self-keymaster</groupId>\n+      <artifactId>syncope-ext-self-keymaster-client</artifactId>\n+      <version>${project.version}</version>\n+    </dependency>\n+\n+    <!-- TEST -->\n+    <dependency>\n+      <groupId>com.h2database</groupId>\n+      <artifactId>h2</artifactId>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.apache.syncope.fit</groupId>\n+      <artifactId>syncope-fit-build-tools</artifactId>\n+      <version>${project.version}</version>\n+      <type>war</type>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.apache.syncope.fit</groupId>\n+      <artifactId>syncope-fit-core-reference</artifactId>\n+      <version>${project.version}</version>\n+      <type>war</type>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.apache.syncope.fit</groupId>\n+      <artifactId>syncope-fit-console-reference</artifactId>\n+      <version>${project.version}</version>\n+      <type>war</type>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.apache.syncope.fit</groupId>\n+      <artifactId>syncope-fit-enduser-reference</artifactId>\n+      <version>${project.version}</version>\n+      <type>war</type>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.junit.jupiter</groupId>\n+      <artifactId>junit-jupiter</artifactId>\n+      <scope>test</scope>\n+    </dependency>\n+  </dependencies>\n+\n+  <build>\n+    <plugins>\n+      <plugin>\n+        <groupId>org.codehaus.cargo</groupId>\n+        <artifactId>cargo-maven2-plugin</artifactId>\n+        <inherited>true</inherited>\n+        <configuration>\n+          <container>\n+            <containerId>tomcat9x</containerId>\n+            <zipUrlInstaller>\n+              <url>https://repo1.maven.org/maven2/org/apache/tomcat/tomcat/${tomcat.version}/tomcat-${tomcat.version}.zip</url>\n+              <downloadDir>${settings.localRepository}/org/codehaus/cargo/cargo-container-archives</downloadDir>\n+              <extractDir>${project.build.directory}/cargo/extract</extractDir>\n+            </zipUrlInstaller>\n+            <timeout>600000</timeout>\n+            <log>${cargo.log}</log>\n+            <output>${cargo.output}</output>\n+            <dependencies>\n+              <dependency>\n+                <groupId>com.h2database</groupId>\n+                <artifactId>h2</artifactId>\n+              </dependency>\n+            </dependencies>\n+          </container>\n+          <configuration>\n+            <properties>\n+              <cargo.jvmargs>\n+                -Dspring.profiles.active=embedded\n+                -XX:+CMSClassUnloadingEnabled -Xmx1024m -Xms512m</cargo.jvmargs>\n+            </properties>\n+          </configuration>\n+          <deployables>\n+            <deployable>\n+              <groupId>org.apache.syncope.fit</groupId>\n+              <artifactId>syncope-fit-build-tools</artifactId>\n+              <type>war</type>\n+              <properties>\n+                <context>syncope-fit-build-tools</context>\n+              </properties>\n+            </deployable>\n+            <deployable>\n+              <location>${basedir}/../core-reference/target/syncope-fit-core-reference-${project.version}</location>\n+              <pingURL>http://localhost:${cargo.servlet.port}/syncope/index.html</pingURL>\n+              <pingTimeout>${cargo.deployable.ping.timeout}</pingTimeout>\n+              <properties>\n+                <context>syncope</context>\n+              </properties>\n+            </deployable>\n+            <deployable>\n+              <location>${basedir}/../console-reference/target/syncope-fit-console-reference-${project.version}</location>\n+              <properties>\n+                <context>syncope-console</context>\n+              </properties>\n+            </deployable>\n+            <deployable>\n+              <location>${basedir}/../enduser-reference/target/syncope-fit-enduser-reference-${project.version}</location>\n+              <properties>\n+                <context>syncope-enduser</context>\n+              </properties>\n+            </deployable>\n+            <deployable>\n+              <location>${project.build.directory}/${project.build.finalName}</location>\n+              <properties>\n+                <context>syncope-wa</context>\n+              </properties>\n+            </deployable>\n+          </deployables>\n+        </configuration>\n+      </plugin>\n+      \n+      <plugin>\n+        <groupId>org.apache.maven.plugins</groupId>\n+        <artifactId>maven-checkstyle-plugin</artifactId>\n+        <configuration>\n+          <resourceIncludes>src/main/resources/**/*.properties</resourceIncludes>\n+        </configuration>\n+      </plugin>\n+    </plugins>\n+    \n+    <resources>\n+      <resource>\n+        <directory>src/main/resources</directory>\n+        <filtering>true</filtering>\n+      </resource>\n+    </resources>\n+    <testResources>\n+      <testResource>\n+        <directory>src/test/resources</directory>\n+        <filtering>true</filtering>\n+      </testResource>\n+    </testResources>\n+  </build>\n+  \n+  <profiles>\n+    <profile>\n+      <id>skipTests</id>\n+    </profile>\n+\n+    <profile>\n+      <id>debug</id>\n+\n+      <properties>\n+        <skipTests>true</skipTests>\n+      </properties>\n+\n+      <build>\n+        <defaultGoal>clean verify cargo:run</defaultGoal>\n+        \n+        <plugins>\n+          <plugin>\n+            <groupId>org.codehaus.cargo</groupId>\n+            <artifactId>cargo-maven2-plugin</artifactId>\n+            <inherited>true</inherited>\n+            <configuration>\n+              <configuration>\n+                <properties>\n+                  <cargo.jvmargs>\n+                    -Dspring.profiles.active=embedded\n+                    -Dwicket.core.settings.general.configuration-type=development\n+                    -Xdebug -Djaxb.debug=true -Xrunjdwp:transport=dt_socket,address=8000,server=y,suspend=n\n+                    -XX:+CMSClassUnloadingEnabled -XX:+UseG1GC -Xmx1024m -Xms512m</cargo.jvmargs>\n+                </properties>\n+              </configuration>\n+            </configuration>\n+          </plugin>\n+        </plugins>\n+      </build>\n+    </profile>\n+    \n+    <!-- requires JAVA_HOME set to the latest JDK from https://github.com/TravaOpenJDK/trava-jdk-11-dcevm -->\n+    <profile>\n+      <id>hotswap</id>\n+      \n+      <build>\n+        <defaultGoal>clean verify cargo:run</defaultGoal>\n+\n+        <plugins>\n+          <plugin>\n+            <groupId>org.apache.maven.plugins</groupId>\n+            <artifactId>maven-antrun-plugin</artifactId>\n+            <inherited>true</inherited>\n+            <executions>\n+              <execution>\n+                <id>enableHotSwapForCoreAndConsoleAndEnduser</id>\n+                <phase>package</phase>\n+                <configuration>\n+                  <target>                                               \n+                    <copy file=\"${basedir}/../core-reference/target/test-classes/hotswap-agent.properties\"\n+                          tofile=\"${basedir}/../core-reference/target/syncope-fit-core-reference-${project.version}/WEB-INF/classes/hotswap-agent.properties\"\n+                          overwrite=\"true\"/>\n+                    <copy file=\"${basedir}/../console-reference/target/test-classes/hotswap-agent.properties\"\n+                          tofile=\"${basedir}/../console-reference/target/syncope-fit-console-reference-${project.version}/WEB-INF/classes/hotswap-agent.properties\"\n+                          overwrite=\"true\"/>\n+                    <copy file=\"${basedir}/../enduser-reference/target/test-classes/hotswap-agent.properties\"\n+                          tofile=\"${basedir}/../enduser-reference/target/syncope-fit-enduser-reference-${project.version}/WEB-INF/classes/hotswap-agent.properties\"\n+                          overwrite=\"true\"/>\n+                  </target>\n+                </configuration>\n+                <goals>\n+                  <goal>run</goal>\n+                </goals>\n+              </execution>\n+            </executions>\n+          </plugin>\n+\n+          <plugin>\n+            <groupId>org.codehaus.cargo</groupId>\n+            <artifactId>cargo-maven2-plugin</artifactId>\n+            <inherited>true</inherited>\n+            <configuration>\n+              <configuration>\n+                <properties>\n+                  <cargo.jvmargs>\n+                    -Dspring.profiles.active=embedded\n+                    -Dwicket.core.settings.general.configuration-type=development\n+                    -javaagent:${java.home}/lib/hotswap/hotswap-agent.jar=autoHotswap=true,disablePlugin=Spring,disablePlugin=Hibernate,disablePlugin=CxfJAXRS\n+                    -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=8000\n+                    -XX:+CMSClassUnloadingEnabled -XX:+UseConcMarkSweepGC -Xmx1024m -Xms512m</cargo.jvmargs>\n+                </properties>\n+              </configuration>\n+            </configuration>\n+          </plugin>\n+        </plugins>\n+        \n+        <resources>\n+          <resource>\n+            <directory>src/test/resources</directory>\n+            <filtering>true</filtering>\n+            <includes>\n+              <include>hotswap-agent.properties</include>\n+            </includes>\n+          </resource>\n+        </resources>\n+      </build>\n+    </profile>\n+\n+    <profile>\n+      <id>apache-release</id>\n+\n+      <build>\n+        <plugins>\n+          <plugin>\n+            <groupId>org.apache.maven.plugins</groupId>\n+            <artifactId>maven-deploy-plugin</artifactId>\n+            <configuration>\n+              <skip>true</skip>\n+            </configuration>\n+          </plugin>\n+          <plugin>\n+            <groupId>org.apache.maven.plugins</groupId>\n+            <artifactId>maven-source-plugin</artifactId>\n+            <inherited>false</inherited>\n+            <configuration>\n+              <skipSource>true</skipSource>\n+            </configuration>\n+          </plugin>          \n+        </plugins>\n+      </build>\n+    </profile>\n+\n+  </profiles>\n+</project>"},{"sha":"464c8c8b682f9f092c36fc53aeb42701dd737e3f","filename":"fit/wa-reference/src/main/resources/application-embedded.properties","status":"added","additions":18,"deletions":0,"changes":18,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/fit%2Fwa-reference%2Fsrc%2Fmain%2Fresources%2Fapplication-embedded.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/fit%2Fwa-reference%2Fsrc%2Fmain%2Fresources%2Fapplication-embedded.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fwa-reference%2Fsrc%2Fmain%2Fresources%2Fapplication-embedded.properties?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,18 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+spring.main.banner-mode=console\n+service.discovery.address=http://localhost:9080/syncope-wa/"},{"sha":"033fe3b8cdc122c28c9d2c96c62b4aaeab664fc4","filename":"fit/wa-reference/src/main/resources/keymaster.properties","status":"added","additions":19,"deletions":0,"changes":19,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/fit%2Fwa-reference%2Fsrc%2Fmain%2Fresources%2Fkeymaster.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/fit%2Fwa-reference%2Fsrc%2Fmain%2Fresources%2Fkeymaster.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fwa-reference%2Fsrc%2Fmain%2Fresources%2Fkeymaster.properties?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,19 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+keymaster.address=http://localhost:9080/syncope/rest/keymaster\n+keymaster.username=${anonymousUser}\n+keymaster.password=${anonymousKey}"},{"sha":"e184c60611b007e091e752af12931c315c47f050","filename":"fit/wa-reference/src/main/resources/log4j2.xml","status":"added","additions":68,"deletions":0,"changes":68,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/fit%2Fwa-reference%2Fsrc%2Fmain%2Fresources%2Flog4j2.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/fit%2Fwa-reference%2Fsrc%2Fmain%2Fresources%2Flog4j2.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fwa-reference%2Fsrc%2Fmain%2Fresources%2Flog4j2.xml?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,68 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+<configuration status=\"WARN\">\n+\n+  <appenders>\n+\n+    <RollingRandomAccessFile name=\"main\" fileName=\"${log.directory}/wa.log\"\n+                             filePattern=\"${log.directory}/wa-%d{yyyy-MM-dd}.log.gz\"\n+                             immediateFlush=\"false\" append=\"true\">\n+      <PatternLayout>\n+        <pattern>%d{HH:mm:ss.SSS} %-5level %logger - %msg%n</pattern>\n+      </PatternLayout>\n+      <Policies>\n+        <TimeBasedTriggeringPolicy/>\n+        <SizeBasedTriggeringPolicy size=\"250 MB\"/>\n+      </Policies>\n+    </RollingRandomAccessFile>\n+\n+  </appenders>\n+\n+  <loggers>\n+\n+    <asyncLogger name=\"org.apereo.cas\" additivity=\"false\" level=\"INFO\">\n+      <appender-ref ref=\"main\"/>\n+    </asyncLogger>\n+    <asyncLogger name=\"org.apereo.inspektr.audit.support\" additivity=\"false\" level=\"INFO\">\n+      <appender-ref ref=\"main\"/>\n+    </asyncLogger>\n+\n+    <asyncLogger name=\"org.springframework\" additivity=\"false\" level=\"INFO\">\n+      <appender-ref ref=\"main\"/>\n+    </asyncLogger>\n+\n+    <asyncLogger name=\"org.apache.syncope.client.lib\" additivity=\"false\" level=\"OFF\">\n+      <appender-ref ref=\"main\"/>\n+    </asyncLogger>\n+    <asyncLogger name=\"org.apache.syncope.wa\" additivity=\"false\" level=\"INFO\">\n+      <appender-ref ref=\"main\"/>\n+    </asyncLogger>\n+\n+    <asyncLogger name=\"org.apache.cxf\" additivity=\"false\" level=\"ERROR\">\n+      <appender-ref ref=\"main\"/>\n+    </asyncLogger>\n+\n+    <root level=\"INFO\">\n+      <appender-ref ref=\"main\"/>\n+    </root>\n+  \n+  </loggers>\n+  \n+</configuration>"},{"sha":"a2080750c4ccf2a88410878e64e1b373f1eff5fc","filename":"fit/wa-reference/src/main/resources/wa.properties","status":"added","additions":25,"deletions":0,"changes":25,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/fit%2Fwa-reference%2Fsrc%2Fmain%2Fresources%2Fwa.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/fit%2Fwa-reference%2Fsrc%2Fmain%2Fresources%2Fwa.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fwa-reference%2Fsrc%2Fmain%2Fresources%2Fwa.properties?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,25 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+anonymousUser=${anonymousUser}\n+anonymousKey=${anonymousKey}\n+\n+useGZIPCompression=true\n+\n+# Conf directories\n+conf.directory=${conf.directory}\n+cas.standalone.configurationDirectory=${conf.directory}\n+cas.authn.oidc.jwksFile=file:${conf.directory}/oidc.keystore"},{"sha":"34b536ebb4afd581990025bec668929f40d682d2","filename":"fit/wa-reference/src/main/webapp/WEB-INF/web.xml","status":"added","additions":29,"deletions":0,"changes":29,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/fit%2Fwa-reference%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/fit%2Fwa-reference%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fwa-reference%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,29 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+<web-app xmlns=\"http://xmlns.jcp.org/xml/ns/javaee\"\n+         xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n+         xsi:schemaLocation=\"http://xmlns.jcp.org/xml/ns/javaee\n+                             http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd\"\n+         version=\"4.0\"\n+         metadata-complete=\"true\">\n+\n+  <display-name>Apache Syncope ${syncope.version} WA</display-name>\n+\n+</web-app>"},{"sha":"d0bf167c4f454242e6b5a1008ad5ecb31016a3db","filename":"fit/wa-reference/src/test/resources/hotswap-agent.properties","status":"added","additions":23,"deletions":0,"changes":23,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/fit%2Fwa-reference%2Fsrc%2Ftest%2Fresources%2Fhotswap-agent.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/fit%2Fwa-reference%2Fsrc%2Ftest%2Fresources%2Fhotswap-agent.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fwa-reference%2Fsrc%2Ftest%2Fresources%2Fhotswap-agent.properties?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,23 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+\n+LOGGER=error\n+\n+autoHotswap=true\n+\n+extraClasspath=\\\n+${basedir}/../../wa/target/classes/org"},{"sha":"6644b0edaa3391d954763926a613a5beac8c02e6","filename":"sra/pom.xml","status":"modified","additions":6,"deletions":0,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/sra%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/sra%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/sra%2Fpom.xml?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -166,6 +166,7 @@ under the License.\n         <directory>src/main/resources</directory>\n         <filtering>true</filtering>\n       </resource>\n+\n       <resource>\n         <directory>${basedir}/../src/main/resources</directory>\n         <filtering>true</filtering>\n@@ -208,6 +209,11 @@ under the License.\n           <artifactId>cxf-rt-transports-http-netty-server</artifactId>\n           <scope>compile</scope>\n         </dependency>\n+\n+        <dependency>\n+          <groupId>org.springframework.boot</groupId>\n+          <artifactId>spring-boot-devtools</artifactId>\n+        </dependency>\n       </dependencies>\n \n       <build>"},{"sha":"3f56eb430d238a2d3a0da475e77238225bbd2708","filename":"sra/src/main/java/org/apache/syncope/sra/SyncopeSRAApplication.java","status":"modified","additions":13,"deletions":0,"changes":13,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/sra%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fsra%2FSyncopeSRAApplication.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/sra%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fsra%2FSyncopeSRAApplication.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/sra%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fsra%2FSyncopeSRAApplication.java?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -19,6 +19,9 @@\n package org.apache.syncope.sra;\n \n import java.util.Objects;\n+import org.apache.syncope.common.keymaster.client.api.model.NetworkService;\n+import org.apache.syncope.common.keymaster.client.api.startstop.KeymasterStart;\n+import org.apache.syncope.common.keymaster.client.api.startstop.KeymasterStop;\n import org.apache.syncope.common.lib.types.IdRepoEntitlement;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.boot.SpringApplication;\n@@ -61,6 +64,16 @@ public void setEnvironment(final Environment env) {\n         this.env = env;\n     }\n \n+    @Bean\n+    public KeymasterStart keymasterStart() {\n+        return new KeymasterStart(NetworkService.Type.SRA);\n+    }\n+\n+    @Bean\n+    public KeymasterStop keymasterStop() {\n+        return new KeymasterStop(NetworkService.Type.SRA);\n+    }\n+\n     @Bean\n     public RouteLocator routes(final RouteLocatorBuilder builder) {\n         return () -> Flux.fromIterable(provider.fetch()).map(Route.AbstractBuilder::build);"},{"sha":"4ed772c67f70dbff010b55aed39bcd48eb3993e5","filename":"sra/src/main/java/org/apache/syncope/sra/SyncopeSRAShutdown.java","status":"removed","additions":0,"deletions":33,"changes":33,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/6381e9a7dec270b587924dee070a4aebd26d5617/sra%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fsra%2FSyncopeSRAShutdown.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/6381e9a7dec270b587924dee070a4aebd26d5617/sra%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fsra%2FSyncopeSRAShutdown.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/sra%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fsra%2FSyncopeSRAShutdown.java?ref=6381e9a7dec270b587924dee070a4aebd26d5617","patch":"@@ -1,33 +0,0 @@\n-/*\n- * Licensed to the Apache Software Foundation (ASF) under one\n- * or more contributor license agreements.  See the NOTICE file\n- * distributed with this work for additional information\n- * regarding copyright ownership.  The ASF licenses this file\n- * to you under the Apache License, Version 2.0 (the\n- * \"License\"); you may not use this file except in compliance\n- * with the License.  You may obtain a copy of the License at\n- *\n- *   http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing,\n- * software distributed under the License is distributed on an\n- * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n- * KIND, either express or implied.  See the License for the\n- * specific language governing permissions and limitations\n- * under the License.\n- */\n-package org.apache.syncope.sra;\n-\n-import org.springframework.context.ApplicationListener;\n-import org.springframework.context.event.ContextClosedEvent;\n-import org.springframework.stereotype.Component;\n-\n-@Component\n-public class SyncopeSRAShutdown extends SyncopeSRAStartStop\n-        implements ApplicationListener<ContextClosedEvent> {\n-\n-    @Override\n-    public void onApplicationEvent(final ContextClosedEvent event) {\n-        serviceOps.unregister(getNetworkService());\n-    }\n-}"},{"sha":"926a6083abc96e90f4afbe7f400aaf020ac30dd6","filename":"sra/src/main/java/org/apache/syncope/sra/SyncopeSRAStartStop.java","status":"removed","additions":0,"deletions":40,"changes":40,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/6381e9a7dec270b587924dee070a4aebd26d5617/sra%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fsra%2FSyncopeSRAStartStop.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/6381e9a7dec270b587924dee070a4aebd26d5617/sra%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fsra%2FSyncopeSRAStartStop.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/sra%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fsra%2FSyncopeSRAStartStop.java?ref=6381e9a7dec270b587924dee070a4aebd26d5617","patch":"@@ -1,40 +0,0 @@\n-/*\n- * Licensed to the Apache Software Foundation (ASF) under one\n- * or more contributor license agreements.  See the NOTICE file\n- * distributed with this work for additional information\n- * regarding copyright ownership.  The ASF licenses this file\n- * to you under the Apache License, Version 2.0 (the\n- * \"License\"); you may not use this file except in compliance\n- * with the License.  You may obtain a copy of the License at\n- *\n- *   http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing,\n- * software distributed under the License is distributed on an\n- * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n- * KIND, either express or implied.  See the License for the\n- * specific language governing permissions and limitations\n- * under the License.\n- */\n-package org.apache.syncope.sra;\n-\n-import org.apache.syncope.common.keymaster.client.api.ServiceOps;\n-import org.apache.syncope.common.keymaster.client.api.model.NetworkService;\n-import org.springframework.beans.factory.annotation.Autowired;\n-import org.springframework.beans.factory.annotation.Value;\n-\n-abstract class SyncopeSRAStartStop {\n-\n-    @Autowired\n-    protected ServiceOps serviceOps;\n-\n-    @Value(\"${service.discovery.address}\")\n-    private String address;\n-\n-    protected NetworkService getNetworkService() {\n-        NetworkService ns = new NetworkService();\n-        ns.setType(NetworkService.Type.SRA);\n-        ns.setAddress(address);\n-        return ns;\n-    }\n-}"},{"sha":"45d71fd653f457e8a12bd69cc1186e348e3d08d1","filename":"standalone/pom.xml","status":"modified","additions":48,"deletions":27,"changes":75,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/standalone%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/standalone%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/standalone%2Fpom.xml?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -73,6 +73,13 @@ under the License.\n       <type>war</type>\n       <scope>test</scope>\n     </dependency>\n+    <dependency>\n+      <groupId>org.apache.syncope.fit</groupId>\n+      <artifactId>syncope-fit-wa-reference</artifactId>\n+      <version>${project.version}</version>\n+      <type>war</type>\n+      <scope>test</scope>\n+    </dependency>\n   </dependencies>\n \n   <build>\n@@ -116,68 +123,76 @@ under the License.\n             <phase>verify</phase>\n             <configuration>\n               <target>\n-                <mkdir dir=\"${work.dir}\" />\n+                <mkdir dir=\"${work.dir}\"/>\n \n                 <!-- legal stuff -->\n-                <copy file=\"${project.build.outputDirectory}/README\" todir=\"${work.dir}\" />\n-                <copy file=\"LICENSE\" todir=\"${work.dir}\" />\n-                <copy file=\"NOTICE\" todir=\"${work.dir}\" />\n+                <copy file=\"${project.build.outputDirectory}/README\" todir=\"${work.dir}\"/>\n+                <copy file=\"LICENSE\" todir=\"${work.dir}\"/>\n+                <copy file=\"NOTICE\" todir=\"${work.dir}\"/>\n \n                 <!-- Unzip Tomcat and remove docs and examples from webapps (space saving) -->\n-                <unzip src=\"${settings.localRepository}/org/codehaus/cargo/cargo-container-archives/tomcat-${tomcat.version}.zip\" dest=\"${work.dir}\" />\n-                <delete dir=\"${work.dir}/apache-tomcat-${tomcat.version}/webapps/docs\" />\n-                <delete dir=\"${work.dir}/apache-tomcat-${tomcat.version}/webapps/examples\" />\n+                <unzip src=\"${settings.localRepository}/org/codehaus/cargo/cargo-container-archives/tomcat-${tomcat.version}.zip\" dest=\"${work.dir}\"/>\n+                <delete dir=\"${work.dir}/apache-tomcat-${tomcat.version}/webapps/docs\"/>\n+                <delete dir=\"${work.dir}/apache-tomcat-${tomcat.version}/webapps/examples\"/>\n \n                 <!-- Syncope core -->\n                 <copy todir=\"${work.dir}/apache-tomcat-${tomcat.version}/webapps/syncope\">\n-                  <fileset dir=\"../fit/core-reference/target/syncope-fit-core-reference-${project.version}\" includes=\"**/*\" />\n+                  <fileset dir=\"../fit/core-reference/target/syncope-fit-core-reference-${project.version}\" includes=\"**/*\"/>\n                 </copy>\n                 <copy todir=\"${work.dir}/apache-tomcat-${tomcat.version}/webapps/syncope/WEB-INF/classes\" overwrite=\"true\">\n-                  <fileset dir=\"${project.build.outputDirectory}/core\" />\n+                  <fileset dir=\"${project.build.outputDirectory}/core\"/>\n                 </copy>\n-                <copy file=\"../fit/core-reference/target/test-classes/keystore\" todir=\"${work.dir}/apache-tomcat-${tomcat.version}/webapps/syncope/WEB-INF/classes\" overwrite=\"true\" />\n+                <copy file=\"../fit/core-reference/target/test-classes/keystore\" todir=\"${work.dir}/apache-tomcat-${tomcat.version}/webapps/syncope/WEB-INF/classes\" overwrite=\"true\"/>\n \n                 <!-- Syncope console -->\n                 <copy todir=\"${work.dir}/apache-tomcat-${tomcat.version}/webapps/syncope-console\">\n-                  <fileset dir=\"../fit/console-reference/target/syncope-fit-console-reference-${project.version}\" includes=\"**/*\" />\n+                  <fileset dir=\"../fit/console-reference/target/syncope-fit-console-reference-${project.version}\" includes=\"**/*\"/>\n                 </copy>\n                 <copy todir=\"${work.dir}/apache-tomcat-${tomcat.version}/webapps/syncope-console/WEB-INF/classes\" overwrite=\"true\">\n-                  <fileset dir=\"${project.build.outputDirectory}/console\" />\n+                  <fileset dir=\"${project.build.outputDirectory}/console\"/>\n                 </copy>\n \n                 <!-- Syncope enduser -->\n                 <copy todir=\"${work.dir}/apache-tomcat-${tomcat.version}/webapps/syncope-enduser\">\n-                  <fileset dir=\"../fit/enduser-reference/target/syncope-fit-enduser-reference-${project.version}\" includes=\"**/*\" />\n+                  <fileset dir=\"../fit/enduser-reference/target/syncope-fit-enduser-reference-${project.version}\" includes=\"**/*\"/>\n                 </copy>\n                 <copy todir=\"${work.dir}/apache-tomcat-${tomcat.version}/webapps/syncope-enduser/WEB-INF/classes\" overwrite=\"true\">\n-                  <fileset dir=\"${project.build.outputDirectory}/enduser\" />\n+                  <fileset dir=\"${project.build.outputDirectory}/enduser\"/>\n+                </copy>f\n+\n+                <!-- Syncope wa -->\n+                <copy todir=\"${work.dir}/apache-tomcat-${tomcat.version}/webapps/syncope-wa\">\n+                  <fileset dir=\"../fit/wa-reference/target/syncope-fit-wa-reference-${project.version}\" includes=\"**/*\"/>\n+                </copy>\n+                <copy todir=\"${work.dir}/apache-tomcat-${tomcat.version}/webapps/syncope-wa/WEB-INF/classes\" overwrite=\"true\">\n+                  <fileset dir=\"${project.build.outputDirectory}/wa\"/>\n                 </copy>\n \n-                <mkdir dir=\"${work.dir}/apache-tomcat-${tomcat.version}/${test.csvdir.path}\" />\n-                <copy file=\"../fit/core-reference/src/test/resources/test.csv\" todir=\"${work.dir}/apache-tomcat-${tomcat.version}/${test.csvdir.path}\" />\n+                <mkdir dir=\"${work.dir}/apache-tomcat-${tomcat.version}/${test.csvdir.path}\"/>\n+                <copy file=\"../fit/core-reference/src/test/resources/test.csv\" todir=\"${work.dir}/apache-tomcat-${tomcat.version}/${test.csvdir.path}\"/>\n \n                 <!-- Syncope build tools (provide H2, Apache DS and REST / SOAP resources + ConnId connector server) -->\n                 <copy todir=\"${work.dir}/apache-tomcat-${tomcat.version}/webapps/syncope-fit-build-tools\">\n-                  <fileset dir=\"../fit/build-tools/target/syncope-fit-build-tools-${project.version}\" includes=\"**/*\" />\n+                  <fileset dir=\"../fit/build-tools/target/syncope-fit-build-tools-${project.version}\" includes=\"**/*\"/>\n                 </copy>\n                 <copy todir=\"${work.dir}/apache-tomcat-${tomcat.version}/webapps/syncope-fit-build-tools/WEB-INF/lib\">\n-                  <fileset dir=\"../fit/core-reference/target/bundles/\" includes=\"**/*\" />\n+                  <fileset dir=\"../fit/core-reference/target/bundles/\" includes=\"**/*\"/>\n                 </copy>\n \n                 <!-- Tomcat shared libraries: H2, StAX2 API, Woodstox -->\n-                <copy file=\"${settings.localRepository}/com/h2database/h2/${h2.version}/h2-${h2.version}.jar\" todir=\"${work.dir}/apache-tomcat-${tomcat.version}/lib\" />\n+                <copy file=\"${settings.localRepository}/com/h2database/h2/${h2.version}/h2-${h2.version}.jar\" todir=\"${work.dir}/apache-tomcat-${tomcat.version}/lib\"/>\n                 <copy todir=\"${work.dir}/apache-tomcat-${tomcat.version}/lib\">\n-                  <fileset dir=\"${work.dir}/apache-tomcat-${tomcat.version}/webapps/syncope/WEB-INF/lib\" includes=\"stax2-api-*.jar\" />\n-                  <fileset dir=\"${work.dir}/apache-tomcat-${tomcat.version}/webapps/syncope/WEB-INF/lib\" includes=\"woodstox-core-asl-*.jar\" />\n+                  <fileset dir=\"${work.dir}/apache-tomcat-${tomcat.version}/webapps/syncope/WEB-INF/lib\" includes=\"stax2-api-*.jar\"/>\n+                  <fileset dir=\"${work.dir}/apache-tomcat-${tomcat.version}/webapps/syncope/WEB-INF/lib\" includes=\"woodstox-core-asl-*.jar\"/>\n                 </copy>\n \n                 <!-- Other custom Tomcat resources -->\n-                <copy file=\"${project.build.outputDirectory}/context.xml\" todir=\"${work.dir}/apache-tomcat-${tomcat.version}/conf\" overwrite=\"true\" />\n-                <copy file=\"src/main/resources/setenv.sh\" todir=\"${work.dir}/apache-tomcat-${tomcat.version}/bin\" />\n-                <copy file=\"src/main/resources/setenv.bat\" todir=\"${work.dir}/apache-tomcat-${tomcat.version}/bin\" />\n-                <replace file=\"${work.dir}/apache-tomcat-${tomcat.version}/conf/server.xml\" token=\"8080\" value=\"${cargo.servlet.port}\" />\n-                <replace file=\"${work.dir}/apache-tomcat-${tomcat.version}/conf/server.xml\" token=\"8009\" value=\"${cargo.tomcat.ajp.port}\" />\n-                <replace file=\"${work.dir}/apache-tomcat-${tomcat.version}/conf/server.xml\" token=\"8005\" value=\"${cargo.rmi.port}\" />\n+                <copy file=\"${project.build.outputDirectory}/context.xml\" todir=\"${work.dir}/apache-tomcat-${tomcat.version}/conf\" overwrite=\"true\"/>\n+                <copy file=\"src/main/resources/setenv.sh\" todir=\"${work.dir}/apache-tomcat-${tomcat.version}/bin\"/>\n+                <copy file=\"src/main/resources/setenv.bat\" todir=\"${work.dir}/apache-tomcat-${tomcat.version}/bin\"/>\n+                <replace file=\"${work.dir}/apache-tomcat-${tomcat.version}/conf/server.xml\" token=\"8080\" value=\"${cargo.servlet.port}\"/>\n+                <replace file=\"${work.dir}/apache-tomcat-${tomcat.version}/conf/server.xml\" token=\"8009\" value=\"${cargo.tomcat.ajp.port}\"/>\n+                <replace file=\"${work.dir}/apache-tomcat-${tomcat.version}/conf/server.xml\" token=\"8005\" value=\"${cargo.rmi.port}\"/>\n               </target>\n             </configuration>\n           </execution>\n@@ -275,6 +290,12 @@ under the License.\n         <filtering>true</filtering>\n       </resource>\n \n+      <resource>\n+        <directory>../fit/wa-reference/src/main/resources</directory>\n+        <targetPath>wa</targetPath>\n+        <filtering>true</filtering>\n+      </resource>\n+\n       <resource>\n         <directory>src/main/resources</directory>\n       </resource>"},{"sha":"13d69aade615941c9a095f0fd32cdd3b642b5f3c","filename":"wa/pom.xml","status":"modified","additions":123,"deletions":10,"changes":133,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/wa%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/wa%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fpom.xml?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -42,6 +42,18 @@ under the License.\n   </properties>\n \n   <dependencies>\n+    <dependency>\n+      <groupId>org.apache.syncope.common.keymaster</groupId>\n+      <artifactId>syncope-common-keymaster-client-api</artifactId>\n+      <version>${project.version}</version>\n+    </dependency>\n+\n+    <dependency>\n+      <groupId>org.apache.syncope.client.am</groupId>\n+      <artifactId>syncope-client-am-lib</artifactId>\n+      <version>${project.version}</version>\n+    </dependency>\n+\n     <dependency>\n       <groupId>org.glassfish</groupId>\n       <artifactId>javax.el</artifactId>\n@@ -174,16 +186,31 @@ under the License.\n       <artifactId>spring-boot-starter-security</artifactId>\n     </dependency>\n \n+    <dependency>\n+      <groupId>org.apache.syncope.common.keymaster</groupId>\n+      <artifactId>syncope-common-keymaster-client-zookeeper</artifactId>\n+      <version>${project.version}</version>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.apache.curator</groupId>\n+      <artifactId>curator-test</artifactId>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.springframework.boot</groupId>\n+      <artifactId>spring-boot-starter-tomcat</artifactId>\n+      <scope>test</scope>      \n+    </dependency>\n     <dependency>\n       <groupId>org.springframework.boot</groupId>\n       <artifactId>spring-boot-starter-test</artifactId>\n       <scope>test</scope>\n-      <exclusions>\n-        <exclusion>\n-          <groupId>org.junit.vintage</groupId>\n-          <artifactId>junit-vintage-engine</artifactId>\n-        </exclusion>\n-      </exclusions>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.junit.jupiter</groupId>\n+      <artifactId>junit-jupiter</artifactId>\n+      <scope>test</scope>\n     </dependency>\n   </dependencies>\n \n@@ -209,23 +236,104 @@ under the License.\n         </includes>\n       </resource>\n     </resources>\n+\n+    <testResources>\n+      <testResource>\n+        <directory>${basedir}/src/test/resources</directory>\n+        <filtering>true</filtering>\n+      </testResource>\n+    </testResources>\n   </build>\n \n   <profiles>\n     <profile>\n       <id>debug</id>\n \n+      <properties>\n+        <skipTests>true</skipTests>\n+      </properties>\n+\n       <dependencies>\n+        <dependency>\n+          <groupId>org.springframework.boot</groupId>\n+          <artifactId>spring-boot-starter-undertow</artifactId>\n+        </dependency>\n+\n+        <dependency>\n+          <groupId>org.apache.syncope.common.keymaster</groupId>\n+          <artifactId>syncope-common-keymaster-client-zookeeper</artifactId>\n+          <version>${project.version}</version>\n+          <scope>compile</scope>\n+        </dependency>\n+        <dependency>\n+          <groupId>org.apache.curator</groupId>\n+          <artifactId>curator-test</artifactId>\n+          <scope>compile</scope>\n+        </dependency>\n+\n         <dependency>\n           <groupId>org.springframework.boot</groupId>\n           <artifactId>spring-boot-devtools</artifactId>\n         </dependency>\n       </dependencies>\n \n       <build>\n-        <defaultGoal>clean package spring-boot:run</defaultGoal>\n+        <defaultGoal>clean package io.fabric8:docker-maven-plugin:start spring-boot:run</defaultGoal>\n \n         <plugins>\n+          <plugin>\n+            <groupId>io.fabric8</groupId>\n+            <artifactId>docker-maven-plugin</artifactId>\n+            <configuration>\n+              <images>\n+                <image>\n+                  <name>zookeeper:${zookeeper.version}</name>\n+                  <run>\n+                    <ports>\n+                      <port>2181:2181</port>\n+                    </ports>\n+                    <volumes>\n+                      <bind>\n+                        <volume>${project.build.testOutputDirectory}/zoo.cfg:/conf/zoo.cfg</volume>\n+                        <volume>${project.build.testOutputDirectory}/java.env:/conf/java.env</volume>\n+                        <volume>${project.build.testOutputDirectory}/server-jaas.conf:/conf/server-jaas.conf</volume>\n+                        <volume>${project.build.testOutputDirectory}/client-jaas.conf:/conf/client-jaas.conf</volume>\n+                      </bind>\n+                    </volumes>\n+                  </run>\n+                </image>\n+              </images>\n+            </configuration>\n+          </plugin>\n+\n+          <plugin>\n+            <groupId>org.codehaus.mojo</groupId>\n+            <artifactId>build-helper-maven-plugin</artifactId>\n+            <executions>\n+              <execution>\n+                <goals>\n+                  <goal>add-source</goal>\n+                </goals>\n+                <configuration>\n+                  <sources>\n+                    <source>${basedir}/src/test/java</source>\n+                  </sources>\n+                </configuration>\n+              </execution>\n+            </executions>\n+          </plugin>\n+\n+          <plugin>\n+            <groupId>org.apache.maven.plugins</groupId>\n+            <artifactId>maven-compiler-plugin</artifactId>\n+            <configuration>\n+              <excludes>\n+                <exclude>**/org/apache/syncope/wa/**Test.java</exclude>\n+                <exclude>**/org/apache/syncope/wa/**Zookeeper*.java</exclude>\n+              </excludes>\n+            </configuration>\n+          </plugin>\n+\n           <plugin>\n             <groupId>org.springframework.boot</groupId>\n             <artifactId>spring-boot-maven-plugin</artifactId>\n@@ -244,11 +352,16 @@ under the License.\n         <resources>\n           <resource>\n             <directory>${basedir}/src/test/resources</directory>\n-            <includes>\n-              <include>application-debug.properties</include>\n-            </includes>\n+            <filtering>true</filtering>\n           </resource>\n         </resources>\n+\n+        <testResources>\n+          <testResource>\n+            <directory>${basedir}/../common/keymaster/client-zookeeper/src/main/resources</directory>\n+            <filtering>true</filtering>\n+          </testResource>\n+        </testResources>\n       </build>\n     </profile>\n "},{"sha":"16d985d20241460acf20b300f7fc48ab942afe53","filename":"wa/src/main/java/org/apache/syncope/wa/SyncopeWAApplication.java","status":"modified","additions":17,"deletions":0,"changes":17,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/wa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2FSyncopeWAApplication.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/wa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2FSyncopeWAApplication.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2FSyncopeWAApplication.java?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -19,6 +19,9 @@\n package org.apache.syncope.wa;\n \n import org.apache.commons.lang.StringUtils;\n+import org.apache.syncope.common.keymaster.client.api.model.NetworkService;\n+import org.apache.syncope.common.keymaster.client.api.startstop.KeymasterStart;\n+import org.apache.syncope.common.keymaster.client.api.startstop.KeymasterStop;\n import org.apereo.cas.configuration.CasConfigurationProperties;\n import org.apereo.cas.util.AsciiArtUtils;\n import org.apereo.cas.util.DateTimeUtils;\n@@ -41,12 +44,16 @@\n import org.springframework.boot.context.event.ApplicationReadyEvent;\n import org.springframework.boot.context.properties.EnableConfigurationProperties;\n import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;\n+import org.springframework.context.annotation.Bean;\n import org.springframework.context.annotation.EnableAspectJAutoProxy;\n+import org.springframework.context.annotation.PropertySource;\n import org.springframework.context.event.EventListener;\n import org.springframework.scheduling.annotation.EnableAsync;\n import org.springframework.scheduling.annotation.EnableScheduling;\n import org.springframework.transaction.annotation.EnableTransactionManagement;\n \n+@PropertySource(\"classpath:wa.properties\")\n+@PropertySource(value = \"file:${conf.directory}/wa.properties\", ignoreResourceNotFound = true)\n @SpringBootApplication(exclude = {\n     HibernateJpaAutoConfiguration.class,\n     JerseyAutoConfiguration.class,\n@@ -84,4 +91,14 @@ public void handleApplicationReadyEvent(final ApplicationReadyEvent event) {\n         AsciiArtUtils.printAsciiArtReady(LOG, StringUtils.EMPTY);\n         LOG.info(\"Ready to process requests @ [{}]\", DateTimeUtils.zonedDateTimeOf(event.getTimestamp()));\n     }\n+\n+    @Bean\n+    public KeymasterStart keymasterStart() {\n+        return new KeymasterStart(NetworkService.Type.WA);\n+    }\n+\n+    @Bean\n+    public KeymasterStop keymasterStop() {\n+        return new KeymasterStop(NetworkService.Type.WA);\n+    }\n }"},{"sha":"53ae4b096332214687ad633e06bdfe6f0ec9613a","filename":"wa/src/main/resources/application.properties","status":"modified","additions":3,"deletions":5,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/wa%2Fsrc%2Fmain%2Fresources%2Fapplication.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/wa%2Fsrc%2Fmain%2Fresources%2Fapplication.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fsrc%2Fmain%2Fresources%2Fapplication.properties?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -26,15 +26,13 @@ spring.http.encoding.force=true\n \n server.servlet.contextPath=/syncope-wa\n \n+management.endpoints.web.exposure.include=health,loggers\n+management.endpoint.health.show-details=always\n+\n ##\n # Allow configuration classes to override bean definitions from Spring Boot\n #\n spring.main.allow-bean-definition-overriding=true\n spring.main.lazy-initialization=false\n \n service.discovery.address=http://localhost:8080/syncope-wa/\n-\n-# Conf directories\n-conf.directory=${conf.directory}\n-cas.standalone.configurationDirectory=${conf.directory}\n-cas.authn.oidc.jwksFile=file:${conf.directory}/oidc.keystore"},{"sha":"e184c60611b007e091e752af12931c315c47f050","filename":"wa/src/main/resources/log4j2.xml","status":"added","additions":68,"deletions":0,"changes":68,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/wa%2Fsrc%2Fmain%2Fresources%2Flog4j2.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/wa%2Fsrc%2Fmain%2Fresources%2Flog4j2.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fsrc%2Fmain%2Fresources%2Flog4j2.xml?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,68 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+<configuration status=\"WARN\">\n+\n+  <appenders>\n+\n+    <RollingRandomAccessFile name=\"main\" fileName=\"${log.directory}/wa.log\"\n+                             filePattern=\"${log.directory}/wa-%d{yyyy-MM-dd}.log.gz\"\n+                             immediateFlush=\"false\" append=\"true\">\n+      <PatternLayout>\n+        <pattern>%d{HH:mm:ss.SSS} %-5level %logger - %msg%n</pattern>\n+      </PatternLayout>\n+      <Policies>\n+        <TimeBasedTriggeringPolicy/>\n+        <SizeBasedTriggeringPolicy size=\"250 MB\"/>\n+      </Policies>\n+    </RollingRandomAccessFile>\n+\n+  </appenders>\n+\n+  <loggers>\n+\n+    <asyncLogger name=\"org.apereo.cas\" additivity=\"false\" level=\"INFO\">\n+      <appender-ref ref=\"main\"/>\n+    </asyncLogger>\n+    <asyncLogger name=\"org.apereo.inspektr.audit.support\" additivity=\"false\" level=\"INFO\">\n+      <appender-ref ref=\"main\"/>\n+    </asyncLogger>\n+\n+    <asyncLogger name=\"org.springframework\" additivity=\"false\" level=\"INFO\">\n+      <appender-ref ref=\"main\"/>\n+    </asyncLogger>\n+\n+    <asyncLogger name=\"org.apache.syncope.client.lib\" additivity=\"false\" level=\"OFF\">\n+      <appender-ref ref=\"main\"/>\n+    </asyncLogger>\n+    <asyncLogger name=\"org.apache.syncope.wa\" additivity=\"false\" level=\"INFO\">\n+      <appender-ref ref=\"main\"/>\n+    </asyncLogger>\n+\n+    <asyncLogger name=\"org.apache.cxf\" additivity=\"false\" level=\"ERROR\">\n+      <appender-ref ref=\"main\"/>\n+    </asyncLogger>\n+\n+    <root level=\"INFO\">\n+      <appender-ref ref=\"main\"/>\n+    </root>\n+  \n+  </loggers>\n+  \n+</configuration>"},{"sha":"aa2f3e261dc2196acb47533eb43eff8a4946b8a1","filename":"wa/src/main/resources/static/images/favicon.png","status":"added","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/wa%2Fsrc%2Fmain%2Fresources%2Fstatic%2Fimages%2Ffavicon.png","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/wa%2Fsrc%2Fmain%2Fresources%2Fstatic%2Fimages%2Ffavicon.png","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fsrc%2Fmain%2Fresources%2Fstatic%2Fimages%2Ffavicon.png?ref=129544844e25b982e17290ab34ddc4992b304e4a"},{"sha":"ad83fbca1d484759c69d3ae31198df18335ee72b","filename":"wa/src/main/resources/templates/layout.html","status":"added","additions":61,"deletions":0,"changes":61,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/wa%2Fsrc%2Fmain%2Fresources%2Ftemplates%2Flayout.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/wa%2Fsrc%2Fmain%2Fresources%2Ftemplates%2Flayout.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fsrc%2Fmain%2Fresources%2Ftemplates%2Flayout.html?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,61 @@\n+<!DOCTYPE html>\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+<html xmlns:layout=\"http://www.ultraq.net.nz/thymeleaf/layout\">\n+\n+<head>\n+    <meta charset=\"UTF-8\" />\n+    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n+    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\" />\n+\n+    <title layout:title-pattern=\"$LAYOUT_TITLE\">Apache Syncope</title>\n+\n+    <!--/* Core CAS CSS */-->\n+    <link rel=\"stylesheet\" type=\"text/css\" href=\"../static/css/normalize.css\" th:href=\"@{#{webjars.normalize.css}}\" />\n+    <link rel=\"stylesheet\" type=\"text/css\" href=\"../static/css/bootstrap-grid.min.css\" th:href=\"@{#{webjars.bootstrap-grid.css}}\" />\n+    <link rel=\"stylesheet\" type=\"text/css\" href=\"../static/css/material-components-web.min.css\" th:href=\"@{#{webjars.material-components.css}}\" />\n+    <link rel=\"stylesheet\" type=\"text/css\" href=\"../static/css/mdi-font.css\" th:href=\"@{#{webjars.mdi-font.css}}\" />\n+    <link rel=\"stylesheet\" type=\"text/css\" href=\"../static/css/cas.css\" th:href=\"@{${#themes.code('cas.standard.css.file')}}\"/>\n+\n+    <link rel=\"shortcut icon\" th:href=\"@{'/images/favicon.png'}\" type=\"image/png\"/>\n+</head>\n+\n+<body>\n+<script th:replace=\"fragments/scripts\" />\n+\n+<div th:replace=\"fragments/header :: header\">\n+    <a href=\"fragments/header.html\">Header</a> fragment will go here\n+</div>\n+\n+<div class=\"mdc-drawer-scrim\"></div>\n+\n+<div class=\"mdc-drawer-app-content mdc-top-app-bar--fixed-adjust d-flex justify-content-center\">\n+    <main role=\"main\" id=\"main-content\" class=\"container-lg py-4\">\n+        <div layout:fragment=\"content\" id=\"content\">\n+            CAS content will go here\n+        </div>\n+    </main>\n+</div>\n+\n+<div th:replace=\"fragments/footer :: footer\">\n+    <a href=\"fragments/footer.html\">Footer</a> fragment will go here\n+</div>\n+\n+</body>\n+</html>"},{"sha":"a2080750c4ccf2a88410878e64e1b373f1eff5fc","filename":"wa/src/main/resources/wa.properties","status":"added","additions":25,"deletions":0,"changes":25,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/wa%2Fsrc%2Fmain%2Fresources%2Fwa.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/wa%2Fsrc%2Fmain%2Fresources%2Fwa.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fsrc%2Fmain%2Fresources%2Fwa.properties?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,25 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+anonymousUser=${anonymousUser}\n+anonymousKey=${anonymousKey}\n+\n+useGZIPCompression=true\n+\n+# Conf directories\n+conf.directory=${conf.directory}\n+cas.standalone.configurationDirectory=${conf.directory}\n+cas.authn.oidc.jwksFile=file:${conf.directory}/oidc.keystore"},{"sha":"c4ed5788c0bb464919a06e686a8c6072a4729d0b","filename":"wa/src/test/java/org/apache/syncope/wa/SyncopeWATest.java","status":"added","additions":158,"deletions":0,"changes":158,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/wa%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2FSyncopeWATest.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/wa%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2FSyncopeWATest.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2FSyncopeWATest.java?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,158 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.wa;\n+\n+import static org.junit.jupiter.api.Assertions.assertEquals;\n+import static org.junit.jupiter.api.Assertions.assertNotEquals;\n+import static org.junit.jupiter.api.Assertions.assertNotNull;\n+import static org.junit.jupiter.api.Assertions.assertTrue;\n+\n+import java.io.IOException;\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.stream.Stream;\n+import javax.ws.rs.core.HttpHeaders;\n+import org.apache.http.Consts;\n+import org.apache.http.Header;\n+import org.apache.http.HttpStatus;\n+import org.apache.http.NameValuePair;\n+import org.apache.http.client.entity.UrlEncodedFormEntity;\n+import org.apache.http.client.methods.CloseableHttpResponse;\n+import org.apache.http.client.methods.HttpGet;\n+import org.apache.http.client.methods.HttpPost;\n+import org.apache.http.client.protocol.HttpClientContext;\n+import org.apache.http.impl.client.BasicCookieStore;\n+import org.apache.http.impl.client.CloseableHttpClient;\n+import org.apache.http.impl.client.HttpClients;\n+import org.apache.http.message.BasicHeader;\n+import org.apache.http.message.BasicNameValuePair;\n+import org.apache.http.util.EntityUtils;\n+import org.junit.jupiter.api.Test;\n+import org.springframework.boot.test.context.SpringBootTest;\n+import org.springframework.boot.web.server.LocalServerPort;\n+import org.springframework.test.context.ContextConfiguration;\n+\n+@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT, properties = {\n+    \"cas.authn.accept.users=mrossi::password\"\n+})\n+@ContextConfiguration(initializers = ZookeeperTestingServer.class)\n+public class SyncopeWATest {\n+\n+    @LocalServerPort\n+    private int port;\n+\n+    private String getLoginURL() {\n+        return \"http://localhost:\" + port + \"/syncope-wa/login\";\n+    }\n+\n+    @Test\n+    public void loginLogout() throws IOException {\n+        CloseableHttpClient httpclient = HttpClients.createDefault();\n+        HttpClientContext context = HttpClientContext.create();\n+        context.setCookieStore(new BasicCookieStore());\n+\n+        // 1. first GET to fetch execution\n+        HttpGet get = new HttpGet(getLoginURL());\n+        get.addHeader(new BasicHeader(HttpHeaders.ACCEPT_LANGUAGE, \"en-US,en;q=0.5\"));\n+        CloseableHttpResponse response = httpclient.execute(get, context);\n+        assertEquals(HttpStatus.SC_OK, response.getStatusLine().getStatusCode());\n+\n+        String responseBody = EntityUtils.toString(response.getEntity());\n+        int begin = responseBody.indexOf(\"name=\\\"execution\\\" value=\\\"\");\n+        assertNotEquals(-1, begin);\n+        int end = responseBody.indexOf(\"\\\"/><input type=\\\"hidden\\\" name=\\\"_eventId\\\"\");\n+        assertNotEquals(-1, end);\n+\n+        String execution = responseBody.substring(begin + 24, end);\n+        assertNotNull(execution);\n+\n+        // 2. then POST to authenticate\n+        List<NameValuePair> form = new ArrayList<>();\n+        form.add(new BasicNameValuePair(\"_eventId\", \"submit\"));\n+        form.add(new BasicNameValuePair(\"execution\", execution));\n+        form.add(new BasicNameValuePair(\"username\", \"mrossi\"));\n+        form.add(new BasicNameValuePair(\"password\", \"password\"));\n+        form.add(new BasicNameValuePair(\"geolocation\", \"\"));\n+\n+        HttpPost post = new HttpPost(getLoginURL());\n+        post.addHeader(new BasicHeader(HttpHeaders.ACCEPT_LANGUAGE, \"en-US,en;q=0.5\"));\n+        post.setEntity(new UrlEncodedFormEntity(form, Consts.UTF_8));\n+        response = httpclient.execute(post, context);\n+\n+        // 3. check authentication results\n+        assertEquals(HttpStatus.SC_OK, response.getStatusLine().getStatusCode());\n+\n+        Header[] cookie = response.getHeaders(\"Set-Cookie\");\n+        assertNotNull(cookie);\n+        assertTrue(cookie.length > 0);\n+        assertEquals(1, Stream.of(cookie).filter(item -> item.getValue().startsWith(\"TGC\")).count());\n+\n+        String body = EntityUtils.toString(response.getEntity());\n+        assertTrue(body.contains(\"Log In Successful\"));\n+        assertTrue(body.contains(\"have successfully logged into the Central Authentication Service\"));\n+\n+        // 4. logout\n+        HttpGet logout = new HttpGet(getLoginURL().replace(\"login\", \"logout\"));\n+        logout.addHeader(new BasicHeader(HttpHeaders.ACCEPT_LANGUAGE, \"en-US,en;q=0.5\"));\n+        response = httpclient.execute(logout, context);\n+        assertEquals(HttpStatus.SC_OK, response.getStatusLine().getStatusCode());\n+\n+        body = EntityUtils.toString(response.getEntity());\n+        assertTrue(body.contains(\"Logout successful\"));\n+        assertTrue(body.contains(\"have successfully logged out of the Central Authentication Service\"));\n+    }\n+\n+    @Test\n+    public void loginError() throws IOException {\n+        CloseableHttpClient httpclient = HttpClients.createDefault();\n+        HttpClientContext context = HttpClientContext.create();\n+        context.setCookieStore(new BasicCookieStore());\n+\n+        // 1. first GET to fetch execution\n+        HttpGet get = new HttpGet(getLoginURL());\n+        get.addHeader(new BasicHeader(HttpHeaders.ACCEPT_LANGUAGE, \"en-US,en;q=0.5\"));\n+        CloseableHttpResponse response = httpclient.execute(get, context);\n+        assertEquals(HttpStatus.SC_OK, response.getStatusLine().getStatusCode());\n+\n+        String responseBody = EntityUtils.toString(response.getEntity());\n+        int begin = responseBody.indexOf(\"name=\\\"execution\\\" value=\\\"\");\n+        assertNotEquals(-1, begin);\n+        int end = responseBody.indexOf(\"\\\"/><input type=\\\"hidden\\\" name=\\\"_eventId\\\"\");\n+        assertNotEquals(-1, end);\n+\n+        String execution = responseBody.substring(begin + 24, end);\n+        assertNotNull(execution);\n+\n+        // 2. then POST to authenticate\n+        List<NameValuePair> form = new ArrayList<>();\n+        form.add(new BasicNameValuePair(\"_eventId\", \"submit\"));\n+        form.add(new BasicNameValuePair(\"execution\", execution));\n+        form.add(new BasicNameValuePair(\"username\", \"mrossi\"));\n+        form.add(new BasicNameValuePair(\"password\", \"WRONG\"));\n+        form.add(new BasicNameValuePair(\"geolocation\", \"\"));\n+\n+        HttpPost post = new HttpPost(getLoginURL());\n+        post.addHeader(new BasicHeader(HttpHeaders.ACCEPT_LANGUAGE, \"en-US,en;q=0.5\"));\n+        post.setEntity(new UrlEncodedFormEntity(form, Consts.UTF_8));\n+        response = httpclient.execute(post, context);\n+\n+        // 3. check authentication results\n+        assertEquals(HttpStatus.SC_UNAUTHORIZED, response.getStatusLine().getStatusCode());\n+    }\n+}"},{"sha":"956e6f336ee2c8a42aebd187444bb2a318732326","filename":"wa/src/test/java/org/apache/syncope/wa/ZookeeperTestingServer.java","status":"added","additions":80,"deletions":0,"changes":80,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/wa%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2FZookeeperTestingServer.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/wa%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2FZookeeperTestingServer.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2FZookeeperTestingServer.java?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,80 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.wa;\n+\n+import static org.junit.jupiter.api.Assertions.fail;\n+\n+import java.io.InputStream;\n+import java.util.HashMap;\n+import java.util.Map;\n+import java.util.Properties;\n+import java.util.concurrent.atomic.AtomicReference;\n+import javax.security.auth.login.AppConfigurationEntry;\n+import javax.security.auth.login.Configuration;\n+import org.apache.curator.test.InstanceSpec;\n+import org.apache.curator.test.TestingServer;\n+import org.apache.zookeeper.server.auth.DigestLoginModule;\n+import org.apache.zookeeper.server.auth.SASLAuthenticationProvider;\n+import org.springframework.context.ApplicationContextInitializer;\n+import org.springframework.context.ConfigurableApplicationContext;\n+\n+public class ZookeeperTestingServer implements ApplicationContextInitializer<ConfigurableApplicationContext> {\n+\n+    @Override\n+    public void initialize(final ConfigurableApplicationContext ctx) {\n+        AtomicReference<String> username = new AtomicReference<>();\n+        AtomicReference<String> password = new AtomicReference<>();\n+        try (InputStream propStream = getClass().getResourceAsStream(\"/keymaster.properties\")) {\n+            Properties props = new Properties();\n+            props.load(propStream);\n+\n+            username.set(props.getProperty(\"keymaster.username\"));\n+            password.set(props.getProperty(\"keymaster.password\"));\n+        } catch (Exception e) {\n+            throw new IllegalStateException(\"Could not load /keymaster.properties\", e);\n+        }\n+\n+        Configuration.setConfiguration(new Configuration() {\n+\n+            private final AppConfigurationEntry[] entries = {\n+                new AppConfigurationEntry(\n+                DigestLoginModule.class.getName(),\n+                AppConfigurationEntry.LoginModuleControlFlag.REQUIRED,\n+                Map.of(\n+                \"user_\" + username.get(), password.get()\n+                ))\n+            };\n+\n+            @Override\n+            public AppConfigurationEntry[] getAppConfigurationEntry(final String name) {\n+                return entries;\n+            }\n+        });\n+\n+        Map<String, Object> customProperties = new HashMap<>();\n+        customProperties.put(\"authProvider.1\", SASLAuthenticationProvider.class.getName());\n+        InstanceSpec spec = new InstanceSpec(null, 2181, -1, -1, true, 1, -1, -1, customProperties);\n+\n+        try {\n+            new TestingServer(spec, true);\n+        } catch (Exception e) {\n+            fail(e);\n+        }\n+    }\n+}"},{"sha":"f374d8ca3a94d0370aa4ab93b5ad8897eb4e944b","filename":"wa/src/test/resources/keymaster.properties","status":"added","additions":19,"deletions":0,"changes":19,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/129544844e25b982e17290ab34ddc4992b304e4a/wa%2Fsrc%2Ftest%2Fresources%2Fkeymaster.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/129544844e25b982e17290ab34ddc4992b304e4a/wa%2Fsrc%2Ftest%2Fresources%2Fkeymaster.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fsrc%2Ftest%2Fresources%2Fkeymaster.properties?ref=129544844e25b982e17290ab34ddc4992b304e4a","patch":"@@ -0,0 +1,19 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+keymaster.address=127.0.0.1:2181\n+keymaster.username=${anonymousUser}\n+keymaster.password=${anonymousKey}"}]}