{"sha":"4fec32be0708252585f4cbfbc9dd25b5670d37ff","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjRmZWMzMmJlMDcwODI1MjU4NWY0Y2JmYmM5ZGQyNWI1NjcwZDM3ZmY=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2018-09-03T15:28:05Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2018-09-03T15:28:14Z"},"message":"[SYNCOPE-1360] Reworking DynRealms-based delegated administration from Admin Console","tree":{"sha":"f9729a4cf4a9ada180fdb5380e6653c26dda66b1","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/f9729a4cf4a9ada180fdb5380e6653c26dda66b1"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/4fec32be0708252585f4cbfbc9dd25b5670d37ff","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/4fec32be0708252585f4cbfbc9dd25b5670d37ff","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/4fec32be0708252585f4cbfbc9dd25b5670d37ff","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/4fec32be0708252585f4cbfbc9dd25b5670d37ff/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"d7f034adaaa3a76028ffc00454f2496f27fdbe3b","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/d7f034adaaa3a76028ffc00454f2496f27fdbe3b","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/d7f034adaaa3a76028ffc00454f2496f27fdbe3b"}],"stats":{"total":114,"additions":81,"deletions":33},"files":[{"sha":"2f952ee81487d244f4daca2ca102a30bfafc2285","filename":"client/console/src/main/java/org/apache/syncope/client/console/SyncopeConsoleSession.java","status":"modified","additions":25,"deletions":8,"changes":33,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4fec32be0708252585f4cbfbc9dd25b5670d37ff/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2FSyncopeConsoleSession.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4fec32be0708252585f4cbfbc9dd25b5670d37ff/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2FSyncopeConsoleSession.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2FSyncopeConsoleSession.java?ref=4fec32be0708252585f4cbfbc9dd25b5670d37ff","patch":"@@ -20,8 +20,10 @@\n \n import java.text.DateFormat;\n import java.util.ArrayList;\n+import java.util.Arrays;\n import java.util.Collections;\n import java.util.HashMap;\n+import java.util.HashSet;\n import java.util.List;\n import java.util.Locale;\n import java.util.Map;\n@@ -32,6 +34,7 @@\n import javax.ws.rs.core.EntityTag;\n import javax.ws.rs.core.MediaType;\n import org.apache.commons.collections4.list.SetUniqueList;\n+import org.apache.commons.lang3.ArrayUtils;\n import org.apache.commons.lang3.StringUtils;\n import org.apache.commons.lang3.time.FastDateFormat;\n import org.apache.commons.lang3.tuple.Pair;\n@@ -224,19 +227,33 @@ public List<String> getAuthRealms() {\n         return sortable;\n     }\n \n-    public boolean owns(final String entitlements) {\n-        return owns(entitlements, SyncopeConstants.ROOT_REALM);\n-    }\n-\n-    public boolean owns(final String entitlements, final String realm) {\n+    public boolean owns(final String entitlements, final String... realms) {\n         if (StringUtils.isEmpty(entitlements)) {\n             return true;\n         }\n \n+        if (auth == null) {\n+            return false;\n+        }\n+\n+        Set<String> requested = ArrayUtils.isEmpty(realms)\n+                ? Collections.singleton(SyncopeConstants.ROOT_REALM)\n+                : new HashSet<>(Arrays.asList(realms));\n+\n         for (String entitlement : entitlements.split(\",\")) {\n-            if (auth != null && auth.containsKey(entitlement) && (realm == null\n-                    || auth.get(entitlement).stream().anyMatch(ownedRealm -> realm.startsWith(ownedRealm)))) {\n-                return true;\n+            if (auth.containsKey(entitlement)) {\n+                boolean owns = false;\n+\n+                Set<String> owned = auth.get(entitlement);\n+                for (String realm : requested) {\n+                    if (realm.startsWith(SyncopeConstants.ROOT_REALM)) {\n+                        owns |= owned.stream().anyMatch(ownedRealm -> realm.startsWith(ownedRealm));\n+                    } else {\n+                        owns |= owned.contains(realm);\n+                    }\n+                }\n+\n+                return owns;\n             }\n         }\n "},{"sha":"ec8a9956a5ec0524eefe1e9a8bfdabb66cb172fa","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/AnyDirectoryPanel.java","status":"modified","additions":12,"deletions":1,"changes":13,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4fec32be0708252585f4cbfbc9dd25b5670d37ff/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4fec32be0708252585f4cbfbc9dd25b5670d37ff/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyDirectoryPanel.java?ref=4fec32be0708252585f4cbfbc9dd25b5670d37ff","patch":"@@ -101,7 +101,11 @@ protected AnyDirectoryPanel(final String id, final Builder<A, E> builder, final\n         } else {\n             MetaDataRoleAuthorizationStrategy.unauthorizeAll(addAjaxLink, RENDER);\n         }\n-        setReadOnly(!SyncopeConsoleSession.get().owns(String.format(\"%s_UPDATE\", builder.type), builder.realm));\n+        if (builder.dynRealm == null) {\n+            setReadOnly(!SyncopeConsoleSession.get().owns(String.format(\"%s_UPDATE\", builder.type), builder.realm));\n+        } else {\n+            setReadOnly(!SyncopeConsoleSession.get().owns(String.format(\"%s_UPDATE\", builder.type), builder.dynRealm));\n+        }\n \n         this.realm = builder.realm;\n         this.type = builder.type;\n@@ -243,6 +247,8 @@ public interface AnyDirectoryPanelBuilder extends Serializable {\n          */\n         protected String realm = SyncopeConstants.ROOT_REALM;\n \n+        protected String dynRealm = null;\n+\n         /**\n          * Any type related to current panel.\n          */\n@@ -266,6 +272,11 @@ public Builder<A, E> setRealm(final String realm) {\n             return this;\n         }\n \n+        public Builder<A, E> setDynRealm(final String dynRealm) {\n+            this.dynRealm = dynRealm;\n+            return this;\n+        }\n+\n         @Override\n         public List<AnyTypeClassTO> getAnyTypeClassTOs() {\n             return this.anyTypeClassTOs;"},{"sha":"34eeed575bd45e4d4a3c75491a8c243775b58601","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/AnyObjectDirectoryPanel.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4fec32be0708252585f4cbfbc9dd25b5670d37ff/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyObjectDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4fec32be0708252585f4cbfbc9dd25b5670d37ff/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyObjectDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyObjectDirectoryPanel.java?ref=4fec32be0708252585f4cbfbc9dd25b5670d37ff","patch":"@@ -111,7 +111,7 @@ public void onClick(final AjaxRequestTarget target, final AnyObjectTO ignore) {\n             }\n         }, ActionType.EDIT,\n                 String.format(\"%s,%s\", AnyEntitlement.READ.getFor(type), AnyEntitlement.UPDATE.getFor(type))).\n-                setRealm(realm);\n+                setRealms(realm, model.getObject().getDynRealms());\n \n         panel.add(new ActionLink<AnyObjectTO>() {\n \n@@ -156,7 +156,7 @@ public void onClick(final AjaxRequestTarget target, final AnyObjectTO ignore) {\n                 }\n             }, ActionType.MANAGE_RESOURCES,\n                     String.format(\"%s,%s\", AnyEntitlement.READ.getFor(type), AnyEntitlement.UPDATE.getFor(type))).\n-                    setRealm(realm);\n+                    setRealms(realm, model.getObject().getDynRealms());\n \n             panel.add(\n                     new ActionLink<AnyObjectTO>() {"},{"sha":"12ec3312848f38e72e070ce3f00e084510e52dd6","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/AnyPanel.java","status":"modified","additions":3,"deletions":3,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4fec32be0708252585f4cbfbc9dd25b5670d37ff/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4fec32be0708252585f4cbfbc9dd25b5670d37ff/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyPanel.java?ref=4fec32be0708252585f4cbfbc9dd25b5670d37ff","patch":"@@ -250,7 +250,7 @@ protected Panel getDirectoryPanel(final String id) {\n                 panel = new UserDirectoryPanel.Builder(\n                         anyTypeClassRestClient.list(anyTypeTO.getClasses()),\n                         anyTypeTO.getKey(),\n-                        pageRef).setRealm(realm).setFiltered(true).\n+                        pageRef).setRealm(realm).setDynRealm(dynRealm).setFiltered(true).\n                         setFiql(fiql).setWizardInModal(true).addNewItemPanelBuilder(FormLayoutInfoUtils.instantiate(\n                         userTO,\n                         anyTypeTO.getClasses(),\n@@ -269,7 +269,7 @@ protected Panel getDirectoryPanel(final String id) {\n                 panel = new GroupDirectoryPanel.Builder(\n                         anyTypeClassRestClient.list(anyTypeTO.getClasses()),\n                         anyTypeTO.getKey(),\n-                        pageRef).setRealm(realm).setFiltered(true).\n+                        pageRef).setRealm(realm).setDynRealm(dynRealm).setFiltered(true).\n                         setFiql(fiql).setWizardInModal(true).addNewItemPanelBuilder(FormLayoutInfoUtils.instantiate(\n                         groupTO,\n                         anyTypeTO.getClasses(),\n@@ -291,7 +291,7 @@ protected Panel getDirectoryPanel(final String id) {\n                 panel = new AnyObjectDirectoryPanel.Builder(\n                         anyTypeClassRestClient.list(anyTypeTO.getClasses()),\n                         anyTypeTO.getKey(),\n-                        pageRef).setRealm(realm).setFiltered(true).\n+                        pageRef).setRealm(realm).setDynRealm(dynRealm).setFiltered(true).\n                         setFiql(fiql).setWizardInModal(true).addNewItemPanelBuilder(FormLayoutInfoUtils.instantiate(\n                         anyObjectTO,\n                         anyTypeTO.getClasses(),"},{"sha":"e7026c233fdad7ad1430368eb064c8cfb14ceed6","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/GroupDirectoryPanel.java","status":"modified","additions":5,"deletions":4,"changes":9,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4fec32be0708252585f4cbfbc9dd25b5670d37ff/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FGroupDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4fec32be0708252585f4cbfbc9dd25b5670d37ff/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FGroupDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FGroupDirectoryPanel.java?ref=4fec32be0708252585f4cbfbc9dd25b5670d37ff","patch":"@@ -216,7 +216,7 @@ public void onClick(final AjaxRequestTarget target, final GroupTO ignore) {\n             }\n         }, ActionType.EDIT,\n                 String.format(\"%s,%s\", StandardEntitlement.GROUP_READ, StandardEntitlement.GROUP_UPDATE)).\n-                setRealm(realm);\n+                setRealms(realm, model.getObject().getDynRealms());\n \n         panel.add(new ActionLink<GroupTO>() {\n \n@@ -247,7 +247,8 @@ public void onClick(final AjaxRequestTarget target, final GroupTO ignore) {\n                 typeExtensionsModal.header(new StringResourceModel(\"typeExtensions\", model));\n                 typeExtensionsModal.show(true);\n             }\n-        }, ActionType.TYPE_EXTENSIONS, StandardEntitlement.GROUP_UPDATE).setRealm(realm);\n+        }, ActionType.TYPE_EXTENSIONS, StandardEntitlement.GROUP_UPDATE).\n+                setRealms(realm, model.getObject().getDynRealms());\n \n         panel.add(new ActionLink<GroupTO>() {\n \n@@ -265,7 +266,7 @@ public boolean isIndicatorEnabled() {\n             }\n         }, ActionType.MEMBERS,\n                 String.format(\"%s,%s\", StandardEntitlement.GROUP_READ, StandardEntitlement.GROUP_UPDATE)).\n-                setRealm(realm);\n+                setRealms(realm, model.getObject().getDynRealms());\n \n         panel.add(new ActionLink<GroupTO>() {\n \n@@ -333,7 +334,7 @@ public void onClick(final AjaxRequestTarget target, final GroupTO ignore) {\n             }\n         }, ActionType.MANAGE_RESOURCES,\n                 String.format(\"%s,%s\", StandardEntitlement.GROUP_READ, StandardEntitlement.GROUP_UPDATE)).\n-                setRealm(realm);\n+                setRealms(realm, model.getObject().getDynRealms());\n \n         panel.add(new ActionLink<GroupTO>() {\n "},{"sha":"597a4f5b45b86c29a287113b979974dbbbba5ec9","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/UserDirectoryPanel.java","status":"modified","additions":10,"deletions":6,"changes":16,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4fec32be0708252585f4cbfbc9dd25b5670d37ff/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FUserDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4fec32be0708252585f4cbfbc9dd25b5670d37ff/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FUserDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FUserDirectoryPanel.java?ref=4fec32be0708252585f4cbfbc9dd25b5670d37ff","patch":"@@ -141,7 +141,7 @@ public void onClick(final AjaxRequestTarget target, final UserTO ignore) {\n             }\n         }, ActionType.EDIT,\n                 String.format(\"%s,%s\", StandardEntitlement.USER_READ, StandardEntitlement.USER_UPDATE)).\n-                setRealm(realm);\n+                setRealms(realm, model.getObject().getDynRealms());\n \n         panel.add(new ActionLink<UserTO>() {\n \n@@ -183,7 +183,8 @@ public void onClick(final AjaxRequestTarget target, final UserTO ignore) {\n                 }\n                 ((BasePage) pageRef.getPage()).getNotificationPanel().refresh(target);\n             }\n-        }, ActionType.MUSTCHANGEPASSWORD, StandardEntitlement.USER_UPDATE).setRealm(realm);\n+        }, ActionType.MUSTCHANGEPASSWORD, StandardEntitlement.USER_UPDATE).\n+                setRealms(realm, model.getObject().getDynRealms());\n \n         if (wizardInModal) {\n             panel.add(new ActionLink<UserTO>() {\n@@ -206,7 +207,8 @@ public void onClick(final AjaxRequestTarget target, final UserTO ignore) {\n \n                     displayAttributeModal.show(true);\n                 }\n-            }, ActionType.PASSWORD_MANAGEMENT, StandardEntitlement.USER_UPDATE).setRealm(realm);\n+            }, ActionType.PASSWORD_MANAGEMENT, StandardEntitlement.USER_UPDATE).\n+                    setRealms(realm, model.getObject().getDynRealms());\n \n             if (SyncopeConsoleSession.get().getPlatformInfo().isPwdResetAllowed()\n                     && !SyncopeConsoleSession.get().getPlatformInfo().isPwdResetRequiringSecurityQuestions()) {\n@@ -230,7 +232,8 @@ public void onClick(final AjaxRequestTarget target, final UserTO ignore) {\n                         }\n                         ((BasePage) pageRef.getPage()).getNotificationPanel().refresh(target);\n                     }\n-                }, ActionType.REQUEST_PASSWORD_RESET, StandardEntitlement.USER_UPDATE).setRealm(realm);\n+                }, ActionType.REQUEST_PASSWORD_RESET, StandardEntitlement.USER_UPDATE).\n+                        setRealms(realm, model.getObject().getDynRealms());\n             }\n \n             panel.add(new ActionLink<UserTO>() {\n@@ -255,7 +258,8 @@ public void onClick(final AjaxRequestTarget target, final UserTO ignore) {\n \n                     altDefaultModal.show(true);\n                 }\n-            }, ActionType.ENABLE, StandardEntitlement.USER_UPDATE).setRealm(realm);\n+            }, ActionType.ENABLE, StandardEntitlement.USER_UPDATE).\n+                    setRealms(realm, model.getObject().getDynRealms());\n \n             panel.add(new ActionLink<UserTO>() {\n \n@@ -281,7 +285,7 @@ public void onClick(final AjaxRequestTarget target, final UserTO ignore) {\n                 }\n             }, ActionType.MANAGE_RESOURCES,\n                     String.format(\"%s,%s\", StandardEntitlement.USER_READ, StandardEntitlement.USER_UPDATE)).\n-                    setRealm(realm);\n+                    setRealms(realm, model.getObject().getDynRealms());\n \n             panel.add(new ActionLink<UserTO>() {\n "},{"sha":"f01a984106622bdeefe3038a7234ddb6b5ed5674","filename":"client/console/src/main/java/org/apache/syncope/client/console/wicket/markup/html/form/Action.java","status":"modified","additions":19,"deletions":5,"changes":24,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4fec32be0708252585f4cbfbc9dd25b5670d37ff/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FAction.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4fec32be0708252585f4cbfbc9dd25b5670d37ff/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FAction.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FAction.java?ref=4fec32be0708252585f4cbfbc9dd25b5670d37ff","patch":"@@ -19,6 +19,8 @@\n package org.apache.syncope.client.console.wicket.markup.html.form;\n \n import java.io.Serializable;\n+import java.util.ArrayList;\n+import java.util.List;\n import org.apache.commons.lang3.StringUtils;\n import org.apache.wicket.model.Model;\n \n@@ -31,7 +33,7 @@\n \n     private static final long serialVersionUID = -7989237020377623993L;\n \n-    private String realm = null;\n+    private final List<String> realms = new ArrayList<>();\n \n     private final ActionLink<T> link;\n \n@@ -66,12 +68,24 @@ public Action(final ActionLink<T> link, final ActionLink.ActionType type) {\n         this.indicator = true;\n     }\n \n-    public String getRealm() {\n-        return realm;\n+    public String[] getRealms() {\n+        return realms.toArray(new String[realms.size()]);\n     }\n \n     public void setRealm(final String realm) {\n-        this.realm = realm;\n+        this.realms.clear();\n+\n+        if (realm != null) {\n+            this.realms.add(realm);\n+        }\n+    }\n+\n+    public void setRealms(final String realm, final List<String> dynRealms) {\n+        setRealm(realm);\n+\n+        if (dynRealms != null) {\n+            this.realms.addAll(dynRealms);\n+        }\n     }\n \n     public ActionLink<T> getLink() {\n@@ -104,7 +118,7 @@ public Action<T> hideLabel() {\n         this.visibleLabel = false;\n         return this;\n     }\n-    \n+\n     public Action<T> showLabel() {\n         this.visibleLabel = true;\n         return this;"},{"sha":"6b986197d686e22fcc74daf4cc76d3aa724df714","filename":"client/console/src/main/java/org/apache/syncope/client/console/wicket/markup/html/form/ActionPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4fec32be0708252585f4cbfbc9dd25b5670d37ff/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FActionPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4fec32be0708252585f4cbfbc9dd25b5670d37ff/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FActionPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FActionPanel.java?ref=4fec32be0708252585f4cbfbc9dd25b5670d37ff","patch":"@@ -130,7 +130,7 @@ public String getAjaxIndicatorMarkupId() {\n             };\n         }\n \n-        if (SyncopeConsoleSession.get().owns(action.getEntitlements(), action.getRealm())) {\n+        if (SyncopeConsoleSession.get().owns(action.getEntitlements(), action.getRealms())) {\n             MetaDataRoleAuthorizationStrategy.authorizeAll(actionLink, RENDER);\n         } else {\n             MetaDataRoleAuthorizationStrategy.unauthorizeAll(actionLink, RENDER);"},{"sha":"d328c43d16c3433d30e91014b4f50f714b05c456","filename":"core/provisioning-java/src/main/java/org/apache/syncope/core/provisioning/java/data/UserDataBinderImpl.java","status":"modified","additions":3,"deletions":3,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4fec32be0708252585f4cbfbc9dd25b5670d37ff/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fdata%2FUserDataBinderImpl.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4fec32be0708252585f4cbfbc9dd25b5670d37ff/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fdata%2FUserDataBinderImpl.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fdata%2FUserDataBinderImpl.java?ref=4fec32be0708252585f4cbfbc9dd25b5670d37ff","patch":"@@ -586,10 +586,10 @@ public UserTO getUserTO(final User user, final boolean details) {\n                 userDAO.findAllResources(user),\n                 details);\n \n-        if (details) {\n-            // dynamic realms\n-            userTO.getDynRealms().addAll(userDAO.findDynRealms(user.getKey()));\n+        // dynamic realms\n+        userTO.getDynRealms().addAll(userDAO.findDynRealms(user.getKey()));\n \n+        if (details) {\n             // roles\n             userTO.getRoles().addAll(user.getRoles().stream().map(Entity::getKey).collect(Collectors.toList()));\n "},{"sha":"af286611592c94022525e866c1231717c5c45264","filename":"src/main/asciidoc/reference-guide/concepts/roles.adoc","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4fec32be0708252585f4cbfbc9dd25b5670d37ff/src%2Fmain%2Fasciidoc%2Freference-guide%2Fconcepts%2Froles.adoc","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4fec32be0708252585f4cbfbc9dd25b5670d37ff/src%2Fmain%2Fasciidoc%2Freference-guide%2Fconcepts%2Froles.adoc","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/src%2Fmain%2Fasciidoc%2Freference-guide%2Fconcepts%2Froles.adoc?ref=4fec32be0708252585f4cbfbc9dd25b5670d37ff","patch":"@@ -104,4 +104,5 @@ For example, the following entitlements are normally required to be granted for\n . `USER_READ`\n . `ANYTYPE_READ`\n . `REALM_LIST`\n+. `GROUP_SEARCH`\n ===="}]}