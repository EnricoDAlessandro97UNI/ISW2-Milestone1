{"sha":"35b1b5103afc059240bd18e024e1df7ab05fc20a","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjM1YjFiNTEwM2FmYzA1OTI0MGJkMThlMDI0ZTFkZjdhYjA1ZmMyMGE=","commit":{"author":{"name":"Andrea Patricelli","email":"andreapatricelli@apache.org","date":"2014-08-12T14:51:21Z"},"committer":{"name":"Andrea Patricelli","email":"andreapatricelli@apache.org","date":"2014-08-12T14:51:21Z"},"message":"removed upgrader logger, changed upgrade log to info to have complete log during upgrade phase\n\ngit-svn-id: https://svn.apache.org/repos/asf/syncope/branches/1_2_X@1617495 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"7da791efc9a7662784ffbd52ff3e5e39e0c3b6e4","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/7da791efc9a7662784ffbd52ff3e5e39e0c3b6e4"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/35b1b5103afc059240bd18e024e1df7ab05fc20a","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/35b1b5103afc059240bd18e024e1df7ab05fc20a","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/35b1b5103afc059240bd18e024e1df7ab05fc20a","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/35b1b5103afc059240bd18e024e1df7ab05fc20a/comments","author":{"login":"andrea-patricelli","id":3763111,"node_id":"MDQ6VXNlcjM3NjMxMTE=","avatar_url":"https://avatars.githubusercontent.com/u/3763111?v=4","gravatar_id":"","url":"https://api.github.com/users/andrea-patricelli","html_url":"https://github.com/andrea-patricelli","followers_url":"https://api.github.com/users/andrea-patricelli/followers","following_url":"https://api.github.com/users/andrea-patricelli/following{/other_user}","gists_url":"https://api.github.com/users/andrea-patricelli/gists{/gist_id}","starred_url":"https://api.github.com/users/andrea-patricelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrea-patricelli/subscriptions","organizations_url":"https://api.github.com/users/andrea-patricelli/orgs","repos_url":"https://api.github.com/users/andrea-patricelli/repos","events_url":"https://api.github.com/users/andrea-patricelli/events{/privacy}","received_events_url":"https://api.github.com/users/andrea-patricelli/received_events","type":"User","site_admin":false},"committer":{"login":"andrea-patricelli","id":3763111,"node_id":"MDQ6VXNlcjM3NjMxMTE=","avatar_url":"https://avatars.githubusercontent.com/u/3763111?v=4","gravatar_id":"","url":"https://api.github.com/users/andrea-patricelli","html_url":"https://github.com/andrea-patricelli","followers_url":"https://api.github.com/users/andrea-patricelli/followers","following_url":"https://api.github.com/users/andrea-patricelli/following{/other_user}","gists_url":"https://api.github.com/users/andrea-patricelli/gists{/gist_id}","starred_url":"https://api.github.com/users/andrea-patricelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrea-patricelli/subscriptions","organizations_url":"https://api.github.com/users/andrea-patricelli/orgs","repos_url":"https://api.github.com/users/andrea-patricelli/repos","events_url":"https://api.github.com/users/andrea-patricelli/events{/privacy}","received_events_url":"https://api.github.com/users/andrea-patricelli/received_events","type":"User","site_admin":false},"parents":[{"sha":"ddc4fa6a8cecb40b83798dc79b7cb77671640f42","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/ddc4fa6a8cecb40b83798dc79b7cb77671640f42","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/ddc4fa6a8cecb40b83798dc79b7cb77671640f42"}],"stats":{"total":60,"additions":21,"deletions":39},"files":[{"sha":"e95ca60d400beaa3f54047fca43483fc59584156","filename":"core-upgrader/src/main/java/org/apache/syncope/upgrader/ContentUpgrader.java","status":"modified","additions":21,"deletions":21,"changes":42,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/35b1b5103afc059240bd18e024e1df7ab05fc20a/core-upgrader%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fupgrader%2FContentUpgrader.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/35b1b5103afc059240bd18e024e1df7ab05fc20a/core-upgrader%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fupgrader%2FContentUpgrader.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core-upgrader%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fupgrader%2FContentUpgrader.java?ref=35b1b5103afc059240bd18e024e1df7ab05fc20a","patch":"@@ -253,7 +253,7 @@ private void upgradeExternalResource() throws Exception {\n             try {\n                 final String oldConf = (String) jsonConf.get(resource);\n                 if (StringUtils.isNotBlank(oldConf)) {\n-                    LOG.debug(\"Upgrading resource {} jsonConf\", resource.getName());\n+                    LOG.info(\"Upgrading resource {} jsonConf\", resource.getName());\n                     resource.setConnInstanceConfiguration(\n                             XMLDeserializer.<HashSet<ConnConfProperty>>deserialize(oldConf));\n                 }\n@@ -262,11 +262,11 @@ private void upgradeExternalResource() throws Exception {\n                 final String oldRSyncToken = (String) rSyncToken.get(resource);\n \n                 if (StringUtils.isNotBlank(oldUSyncToken)) {\n-                    LOG.debug(\"Upgrading resource {} userializedSyncToken\", resource.getName());\n+                    LOG.info(\"Upgrading resource {} userializedSyncToken\", resource.getName());\n                     resource.setUsyncToken(XMLDeserializer.<SyncToken>deserialize(oldUSyncToken));\n                 }\n                 if (StringUtils.isNotBlank(oldRSyncToken)) {\n-                    LOG.debug(\"Upgrading resource {} rserializedSyncToken\", resource.getName());\n+                    LOG.info(\"Upgrading resource {} rserializedSyncToken\", resource.getName());\n                     resource.setRsyncToken(XMLDeserializer.<SyncToken>deserialize(oldRSyncToken));\n                 }\n             } catch (Exception e) {\n@@ -282,7 +282,7 @@ private void upgradeConnInstance() throws Exception {\n         final Field jsonConf = ReflectionUtils.findField(ConnInstance.class, \"jsonConf\");\n         jsonConf.setAccessible(true);\n         for (ConnInstance connInstance : connInstanceDAO.findAll()) {\n-            LOG.debug(\"Upgrading connInstance {} jsonConf\", connInstance);\n+            LOG.info(\"Upgrading connInstance {} jsonConf\", connInstance);\n             try {\n                 final String oldConf = (String) jsonConf.get(connInstance);\n                 connInstance.setConfiguration(XMLDeserializer.<HashSet<ConnConfProperty>>deserialize(oldConf));\n@@ -299,7 +299,7 @@ private void upgradePolicy() throws Exception {\n         final Field specification = ReflectionUtils.findField(Policy.class, \"specification\");\n         specification.setAccessible(true);\n         for (Policy policy : policyDAO.findAll()) {\n-            LOG.debug(\"Upgrading policy {} specification\", policy.getDescription());\n+            LOG.info(\"Upgrading policy {} specification\", policy.getDescription());\n             try {\n                 final String oldConf = (String) specification.get(policy);\n                 policy.setSpecification(XMLDeserializer.<AbstractPolicySpec>deserialize(oldConf));\n@@ -319,14 +319,14 @@ private void upgradeSyncTask() throws Exception {\n         roleTemplate.setAccessible(true);\n         for (SyncTask task : taskDAO.findAll(SyncTask.class)) {\n             try {\n-                LOG.debug(\"Upgrading syncTask {} userTemplate\", task.getName());\n+                LOG.info(\"Upgrading syncTask {} userTemplate\", task.getName());\n                 final String oldUserTemplate = (String) userTemplate.get(task);\n                 final String oldRoleTemplate = (String) roleTemplate.get(task);\n                 if (oldUserTemplate != null) {\n                     task.setUserTemplate(XMLDeserializer.<UserTO>deserialize(oldUserTemplate));\n                 }\n                 if (oldRoleTemplate != null) {\n-                    LOG.debug(\"Upgrading syncTask {} roleTemplate\", task.getName());\n+                    LOG.info(\"Upgrading syncTask {} roleTemplate\", task.getName());\n                     task.setRoleTemplate(XMLDeserializer.<RoleTO>deserialize(oldRoleTemplate));\n                 }\n             } catch (Exception e) {\n@@ -345,7 +345,7 @@ private void updgradePropagationTask() throws Exception {\n             try {\n                 final String oldXmlAttr = (String) xmlAttributes.get(task);\n                 if (StringUtils.isNotBlank(oldXmlAttr)) {\n-                    LOG.debug(\"Upgrading propagationTask {} xmlAttributes\", task.getId());\n+                    LOG.info(\"Upgrading propagationTask {} xmlAttributes\", task.getId());\n                     task.setAttributes(XMLDeserializer.<HashSet<Attribute>>deserialize(oldXmlAttr));\n                 }\n             } catch (Exception e) {\n@@ -364,7 +364,7 @@ private void upgradeReportletConf() {\n             for (Map<String, Object> row : reportletConfs) {\n                 final String serializedInstance = (String) row.get(\"serializedInstance\");\n                 if (StringUtils.isNotBlank(serializedInstance)) {\n-                    LOG.debug(\"Upgrading ReportletConf {} serializedInstance\", row.get(\"id\"));\n+                    LOG.info(\"Upgrading ReportletConf {} serializedInstance\", row.get(\"id\"));\n                     final UserReportletConf set = XMLDeserializer.<UserReportletConf>deserialize(serializedInstance);\n                     final String newSerializedInst = POJOHelper.serialize(set);\n                     jdbcTemplate.update(\"UPDATE ReportletConfInstance set serializedInstance = ? WHERE id = ?\",\n@@ -441,7 +441,7 @@ private void upgradeWorkflow() {\n             }\n             if (userWorkflowBytes != null && userWorkflowBytes.length > 0) {\n                 // write default workflow value to database\n-                LOG.debug(\"Importing default workflow for Syncope 1.2.X\");\n+                LOG.info(\"Importing default workflow for Syncope 1.2.X\");\n \n                 importUtils.fromXML(userWorkflowBytes);\n \n@@ -486,13 +486,13 @@ private void addTemplatesToRoles() {\n                 final List<RVirAttr> newRVirattrs = new ArrayList<RVirAttr>();\n                 final List<RVirAttrTemplate> newRVirattrTemplates = new ArrayList<RVirAttrTemplate>();\n \n-                LOG.debug(\"Adding role templates to role {}\", role);\n+                LOG.info(\"Adding role templates to role {}\", role);\n \n                 //Create normal attributes templates\n                 for (AbstractAttr attr : role.getAttrs()) {\n                     final RAttrTemplate rAttrTemplate = new RAttrTemplate();\n                     rAttrTemplate.setOwner(role);\n-                    LOG.debug(\"Creating template for role normal attribute {}\", attr);\n+                    LOG.info(\"Creating template for role normal attribute {}\", attr);\n                     final String schemaName = jdbcTemplate.queryForObject(\n                             \"SELECT schema_name FROM RAttr WHERE id = ?;\", String.class, attr.getId());\n \n@@ -504,7 +504,7 @@ private void addTemplatesToRoles() {\n                 for (AbstractDerAttr derAttr : role.getDerAttrs()) {\n                     final RDerAttrTemplate rDerattrTemplate = new RDerAttrTemplate();\n                     rDerattrTemplate.setOwner(role);\n-                    LOG.debug(\"Creating template for role derived attribute {}\", derAttr);\n+                    LOG.info(\"Creating template for role derived attribute {}\", derAttr);\n                     final String derSchemaName = jdbcTemplate.queryForObject(\n                             \"SELECT DERIVEDSCHEMA_NAME FROM RDerAttr WHERE id = ?;\", String.class, derAttr.getId());\n \n@@ -516,7 +516,7 @@ private void addTemplatesToRoles() {\n                 for (AbstractVirAttr virAttr : role.getVirAttrs()) {\n                     final RVirAttrTemplate rVirattrTemplate = new RVirAttrTemplate();\n                     rVirattrTemplate.setOwner(role);\n-                    LOG.debug(\"Creating template for role virtual attribute {}\", virAttr);\n+                    LOG.info(\"Creating template for role virtual attribute {}\", virAttr);\n                     final String virSchemaName = jdbcTemplate.queryForObject(\n                             \"SELECT VIRTUALSCHEMA_NAME FROM RVirAttr WHERE id = ?;\", String.class, virAttr.getId());\n                     rVirattrTemplate.setSchema(virSchemaDAO.find(virSchemaName, RVirSchema.class));\n@@ -548,7 +548,7 @@ private void addTemplatesToRAttrs() {\n                         role.getId())) {\n                     final RAttr rAttr = attrDAO.find(attrId, RAttr.class);\n \n-                    LOG.debug(\"Adding template to role attribute {}\", rAttr);\n+                    LOG.info(\"Adding template to role attribute {}\", rAttr);\n \n                     final String schemaName = jdbcTemplate.queryForObject(\n                             \"SELECT schema_name FROM RAttr WHERE id = ?;\", String.class, attrId);\n@@ -562,7 +562,7 @@ private void addTemplatesToRAttrs() {\n                         role.getId())) {\n                     final RDerAttr rDerAttr = derAttrDAO.find(attrId, RDerAttr.class);\n \n-                    LOG.debug(\"Adding template to role attribute {}\", rDerAttr);\n+                    LOG.info(\"Adding template to role attribute {}\", rDerAttr);\n \n                     final String derSchemaName = jdbcTemplate.queryForObject(\n                             \"SELECT DERIVEDSCHEMA_NAME FROM RDerAttr WHERE id = ?;\", String.class, attrId);\n@@ -576,7 +576,7 @@ private void addTemplatesToRAttrs() {\n                         role.getId())) {\n                     final RVirAttr rVirAttr = virAttrDAO.find(attrId, RVirAttr.class);\n \n-                    LOG.debug(\"Adding template to role attribute {}\", rVirAttr);\n+                    LOG.info(\"Adding template to role attribute {}\", rVirAttr);\n \n                     final String virSchemaName = jdbcTemplate.queryForObject(\n                             \"SELECT VIRTUALSCHEMA_NAME FROM RVirAttr WHERE id = ?;\", String.class, attrId);\n@@ -613,7 +613,7 @@ private void addTemplatesToMemberships() {\n                 final List<MVirAttr> newMVirattrs = new ArrayList<MVirAttr>();\n                 final List<MVirAttrTemplate> newMVirattrTemplates = new ArrayList<MVirAttrTemplate>();\n \n-                LOG.debug(\"Adding template to membership {}\", membership);\n+                LOG.info(\"Adding template to membership {}\", membership);\n \n                 //Create normal attributes templates\n                 for (AbstractAttr attr : membership.getAttrs()) {\n@@ -673,7 +673,7 @@ private void addTemplatesToMAttrs() {\n                         membership.getId())) {\n                     final MAttr mAttr = attrDAO.find(attrId, MAttr.class);\n \n-                    LOG.debug(\"Adding template to membership normal attribute {}\", mAttr);\n+                    LOG.info(\"Adding template to membership normal attribute {}\", mAttr);\n \n                     final String schemaName = jdbcTemplate.queryForObject(\n                             \"SELECT schema_name FROM MAttr WHERE id = ?;\", String.class, attrId);\n@@ -687,7 +687,7 @@ private void addTemplatesToMAttrs() {\n                         membership.getId())) {\n                     final MDerAttr mDerAttr = derAttrDAO.find(attrId, MDerAttr.class);\n \n-                    LOG.debug(\"Adding template to membership derived attribute {}\", mDerAttr);\n+                    LOG.info(\"Adding template to membership derived attribute {}\", mDerAttr);\n \n                     final String derSchemaName = jdbcTemplate.queryForObject(\n                             \"SELECT DERIVEDSCHEMA_NAME FROM MDerAttr WHERE id = ?;\", String.class, attrId);\n@@ -701,7 +701,7 @@ private void addTemplatesToMAttrs() {\n                         membership.getId())) {\n                     final MVirAttr mVirAttr = virAttrDAO.find(attrId, MVirAttr.class);\n \n-                    LOG.debug(\"Adding template to membership virtual attribute {}\", mVirAttr);\n+                    LOG.info(\"Adding template to membership virtual attribute {}\", mVirAttr);\n \n                     final String virSchemaName = jdbcTemplate.queryForObject(\n                             \"SELECT VIRTUALSCHEMA_NAME FROM MVirAttr WHERE id = ?;\", String.class, attrId);"},{"sha":"21decb1b3f127c5e59c789bfdb1223eec67746c3","filename":"core/src/main/resources/log4j2.xml","status":"modified","additions":0,"deletions":18,"changes":18,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/35b1b5103afc059240bd18e024e1df7ab05fc20a/core%2Fsrc%2Fmain%2Fresources%2Flog4j2.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/35b1b5103afc059240bd18e024e1df7ab05fc20a/core%2Fsrc%2Fmain%2Fresources%2Flog4j2.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fresources%2Flog4j2.xml?ref=35b1b5103afc059240bd18e024e1df7ab05fc20a","patch":"@@ -69,19 +69,6 @@ under the License.\n       </Policies>\n     </RollingRandomAccessFile>\n \n-    <!--upgrader-->\n-    <RollingRandomAccessFile name=\"upgrader\" fileName=\"${log.directory}/upgrader.log\"\n-                             filePattern=\"${log.directory}/upgrader-%d{yyyy-MM-dd}.log.gz\"\n-                             immediateFlush=\"false\" append=\"true\">\n-      <PatternLayout>\n-        <pattern>%d{HH:mm:ss.SSS} %-5level %logger - %msg%n</pattern>\n-      </PatternLayout>\n-      <Policies>\n-        <TimeBasedTriggeringPolicy/>\n-        <SizeBasedTriggeringPolicy size=\"250 MB\"/>\n-      </Policies>\n-    </RollingRandomAccessFile>\n-\n     <!-- Audit -->    \n     <Jdbc name=\"audit\" tableName=\"SYNCOPEAUDIT\">\n       <ConnectionFactory class=\"org.apache.syncope.core.audit.AuditConnectionFactory\" method=\"getConnection\" />\n@@ -156,11 +143,6 @@ under the License.\n       <appender-ref ref=\"rest\"/>\n     </asyncLogger>\n      \n-    <!--upgrader logger-->               \n-    <asyncLogger name=\"org.apache.syncope.upgrader\" additivity=\"false\" level=\"OFF\">\n-      <appender-ref ref=\"upgrader\"/>\n-    </asyncLogger>\n-\n     <logger name=\"syncope.audit\" additivity=\"false\" level=\"DEBUG\">\n       <appender-ref ref=\"audit\"/>\n     </logger>"}]}