{"sha":"813625713812587eb683205cc8e5d036ccda08ff","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjgxMzYyNTcxMzgxMjU4N2ViNjgzMjA1Y2M4ZTVkMDM2Y2NkYTA4ZmY=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2020-05-19T14:05:45Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2020-05-19T14:05:45Z"},"message":"[SYNCOPE-1560] Possibly the last tweaks","tree":{"sha":"940d90ef2f6ab179ab0730201aa31d234ed19202","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/940d90ef2f6ab179ab0730201aa31d234ed19202"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/813625713812587eb683205cc8e5d036ccda08ff","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/813625713812587eb683205cc8e5d036ccda08ff","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/813625713812587eb683205cc8e5d036ccda08ff","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/813625713812587eb683205cc8e5d036ccda08ff/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"d08d0a69e14cc890712745dc2d57c23fd3c91618","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/d08d0a69e14cc890712745dc2d57c23fd3c91618","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/d08d0a69e14cc890712745dc2d57c23fd3c91618"}],"stats":{"total":33,"additions":14,"deletions":19},"files":[{"sha":"3e21b1e4c15d94d2cc8caa30eb2a5b9fc96862a1","filename":"client/idm/console/src/main/java/org/apache/syncope/client/console/wizards/CSVPullWizardBuilder.java","status":"modified","additions":4,"deletions":5,"changes":9,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/813625713812587eb683205cc8e5d036ccda08ff/client%2Fidm%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FCSVPullWizardBuilder.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/813625713812587eb683205cc8e5d036ccda08ff/client%2Fidm%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FCSVPullWizardBuilder.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidm%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FCSVPullWizardBuilder.java?ref=813625713812587eb683205cc8e5d036ccda08ff","patch":"@@ -129,24 +129,23 @@ public class Details extends WizardStep {\n         private static final long serialVersionUID = -4736870165235853919L;\n \n         public Details(final CSVPullSpec spec) {\n-            ListModel<FileUpload> fileUploadModel = new ListModel<>(new ArrayList<>());\n             FileInputConfig csvFile = new FileInputConfig().\n                     showUpload(false).showRemove(false).showPreview(false).\n                     browseClass(\"btn btn-success\").browseIcon(\"<i class=\\\"fas fa-folder-open\\\"></i> &nbsp;\");\n             String language = SyncopeConsoleSession.get().getLocale().getLanguage();\n             if (!Locale.ENGLISH.getLanguage().equals(language)) {\n                 csvFile.withLocale(language);\n             }\n-            BootstrapFileInputField csvUpload = new BootstrapFileInputField(\"csvUpload\", fileUploadModel, csvFile);\n+            BootstrapFileInputField csvUpload =\n+                    new BootstrapFileInputField(\"csvUpload\", new ListModel<>(new ArrayList<>()), csvFile);\n             csvUpload.add(new AjaxFormSubmitBehavior(Constants.ON_CHANGE) {\n \n                 private static final long serialVersionUID = 5538299138211283825L;\n \n                 @Override\n                 protected void onSubmit(final AjaxRequestTarget target) {\n-                    if (!fileUploadModel.getObject().isEmpty()) {\n-                        FileUpload uploadedFile = fileUploadModel.getObject().get(0);\n-\n+                    FileUpload uploadedFile = csvUpload.getFileUpload();\n+                    if (uploadedFile != null) {\n                         if (maxUploadSize != null && uploadedFile.getSize() > maxUploadSize.bytes()) {\n                             SyncopeConsoleSession.get().error(getString(\"tooLargeFile\").\n                                     replace(\"${maxUploadSizeB}\", String.valueOf(maxUploadSize.bytes()))."},{"sha":"62191347943c16e4dcd1a24d2db695bd610326e7","filename":"client/idrepo/console/src/main/java/org/apache/syncope/client/console/wicket/markup/html/form/BinaryFieldPanel.java","status":"modified","additions":3,"deletions":5,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/813625713812587eb683205cc8e5d036ccda08ff/client%2Fidrepo%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FBinaryFieldPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/813625713812587eb683205cc8e5d036ccda08ff/client%2Fidrepo%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FBinaryFieldPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FBinaryFieldPanel.java?ref=813625713812587eb683205cc8e5d036ccda08ff","patch":"@@ -179,24 +179,22 @@ public void onClick(final AjaxRequestTarget target) {\n         downloadLink.setOutputMarkupId(true);\n         uploadForm.add(downloadLink);\n \n-        ListModel<FileUpload> fileUploadModel = new ListModel<>(new ArrayList<>());\n         FileInputConfig config = new FileInputConfig().\n                 showUpload(false).showRemove(false).showPreview(false).\n                 browseClass(\"btn btn-success\").browseIcon(\"<i class=\\\"fas fa-folder-open\\\"></i> &nbsp;\");\n         String language = SyncopeConsoleSession.get().getLocale().getLanguage();\n         if (!Locale.ENGLISH.getLanguage().equals(language)) {\n             config.withLocale(language);\n         }\n-        fileUpload = new BootstrapFileInputField(\"fileUpload\", fileUploadModel, config);\n+        fileUpload = new BootstrapFileInputField(\"fileUpload\", new ListModel<>(new ArrayList<>()), config);\n         fileUpload.add(new AjaxFormSubmitBehavior(Constants.ON_CHANGE) {\n \n             private static final long serialVersionUID = -1107858522700306810L;\n \n             @Override\n             protected void onSubmit(final AjaxRequestTarget target) {\n-                if (!fileUploadModel.getObject().isEmpty()) {\n-                    FileUpload uploaded = fileUploadModel.getObject().get(0);\n-\n+                FileUpload uploaded = fileUpload.getFileUpload();\n+                if (uploaded != null) {\n                     if (maxUploadSize != null && uploaded.getSize() > maxUploadSize.bytes()) {\n                         // SYNCOPE-1213 manage directly max upload file size (if set in properties file)\n                         SyncopeConsoleSession.get().error(getString(\"tooLargeFile\")."},{"sha":"7de12999300ab334a7995c08fff9c12731fc4e40","filename":"client/idrepo/enduser/src/main/java/org/apache/syncope/client/enduser/markup/html/form/BinaryFieldPanel.java","status":"modified","additions":3,"deletions":5,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/813625713812587eb683205cc8e5d036ccda08ff/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fmarkup%2Fhtml%2Fform%2FBinaryFieldPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/813625713812587eb683205cc8e5d036ccda08ff/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fmarkup%2Fhtml%2Fform%2FBinaryFieldPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fmarkup%2Fhtml%2Fform%2FBinaryFieldPanel.java?ref=813625713812587eb683205cc8e5d036ccda08ff","patch":"@@ -177,7 +177,6 @@ public void onClick(final AjaxRequestTarget target) {\n         downloadLink.setOutputMarkupId(true);\n         uploadForm.add(downloadLink);\n \n-        ListModel<FileUpload> fileUploadModel = new ListModel<>(new ArrayList<>());\n         FileInputConfig config = new FileInputConfig().\n                 showUpload(false).showRemove(false).showPreview(false).\n                 browseClass(\"btn btn-success\").browseIcon(\"<i class=\\\"fas fa-folder-open\\\"></i> &nbsp;\");\n@@ -186,7 +185,7 @@ public void onClick(final AjaxRequestTarget target) {\n             config.withLocale(language);\n         }\n \n-        fileUpload = new BootstrapFileInputField(\"fileUpload\", fileUploadModel, config);\n+        fileUpload = new BootstrapFileInputField(\"fileUpload\", new ListModel<>(new ArrayList<>()), config);\n         fileUpload.setOutputMarkupId(true);\n \n         fileUpload.add(new AjaxFormSubmitBehavior(Constants.ON_CHANGE) {\n@@ -195,9 +194,8 @@ public void onClick(final AjaxRequestTarget target) {\n \n             @Override\n             protected void onSubmit(final AjaxRequestTarget target) {\n-                if (!fileUploadModel.getObject().isEmpty()) {\n-                    FileUpload uploaded = fileUploadModel.getObject().get(0);\n-\n+                FileUpload uploaded = fileUpload.getFileUpload();\n+                if (uploaded != null) {\n                     if (maxUploadSize != null && uploaded.getSize() > maxUploadSize.bytes()) {\n                         // SYNCOPE-1213 manage directly max upload file size (if set in properties file)\n                         SyncopeEnduserSession.get().error(getString(\"tooLargeFile\")."},{"sha":"449795fc4654256e066fbb8336b91e5de8cf4f9f","filename":"ext/saml2sp/client-console/src/main/java/org/apache/syncope/client/console/panels/ImportMetadata.java","status":"modified","additions":4,"deletions":4,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/813625713812587eb683205cc8e5d036ccda08ff/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FImportMetadata.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/813625713812587eb683205cc8e5d036ccda08ff/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FImportMetadata.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FImportMetadata.java?ref=813625713812587eb683205cc8e5d036ccda08ff","patch":"@@ -45,15 +45,15 @@ public ImportMetadata(final String id, final WebMarkupContainer container, final\n         Form<?> form = new Form<>(\"metadataForm\");\n         addInnerObject(form);\n \n-        ListModel<FileUpload> fileUploadModel = new ListModel<>(new ArrayList<>());\n         FileInputConfig config = new FileInputConfig().\n                 showUpload(false).showRemove(false).showPreview(false).\n                 browseClass(\"btn btn-success\").browseIcon(\"<i class=\\\"fas fa-folder-open\\\"></i> &nbsp;\");\n         String language = SyncopeConsoleSession.get().getLocale().getLanguage();\n         if (!Locale.ENGLISH.getLanguage().equals(language)) {\n             config.withLocale(language);\n         }\n-        BootstrapFileInputField fileUpload = new BootstrapFileInputField(\"fileUpload\", fileUploadModel, config);\n+        BootstrapFileInputField fileUpload =\n+                new BootstrapFileInputField(\"fileUpload\", new ListModel<>(new ArrayList<>()), config);\n         form.add(fileUpload.setOutputMarkupId(true));\n \n         form.add(new AjaxSubmitLink(\"doUpload\", form) {\n@@ -62,8 +62,8 @@ public ImportMetadata(final String id, final WebMarkupContainer container, final\n \n             @Override\n             protected void onSubmit(final AjaxRequestTarget target) {\n-                if (!fileUploadModel.getObject().isEmpty()) {\n-                    FileUpload uploaded = fileUploadModel.getObject().get(0);\n+                FileUpload uploaded = fileUpload.getFileUpload();\n+                if (uploaded != null) {\n                     try {\n                         SAML2IdPsRestClient.importIdPs(uploaded.getInputStream());\n "}]}