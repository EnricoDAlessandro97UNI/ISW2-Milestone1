{"sha":"951a64a7aa83c92ed619a3b306ddf92d0968a468","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjk1MWE2NGE3YWE4M2M5MmVkNjE5YTNiMzA2ZGRmOTJkMDk2OGE0Njg=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2016-05-12T15:46:11Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2016-05-12T15:46:11Z"},"message":"[SYNCOPE-848] Refactoring completed","tree":{"sha":"29c66ccd326e4f80fcb54a10cc104ed16beb9599","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/29c66ccd326e4f80fcb54a10cc104ed16beb9599"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/951a64a7aa83c92ed619a3b306ddf92d0968a468","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/951a64a7aa83c92ed619a3b306ddf92d0968a468","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/951a64a7aa83c92ed619a3b306ddf92d0968a468","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/951a64a7aa83c92ed619a3b306ddf92d0968a468/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"67fe7075bff71bca00b2fca3381bbdfe40f1cfa3","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/67fe7075bff71bca00b2fca3381bbdfe40f1cfa3","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/67fe7075bff71bca00b2fca3381bbdfe40f1cfa3"}],"stats":{"total":299,"additions":154,"deletions":145},"files":[{"sha":"9bcff62ae40b7511933ac0ab527d1ad46ddd1935","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/SchemaTypePanel.java","status":"modified","additions":7,"deletions":4,"changes":11,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSchemaTypePanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSchemaTypePanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSchemaTypePanel.java?ref=951a64a7aa83c92ed619a3b306ddf92d0968a468","patch":"@@ -70,10 +70,12 @@ public class SchemaTypePanel extends TypesDirectoryPanel<AbstractSchemaTO, Schem\n         private static final long serialVersionUID = 3109256773218160485L;\n \n         {\n-            put(SchemaType.PLAIN, Arrays.asList(new String[] { \"key\", \"type\",\n-                \"mandatoryCondition\", \"uniqueConstraint\", \"multivalue\", \"readonly\" }));\n-            put(SchemaType.DERIVED, Arrays.asList(new String[] { \"key\", \"expression\" }));\n-            put(SchemaType.VIRTUAL, Arrays.asList(new String[] { \"key\", \"provision\", \"extAttrName\", \"readonly\" }));\n+            put(SchemaType.PLAIN, Arrays.asList(new String[] {\n+                \"key\", \"type\", \"mandatoryCondition\", \"uniqueConstraint\", \"multivalue\", \"readonly\" }));\n+            put(SchemaType.DERIVED, Arrays.asList(new String[] {\n+                \"key\", \"expression\" }));\n+            put(SchemaType.VIRTUAL, Arrays.asList(new String[] {\n+                \"key\", \"resource\", \"anyType\", \"extAttrName\", \"readonly\" }));\n         }\n     };\n \n@@ -96,6 +98,7 @@ public SchemaTypePanel(final String id, final SchemaType schemaType, final PageR\n                 @Override\n                 public WizardModalPanel<AbstractSchemaTO> build(\n                         final String id, final int index, final AjaxWizard.Mode mode) {\n+\n                     final AbstractSchemaTO modelObject = newModelObject();\n                     return new SchemaModalPanel(modal, modelObject, pageRef) {\n "},{"sha":"b0a341253adc7604c496f6e9f0cad1d4d77e1f19","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/VirSchemaDetails.java","status":"modified","additions":73,"deletions":38,"changes":111,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FVirSchemaDetails.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FVirSchemaDetails.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FVirSchemaDetails.java?ref=951a64a7aa83c92ed619a3b306ddf92d0968a468","patch":"@@ -19,22 +19,30 @@\n package org.apache.syncope.client.console.panels;\n \n import java.util.ArrayList;\n+import java.util.Collections;\n import java.util.HashMap;\n+import java.util.List;\n import java.util.Map;\n import org.apache.commons.collections4.CollectionUtils;\n+import org.apache.commons.collections4.IterableUtils;\n+import org.apache.commons.collections4.Predicate;\n+import org.apache.syncope.client.console.SyncopeConsoleSession;\n import org.apache.syncope.client.console.commons.Constants;\n+import org.apache.syncope.client.console.rest.ConnectorRestClient;\n import org.apache.syncope.client.console.rest.ResourceRestClient;\n import org.apache.syncope.client.console.wicket.ajax.form.IndicatorAjaxFormComponentUpdatingBehavior;\n import org.apache.syncope.client.console.wicket.markup.html.form.AjaxCheckBoxPanel;\n import org.apache.syncope.client.console.wicket.markup.html.form.AjaxDropDownChoicePanel;\n import org.apache.syncope.client.console.wicket.markup.html.form.AjaxTextFieldPanel;\n import org.apache.syncope.common.lib.EntityTOUtils;\n import org.apache.syncope.common.lib.to.AbstractSchemaTO;\n+import org.apache.syncope.common.lib.to.ConnIdObjectClassTO;\n+import org.apache.syncope.common.lib.to.ConnInstanceTO;\n import org.apache.syncope.common.lib.to.ProvisionTO;\n import org.apache.syncope.common.lib.to.ResourceTO;\n+import org.apache.syncope.common.lib.types.StandardEntitlement;\n import org.apache.wicket.PageReference;\n import org.apache.wicket.ajax.AjaxRequestTarget;\n-import org.apache.wicket.markup.html.form.ChoiceRenderer;\n import org.apache.wicket.model.PropertyModel;\n \n public class VirSchemaDetails extends AbstractSchemaDetailsPanel {\n@@ -43,43 +51,50 @@ public class VirSchemaDetails extends AbstractSchemaDetailsPanel {\n \n     private final ResourceRestClient resourceRestClient = new ResourceRestClient();\n \n-    private Map<String, String> anys = new HashMap<>();\n+    private final ConnectorRestClient connRestClient = new ConnectorRestClient();\n \n-    private final AjaxDropDownChoicePanel<String> provision;\n+    private final Map<String, String> anyTypes = new HashMap<>();\n+\n+    private final AjaxDropDownChoicePanel<String> anyType;\n+\n+    private ResourceTO selectedResource;\n \n     public VirSchemaDetails(final String id,\n             final PageReference pageReference,\n             final AbstractSchemaTO schemaTO) {\n+\n         super(id, pageReference, schemaTO);\n \n-        final AjaxCheckBoxPanel readonly = new AjaxCheckBoxPanel(\"readonly\", getString(\"readonly\"),\n+        AjaxCheckBoxPanel readonly = new AjaxCheckBoxPanel(\"readonly\", getString(\"readonly\"),\n                 new PropertyModel<Boolean>(schemaTO, \"readonly\"));\n         schemaForm.add(readonly);\n \n         final AjaxDropDownChoicePanel<String> resource = new AjaxDropDownChoicePanel<>(\n                 \"resource\", getString(\"resource\"), new PropertyModel<String>(schemaTO, \"resource\"));\n         resource.setChoices(CollectionUtils.collect(resourceRestClient.list(),\n                 EntityTOUtils.<ResourceTO>keyTransformer(), new ArrayList<String>()));\n-\n         resource.setOutputMarkupId(true);\n         resource.addRequiredLabel();\n+        if (resource.getModelObject() != null) {\n+            populateAnyTypes(resource.getModelObject());\n+        }\n         schemaForm.add(resource);\n \n-        provision = new AjaxDropDownChoicePanel<>(\n-                \"provision\", getString(\"provision\"), new PropertyModel<String>(schemaTO, \"provision\"));\n-\n-        provision.setChoices(new ArrayList<>(anys.keySet()));\n-        provision.setChoiceRenderer(new AnyTypeRenderer());\n-        provision.setOutputMarkupId(true);\n-        provision.setOutputMarkupPlaceholderTag(true);\n-        provision.addRequiredLabel();\n-        provision.setVisible(false);\n-\n-        schemaForm.add(provision);\n+        anyType = new AjaxDropDownChoicePanel<>(\n+                \"anyType\", getString(\"anyType\"), new PropertyModel<String>(schemaTO, \"anyType\"));\n+        anyType.setChoices(new ArrayList<>(anyTypes.keySet()));\n+        anyType.setOutputMarkupId(true);\n+        anyType.setOutputMarkupPlaceholderTag(true);\n+        anyType.addRequiredLabel();\n+        schemaForm.add(anyType);\n \n         final AjaxTextFieldPanel extAttrName = new AjaxTextFieldPanel(\n                 \"extAttrName\", getString(\"extAttrName\"), new PropertyModel<String>(schemaTO, \"extAttrName\"));\n+        extAttrName.setOutputMarkupId(true);\n         extAttrName.addRequiredLabel();\n+        if (selectedResource != null) {\n+            extAttrName.setChoices(getExtAttrNames());\n+        }\n         schemaForm.add(extAttrName);\n \n         add(schemaForm);\n@@ -90,36 +105,56 @@ public VirSchemaDetails(final String id,\n \n             @Override\n             protected void onUpdate(final AjaxRequestTarget target) {\n-                anys.clear();\n-                if (resource != null & resource.getModelObject() != null) {\n-                    for (ProvisionTO provisionTO : resourceRestClient.read(resource.getModelObject()).getProvisions()) {\n-                        anys.put(provisionTO.getKey(), provisionTO.getAnyType());\n-                    }\n+                anyTypes.clear();\n+                if (resource.getModelObject() != null) {\n+                    populateAnyTypes(resource.getModelObject());\n                 }\n-                provision.setChoices(new ArrayList<>(anys.keySet()));\n-                provision.setModelObject(null);\n-                provision.setVisible(true);\n-                target.add(provision);\n+                anyType.setChoices(new ArrayList<>(anyTypes.keySet()));\n+                anyType.setModelObject(null);\n+                target.add(anyType);\n             }\n         });\n-    }\n \n-    private class AnyTypeRenderer extends ChoiceRenderer<String> {\n+        anyType.getField().add(new IndicatorAjaxFormComponentUpdatingBehavior(Constants.ON_CHANGE) {\n \n-        private static final long serialVersionUID = 2840364232128308553L;\n+            private static final long serialVersionUID = -1107858522700306810L;\n \n-        AnyTypeRenderer() {\n-            super();\n-        }\n+            @Override\n+            protected void onUpdate(final AjaxRequestTarget target) {\n+                if (selectedResource != null && SyncopeConsoleSession.get().owns(StandardEntitlement.CONNECTOR_READ)) {\n+                    extAttrName.setChoices(getExtAttrNames());\n+                    target.add(extAttrName);\n+                }\n+            }\n+        });\n+    }\n \n-        @Override\n-        public Object getDisplayValue(final String object) {\n-            return anys.get(object);\n+    private void populateAnyTypes(final String resourceKey) {\n+        anyTypes.clear();\n+        if (resourceKey != null && SyncopeConsoleSession.get().owns(StandardEntitlement.RESOURCE_READ)) {\n+            selectedResource = resourceRestClient.read(resourceKey);\n+            for (ProvisionTO provisionTO : selectedResource.getProvisions()) {\n+                anyTypes.put(provisionTO.getAnyType(), provisionTO.getObjectClass());\n+            }\n         }\n+    }\n \n-        @Override\n-        public String getIdValue(final String object, final int index) {\n-            return String.valueOf(object != null ? object : 0L);\n-        }\n+    private List<String> getExtAttrNames() {\n+        ConnInstanceTO connInstanceTO = new ConnInstanceTO();\n+        connInstanceTO.setKey(selectedResource.getConnector());\n+        connInstanceTO.getConf().addAll(selectedResource.getConfOverride());\n+\n+        ConnIdObjectClassTO connIdObjectClass = IterableUtils.find(\n+                connRestClient.buildObjectClassInfo(connInstanceTO, false), new Predicate<ConnIdObjectClassTO>() {\n+\n+            @Override\n+            public boolean evaluate(final ConnIdObjectClassTO object) {\n+                return object.getType().equals(anyTypes.get(anyType.getModelObject()));\n+            }\n+        });\n+\n+        return connIdObjectClass == null\n+                ? Collections.<String>emptyList()\n+                : connIdObjectClass.getAttributes();\n     }\n }"},{"sha":"a6ad2ebf771cc165d287e4900150a3508fcff076","filename":"client/console/src/main/java/org/apache/syncope/client/console/rest/SchemaRestClient.java","status":"modified","additions":0,"deletions":45,"changes":45,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Frest%2FSchemaRestClient.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Frest%2FSchemaRestClient.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Frest%2FSchemaRestClient.java?ref=951a64a7aa83c92ed619a3b306ddf92d0968a468","patch":"@@ -122,63 +122,18 @@ public List<String> getVirSchemaNames() {\n         return getSchemaNames(SchemaType.VIRTUAL);\n     }\n \n-    public void createPlainSchema(final PlainSchemaTO schemaTO) {\n-        getService(SchemaService.class).create(SchemaType.PLAIN, schemaTO);\n-    }\n-\n-    public PlainSchemaTO readPlainSchema(final String name) {\n-        PlainSchemaTO schema = null;\n-\n-        try {\n-            schema = getService(SchemaService.class).read(SchemaType.PLAIN, name);\n-        } catch (SyncopeClientException e) {\n-            LOG.error(\"While reading a user schema\", e);\n-        }\n-        return schema;\n-    }\n-\n-    public void updatePlainSchema(final PlainSchemaTO schemaTO) {\n-        getService(SchemaService.class).update(SchemaType.PLAIN, schemaTO);\n-    }\n-\n     public PlainSchemaTO deletePlainSchema(final String name) {\n         PlainSchemaTO response = getService(SchemaService.class).read(SchemaType.PLAIN, name);\n         getService(SchemaService.class).delete(SchemaType.PLAIN, name);\n         return response;\n     }\n \n-    public void createDerSchema(final DerSchemaTO schemaTO) {\n-        getService(SchemaService.class).create(SchemaType.DERIVED, schemaTO);\n-    }\n-\n-    public DerSchemaTO readDerSchema(final String name) {\n-        DerSchemaTO derivedSchemaTO = null;\n-        try {\n-            derivedSchemaTO = getService(SchemaService.class).read(SchemaType.DERIVED, name);\n-        } catch (SyncopeClientException e) {\n-            LOG.error(\"While reading a derived user schema\", e);\n-        }\n-        return derivedSchemaTO;\n-    }\n-\n-    public void updateVirSchema(final VirSchemaTO schemaTO) {\n-        getService(SchemaService.class).update(SchemaType.VIRTUAL, schemaTO);\n-    }\n-\n     public DerSchemaTO deleteDerSchema(final String name) {\n         DerSchemaTO schemaTO = getService(SchemaService.class).read(SchemaType.DERIVED, name);\n         getService(SchemaService.class).delete(SchemaType.DERIVED, name);\n         return schemaTO;\n     }\n \n-    public void createVirSchema(final VirSchemaTO schemaTO) {\n-        getService(SchemaService.class).create(SchemaType.VIRTUAL, schemaTO);\n-    }\n-\n-    public void updateDerSchema(final DerSchemaTO schemaTO) {\n-        getService(SchemaService.class).update(SchemaType.DERIVED, schemaTO);\n-    }\n-\n     public VirSchemaTO deleteVirSchema(final String name) {\n         VirSchemaTO schemaTO = getService(SchemaService.class).read(SchemaType.VIRTUAL, name);\n         getService(SchemaService.class).delete(SchemaType.VIRTUAL, name);"},{"sha":"267b425e48eebb50b6600b084e40355ab7d1ccc5","filename":"client/console/src/main/resources/META-INF/resources/css/syncopeConsole.css","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fcss%2FsyncopeConsole.css","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fcss%2FsyncopeConsole.css","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fcss%2FsyncopeConsole.css?ref=951a64a7aa83c92ed619a3b306ddf92d0968a468","patch":"@@ -229,8 +229,8 @@ a.help span a {\n }\n \n .wizard-view {\n-  max-height: 500px;\n-  height: 500px;\n+  max-height: 450px;\n+  height: 450px;\n   overflow-y: auto;\n   overflow-x: hidden;\n   padding: 0px 5px 0px 5px;"},{"sha":"686675a2082090d759a265b3df5d0c00f5948172","filename":"client/console/src/main/resources/org/apache/syncope/client/console/panels/SchemasPanel.properties","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSchemasPanel.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSchemasPanel.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSchemasPanel.properties?ref=951a64a7aa83c92ed619a3b306ddf92d0968a468","patch":"@@ -25,5 +25,6 @@ type=Type\n title=Schema\n readonly=Read-only\n expression=Expression\n-provision=Provision\n+resource=Resource\n extAttrName=ExtAttrName\n+anyType=Type"},{"sha":"52622d057ef5a1317f0c4333e0691d6ca66f20dc","filename":"client/console/src/main/resources/org/apache/syncope/client/console/panels/SchemasPanel_it.properties","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSchemasPanel_it.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSchemasPanel_it.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSchemasPanel_it.properties?ref=951a64a7aa83c92ed619a3b306ddf92d0968a468","patch":"@@ -25,5 +25,6 @@ title=Schema\n readonly=Read-only\n uniqueConstraint=Univoco\n expression=Express\\u00e3o\n-provision=Provision\n+resource=Resource\n extAttrName=ExtAttrName\n+anyType=Tipo"},{"sha":"ed0e5fb5de5df5e88080742309c5e775fe6f8acf","filename":"client/console/src/main/resources/org/apache/syncope/client/console/panels/SchemasPanel_pt_BR.properties","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSchemasPanel_pt_BR.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSchemasPanel_pt_BR.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSchemasPanel_pt_BR.properties?ref=951a64a7aa83c92ed619a3b306ddf92d0968a468","patch":"@@ -25,5 +25,6 @@ type=Tipo\n title=Esquema\n readonly=Apenas leitura\n expression=Espressione\n-provision=Provision\n+resource=Resource\n extAttrName=ExtAttrName\n+anyType=Type"},{"sha":"b18d2d20e451659be18e07bf2d6e92fd03bca7aa","filename":"client/console/src/main/resources/org/apache/syncope/client/console/panels/SchemasPanel_ru.properties","status":"modified","additions":15,"deletions":14,"changes":29,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSchemasPanel_ru.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSchemasPanel_ru.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSchemasPanel_ru.properties?ref=951a64a7aa83c92ed619a3b306ddf92d0968a468","patch":"@@ -15,29 +15,30 @@\n # specific language governing permissions and limitations\n # under the License.\n #\n-# any.edit=Изменить атрибут ${key}\n+# any.edit=\\u00d0\\u0098\\u00d0\\u00b7\\u00d0\\u00bc\\u00d0\\u00b5\\u00d0\\u00bd\\u00d0\\u00b8\\u00d1\\u0082\\u00d1\\u008c \\u00d0\\u00b0\\u00d1\\u0082\\u00d1\\u0080\\u00d0\\u00b8\\u00d0\\u00b1\\u00d1\\u0083\\u00d1\\u0082 ${key}\n any.edit=\\u0418\\u0437\\u043c\\u0435\\u043d\\u0438\\u0442\\u044c \\u0430\\u0442\\u0440\\u0438\\u0431\\u0443\\u0442 ${key}\n-# any.new=Создать атрибут\n+# any.new=\\u00d0\\u00a1\\u00d0\\u00be\\u00d0\\u00b7\\u00d0\\u00b4\\u00d0\\u00b0\\u00d1\\u0082\\u00d1\\u008c \\u00d0\\u00b0\\u00d1\\u0082\\u00d1\\u0080\\u00d0\\u00b8\\u00d0\\u00b1\\u00d1\\u0083\\u00d1\\u0082\n any.new=\\u0421\\u043e\\u0437\\u0434\\u0430\\u0442\\u044c \\u0430\\u0442\\u0440\\u0438\\u0431\\u0443\\u0442\n-# mandatoryCondition=Обязательный\n+# mandatoryCondition=\\u00d0\\u009e\\u00d0\\u00b1\\u00d1\\u008f\\u00d0\\u00b7\\u00d0\\u00b0\\u00d1\\u0082\\u00d0\\u00b5\\u00d0\\u00bb\\u00d1\\u008c\\u00d0\\u00bd\\u00d1\\u008b\\u00d0\\u00b9\n mandatoryCondition=\\u041e\\u0431\\u044f\\u0437\\u0430\\u0442\\u0435\\u043b\\u044c\\u043d\\u044b\\u0439\n-# enumerationValues=Перечень значений\n+# enumerationValues=\\u00d0\\u009f\\u00d0\\u00b5\\u00d1\\u0080\\u00d0\\u00b5\\u00d1\\u0087\\u00d0\\u00b5\\u00d0\\u00bd\\u00d1\\u008c \\u00d0\\u00b7\\u00d0\\u00bd\\u00d0\\u00b0\\u00d1\\u0087\\u00d0\\u00b5\\u00d0\\u00bd\\u00d0\\u00b8\\u00d0\\u00b9\n enumerationValues=\\u041f\\u0435\\u0440\\u0435\\u0447\\u0435\\u043d\\u044c \\u0437\\u043d\\u0430\\u0447\\u0435\\u043d\\u0438\\u0439\n-# enumerationKeys=Перечень наименований\n+# enumerationKeys=\\u00d0\\u009f\\u00d0\\u00b5\\u00d1\\u0080\\u00d0\\u00b5\\u00d1\\u0087\\u00d0\\u00b5\\u00d0\\u00bd\\u00d1\\u008c \\u00d0\\u00bd\\u00d0\\u00b0\\u00d0\\u00b8\\u00d0\\u00bc\\u00d0\\u00b5\\u00d0\\u00bd\\u00d0\\u00be\\u00d0\\u00b2\\u00d0\\u00b0\\u00d0\\u00bd\\u00d0\\u00b8\\u00d0\\u00b9\n enumerationKeys=\\u041f\\u0435\\u0440\\u0435\\u0447\\u0435\\u043d\\u044c \\u043d\\u0430\\u0438\\u043c\\u0435\\u043d\\u043e\\u0432\\u0430\\u043d\\u0438\\u0439\n-# uniqueConstraint=Уникальный\n+# uniqueConstraint=\\u00d0\\u00a3\\u00d0\\u00bd\\u00d0\\u00b8\\u00d0\\u00ba\\u00d0\\u00b0\\u00d0\\u00bb\\u00d1\\u008c\\u00d0\\u00bd\\u00d1\\u008b\\u00d0\\u00b9\n uniqueConstraint=\\u0423\\u043d\\u0438\\u043a\\u0430\\u043b\\u044c\\u043d\\u044b\\u0439\n-# multivalue=Множественные значения\n+# multivalue=\\u00d0\\u009c\\u00d0\\u00bd\\u00d0\\u00be\\u00d0\\u00b6\\u00d0\\u00b5\\u00d1\\u0081\\u00d1\\u0082\\u00d0\\u00b2\\u00d0\\u00b5\\u00d0\\u00bd\\u00d0\\u00bd\\u00d1\\u008b\\u00d0\\u00b5 \\u00d0\\u00b7\\u00d0\\u00bd\\u00d0\\u00b0\\u00d1\\u0087\\u00d0\\u00b5\\u00d0\\u00bd\\u00d0\\u00b8\\u00d1\\u008f\n multivalue=\\u041c\\u043d\\u043e\\u0436\\u0435\\u0441\\u0442\\u0432\\u0435\\u043d\\u043d\\u044b\\u0435 \\u0437\\u043d\\u0430\\u0447\\u0435\\u043d\\u0438\\u044f\n-# type=Тип\n+# type=\\u00d0\\u00a2\\u00d0\\u00b8\\u00d0\\u00bf\n type=\\u0422\\u0438\\u043f\n-# title=Атрибут\n+# title=\\u00d0\\u0090\\u00d1\\u0082\\u00d1\\u0080\\u00d0\\u00b8\\u00d0\\u00b1\\u00d1\\u0083\\u00d1\\u0082\n title=\\u0410\\u0442\\u0440\\u0438\\u0431\\u0443\\u0442\n-# readonly=Только чтение\n+# readonly=\\u00d0\\u00a2\\u00d0\\u00be\\u00d0\\u00bb\\u00d1\\u008c\\u00d0\\u00ba\\u00d0\\u00be \\u00d1\\u0087\\u00d1\\u0082\\u00d0\\u00b5\\u00d0\\u00bd\\u00d0\\u00b8\\u00d0\\u00b5\n readonly=\\u0422\\u043e\\u043b\\u044c\\u043a\\u043e \\u0447\\u0442\\u0435\\u043d\\u0438\\u0435\n-# expression=Выражение\n+# expression=\\u00d0\\u0092\\u00d1\\u008b\\u00d1\\u0080\\u00d0\\u00b0\\u00d0\\u00b6\\u00d0\\u00b5\\u00d0\\u00bd\\u00d0\\u00b8\\u00d0\\u00b5\n expression=\\u0412\\u044b\\u0440\\u0430\\u0436\\u0435\\u043d\\u0438\\u0435\n-# provision=Предоставление\n-provision=\\u041f\\u0440\\u0435\\u0434\\u043e\\u0441\\u0442\\u0430\\u0432\\u043b\\u0435\\u043d\\u0438\\u0435\n-# extAttrName=Внешний атрибут\n+# provision=\\u00d0\\u009f\\u00d1\\u0080\\u00d0\\u00b5\\u00d0\\u00b4\\u00d0\\u00be\\u00d1\\u0081\\u00d1\\u0082\\u00d0\\u00b0\\u00d0\\u00b2\\u00d0\\u00bb\\u00d0\\u00b5\\u00d0\\u00bd\\u00d0\\u00b8\\u00d0\\u00b5\n+resource=Resource\n+# extAttrName=\\u00d0\\u0092\\u00d0\\u00bd\\u00d0\\u00b5\\u00d1\\u0088\\u00d0\\u00bd\\u00d0\\u00b8\\u00d0\\u00b9 \\u00d0\\u00b0\\u00d1\\u0082\\u00d1\\u0080\\u00d0\\u00b8\\u00d0\\u00b1\\u00d1\\u0083\\u00d1\\u0082\n extAttrName=\\u0412\\u043d\\u0435\\u0448\\u043d\\u0438\\u0439 \\u0430\\u0442\\u0440\\u0438\\u0431\\u0443\\u0442\n+anyType=Type"},{"sha":"86d2ed6160492a79bb5cd4737aaf5f3935ad838b","filename":"client/console/src/main/resources/org/apache/syncope/client/console/panels/VirSchemaDetails.html","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FVirSchemaDetails.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FVirSchemaDetails.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FVirSchemaDetails.html?ref=951a64a7aa83c92ed619a3b306ddf92d0968a468","patch":"@@ -31,7 +31,7 @@\n             <span wicket:id=\"resource\">[resource]</span>\n           </div>\n           <div class=\"form-group\">\n-            <span wicket:id=\"provision\">[provision]</span>\n+            <span wicket:id=\"anyType\">[anyType]</span>\n           </div>\n           <div class=\"form-group\">\n             <span wicket:id=\"extAttrName\">[extAttrName]</span>"},{"sha":"a93c17a1f9ace0601dc5764e5e212d5d1795b434","filename":"client/console/src/main/resources/org/apache/syncope/client/console/panels/VirSchemaDetails.properties","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FVirSchemaDetails.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FVirSchemaDetails.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FVirSchemaDetails.properties?ref=951a64a7aa83c92ed619a3b306ddf92d0968a468","patch":"@@ -20,5 +20,5 @@ attributes=Virtual attributes\n title=Virtual Schema\n readonly=Read-only\n resource=Resource\n-provision=Provision\n+anyType=Type\n extAttrName=External attribute"},{"sha":"24de32579cffa74d2114bae1162d3206aa51dd96","filename":"client/console/src/main/resources/org/apache/syncope/client/console/panels/VirSchemaDetails_it.properties","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FVirSchemaDetails_it.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FVirSchemaDetails_it.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FVirSchemaDetails_it.properties?ref=951a64a7aa83c92ed619a3b306ddf92d0968a468","patch":"@@ -20,5 +20,5 @@ attributes=Attributi virtuali\n title=Schema Virtuale\n readonly=Read-only\n resource=Risorsa\n-provision=Provision\n+anyType=Tipo\n extAttrName=Attributo esterno"},{"sha":"c757d89a73cfed44f6e715643dad7deee5993519","filename":"client/console/src/main/resources/org/apache/syncope/client/console/panels/VirSchemaDetails_pt_BR.properties","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FVirSchemaDetails_pt_BR.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FVirSchemaDetails_pt_BR.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FVirSchemaDetails_pt_BR.properties?ref=951a64a7aa83c92ed619a3b306ddf92d0968a468","patch":"@@ -20,5 +20,5 @@ attributes=Atributos Virtuais\n title=Esquema Virtual\n readonly=Apenas Leitura\n resource=Recurso\n-provision=Provision\n+anyType=Type\n extAttrName=Atributo Externo"},{"sha":"87eb4595d2af210f7c5375df78ec62394414c17b","filename":"client/console/src/main/resources/org/apache/syncope/client/console/panels/VirSchemaDetails_ru.properties","status":"modified","additions":1,"deletions":10,"changes":11,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FVirSchemaDetails_ru.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/951a64a7aa83c92ed619a3b306ddf92d0968a468/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FVirSchemaDetails_ru.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FVirSchemaDetails_ru.properties?ref=951a64a7aa83c92ed619a3b306ddf92d0968a468","patch":"@@ -14,20 +14,11 @@\n # KIND, either express or implied.  See the License for the\n # specific language governing permissions and limitations\n # under the License.\n-#\n-# required_alert=Все поля обязательны для заполнения.\n required_alert=\\u0412\\u0441\\u0435 \\u043f\\u043e\\u043b\\u044f \\u043e\\u0431\\u044f\\u0437\\u0430\\u0442\\u0435\\u043b\\u044c\\u043d\\u044b \\u0434\\u043b\\u044f \\u0437\\u0430\\u043f\\u043e\\u043b\\u043d\\u0435\\u043d\\u0438\\u044f.\n-# edit_attribute=Изменить атрибут\n edit_attribute=\\u0418\\u0437\\u043c\\u0435\\u043d\\u0438\\u0442\\u044c \\u0430\\u0442\\u0440\\u0438\\u0431\\u0443\\u0442\n-# attributes=Виртуальные атрибуты\n attributes=\\u0412\\u0438\\u0440\\u0442\\u0443\\u0430\\u043b\\u044c\\u043d\\u044b\\u0435 \\u0430\\u0442\\u0440\\u0438\\u0431\\u0443\\u0442\\u044b\n-# title=Виртуальная схема\n title=\\u0412\\u0438\\u0440\\u0442\\u0443\\u0430\\u043b\\u044c\\u043d\\u0430\\u044f \\u0441\\u0445\\u0435\\u043c\\u0430\n-# readonly=Только чтение\n readonly=\\u0422\\u043e\\u043b\\u044c\\u043a\\u043e \\u0447\\u0442\\u0435\\u043d\\u0438\\u0435\n-# resource=Ресурс\n resource=\\u0420\\u0435\\u0441\\u0443\\u0440\\u0441\n-# provision=Предоставление\n-provision=\\u041f\\u0440\\u0435\\u0434\\u043e\\u0441\\u0442\\u0430\\u0432\\u043b\\u0435\\u043d\\u0438\\u0435\n-# extAttrName=Внешний атрибут\n+anyType=Type\n extAttrName=\\u0412\\u043d\\u0435\\u0448\\u043d\\u0438\\u0439 \\u0430\\u0442\\u0440\\u0438\\u0431\\u0443\\u0442"},{"sha":"1f10e6b7367d3032db99cfc1e3b9d8abd25c7302","filename":"common/lib/src/main/java/org/apache/syncope/common/lib/to/VirSchemaTO.java","status":"modified","additions":5,"deletions":5,"changes":10,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/951a64a7aa83c92ed619a3b306ddf92d0968a468/common%2Flib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2Fto%2FVirSchemaTO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/951a64a7aa83c92ed619a3b306ddf92d0968a468/common%2Flib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2Fto%2FVirSchemaTO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/common%2Flib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2Fto%2FVirSchemaTO.java?ref=951a64a7aa83c92ed619a3b306ddf92d0968a468","patch":"@@ -29,7 +29,7 @@ public class VirSchemaTO extends AbstractSchemaTO {\n \n     private String resource;\n \n-    private String provision;\n+    private String anyType;\n \n     private String extAttrName;\n \n@@ -49,12 +49,12 @@ public void setResource(final String resource) {\n         this.resource = resource;\n     }\n \n-    public String getProvision() {\n-        return provision;\n+    public String getAnyType() {\n+        return anyType;\n     }\n \n-    public void setProvision(final String provision) {\n-        this.provision = provision;\n+    public void setAnyType(final String anyType) {\n+        this.anyType = anyType;\n     }\n \n     public String getExtAttrName() {"},{"sha":"51dd04b55edf17b202d5abc5f373c197c5dfd176","filename":"core/persistence-api/src/main/java/org/apache/syncope/core/persistence/api/dao/ExternalResourceDAO.java","status":"modified","additions":0,"deletions":2,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/951a64a7aa83c92ed619a3b306ddf92d0968a468/core%2Fpersistence-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fapi%2Fdao%2FExternalResourceDAO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/951a64a7aa83c92ed619a3b306ddf92d0968a468/core%2Fpersistence-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fapi%2Fdao%2FExternalResourceDAO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fapi%2Fdao%2FExternalResourceDAO.java?ref=951a64a7aa83c92ed619a3b306ddf92d0968a468","patch":"@@ -31,8 +31,6 @@ public interface ExternalResourceDAO extends DAO<ExternalResource> {\n \n     ExternalResource find(String key);\n \n-    Provision findProvision(String key);\n-\n     List<Provision> findProvisionsByAuxClass(AnyTypeClass anyTypeClass);\n \n     List<ExternalResource> findByPolicy(Policy policy);"},{"sha":"96927825c927ca7937a3fe44d0394940e5b8c22f","filename":"core/persistence-jpa/src/main/java/org/apache/syncope/core/persistence/jpa/dao/JPAExternalResourceDAO.java","status":"modified","additions":0,"deletions":5,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/951a64a7aa83c92ed619a3b306ddf92d0968a468/core%2Fpersistence-jpa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FJPAExternalResourceDAO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/951a64a7aa83c92ed619a3b306ddf92d0968a468/core%2Fpersistence-jpa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FJPAExternalResourceDAO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FJPAExternalResourceDAO.java?ref=951a64a7aa83c92ed619a3b306ddf92d0968a468","patch":"@@ -90,11 +90,6 @@ public ExternalResource find(final String name) {\n         return entityManager().find(JPAExternalResource.class, name);\n     }\n \n-    @Override\n-    public Provision findProvision(final String key) {\n-        return entityManager().find(JPAProvision.class, key);\n-    }\n-\n     @Override\n     public List<Provision> findProvisionsByAuxClass(final AnyTypeClass anyTypeClass) {\n         TypedQuery<Provision> query = entityManager().createQuery("},{"sha":"7a5b12ebd4ede5e4e5edf512d4e2ac069e7ce6ab","filename":"core/persistence-jpa/src/test/java/org/apache/syncope/core/persistence/jpa/outer/VirSchemaTest.java","status":"modified","additions":6,"deletions":3,"changes":9,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/951a64a7aa83c92ed619a3b306ddf92d0968a468/core%2Fpersistence-jpa%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fouter%2FVirSchemaTest.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/951a64a7aa83c92ed619a3b306ddf92d0968a468/core%2Fpersistence-jpa%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fouter%2FVirSchemaTest.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fouter%2FVirSchemaTest.java?ref=951a64a7aa83c92ed619a3b306ddf92d0968a468","patch":"@@ -23,8 +23,8 @@\n import static org.junit.Assert.assertNotNull;\n import static org.junit.Assert.assertTrue;\n \n-import java.util.UUID;\n import org.apache.syncope.common.lib.types.IntMappingType;\n+import org.apache.syncope.core.persistence.api.dao.AnyTypeDAO;\n import org.apache.syncope.core.persistence.api.dao.ExternalResourceDAO;\n import org.apache.syncope.core.persistence.api.dao.VirSchemaDAO;\n import org.apache.syncope.core.persistence.api.entity.VirSchema;\n@@ -44,9 +44,12 @@ public class VirSchemaTest extends AbstractTest {\n     @Autowired\n     private ExternalResourceDAO resourceDAO;\n \n+    @Autowired\n+    private AnyTypeDAO anyTypeDAO;\n+\n     @Test\n     public void deal() {\n-        Provision provision = resourceDAO.findProvision(\"209ea85f-f964-49c7-a498-6c9c2baa3bd8\");\n+        Provision provision = resourceDAO.find(\"ws-target-resource-1\").getProvision(anyTypeDAO.findUser());\n         assertNotNull(provision);\n         assertTrue(virSchemaDAO.findByProvision(provision).isEmpty());\n \n@@ -64,7 +67,7 @@ public void deal() {\n         assertTrue(virSchema.isReadonly());\n         assertEquals(\"EXT_ATTR\", virSchema.getExtAttrName());\n \n-        provision = resourceDAO.findProvision(\"209ea85f-f964-49c7-a498-6c9c2baa3bd8\");\n+        provision = resourceDAO.find(\"ws-target-resource-1\").getProvision(anyTypeDAO.findUser());\n         assertNotNull(provision);\n         assertFalse(virSchemaDAO.findByProvision(provision).isEmpty());\n         assertTrue(virSchemaDAO.findByProvision(provision).contains(virSchema));"},{"sha":"10e4f7323920b4f76938cf1df9c64b73e1912d8b","filename":"core/provisioning-java/src/main/java/org/apache/syncope/core/provisioning/java/data/SchemaDataBinderImpl.java","status":"modified","additions":22,"deletions":3,"changes":25,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/951a64a7aa83c92ed619a3b306ddf92d0968a468/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fdata%2FSchemaDataBinderImpl.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/951a64a7aa83c92ed619a3b306ddf92d0968a468/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fdata%2FSchemaDataBinderImpl.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fdata%2FSchemaDataBinderImpl.java?ref=951a64a7aa83c92ed619a3b306ddf92d0968a468","patch":"@@ -34,13 +34,16 @@\n import org.apache.syncope.core.spring.BeanUtils;\n import org.apache.syncope.core.provisioning.java.jexl.JexlUtils;\n import org.apache.syncope.core.persistence.api.dao.AnyTypeClassDAO;\n+import org.apache.syncope.core.persistence.api.dao.AnyTypeDAO;\n import org.apache.syncope.core.persistence.api.dao.DerSchemaDAO;\n import org.apache.syncope.core.persistence.api.dao.ExternalResourceDAO;\n import org.apache.syncope.core.persistence.api.dao.VirSchemaDAO;\n+import org.apache.syncope.core.persistence.api.entity.AnyType;\n import org.apache.syncope.core.persistence.api.entity.AnyTypeClass;\n import org.apache.syncope.core.persistence.api.entity.AnyUtils;\n import org.apache.syncope.core.persistence.api.entity.AnyUtilsFactory;\n import org.apache.syncope.core.persistence.api.entity.EntityFactory;\n+import org.apache.syncope.core.persistence.api.entity.resource.ExternalResource;\n import org.apache.syncope.core.persistence.api.entity.resource.Provision;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n@@ -69,6 +72,9 @@ public class SchemaDataBinderImpl implements SchemaDataBinder {\n     @Autowired\n     private ExternalResourceDAO resourceDAO;\n \n+    @Autowired\n+    private AnyTypeDAO anyTypeDAO;\n+\n     @Autowired\n     private EntityFactory entityFactory;\n \n@@ -238,10 +244,23 @@ private VirSchema fill(final VirSchema schema, final VirSchemaTO schemaTO) {\n             schema.setAnyTypeClass(null);\n         }\n \n-        Provision provision = resourceDAO.findProvision(schemaTO.getProvision());\n+        ExternalResource resource = resourceDAO.find(schemaTO.getResource());\n+        if (resource == null) {\n+            SyncopeClientException sce = SyncopeClientException.build(ClientExceptionType.InvalidSchemaDefinition);\n+            sce.getElements().add(\"Resource \" + schemaTO.getResource() + \" not found\");\n+            throw sce;\n+        }\n+        AnyType anyType = anyTypeDAO.find(schemaTO.getAnyType());\n+        if (anyType == null) {\n+            SyncopeClientException sce = SyncopeClientException.build(ClientExceptionType.InvalidSchemaDefinition);\n+            sce.getElements().add(\"AnyType \" + schemaTO.getAnyType() + \" not found\");\n+            throw sce;\n+        }\n+        Provision provision = resource.getProvision(anyType);\n         if (provision == null) {\n             SyncopeClientException sce = SyncopeClientException.build(ClientExceptionType.InvalidSchemaDefinition);\n-            sce.getElements().add(\"Provision \" + schemaTO.getProvision() + \" not found\");\n+            sce.getElements().add(\"Provision for AnyType\" + schemaTO.getAnyType()\n+                    + \" not found in \" + schemaTO.getResource());\n             throw sce;\n         }\n         schema.setProvision(provision);\n@@ -265,7 +284,7 @@ public VirSchemaTO getVirSchemaTO(final VirSchema schema) {\n         BeanUtils.copyProperties(schema, schemaTO, IGNORE_PROPERTIES);\n         schemaTO.setAnyTypeClass(schema.getAnyTypeClass() == null ? null : schema.getAnyTypeClass().getKey());\n         schemaTO.setResource(schema.getProvision().getResource().getKey());\n-        schemaTO.setProvision(schema.getProvision().getKey());\n+        schemaTO.setAnyType(schema.getProvision().getAnyType().getKey());\n \n         return schemaTO;\n     }"},{"sha":"413d80d4b4068a9fea98c61cef2af17a0403bfa3","filename":"fit/core-reference/src/test/java/org/apache/syncope/fit/core/VirAttrITCase.java","status":"modified","additions":8,"deletions":4,"changes":12,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/951a64a7aa83c92ed619a3b306ddf92d0968a468/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FVirAttrITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/951a64a7aa83c92ed619a3b306ddf92d0968a468/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FVirAttrITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FVirAttrITCase.java?ref=951a64a7aa83c92ed619a3b306ddf92d0968a468","patch":"@@ -109,7 +109,8 @@ public void issueSYNCOPE260() {\n         VirSchemaTO virSchema = new VirSchemaTO();\n         virSchema.setKey(\"syncope260\" + getUUIDString());\n         virSchema.setExtAttrName(\"companyName\");\n-        virSchema.setProvision(provision.getKey());\n+        virSchema.setResource(RESOURCE_NAME_WS2);\n+        virSchema.setAnyType(provision.getAnyType());\n         virSchema = createSchema(SchemaType.VIRTUAL, virSchema);\n         assertNotNull(virSchema);\n \n@@ -286,7 +287,8 @@ public boolean evaluate(final MappingItemTO item) {\n             VirSchemaTO virSchema = new VirSchemaTO();\n             virSchema.setKey(\"syncope397\" + getUUIDString());\n             virSchema.setExtAttrName(\"email\");\n-            virSchema.setProvision(provision.getKey());\n+            virSchema.setResource(RESOURCE_NAME_CSV);\n+            virSchema.setAnyType(provision.getAnyType());\n             virSchema = createSchema(SchemaType.VIRTUAL, virSchema);\n             assertNotNull(virSchema);\n \n@@ -467,7 +469,8 @@ public void issueSYNCOPE453() {\n                 rvirtualdata = new VirSchemaTO();\n                 rvirtualdata.setKey(\"rvirtualdata\");\n                 rvirtualdata.setExtAttrName(\"businessCategory\");\n-                rvirtualdata.setProvision(\"20a75199-3f2e-4b9a-9510-c68dd7fc7b3d\");\n+                rvirtualdata.setResource(RESOURCE_NAME_LDAP);\n+                rvirtualdata.setAnyType(AnyTypeKind.GROUP.name());\n \n                 rvirtualdata = createSchema(SchemaType.VIRTUAL, rvirtualdata);\n             }\n@@ -651,7 +654,8 @@ public boolean evaluate(final MappingItemTO item) {\n             VirSchemaTO virSchema = new VirSchemaTO();\n             virSchema.setKey(\"syncope691\" + getUUIDString());\n             virSchema.setExtAttrName(\"mail\");\n-            virSchema.setProvision(provision.getKey());\n+            virSchema.setResource(ldap.getKey());\n+            virSchema.setAnyType(provision.getAnyType());\n             virSchema = createSchema(SchemaType.VIRTUAL, virSchema);\n             assertNotNull(virSchema);\n "},{"sha":"fbe264ec90c1157d1d9e6458a6ea079747938909","filename":"fit/core-reference/src/test/java/org/apache/syncope/fit/core/VirSchemaITCase.java","status":"modified","additions":5,"deletions":3,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/951a64a7aa83c92ed619a3b306ddf92d0968a468/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FVirSchemaITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/951a64a7aa83c92ed619a3b306ddf92d0968a468/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FVirSchemaITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FVirSchemaITCase.java?ref=951a64a7aa83c92ed619a3b306ddf92d0968a468","patch":"@@ -62,11 +62,12 @@ public void crud() {\n         VirSchemaTO schema = new VirSchemaTO();\n         schema.setKey(\"virtualTest\" + getUUIDString());\n         schema.setExtAttrName(\"name\");\n-        schema.setProvision(csv.getProvisions().get(0).getKey());\n+        schema.setResource(RESOURCE_NAME_CSV);\n+        schema.setAnyType(csv.getProvisions().get(0).getAnyType());\n \n         schema = createSchema(SchemaType.VIRTUAL, schema);\n         assertNotNull(schema);\n-        assertEquals(csv.getProvisions().get(0).getKey(), schema.getProvision());\n+        assertEquals(csv.getProvisions().get(0).getAnyType(), schema.getAnyType());\n \n         csv = resourceService.read(RESOURCE_NAME_CSV);\n         assertNotNull(csv);\n@@ -138,7 +139,8 @@ public void issueSYNCOPE418() {\n         VirSchemaTO schema = new VirSchemaTO();\n         schema.setKey(\"http://schemas.examples.org/security/authorization/organizationUnit\");\n         schema.setExtAttrName(\"name\");\n-        schema.setProvision(ws1.getProvisions().get(0).getKey());\n+        schema.setResource(RESOURCE_NAME_WS1);\n+        schema.setAnyType(ws1.getProvisions().get(0).getAnyType());\n \n         try {\n             createSchema(SchemaType.VIRTUAL, schema);"}]}