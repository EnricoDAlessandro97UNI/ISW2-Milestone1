{"sha":"3f279cd7b836c5d786ed21f5f400ab5d315a55f2","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjNmMjc5Y2Q3YjgzNmM1ZDc4NmVkMjFmNWY0MDBhYjVkMzE1YTU1ZjI=","commit":{"author":{"name":"fmartelli","email":"fabio.martelli@gmail.com","date":"2016-08-09T09:14:50Z"},"committer":{"name":"fmartelli","email":"fabio.martelli@gmail.com","date":"2016-08-09T09:14:50Z"},"message":"[SYNCOPE-905] provides role entitlement evaluation compliants with core side","tree":{"sha":"3649f77d66391f0d78ff780e37aaf40e13f951dd","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/3649f77d66391f0d78ff780e37aaf40e13f951dd"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/3f279cd7b836c5d786ed21f5f400ab5d315a55f2","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/3f279cd7b836c5d786ed21f5f400ab5d315a55f2","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/3f279cd7b836c5d786ed21f5f400ab5d315a55f2","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/comments","author":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"committer":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"parents":[{"sha":"729de516b9dd0c86fb1b481a37e6b11c0492abf0","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/729de516b9dd0c86fb1b481a37e6b11c0492abf0","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/729de516b9dd0c86fb1b481a37e6b11c0492abf0"}],"stats":{"total":532,"additions":384,"deletions":148},"files":[{"sha":"e7b6bd5015b2d84204a213efaf5b9d02ab901ef5","filename":"client/console/src/main/java/org/apache/syncope/client/console/approvals/ApprovalDirectoryPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fapprovals%2FApprovalDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fapprovals%2FApprovalDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fapprovals%2FApprovalDirectoryPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -68,7 +68,7 @@ public ApprovalDirectoryPanel(final String id, final PageReference pageReference\n \n         initResultTable();\n \n-        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, ENABLE, StandardEntitlement.WORKFLOW_FORM_SUBMIT);\n+        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, RENDER, StandardEntitlement.WORKFLOW_FORM_SUBMIT);\n     }\n \n     @Override"},{"sha":"a66afb0a5bdb52607686d35756b0bbb54eb0df7a","filename":"client/console/src/main/java/org/apache/syncope/client/console/commons/ITabComponent.java","status":"added","additions":83,"deletions":0,"changes":83,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fcommons%2FITabComponent.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fcommons%2FITabComponent.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fcommons%2FITabComponent.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -0,0 +1,83 @@\n+/*\n+ * Copyright 2016 The Apache Software Foundation.\n+ *\n+ * Licensed under the Apache License, Version 2.0 (the \"License\");\n+ * you may not use this file except in compliance with the License.\n+ * You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.apache.syncope.client.console.commons;\n+\n+import static org.apache.wicket.Component.RENDER;\n+import static org.apache.wicket.authroles.authorization.strategies.role.metadata.MetaDataRoleAuthorizationStrategy.ACTION_PERMISSIONS;\n+\n+import java.util.UUID;\n+import org.apache.wicket.Component;\n+import org.apache.wicket.authroles.authorization.strategies.role.Roles;\n+import org.apache.wicket.authroles.authorization.strategies.role.metadata.ActionPermissions;\n+import org.apache.wicket.extensions.markup.html.tabs.ITab;\n+import org.apache.wicket.markup.html.WebMarkupContainer;\n+import org.apache.wicket.model.IModel;\n+\n+/**\n+ * ITab available to perform authorization on it\n+ */\n+public abstract class ITabComponent extends Component implements ITab {\n+\n+    private static final long serialVersionUID = -6908617525434875508L;\n+\n+    private final IModel<String> title;\n+\n+    /**\n+     * Constructor\n+     *\n+     * @param title IModel used to represent the title of the tab. Must contain a string\n+     * @param roles authorized roles\n+     */\n+    public ITabComponent(final IModel<String> title, final String roles) {\n+        super(UUID.randomUUID().toString());\n+        this.title = title;\n+\n+        final ActionPermissions permissions = new ActionPermissions();\n+        setMetaData(ACTION_PERMISSIONS, permissions);\n+        permissions.authorize(RENDER, new Roles(roles));\n+    }\n+\n+    /**\n+     * {@inheritDoc}\n+     */\n+    @Override\n+    public IModel<String> getTitle() {\n+        return title;\n+    }\n+\n+    /**\n+     * {@inheritDoc}\n+     */\n+    @Override\n+    public boolean isVisible() {\n+        return true;\n+    }\n+\n+    /**\n+     * @see org.apache.wicket.Component#onRender()\n+     */\n+    @Override\n+    protected void onRender() {\n+        internalRenderComponent();\n+    }\n+\n+    /**\n+     * {@inheritDoc}\n+     */\n+    @Override\n+    public abstract WebMarkupContainer getPanel(final String panelId);\n+\n+}"},{"sha":"9f5f8a3a9b03a8cb809087e6ad67adb5e54283ce","filename":"client/console/src/main/java/org/apache/syncope/client/console/notifications/MailTemplateDirectoryPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fnotifications%2FMailTemplateDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fnotifications%2FMailTemplateDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fnotifications%2FMailTemplateDirectoryPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -103,7 +103,7 @@ public WizardModalPanel<MailTemplateTO> build(\n \n         initResultTable();\n \n-        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, ENABLE, StandardEntitlement.MAIL_TEMPLATE_CREATE);\n+        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, RENDER, StandardEntitlement.MAIL_TEMPLATE_CREATE);\n     }\n \n     @Override"},{"sha":"1c481d4d745c6e962641fa410ed9d481b71c699a","filename":"client/console/src/main/java/org/apache/syncope/client/console/notifications/NotificationDirectoryPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fnotifications%2FNotificationDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fnotifications%2FNotificationDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fnotifications%2FNotificationDirectoryPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -81,7 +81,7 @@ public NotificationDirectoryPanel(final String id, final PageReference pageRef)\n \n         initResultTable();\n \n-        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, ENABLE, StandardEntitlement.NOTIFICATION_CREATE);\n+        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, RENDER, StandardEntitlement.NOTIFICATION_CREATE);\n     }\n \n     @Override"},{"sha":"aa3014488cc348b41a62d8246b9615a908a21747","filename":"client/console/src/main/java/org/apache/syncope/client/console/pages/BasePage.java","status":"modified","additions":13,"deletions":5,"changes":18,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpages%2FBasePage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpages%2FBasePage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpages%2FBasePage.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -171,8 +171,10 @@ public void onClick() {\n         liContainer = new WebMarkupContainer(getLIContainerId(\"topology\"));\n         body.add(liContainer);\n         link = BookmarkablePageLinkBuilder.build(\"topology\", Topology.class);\n-        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.ENABLE,\n-                String.format(\"%s,%s\", StandardEntitlement.CONNECTOR_LIST, StandardEntitlement.RESOURCE_LIST));\n+        StringBuilder bld = new StringBuilder();\n+        bld.append(StandardEntitlement.CONNECTOR_LIST).append(\",\").\n+                append(StandardEntitlement.RESOURCE_LIST).append(\",\");\n+        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.ENABLE, bld.toString());\n         liContainer.add(link);\n \n         liContainer = new WebMarkupContainer(getLIContainerId(\"reports\"));\n@@ -206,7 +208,13 @@ public void onClick() {\n \n         liContainer = new WebMarkupContainer(getLIContainerId(\"securityquestions\"));\n         confULContainer.add(liContainer);\n-        liContainer.add(BookmarkablePageLinkBuilder.build(\"securityquestions\", SecurityQuestions.class));\n+        bld = new StringBuilder();\n+        bld.append(StandardEntitlement.SECURITY_QUESTION_CREATE).append(\",\").\n+                append(StandardEntitlement.SECURITY_QUESTION_DELETE).append(\",\").\n+                append(StandardEntitlement.SECURITY_QUESTION_UPDATE);\n+        link = BookmarkablePageLinkBuilder.build(\"securityquestions\", SecurityQuestions.class);\n+        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.ENABLE, bld.toString());\n+        liContainer.add(link);\n \n         liContainer = new WebMarkupContainer(getLIContainerId(\"types\"));\n         confULContainer.add(liContainer);\n@@ -298,8 +306,8 @@ public void onComponentTag(final Component component, final ComponentTag tag) {\n         }\n \n         // Extensions\n-        ClassPathScanImplementationLookup classPathScanImplementationLookup =\n-                (ClassPathScanImplementationLookup) SyncopeConsoleApplication.get().\n+        ClassPathScanImplementationLookup classPathScanImplementationLookup\n+                = (ClassPathScanImplementationLookup) SyncopeConsoleApplication.get().\n                 getServletContext().getAttribute(ConsoleInitializer.CLASSPATH_LOOKUP);\n         List<Class<? extends BaseExtPage>> extPageClasses = classPathScanImplementationLookup.getExtPageClasses();\n "},{"sha":"388b07f9eebd6f30e66e48cf5b1a5274ef4c5070","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/AbstractLogsPanel.java","status":"modified","additions":4,"deletions":0,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAbstractLogsPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAbstractLogsPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAbstractLogsPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -30,9 +30,11 @@\n import org.apache.syncope.common.lib.SyncopeClientException;\n import org.apache.syncope.common.lib.to.LoggerTO;\n import org.apache.syncope.common.lib.types.LoggerLevel;\n+import org.apache.syncope.common.lib.types.StandardEntitlement;\n import org.apache.wicket.Component;\n import org.apache.wicket.PageReference;\n import org.apache.wicket.ajax.AjaxRequestTarget;\n+import org.apache.wicket.authroles.authorization.strategies.role.metadata.MetaDataRoleAuthorizationStrategy;\n import org.apache.wicket.markup.html.WebMarkupContainer;\n import org.apache.wicket.markup.html.panel.Panel;\n import org.apache.wicket.model.Model;\n@@ -66,6 +68,8 @@ protected Component getValueComponent(final String key, final LoggerTO loggerTO)\n                 if (\"level\".equalsIgnoreCase(key)) {\n                     final AjaxDropDownChoicePanel<LoggerLevel> loggerTOs = new AjaxDropDownChoicePanel<>(\n                             \"field\", getString(\"level\"), Model.of(loggerTO.getLevel()), false);\n+                    MetaDataRoleAuthorizationStrategy.authorize(loggerTOs, ENABLE, StandardEntitlement.LOG_SET_LEVEL);\n+\n                     loggerTOs.hideLabel();\n                     loggerTOs.setChoices(Arrays.asList(LoggerLevel.values()));\n                     loggerTOs.getField().add(new IndicatorAjaxFormComponentUpdatingBehavior(Constants.ON_CHANGE) {"},{"sha":"f04889febca7e259dda83e4bc7d347e0c4cfa3b2","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/AnyDirectoryPanel.java","status":"modified","additions":7,"deletions":0,"changes":7,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyDirectoryPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -18,6 +18,8 @@\n  */\n package org.apache.syncope.client.console.panels;\n \n+import static org.apache.wicket.Component.RENDER;\n+\n import de.agilecoders.wicket.core.markup.html.bootstrap.dialog.Modal;\n import java.io.Serializable;\n import java.lang.reflect.Field;\n@@ -27,6 +29,7 @@\n import java.util.List;\n import org.apache.commons.collections4.CollectionUtils;\n import org.apache.commons.lang3.tuple.Pair;\n+import org.apache.syncope.client.console.SyncopeConsoleSession;\n import org.apache.syncope.client.console.commons.AnyDataProvider;\n import org.apache.syncope.client.console.commons.SerializableTransformer;\n import org.apache.syncope.client.console.commons.status.ConnObjectWrapper;\n@@ -48,6 +51,7 @@\n import org.apache.syncope.common.lib.to.ProvisioningResult;\n import org.apache.wicket.PageReference;\n import org.apache.wicket.ajax.AjaxRequestTarget;\n+import org.apache.wicket.authroles.authorization.strategies.role.metadata.MetaDataRoleAuthorizationStrategy;\n import org.apache.wicket.extensions.markup.html.repeater.data.table.IColumn;\n import org.apache.wicket.extensions.markup.html.repeater.data.table.PropertyColumn;\n import org.apache.wicket.markup.html.panel.Panel;\n@@ -88,6 +92,9 @@ protected AnyDirectoryPanel(final String id, final Builder<A, E> builder) {\n \n     protected AnyDirectoryPanel(final String id, final Builder<A, E> builder, final boolean wizardInModal) {\n         super(id, builder, wizardInModal);\n+        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, RENDER, String.format(\"%s_CREATE\", builder.type));\n+        setReadOnly(!SyncopeConsoleSession.get().owns(String.format(\"%s_UPDATE\", builder.type)));\n+\n         this.realm = builder.realm;\n         this.type = builder.type;\n         this.fiql = builder.fiql;"},{"sha":"3f940dc54fd8c4a7c0cfbb7cfc4f2ff71c661627","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/AnyPanel.java","status":"modified","additions":4,"deletions":9,"changes":13,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -94,7 +94,6 @@ public AnyPanel(\n         this.realmTO = realmTO;\n         this.formLayoutInfo = formLayoutInfo;\n         this.pageRef = pageRef;\n-\n         // ------------------------\n         // Accordion\n         // ------------------------\n@@ -176,20 +175,16 @@ private AbstractSearchPanel getSearchPanel(final String id) {\n         final AbstractSearchPanel panel;\n         switch (anyTypeTO.getKind()) {\n             case USER:\n-                panel = UserSearchPanel.class.cast(new UserSearchPanel.Builder(\n-                        new ListModel<>(new ArrayList<SearchClause>())).required(false).enableSearch().build(id));\n-                MetaDataRoleAuthorizationStrategy.authorize(panel, WebPage.RENDER, StandardEntitlement.USER_LIST);\n+                panel = new UserSearchPanel.Builder(\n+                        new ListModel<>(new ArrayList<SearchClause>())).required(false).enableSearch().build(id);\n                 break;\n             case GROUP:\n                 panel = new GroupSearchPanel.Builder(\n                         new ListModel<>(new ArrayList<SearchClause>())).required(false).enableSearch().build(id);\n-                // list of group is available to all authenticated users\n                 break;\n             case ANY_OBJECT:\n                 panel = new AnyObjectSearchPanel.Builder(anyTypeTO.getKey(),\n                         new ListModel<>(new ArrayList<SearchClause>())).required(false).enableSearch().build(id);\n-                MetaDataRoleAuthorizationStrategy.authorize(\n-                        panel, WebPage.RENDER, AnyEntitlement.LIST.getFor(anyTypeTO.getKey()));\n                 break;\n             default:\n                 panel = null;\n@@ -214,7 +209,7 @@ protected Panel getDirectoryPanel(final String id) {\n                         anyTypeTO.getClasses(),\n                         formLayoutInfo.getLeft(),\n                         pageRef)).build(id);\n-                MetaDataRoleAuthorizationStrategy.authorize(panel, WebPage.RENDER, StandardEntitlement.USER_LIST);\n+                MetaDataRoleAuthorizationStrategy.authorize(panel, WebPage.RENDER, StandardEntitlement.USER_SEARCH);\n                 break;\n \n             case GROUP:\n@@ -249,7 +244,7 @@ protected Panel getDirectoryPanel(final String id) {\n                         formLayoutInfo.getRight().get(anyTypeTO.getKey()),\n                         pageRef)).build(id);\n                 MetaDataRoleAuthorizationStrategy.authorize(\n-                        panel, WebPage.RENDER, AnyEntitlement.LIST.getFor(anyTypeTO.getKey()));\n+                        panel, WebPage.RENDER, AnyEntitlement.SEARCH.getFor(anyTypeTO.getKey()));\n                 break;\n \n             default:"},{"sha":"c63deaa647a1a84027e9400299d17b519fed0de2","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/AnyTypeClassesPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyTypeClassesPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyTypeClassesPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyTypeClassesPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -96,7 +96,7 @@ public void onSubmit(final AjaxRequestTarget target, final Form<?> form) {\n         }, true);\n \n         initResultTable();\n-        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, ENABLE, StandardEntitlement.ANYTYPE_CREATE);\n+        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, RENDER, StandardEntitlement.ANYTYPE_CREATE);\n     }\n \n     @Override"},{"sha":"fa7ecdd445244c26c7cdf6361f0f584a46ce5a02","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/AnyTypesPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyTypesPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyTypesPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyTypesPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -99,7 +99,7 @@ public void onSubmit(final AjaxRequestTarget target, final Form<?> form) {\n         }, true);\n \n         initResultTable();\n-        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, ENABLE, StandardEntitlement.ANYTYPE_CREATE);\n+        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, RENDER, StandardEntitlement.ANYTYPE_CREATE);\n     }\n \n     @Override"},{"sha":"67e806dd9b02941eb217b046257cd0db73f7e675","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/GroupDirectoryPanel.java","status":"modified","additions":3,"deletions":5,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FGroupDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FGroupDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FGroupDirectoryPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -134,7 +134,7 @@ protected Panel getDirectoryPanel(final String id) {\n                                     setWizardInModal(false).build(id);\n \n                             MetaDataRoleAuthorizationStrategy.authorize(\n-                                    panel, WebPage.RENDER, StandardEntitlement.USER_LIST);\n+                                    panel, WebPage.RENDER, StandardEntitlement.USER_SEARCH);\n                         } else {\n                             String query = SyncopeClient.getAnyObjectSearchConditionBuilder(type).and(\n                                     SyncopeClient.getUserSearchConditionBuilder().inGroups(groupTO.getKey()),\n@@ -154,7 +154,7 @@ protected Panel getDirectoryPanel(final String id) {\n                                     setWizardInModal(false).build(id);\n \n                             MetaDataRoleAuthorizationStrategy.authorize(\n-                                    panel, WebPage.RENDER, AnyEntitlement.LIST.getFor(anyTypeTO.getKey()));\n+                                    panel, WebPage.RENDER, AnyEntitlement.SEARCH.getFor(anyTypeTO.getKey()));\n                         }\n \n                         return panel;\n@@ -212,8 +212,6 @@ protected List<IColumn<GroupTO, String>> getColumns() {\n                     Arrays.asList(GroupDisplayAttributesModalPanel.DEFAULT_SELECTION));\n         }\n \n-        setWindowClosedReloadCallback(displayAttributeModal);\n-\n         columns.add(new ActionColumn<GroupTO, String>(new ResourceModel(\"actions\")) {\n \n             private static final long serialVersionUID = -3503023501954863131L;\n@@ -268,7 +266,7 @@ public void onClick(final AjaxRequestTarget target, final GroupTO ignore) {\n                                 new AjaxWizard.EditItemActionEvent<>(new GroupWrapper(\n                                         restClient.read(model.getObject().getKey())), target));\n                     }\n-                }, ActionType.EDIT, StandardEntitlement.GROUP_UPDATE).add(new ActionLink<GroupTO>() {\n+                }, ActionType.EDIT, StandardEntitlement.GROUP_READ).add(new ActionLink<GroupTO>() {\n \n                     private static final long serialVersionUID = 6242834621660352855L;\n "},{"sha":"5d383390b596fd8409366118dfa51ec320896075","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/ParametersPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FParametersPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FParametersPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FParametersPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -108,7 +108,7 @@ public WizardModalPanel<AttrTO> build(final String id, final int index, final Aj\n         modal.size(Modal.Size.Medium);\n         initResultTable();\n \n-        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, ENABLE, StandardEntitlement.CONFIGURATION_SET);\n+        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, RENDER, StandardEntitlement.CONFIGURATION_SET);\n     }\n \n     public ParametersPanel("},{"sha":"54ef1a0b42bc9ac1be30b7b0260ad5890934d190","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/Realm.java","status":"modified","additions":16,"deletions":3,"changes":19,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FRealm.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FRealm.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FRealm.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -18,6 +18,8 @@\n  */\n package org.apache.syncope.client.console.panels;\n \n+import static org.apache.wicket.Component.RENDER;\n+\n import de.agilecoders.wicket.core.markup.html.bootstrap.dialog.Modal;\n import de.agilecoders.wicket.core.markup.html.bootstrap.tabs.AjaxBootstrapTabbedPanel;\n import java.io.Serializable;\n@@ -30,9 +32,11 @@\n import org.apache.commons.lang3.StringUtils;\n import org.apache.commons.lang3.tuple.Pair;\n import org.apache.commons.lang3.tuple.Triple;\n+import org.apache.syncope.client.console.SyncopeConsoleApplication;\n import org.apache.syncope.client.console.commons.AnyTypeComparator;\n import org.apache.syncope.client.console.commons.ConnIdSpecialAttributeName;\n import org.apache.syncope.client.console.commons.Constants;\n+import org.apache.syncope.client.console.commons.ITabComponent;\n import org.apache.syncope.client.console.commons.status.StatusUtils;\n import org.apache.syncope.client.console.layout.AnyObjectFormLayoutInfo;\n import org.apache.syncope.client.console.layout.FormLayoutInfoUtils;\n@@ -55,6 +59,7 @@\n import org.apache.wicket.ajax.AjaxRequestTarget;\n import org.apache.wicket.extensions.markup.html.tabs.AbstractTab;\n import org.apache.wicket.extensions.markup.html.tabs.ITab;\n+import org.apache.wicket.markup.html.WebMarkupContainer;\n import org.apache.wicket.markup.html.basic.Label;\n import org.apache.wicket.markup.html.panel.Panel;\n import org.apache.wicket.model.Model;\n@@ -159,14 +164,22 @@ public void onClick(final AjaxRequestTarget target, final RealmTO modelObject) {\n \n         Collections.sort(anyTypeTOs, new AnyTypeComparator());\n         for (final AnyTypeTO anyTypeTO : anyTypeTOs) {\n-            tabs.add(new AbstractTab(new Model<>(anyTypeTO.getKey())) {\n+            tabs.add(new ITabComponent(\n+                    new Model<>(anyTypeTO.getKey()),\n+                    String.format(\"%s_SEARCH\", anyTypeTO.getKey())) {\n \n-                private static final long serialVersionUID = -5861786415855103549L;\n+                private static final long serialVersionUID = 1169585538404171118L;\n \n                 @Override\n-                public Panel getPanel(final String panelId) {\n+                public WebMarkupContainer getPanel(final String panelId) {\n                     return new AnyPanel(panelId, anyTypeTO, realmTO, formLayoutInfo, true, pageRef);\n                 }\n+\n+                @Override\n+                public boolean isVisible() {\n+                    return SyncopeConsoleApplication.get().getSecuritySettings().getAuthorizationStrategy().\n+                            isActionAuthorized(this, RENDER);\n+                }\n             });\n         }\n "},{"sha":"a4f308543b3b87660b750aee2ed21b4acaf00237","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/RelationshipTypesPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FRelationshipTypesPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FRelationshipTypesPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FRelationshipTypesPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -99,7 +99,7 @@ public void onSubmit(final AjaxRequestTarget target, final Form<?> form) {\n         }, true);\n \n         initResultTable();\n-        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, ENABLE, StandardEntitlement.RELATIONSHIPTYPE_CREATE);\n+        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, RENDER, StandardEntitlement.RELATIONSHIPTYPE_CREATE);\n     }\n \n     @Override"},{"sha":"268593c5ed251fdd644a9b4756439e485cea4ae0","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/RoleDirectoryPanel.java","status":"modified","additions":5,"deletions":4,"changes":9,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FRoleDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FRoleDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FRoleDirectoryPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -71,6 +71,9 @@ public class RoleDirectoryPanel extends DirectoryPanel<RoleTO, RoleWrapper, Role\n \n     protected RoleDirectoryPanel(final String id, final Builder builder) {\n         super(id, builder);\n+        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, RENDER, StandardEntitlement.ROLE_CREATE);\n+        setReadOnly(!SyncopeConsoleSession.get().owns(StandardEntitlement.ROLE_UPDATE));\n+\n         setShowResultPage(true);\n \n         modal.size(Modal.Size.Large);\n@@ -83,8 +86,6 @@ protected RoleDirectoryPanel(final String id, final Builder builder) {\n \n         addOuterObject(membersModal);\n         membersModal.size(Modal.Size.Large);\n-\n-        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, ENABLE, StandardEntitlement.ROLE_CREATE);\n     }\n \n     @Override\n@@ -153,7 +154,7 @@ protected Panel getDirectoryPanel(final String id) {\n                                 MetaDataRoleAuthorizationStrategy.authorize(\n                                         panel,\n                                         WebPage.RENDER,\n-                                        StandardEntitlement.USER_LIST);\n+                                        StandardEntitlement.USER_SEARCH);\n \n                                 return panel;\n                             }\n@@ -164,7 +165,7 @@ protected Panel getDirectoryPanel(final String id) {\n                         membersModal.show(true);\n                         target.add(membersModal);\n                     }\n-                }, ActionLink.ActionType.MEMBERS, StandardEntitlement.USER_LIST).add(new ActionLink<RoleTO>() {\n+                }, ActionLink.ActionType.MEMBERS, StandardEntitlement.USER_SEARCH).add(new ActionLink<RoleTO>() {\n \n                     private static final long serialVersionUID = -7978723352517770644L;\n "},{"sha":"6f3f7dd7231f06e1d269eabf5fc4f88ad729ed6d","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/SchemaTypePanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSchemaTypePanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSchemaTypePanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSchemaTypePanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -131,7 +131,7 @@ public void onSubmit(final AjaxRequestTarget target, final Form<?> form) {\n             }, true);\n \n             initResultTable();\n-            MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, ENABLE, StandardEntitlement.SCHEMA_LIST);\n+            MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, RENDER, StandardEntitlement.SCHEMA_LIST);\n         } catch (InstantiationException | IllegalAccessException e) {\n             LOG.error(\"Error create new schema\", e);\n         }"},{"sha":"bc6a3b1845d4baa71fc35776ced83e3b01a99ffd","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/SecurityQuestionsPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSecurityQuestionsPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSecurityQuestionsPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSecurityQuestionsPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -87,7 +87,7 @@ public WizardModalPanel<SecurityQuestionTO> build(\n         modal.size(Modal.Size.Large);\n         initResultTable();\n \n-        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, ENABLE, StandardEntitlement.SECURITY_QUESTION_CREATE);\n+        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, RENDER, StandardEntitlement.SECURITY_QUESTION_CREATE);\n     }\n \n     private SecurityQuestionsPanel("},{"sha":"08931f831850092c6eb579559b930f210a1dec4a","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/UserDirectoryPanel.java","status":"modified","additions":4,"deletions":3,"changes":7,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FUserDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FUserDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FUserDirectoryPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -167,7 +167,8 @@ public void onClick(final AjaxRequestTarget target, final UserTO ignore) {\n                                         new UserWrapper(new UserRestClient().read(model.getObject().getKey())),\n                                         target));\n                     }\n-                }, ActionType.EDIT, StandardEntitlement.USER_READ).add(new ActionLink<UserTO>() {\n+                }, ActionType.EDIT, new StringBuilder().append(StandardEntitlement.USER_READ).append(\",\").\n+                        append(StandardEntitlement.USER_UPDATE).toString()).add(new ActionLink<UserTO>() {\n \n                     private static final long serialVersionUID = -7978723352517770644L;\n \n@@ -227,7 +228,7 @@ public void onClick(final AjaxRequestTarget target, final UserTO ignore) {\n \n                             altDefaultModal.show(true);\n                         }\n-                    }, ActionType.MANAGE_RESOURCES, StandardEntitlement.USER_READ).add(new ActionLink<UserTO>() {\n+                    }, ActionType.MANAGE_RESOURCES, StandardEntitlement.USER_UPDATE).add(new ActionLink<UserTO>() {\n \n                         private static final long serialVersionUID = -7978723352517770644L;\n \n@@ -249,7 +250,7 @@ public void onClick(final AjaxRequestTarget target, final UserTO ignore) {\n \n                             altDefaultModal.show(true);\n                         }\n-                    }, ActionType.ENABLE, StandardEntitlement.USER_READ).add(new ActionLink<UserTO>() {\n+                    }, ActionType.ENABLE, StandardEntitlement.USER_UPDATE).add(new ActionLink<UserTO>() {\n \n                         private static final long serialVersionUID = -7978723352517770644L;\n "},{"sha":"4a8ec3425740060b8907ca3097113f2df616a69d","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/WorkflowTogglePanel.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FWorkflowTogglePanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FWorkflowTogglePanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FWorkflowTogglePanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -71,7 +71,7 @@ public WorkflowTogglePanel(final String id, final PageReference pageRef, final I\n         activitiModeler.setEnabled(activitiModelerEnabled);\n \n         AjaxSubmitLink xmlEditorSubmit = modal.addSubmitButton();\n-        MetaDataRoleAuthorizationStrategy.authorize(xmlEditorSubmit, ENABLE, StandardEntitlement.WORKFLOW_DEF_UPDATE);\n+        MetaDataRoleAuthorizationStrategy.authorize(xmlEditorSubmit, RENDER, StandardEntitlement.WORKFLOW_DEF_UPDATE);\n         modal.setWindowClosedCallback(new ModalWindow.WindowClosedCallback() {\n \n             private static final long serialVersionUID = 8804221891699487139L;\n@@ -96,7 +96,7 @@ public void onClick(final AjaxRequestTarget target) {\n                 modal.show(true);\n             }\n         };\n-        MetaDataRoleAuthorizationStrategy.authorize(xmlEditor, ENABLE, StandardEntitlement.WORKFLOW_DEF_READ);\n+        MetaDataRoleAuthorizationStrategy.authorize(xmlEditor, RENDER, StandardEntitlement.WORKFLOW_DEF_READ);\n         container.add(xmlEditor);\n     }\n "},{"sha":"0eb17ef6dfc30ed707ab3fc4665d8560f3fb06af","filename":"client/console/src/main/java/org/apache/syncope/client/console/policies/AccountPolicyDirectoryPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpolicies%2FAccountPolicyDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpolicies%2FAccountPolicyDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpolicies%2FAccountPolicyDirectoryPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -47,7 +47,7 @@ public AccountPolicyDirectoryPanel(final String id, final PageReference pageRef)\n \n         this.addNewItemPanelBuilder(new PolicyModalPanelBuilder<AccountPolicyTO>(\n                 new AccountPolicyTO(), modal, pageRef), true);\n-        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, ENABLE, StandardEntitlement.POLICY_CREATE);\n+        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, RENDER, StandardEntitlement.POLICY_CREATE);\n \n         initResultTable();\n     }"},{"sha":"6bf607a4e2d4081fa0fdce10662d1b33e6002e4c","filename":"client/console/src/main/java/org/apache/syncope/client/console/policies/PasswordPolicyDirectoryPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpolicies%2FPasswordPolicyDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpolicies%2FPasswordPolicyDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpolicies%2FPasswordPolicyDirectoryPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -46,7 +46,7 @@ public PasswordPolicyDirectoryPanel(final String id, final PageReference pageRef\n \n         this.addNewItemPanelBuilder(\n                 new PolicyModalPanelBuilder<PasswordPolicyTO>(new PasswordPolicyTO(), modal, pageRef), true);\n-        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, ENABLE, StandardEntitlement.POLICY_CREATE);\n+        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, RENDER, StandardEntitlement.POLICY_CREATE);\n \n         initResultTable();\n     }"},{"sha":"47248d7c7bdcececb6e5989947a93445ef5916c8","filename":"client/console/src/main/java/org/apache/syncope/client/console/policies/PolicyRuleDirectoryPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpolicies%2FPolicyRuleDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpolicies%2FPolicyRuleDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpolicies%2FPolicyRuleDirectoryPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -96,7 +96,7 @@ protected PolicyRuleDirectoryPanel(\n \n         this.addNewItemPanelBuilder(new PolicyRuleWizardBuilder(policy, type, new PolicyRuleWrapper(), pageRef), true);\n \n-        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, ENABLE, StandardEntitlement.POLICY_UPDATE);\n+        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, RENDER, StandardEntitlement.POLICY_UPDATE);\n         initResultTable();\n     }\n "},{"sha":"1a615e5d5b4faa240f72fefc3e836f8dc91b0119","filename":"client/console/src/main/java/org/apache/syncope/client/console/policies/PullPolicyDirectoryPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpolicies%2FPullPolicyDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpolicies%2FPullPolicyDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpolicies%2FPullPolicyDirectoryPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -46,7 +46,7 @@ public PullPolicyDirectoryPanel(final String id, final PageReference pageRef) {\n \n         this.addNewItemPanelBuilder(\n                 new PolicyModalPanelBuilder<PullPolicyTO>(defaultItem, modal, pageRef), true);\n-        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, ENABLE, StandardEntitlement.POLICY_CREATE);\n+        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, RENDER, StandardEntitlement.POLICY_CREATE);\n \n         initResultTable();\n     }"},{"sha":"b389b6d6d7bdcdbdb5edcbd5cda14a6c82bcb859","filename":"client/console/src/main/java/org/apache/syncope/client/console/reports/ReportDirectoryPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Freports%2FReportDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Freports%2FReportDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Freports%2FReportDirectoryPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -73,7 +73,7 @@ protected ReportDirectoryPanel(final MultilevelPanel multiLevelPanelRef, final P\n         this.restClient = new ReportRestClient();\n \n         this.addNewItemPanelBuilder(new ReportWizardBuilder(new ReportTO(), pageRef), true);\n-        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, ENABLE, StandardEntitlement.REPORT_CREATE);\n+        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, RENDER, StandardEntitlement.REPORT_CREATE);\n \n         modal.size(Modal.Size.Large);\n         initResultTable();"},{"sha":"d3602ee11d48bf7bdc620a0a9e20d241c09efd8d","filename":"client/console/src/main/java/org/apache/syncope/client/console/reports/ReportTemplateDirectoryPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Freports%2FReportTemplateDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Freports%2FReportTemplateDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Freports%2FReportTemplateDirectoryPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -105,7 +105,7 @@ public WizardModalPanel<ReportTemplateTO> build(\n \n         initResultTable();\n \n-        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, ENABLE, StandardEntitlement.MAIL_TEMPLATE_CREATE);\n+        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, RENDER, StandardEntitlement.MAIL_TEMPLATE_CREATE);\n     }\n \n     @Override"},{"sha":"b9ef700a936e4d2226205ba13f498c8f7800a7d5","filename":"client/console/src/main/java/org/apache/syncope/client/console/reports/ReportletDirectoryPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Freports%2FReportletDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Freports%2FReportletDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Freports%2FReportletDirectoryPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -98,7 +98,7 @@ protected ReportletDirectoryPanel(\n \n         this.addNewItemPanelBuilder(new ReportletWizardBuilder(report, new ReportletWrapper(), pageRef), true);\n \n-        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, ENABLE, StandardEntitlement.REPORT_UPDATE);\n+        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, RENDER, StandardEntitlement.REPORT_UPDATE);\n         initResultTable();\n     }\n "},{"sha":"21427851ac9cac78da71d517cd06ff2e082eec51","filename":"client/console/src/main/java/org/apache/syncope/client/console/tasks/SchedTaskDirectoryPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Ftasks%2FSchedTaskDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Ftasks%2FSchedTaskDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Ftasks%2FSchedTaskDirectoryPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -101,7 +101,7 @@ protected SchedTaskDirectoryPanel(\n \n         this.addNewItemPanelBuilder(new SchedTaskWizardBuilder<>(schedTaskTO, pageRef), true);\n \n-        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, ENABLE, StandardEntitlement.TASK_CREATE);\n+        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, RENDER, StandardEntitlement.TASK_CREATE);\n \n         enableExitButton();\n         setFooterVisibility(false);"},{"sha":"0411523459795f127d18f3a2f78c67efcb2caefb","filename":"client/console/src/main/java/org/apache/syncope/client/console/topology/TopologyTogglePanel.java","status":"modified","additions":19,"deletions":19,"changes":38,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Ftopology%2FTopologyTogglePanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Ftopology%2FTopologyTogglePanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Ftopology%2FTopologyTogglePanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -162,7 +162,7 @@ public void onClick(final AjaxRequestTarget target) {\n             }\n         };\n         fragment.add(reload);\n-        MetaDataRoleAuthorizationStrategy.authorize(reload, ENABLE, StandardEntitlement.CONNECTOR_RELOAD);\n+        MetaDataRoleAuthorizationStrategy.authorize(reload, RENDER, StandardEntitlement.CONNECTOR_RELOAD);\n \n         AjaxLink<String> tasks = new IndicatingAjaxLink<String>(\"tasks\") {\n \n@@ -176,7 +176,7 @@ public void onClick(final AjaxRequestTarget target) {\n             }\n         };\n         fragment.add(tasks);\n-        MetaDataRoleAuthorizationStrategy.authorize(tasks, ENABLE, StandardEntitlement.TASK_LIST);\n+        MetaDataRoleAuthorizationStrategy.authorize(tasks, RENDER, StandardEntitlement.TASK_LIST);\n \n         return fragment;\n     }\n@@ -202,13 +202,13 @@ public void onClick(final AjaxRequestTarget target) {\n                 modal.header(new Model<>(MessageFormat.format(getString(\"connector.new\"), node.getKey())));\n \n                 MetaDataRoleAuthorizationStrategy.\n-                        authorize(modal.getForm(), ENABLE, StandardEntitlement.CONNECTOR_CREATE);\n+                        authorize(modal.getForm(), RENDER, StandardEntitlement.CONNECTOR_CREATE);\n \n                 modal.show(true);\n             }\n         };\n         fragment.add(create);\n-        MetaDataRoleAuthorizationStrategy.authorize(create, ENABLE, StandardEntitlement.CONNECTOR_CREATE);\n+        MetaDataRoleAuthorizationStrategy.authorize(create, RENDER, StandardEntitlement.CONNECTOR_CREATE);\n \n         return fragment;\n     }\n@@ -235,7 +235,7 @@ public void onClick(final AjaxRequestTarget target) {\n                 ((BasePage) pageRef.getPage()).getNotificationPanel().refresh(target);\n             }\n         };\n-        MetaDataRoleAuthorizationStrategy.authorize(delete, ENABLE, StandardEntitlement.CONNECTOR_DELETE);\n+        MetaDataRoleAuthorizationStrategy.authorize(delete, RENDER, StandardEntitlement.CONNECTOR_DELETE);\n         fragment.add(delete);\n \n         AjaxLink<String> create = new IndicatingAjaxLink<String>(\"create\") {\n@@ -257,12 +257,12 @@ public void onClick(final AjaxRequestTarget target) {\n                 modal.header(new Model<>(MessageFormat.format(getString(\"resource.new\"), node.getKey())));\n \n                 MetaDataRoleAuthorizationStrategy.\n-                        authorize(modal.getForm(), ENABLE, StandardEntitlement.RESOURCE_CREATE);\n+                        authorize(modal.getForm(), RENDER, StandardEntitlement.RESOURCE_CREATE);\n \n                 modal.show(true);\n             }\n         };\n-        MetaDataRoleAuthorizationStrategy.authorize(create, ENABLE, StandardEntitlement.RESOURCE_CREATE);\n+        MetaDataRoleAuthorizationStrategy.authorize(create, RENDER, StandardEntitlement.RESOURCE_CREATE);\n         fragment.add(create);\n \n         AjaxLink<String> edit = new IndicatingAjaxLink<String>(\"edit\") {\n@@ -282,12 +282,12 @@ public void onClick(final AjaxRequestTarget target) {\n                 modal.header(new Model<>(MessageFormat.format(getString(\"connector.edit\"), node.getDisplayName())));\n \n                 MetaDataRoleAuthorizationStrategy.\n-                        authorize(modal.getForm(), ENABLE, StandardEntitlement.CONNECTOR_UPDATE);\n+                        authorize(modal.getForm(), RENDER, StandardEntitlement.CONNECTOR_UPDATE);\n \n                 modal.show(true);\n             }\n         };\n-        MetaDataRoleAuthorizationStrategy.authorize(edit, ENABLE, StandardEntitlement.CONNECTOR_UPDATE);\n+        MetaDataRoleAuthorizationStrategy.authorize(edit, RENDER, StandardEntitlement.CONNECTOR_UPDATE);\n         fragment.add(edit);\n \n         return fragment;\n@@ -315,7 +315,7 @@ public void onClick(final AjaxRequestTarget target) {\n                 ((BasePage) pageRef.getPage()).getNotificationPanel().refresh(target);\n             }\n         };\n-        MetaDataRoleAuthorizationStrategy.authorize(delete, ENABLE, StandardEntitlement.RESOURCE_DELETE);\n+        MetaDataRoleAuthorizationStrategy.authorize(delete, RENDER, StandardEntitlement.RESOURCE_DELETE);\n         fragment.add(delete);\n \n         AjaxLink<String> edit = new IndicatingAjaxLink<String>(\"edit\") {\n@@ -335,12 +335,12 @@ public void onClick(final AjaxRequestTarget target) {\n                 modal.header(new Model<>(MessageFormat.format(getString(\"resource.edit\"), node.getKey())));\n \n                 MetaDataRoleAuthorizationStrategy.\n-                        authorize(modal.getForm(), ENABLE, StandardEntitlement.RESOURCE_UPDATE);\n+                        authorize(modal.getForm(), RENDER, StandardEntitlement.RESOURCE_UPDATE);\n \n                 modal.show(true);\n             }\n         };\n-        MetaDataRoleAuthorizationStrategy.authorize(edit, ENABLE, StandardEntitlement.RESOURCE_UPDATE);\n+        MetaDataRoleAuthorizationStrategy.authorize(edit, RENDER, StandardEntitlement.RESOURCE_UPDATE);\n         fragment.add(edit);\n \n         AjaxLink<String> status = new IndicatingAjaxLink<String>(\"status\") {\n@@ -356,7 +356,7 @@ public void onClick(final AjaxRequestTarget target) {\n                 propTaskModal.show(true);\n             }\n         };\n-        MetaDataRoleAuthorizationStrategy.authorize(status, ENABLE, StandardEntitlement.USER_UPDATE);\n+        MetaDataRoleAuthorizationStrategy.authorize(status, RENDER, StandardEntitlement.USER_UPDATE);\n         fragment.add(status);\n \n         AjaxLink<String> provision = new IndicatingAjaxLink<String>(\"provision\") {\n@@ -375,12 +375,12 @@ public void onClick(final AjaxRequestTarget target) {\n                 provisionModal.header(new Model<>(MessageFormat.format(getString(\"resource.edit\"), node.getKey())));\n \n                 MetaDataRoleAuthorizationStrategy.\n-                        authorize(provisionModal.getForm(), ENABLE, StandardEntitlement.RESOURCE_UPDATE);\n+                        authorize(provisionModal.getForm(), RENDER, StandardEntitlement.RESOURCE_UPDATE);\n \n                 provisionModal.show(true);\n             }\n         };\n-        MetaDataRoleAuthorizationStrategy.authorize(edit, ENABLE, StandardEntitlement.RESOURCE_UPDATE);\n+        MetaDataRoleAuthorizationStrategy.authorize(edit, RENDER, StandardEntitlement.RESOURCE_UPDATE);\n         fragment.add(provision);\n \n         AjaxLink<String> explore = new IndicatingAjaxLink<String>(\"explore\") {\n@@ -394,7 +394,7 @@ public void onClick(final AjaxRequestTarget target) {\n                 propTaskModal.show(true);\n             }\n         };\n-        MetaDataRoleAuthorizationStrategy.authorize(explore, ENABLE, StandardEntitlement.RESOURCE_LIST_CONNOBJECT);\n+        MetaDataRoleAuthorizationStrategy.authorize(explore, RENDER, StandardEntitlement.RESOURCE_LIST_CONNOBJECT);\n         fragment.add(explore);\n \n         AjaxLink<String> propagation = new IndicatingAjaxLink<String>(\"propagation\") {\n@@ -410,7 +410,7 @@ public void onClick(final AjaxRequestTarget target) {\n                 propTaskModal.show(true);\n             }\n         };\n-        MetaDataRoleAuthorizationStrategy.authorize(propagation, ENABLE, StandardEntitlement.TASK_LIST);\n+        MetaDataRoleAuthorizationStrategy.authorize(propagation, RENDER, StandardEntitlement.TASK_LIST);\n         fragment.add(propagation);\n \n         AjaxLink<String> pull = new IndicatingAjaxLink<String>(\"pull\") {\n@@ -424,7 +424,7 @@ public void onClick(final AjaxRequestTarget target) {\n                 schedTaskModal.show(true);\n             }\n         };\n-        MetaDataRoleAuthorizationStrategy.authorize(pull, ENABLE, StandardEntitlement.TASK_LIST);\n+        MetaDataRoleAuthorizationStrategy.authorize(pull, RENDER, StandardEntitlement.TASK_LIST);\n         fragment.add(pull);\n \n         AjaxLink<String> push = new IndicatingAjaxLink<String>(\"push\") {\n@@ -438,7 +438,7 @@ public void onClick(final AjaxRequestTarget target) {\n                 schedTaskModal.show(true);\n             }\n         };\n-        MetaDataRoleAuthorizationStrategy.authorize(push, ENABLE, StandardEntitlement.TASK_LIST);\n+        MetaDataRoleAuthorizationStrategy.authorize(push, RENDER, StandardEntitlement.TASK_LIST);\n         fragment.add(push);\n \n         return fragment;"},{"sha":"e02b24b48e46de2edfb6e58e184a11ddbcf245c1","filename":"client/console/src/main/java/org/apache/syncope/client/console/wicket/markup/html/form/ActionLinksPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FActionLinksPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FActionLinksPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FActionLinksPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -1126,7 +1126,7 @@ public String getAjaxIndicatorMarkupId() {\n         if (fragment != null) {\n             fragment.setEnabled(enabled);\n             if (StringUtils.isNotBlank(entitlements)) {\n-                MetaDataRoleAuthorizationStrategy.authorize(fragment, ENABLE, entitlements);\n+                MetaDataRoleAuthorizationStrategy.authorize(fragment, RENDER, entitlements);\n             }\n             super.addOrReplace(fragment);\n         }"},{"sha":"3301bb922220db907f4eecc3ad33f58a292bbded","filename":"client/console/src/main/java/org/apache/syncope/client/console/widgets/ApprovalsWidget.java","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwidgets%2FApprovalsWidget.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwidgets%2FApprovalsWidget.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwidgets%2FApprovalsWidget.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -202,7 +202,8 @@ public void run() {\n \n         protected static List<WorkflowFormTO> getLatestAlerts() {\n             final List<WorkflowFormTO> updatedApprovals;\n-            if (SyncopeConsoleSession.get().owns(StandardEntitlement.WORKFLOW_FORM_LIST)) {\n+            if (SyncopeConsoleSession.get().owns(StandardEntitlement.WORKFLOW_FORM_LIST)\n+                    && SyncopeConsoleSession.get().owns(StandardEntitlement.WORKFLOW_FORM_READ)) {\n                 updatedApprovals = SyncopeConsoleSession.get().getService(UserWorkflowService.class).getForms();\n             } else {\n                 updatedApprovals = Collections.<WorkflowFormTO>emptyList();"},{"sha":"6c6cf0da23e229167cf06c350303780895e357af","filename":"client/console/src/main/java/org/apache/syncope/client/console/wizards/WizardMgtPanel.java","status":"modified","additions":15,"deletions":1,"changes":16,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FWizardMgtPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FWizardMgtPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FWizardMgtPanel.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -56,6 +56,8 @@\n \n     protected static final String WIZARD_ID = \"wizard\";\n \n+    private boolean readOnly = false;\n+\n     private final String actualId;\n \n     private final WebMarkupContainer container;\n@@ -180,7 +182,11 @@ public void onEvent(final IEvent<?> event) {\n                     modalPanel = newItemPanelBuilder.build(\n                             actualId,\n                             ((AjaxWizard.NewItemActionEvent<T>) newItemEvent).getIndex(),\n-                            item != null ? AjaxWizard.Mode.EDIT : AjaxWizard.Mode.CREATE);\n+                            item != null\n+                                    ? isReadOnly()\n+                                            ? AjaxWizard.Mode.READONLY\n+                                            : AjaxWizard.Mode.EDIT\n+                                    : AjaxWizard.Mode.CREATE);\n                 } else {\n                     modalPanel = newItemEvent.getModalPanel();\n                 }\n@@ -465,4 +471,12 @@ public AjaxRequestTarget getTarget() {\n             return target;\n         }\n     }\n+\n+    public boolean isReadOnly() {\n+        return readOnly;\n+    }\n+\n+    public void setReadOnly(final boolean readOnly) {\n+        this.readOnly = readOnly;\n+    }\n }"},{"sha":"5d6338c97011e8d394e3602b63fad6ae9ddd769e","filename":"client/console/src/main/java/org/apache/syncope/client/console/wizards/any/Groups.java","status":"modified","additions":54,"deletions":36,"changes":90,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2Fany%2FGroups.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2Fany%2FGroups.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2Fany%2FGroups.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -18,6 +18,9 @@\n  */\n package org.apache.syncope.client.console.wizards.any;\n \n+import static org.apache.wicket.Component.RENDER;\n+import static org.apache.wicket.authroles.authorization.strategies.role.metadata.MetaDataRoleAuthorizationStrategy.ACTION_PERMISSIONS;\n+\n import java.util.ArrayList;\n import java.util.LinkedHashMap;\n import java.util.List;\n@@ -26,6 +29,7 @@\n import org.apache.commons.collections4.IterableUtils;\n import org.apache.commons.collections4.Predicate;\n import org.apache.commons.collections4.Transformer;\n+import org.apache.syncope.client.console.SyncopeConsoleApplication;\n import org.apache.syncope.client.console.rest.GroupRestClient;\n import org.apache.syncope.client.console.wicket.markup.html.form.AjaxPalettePanel;\n import org.apache.syncope.client.lib.SyncopeClient;\n@@ -41,6 +45,8 @@\n import org.apache.wicket.model.util.ListModel;\n import org.apache.wicket.util.lang.Args;\n import org.apache.syncope.common.lib.to.GroupableRelatableTO;\n+import org.apache.syncope.common.lib.types.StandardEntitlement;\n+import org.apache.wicket.authroles.authorization.strategies.role.metadata.ActionPermissions;\n import org.apache.wicket.extensions.wizard.WizardModel.ICondition;\n \n public class Groups extends WizardStep implements ICondition {\n@@ -53,38 +59,48 @@ public class Groups extends WizardStep implements ICondition {\n \n     public <T extends AnyTO> Groups(final T anyTO, final boolean templateMode) {\n         super();\n+\n+        // -----------------------------------------------------------------\n+        // Pre-Authorizations\n+        // -----------------------------------------------------------------\n+        final ActionPermissions permissions = new ActionPermissions();\n+        setMetaData(ACTION_PERMISSIONS, permissions);\n+        permissions.authorize(RENDER,\n+                new org.apache.wicket.authroles.authorization.strategies.role.Roles(StandardEntitlement.GROUP_SEARCH));\n+        // -----------------------------------------------------------------\n+\n         setOutputMarkupId(true);\n \n         Args.isTrue((anyTO instanceof UserTO) || (anyTO instanceof AnyObjectTO), \"Expected user or anyObject\");\n \n         AjaxPalettePanel.Builder<MembershipTO> builder = new AjaxPalettePanel.Builder<MembershipTO>().\n                 setRenderer(new IChoiceRenderer<MembershipTO>() {\n \n-            private static final long serialVersionUID = -3086661086073628855L;\n+                    private static final long serialVersionUID = -3086661086073628855L;\n \n-            @Override\n-            public Object getDisplayValue(final MembershipTO object) {\n-                return object.getGroupName();\n-            }\n+                    @Override\n+                    public Object getDisplayValue(final MembershipTO object) {\n+                        return object.getGroupName();\n+                    }\n \n-            @Override\n-            public String getIdValue(final MembershipTO object, final int index) {\n-                return object.getGroupName();\n-            }\n+                    @Override\n+                    public String getIdValue(final MembershipTO object, final int index) {\n+                        return object.getGroupName();\n+                    }\n \n-            @Override\n-            public MembershipTO getObject(\n-                    final String id, final IModel<? extends List<? extends MembershipTO>> choices) {\n+                    @Override\n+                    public MembershipTO getObject(\n+                            final String id, final IModel<? extends List<? extends MembershipTO>> choices) {\n \n-                return IterableUtils.find(choices.getObject(), new Predicate<MembershipTO>() {\n+                        return IterableUtils.find(choices.getObject(), new Predicate<MembershipTO>() {\n \n-                    @Override\n-                    public boolean evaluate(final MembershipTO object) {\n-                        return id.equalsIgnoreCase(object.getGroupName());\n+                            @Override\n+                            public boolean evaluate(final MembershipTO object) {\n+                                return id.equalsIgnoreCase(object.getGroupName());\n+                            }\n+                        });\n                     }\n                 });\n-            }\n-        });\n \n         add(builder.setAllowOrder(true).withFilter().build(\"groups\",\n                 new ListModel<>(GroupableRelatableTO.class.cast(anyTO).getMemberships()),\n@@ -96,12 +112,12 @@ public boolean evaluate(final MembershipTO object) {\n             public List<MembershipTO> execute(final String filter) {\n                 return CollectionUtils.collect(\n                         groupRestClient.search(\n-                        anyTO.getRealm(),\n-                        SyncopeClient.getGroupSearchConditionBuilder().\n-                        isAssignable().and().is(\"name\").equalTo(filter).query(),\n-                        -1, -1,\n-                        new SortParam<>(\"name\", true),\n-                        null),\n+                                anyTO.getRealm(),\n+                                SyncopeClient.getGroupSearchConditionBuilder().\n+                                isAssignable().and().is(\"name\").equalTo(filter).query(),\n+                                -1, -1,\n+                                new SortParam<>(\"name\", true),\n+                                null),\n                         new Transformer<GroupTO, MembershipTO>() {\n \n                     @Override\n@@ -123,25 +139,27 @@ public MembershipTO transform(final GroupTO input) {\n         }\n         add(new AjaxPalettePanel.Builder<String>().setAllowOrder(true).build(\"dyngroups\",\n                 new ListModel<>(CollectionUtils.collect(GroupableRelatableTO.class.cast(anyTO).getDynGroups(),\n-                new Transformer<String, String>() {\n+                        new Transformer<String, String>() {\n \n-            @Override\n-            public String transform(final String input) {\n-                return allGroupsByKey.get(input).getName();\n-            }\n-        }, new ArrayList<String>())),\n+                    @Override\n+                    public String transform(final String input) {\n+                        return allGroupsByKey.get(input).getName();\n+                    }\n+                }, new ArrayList<String>())),\n                 new ListModel<>(CollectionUtils.collect(allGroups, new Transformer<GroupTO, String>() {\n \n-            @Override\n-            public String transform(final GroupTO input) {\n-                return input.getName();\n-            }\n-        }, new ArrayList<String>()))).\n+                    @Override\n+                    public String transform(final GroupTO input) {\n+                        return input.getName();\n+                    }\n+                }, new ArrayList<String>()))).\n                 hideLabel().setEnabled(false).setOutputMarkupId(true));\n     }\n \n     @Override\n     public boolean evaluate() {\n-        return CollectionUtils.isNotEmpty(allGroups);\n+        return CollectionUtils.isNotEmpty(allGroups)\n+                && SyncopeConsoleApplication.get().getSecuritySettings().getAuthorizationStrategy().\n+                isActionAuthorized(this, RENDER);\n     }\n }"},{"sha":"d0dcd3ef7927ffbee90c4220f45abc07debe245d","filename":"client/console/src/main/java/org/apache/syncope/client/console/wizards/any/Ownership.java","status":"modified","additions":26,"deletions":1,"changes":27,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2Fany%2FOwnership.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2Fany%2FOwnership.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2Fany%2FOwnership.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -18,12 +18,16 @@\n  */\n package org.apache.syncope.client.console.wizards.any;\n \n+import static org.apache.wicket.Component.RENDER;\n+import static org.apache.wicket.authroles.authorization.strategies.role.metadata.MetaDataRoleAuthorizationStrategy.ACTION_PERMISSIONS;\n+\n import de.agilecoders.wicket.extensions.markup.html.bootstrap.form.checkbox.bootstraptoggle.BootstrapToggle;\n import de.agilecoders.wicket.extensions.markup.html.bootstrap.form.checkbox.bootstraptoggle.BootstrapToggleConfig;\n import java.util.ArrayList;\n import java.util.regex.Matcher;\n import java.util.regex.Pattern;\n import org.apache.commons.lang3.StringUtils;\n+import org.apache.syncope.client.console.SyncopeConsoleApplication;\n import org.apache.syncope.client.console.commons.Constants;\n import org.apache.syncope.client.console.panels.search.AnySelectionDirectoryPanel;\n import org.apache.syncope.client.console.panels.search.GroupSearchPanel;\n@@ -45,11 +49,14 @@\n import org.apache.syncope.common.lib.to.GroupTO;\n import org.apache.syncope.common.lib.to.UserTO;\n import org.apache.syncope.common.lib.types.AnyTypeKind;\n+import org.apache.syncope.common.lib.types.StandardEntitlement;\n import org.apache.wicket.PageReference;\n import org.apache.wicket.ajax.AjaxRequestTarget;\n+import org.apache.wicket.authroles.authorization.strategies.role.metadata.ActionPermissions;\n import org.apache.wicket.event.Broadcast;\n import org.apache.wicket.event.IEvent;\n import org.apache.wicket.extensions.ajax.markup.html.IndicatingAjaxLink;\n+import org.apache.wicket.extensions.wizard.WizardModel;\n import org.apache.wicket.extensions.wizard.WizardStep;\n import org.apache.wicket.markup.html.WebMarkupContainer;\n import org.apache.wicket.markup.html.form.CheckBox;\n@@ -60,7 +67,7 @@\n import org.apache.wicket.model.ResourceModel;\n import org.apache.wicket.model.util.ListModel;\n \n-public class Ownership extends WizardStep {\n+public class Ownership extends WizardStep implements WizardModel.ICondition {\n \n     private static final long serialVersionUID = 855618618337931784L;\n \n@@ -94,6 +101,18 @@ public class Ownership extends WizardStep {\n \n     public Ownership(final GroupWrapper groupWrapper, final PageReference pageRef) {\n         super();\n+\n+        // -----------------------------------------------------------------\n+        // Pre-Authorizations\n+        // -----------------------------------------------------------------\n+        final ActionPermissions permissions = new ActionPermissions();\n+        setMetaData(ACTION_PERMISSIONS, permissions);\n+        permissions.authorize(RENDER,\n+                new org.apache.wicket.authroles.authorization.strategies.role.Roles(new StringBuilder().\n+                        append(StandardEntitlement.USER_SEARCH).append(\",\").\n+                        append(StandardEntitlement.GROUP_SEARCH).toString()));\n+        // -----------------------------------------------------------------\n+\n         setTitleModel(new ResourceModel(\"group.ownership\"));\n         this.wrapper = groupWrapper;\n \n@@ -316,4 +335,10 @@ public void onEvent(final IEvent<?> event) {\n             super.onEvent(event);\n         }\n     }\n+\n+    @Override\n+    public boolean evaluate() {\n+        return SyncopeConsoleApplication.get().getSecuritySettings().getAuthorizationStrategy().\n+                isActionAuthorized(this, RENDER);\n+    }\n }"},{"sha":"99d28215ed38858023c8275bf07ce3c8b1742fbe","filename":"client/console/src/main/java/org/apache/syncope/client/console/wizards/any/Relationships.java","status":"modified","additions":1,"deletions":2,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2Fany%2FRelationships.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2Fany%2FRelationships.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2Fany%2FRelationships.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -166,8 +166,7 @@ public void onClick(final AjaxRequestTarget target, final RelationshipTO ignore)\n                 addFragment.add(new Specification().setRenderBodyOnly(true));\n                 target.add(Relationships.this);\n             }\n-        }, ActionType.CREATE, AnyEntitlement.UPDATE.getFor(anyTO.getType())).\n-                build(\"actions\"));\n+        }, ActionType.CREATE, AnyEntitlement.UPDATE.getFor(anyTO.getType())).build(\"actions\"));\n \n         return viewFragment;\n     }"},{"sha":"561a231db383f5e4e674d2f88ccc0e8e84b4fbea","filename":"client/console/src/main/java/org/apache/syncope/client/console/wizards/any/Resources.java","status":"modified","additions":23,"deletions":3,"changes":26,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2Fany%2FResources.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2Fany%2FResources.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2Fany%2FResources.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -18,15 +18,21 @@\n  */\n package org.apache.syncope.client.console.wizards.any;\n \n+import static org.apache.wicket.Component.RENDER;\n+import static org.apache.wicket.authroles.authorization.strategies.role.metadata.MetaDataRoleAuthorizationStrategy.ACTION_PERMISSIONS;\n+\n import java.util.ArrayList;\n import java.util.Collections;\n import java.util.List;\n import org.apache.commons.collections4.CollectionUtils;\n+import org.apache.syncope.client.console.SyncopeConsoleApplication;\n import org.apache.syncope.client.console.rest.ResourceRestClient;\n import org.apache.syncope.client.console.wicket.markup.html.form.AjaxPalettePanel;\n import org.apache.syncope.common.lib.EntityTOUtils;\n import org.apache.syncope.common.lib.to.AnyTO;\n import org.apache.syncope.common.lib.to.ResourceTO;\n+import org.apache.syncope.common.lib.types.StandardEntitlement;\n+import org.apache.wicket.authroles.authorization.strategies.role.metadata.ActionPermissions;\n import org.apache.wicket.extensions.wizard.WizardModel;\n import org.apache.wicket.extensions.wizard.WizardStep;\n import org.apache.wicket.model.PropertyModel;\n@@ -39,6 +45,15 @@ public class Resources extends WizardStep implements WizardModel.ICondition {\n     private final ListModel<String> available;\n \n     public <T extends AnyTO> Resources(final T entityTO) {\n+        // -----------------------------------------------------------------\n+        // Pre-Authorizations\n+        // -----------------------------------------------------------------\n+        final ActionPermissions permissions = new ActionPermissions();\n+        setMetaData(ACTION_PERMISSIONS, permissions);\n+        permissions.authorize(RENDER,\n+                new org.apache.wicket.authroles.authorization.strategies.role.Roles(StandardEntitlement.RESOURCE_LIST));\n+        // -----------------------------------------------------------------\n+\n         this.setOutputMarkupId(true);\n         this.available = new ListModel<>(Collections.<String>emptyList());\n \n@@ -62,8 +77,13 @@ public void setObject(final List<String> object) {\n \n     @Override\n     public boolean evaluate() {\n-        available.setObject(CollectionUtils.collect(new ResourceRestClient().list(),\n-                EntityTOUtils.<ResourceTO>keyTransformer(), new ArrayList<String>()));\n-        return CollectionUtils.isNotEmpty(available.getObject());\n+        if (SyncopeConsoleApplication.get().getSecuritySettings().getAuthorizationStrategy().\n+                isActionAuthorized(this, RENDER)) {\n+            available.setObject(CollectionUtils.collect(new ResourceRestClient().list(),\n+                    EntityTOUtils.<ResourceTO>keyTransformer(), new ArrayList<String>()));\n+            return CollectionUtils.isNotEmpty(available.getObject());\n+        } else {\n+            return false;\n+        }\n     }\n }"},{"sha":"a4ab51b244882e2cd6f42f092a740d4a2dc560bc","filename":"client/console/src/main/java/org/apache/syncope/client/console/wizards/any/Roles.java","status":"modified","additions":22,"deletions":4,"changes":26,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2Fany%2FRoles.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2Fany%2FRoles.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2Fany%2FRoles.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -18,16 +18,22 @@\n  */\n package org.apache.syncope.client.console.wizards.any;\n \n+import static org.apache.wicket.Component.RENDER;\n+import static org.apache.wicket.authroles.authorization.strategies.role.metadata.MetaDataRoleAuthorizationStrategy.ACTION_PERMISSIONS;\n+\n import java.util.ArrayList;\n import java.util.Collections;\n import java.util.List;\n import org.apache.commons.collections4.CollectionUtils;\n+import org.apache.syncope.client.console.SyncopeConsoleApplication;\n import org.apache.syncope.client.console.rest.RoleRestClient;\n import org.apache.syncope.client.console.wicket.markup.html.form.AjaxPalettePanel;\n import org.apache.syncope.common.lib.EntityTOUtils;\n import org.apache.syncope.common.lib.to.AnyTO;\n import org.apache.syncope.common.lib.to.RoleTO;\n import org.apache.syncope.common.lib.to.UserTO;\n+import org.apache.syncope.common.lib.types.StandardEntitlement;\n+import org.apache.wicket.authroles.authorization.strategies.role.metadata.ActionPermissions;\n import org.apache.wicket.extensions.wizard.WizardModel.ICondition;\n import org.apache.wicket.extensions.wizard.WizardStep;\n import org.apache.wicket.model.PropertyModel;\n@@ -40,10 +46,20 @@ public class Roles extends WizardStep implements ICondition {\n     private final List<String> allRoles;\n \n     public <T extends AnyTO> Roles(final UserTO entityTO) {\n+        // -----------------------------------------------------------------\n+        // Pre-Authorizations\n+        // -----------------------------------------------------------------\n+        final ActionPermissions permissions = new ActionPermissions();\n+        setMetaData(ACTION_PERMISSIONS, permissions);\n+        permissions.authorize(RENDER,\n+                new org.apache.wicket.authroles.authorization.strategies.role.Roles(StandardEntitlement.ROLE_LIST));\n+        // -----------------------------------------------------------------\n+\n         this.setOutputMarkupId(true);\n \n-        allRoles = CollectionUtils.collect(new RoleRestClient().list(),\n-                EntityTOUtils.<RoleTO>keyTransformer(), new ArrayList<String>());\n+        allRoles = SyncopeConsoleApplication.get().getSecuritySettings().getAuthorizationStrategy().\n+                isActionAuthorized(this, RENDER) ? CollectionUtils.collect(new RoleRestClient().list(),\n+                EntityTOUtils.<RoleTO>keyTransformer(), new ArrayList<String>()) : Collections.<String>emptyList();\n         Collections.sort(allRoles);\n \n         add(new AjaxPalettePanel.Builder<String>().build(\"roles\",\n@@ -56,7 +72,9 @@ public <T extends AnyTO> Roles(final UserTO entityTO) {\n     }\n \n     @Override\n-    public boolean evaluate() {\n-        return CollectionUtils.isNotEmpty(allRoles);\n+    public final boolean evaluate() {\n+        return CollectionUtils.isNotEmpty(allRoles)\n+                && SyncopeConsoleApplication.get().getSecuritySettings().getAuthorizationStrategy().\n+                isActionAuthorized(this, RENDER);\n     }\n }"},{"sha":"1fb0cf619f7c189f3288b0b8299d758f4e4e6311","filename":"client/console/src/main/resources/org/apache/syncope/client/console/panels/TogglePanel.html","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FTogglePanel.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FTogglePanel.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FTogglePanel.html?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -46,9 +46,9 @@\n         padding: 5px 10px;\n       }\n \n-      div.topology-menu ul.menu li a {\n+      div.topology-menu ul.menu li a i {\n         position: relative;\n-        padding: 12px 5px 12px 15px;\n+        padding: 12px 15px 12px 5px;\n       }\n \n       div.topology-menu div.header a:active,"},{"sha":"ee93861285123b87695baaae021872a093a69fae","filename":"client/console/src/main/resources/org/apache/syncope/client/console/panels/WorkflowTogglePanel.html","status":"modified","additions":6,"deletions":2,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FWorkflowTogglePanel.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FWorkflowTogglePanel.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FWorkflowTogglePanel.html?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -38,8 +38,12 @@\n   <wicket:extend>\n     <div wicket:id=\"container\">\n       <ul class=\"menu\">\n-        <li><i class=\"fa fa-file-image-o\"></i><a href=\"#\" wicket:id=\"activitiModeler\">Activiti Modeler</a></li>\n-        <li><i class=\"fa fa-file-text-o\"></i><a href=\"#\" wicket:id=\"xmlEditor\">XML editor</a></li>\n+        <wicket:enclosure child=\"activitiModeler\">\n+          <li><a href=\"#\" wicket:id=\"activitiModeler\"><i class=\"fa fa-file-image-o\"></i>Activiti Modeler</a></li>\n+        </wicket:enclosure>\n+        <wicket:enclosure child=\"xmlEditor\">\n+          <li><a href=\"#\" wicket:id=\"xmlEditor\"><i class=\"fa fa-file-text-o\"></i>XML editor</a></li>\n+        </wicket:enclosure>\n       </ul>\n     </div>\n   </wicket:extend>"},{"sha":"28ef60754a05dea2f7602463467a8e6dfd5d9f0a","filename":"client/console/src/main/resources/org/apache/syncope/client/console/topology/TopologyTogglePanel.html","status":"modified","additions":42,"deletions":14,"changes":56,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Ftopology%2FTopologyTogglePanel.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Ftopology%2FTopologyTogglePanel.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Ftopology%2FTopologyTogglePanel.html?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -24,35 +24,63 @@\n \n     <wicket:fragment wicket:id=\"connectorActions\">\n       <ul class=\"menu\">\n-        <li><i class=\"fa fa-plus\"></i><a href=\"#\" wicket:id=\"create\"><wicket:message key=\"resource.menu.add\"/></a></li>\n-        <li><i class=\"fa fa-pencil\"></i><a href=\"#\" wicket:id=\"edit\"><wicket:message key=\"connector.menu.edit\"/></a></li>\n-        <li><i class=\"fa fa-minus\"></i><a href=\"#\" wicket:id=\"delete\"><wicket:message key=\"connector.menu.remove\"/></a></li>\n+        <wicket:enclosure child=\"create\">\n+          <li><a href=\"#\" wicket:id=\"create\"><i class=\"fa fa-plus\"></i><wicket:message key=\"resource.menu.add\"/></a></li>\n+        </wicket:enclosure>\n+        <wicket:enclosure child=\"edit\">\n+          <li><a href=\"#\" wicket:id=\"edit\"><i class=\"fa fa-pencil\"></i><wicket:message key=\"connector.menu.edit\"/></a></li>\n+        </wicket:enclosure>\n+        <wicket:enclosure child=\"delete\">\n+          <li><a href=\"#\" wicket:id=\"delete\"><i class=\"fa fa-minus\"></i><wicket:message key=\"connector.menu.remove\"/></a></li>\n+        </wicket:enclosure>\n       </ul>\n     </wicket:fragment>\n \n     <wicket:fragment wicket:id=\"resourceActions\">\n       <ul class=\"menu\">\n-        <li><i class=\"fa fa-pencil\"></i><a href=\"#\" wicket:id=\"edit\"><wicket:message key=\"resource.menu.edit\"/></a></li>\n-        <li><i class=\"fa fa-exchange\"></i><a href=\"#\" wicket:id=\"provision\"><wicket:message key=\"resource.menu.provision\"/></a></li>\n-        <li><i class=\"fa fa-eye\"></i><a href=\"#\" wicket:id=\"explore\"><wicket:message key=\"resource.menu.explore\"/></a></li>\n-        <li><i class=\"fa fa-arrow-right\"></i><a href=\"#\" wicket:id=\"propagation\"><wicket:message key=\"task.propagation.list\"/></a></li>\n-        <li><i class=\"fa fa-chevron-circle-left\"></i><a href=\"#\" wicket:id=\"pull\"><wicket:message key=\"task.pull.list\"/></a></li>\n-        <li><i class=\"fa fa-chevron-circle-right\"></i><a href=\"#\" wicket:id=\"push\"><wicket:message key=\"task.push.list\"/></a></li>\n-        <li><i class=\"fa fa-list-ul\"></i><a href=\"#\" wicket:id=\"status\"><wicket:message key=\"resource.menu.provisioning.status\"/></a></li>\n-        <li><i class=\"fa fa-minus\"></i><a href=\"#\" wicket:id=\"delete\"><wicket:message key=\"resource.menu.remove\"/></a></li>\n+        <wicket:enclosure child=\"edit\">\n+          <li><a href=\"#\" wicket:id=\"edit\"><i class=\"fa fa-pencil\"></i><wicket:message key=\"resource.menu.edit\"/></a></li>\n+        </wicket:enclosure>\n+        <wicket:enclosure child=\"provision\">\n+          <li><a href=\"#\" wicket:id=\"provision\"><i class=\"fa fa-exchange\"></i><wicket:message key=\"resource.menu.provision\"/></a></li>\n+        </wicket:enclosure>\n+        <wicket:enclosure child=\"explore\">\n+          <li><a href=\"#\" wicket:id=\"explore\"><i class=\"fa fa-eye\"></i><wicket:message key=\"resource.menu.explore\"/></a></li>\n+        </wicket:enclosure>\n+        <wicket:enclosure child=\"propagation\">\n+          <li><a href=\"#\" wicket:id=\"propagation\"><i class=\"fa fa-arrow-right\"></i><wicket:message key=\"task.propagation.list\"/></a></li>\n+        </wicket:enclosure>\n+        <wicket:enclosure child=\"pull\">\n+          <li><a href=\"#\" wicket:id=\"pull\"><i class=\"fa fa-chevron-circle-left\"></i><wicket:message key=\"task.pull.list\"/></a></li>\n+        </wicket:enclosure>\n+        <wicket:enclosure child=\"push\">\n+          <li><a href=\"#\" wicket:id=\"push\"><i class=\"fa fa-chevron-circle-right\"></i><wicket:message key=\"task.push.list\"/></a></li>\n+        </wicket:enclosure>\n+        <wicket:enclosure child=\"status\">\n+          <li><a href=\"#\" wicket:id=\"status\"><i class=\"fa fa-list-ul\"></i><wicket:message key=\"resource.menu.provisioning.status\"/></a></li>\n+        </wicket:enclosure>\n+        <wicket:enclosure child=\"delete\">\n+          <li><a href=\"#\" wicket:id=\"delete\"><i class=\"fa fa-minus\"></i><wicket:message key=\"resource.menu.remove\"/></a></li>\n+        </wicket:enclosure>\n       </ul>\n     </wicket:fragment>\n \n     <wicket:fragment wicket:id=\"locationActions\">\n       <ul class=\"menu\">\n-        <li><i class=\"fa fa-plus\"></i><a href=\"#\" wicket:id=\"create\"><wicket:message key=\"connector.menu.add\"/></a></li>\n+        <wicket:enclosure child=\"create\">\n+          <li><a href=\"#\" wicket:id=\"create\"><i class=\"fa fa-plus\"></i><wicket:message key=\"connector.menu.add\"/></a></li>\n+        </wicket:enclosure>\n       </ul>\n     </wicket:fragment>\n \n     <wicket:fragment wicket:id=\"syncopeActions\">\n       <ul class=\"menu\">\n-        <li><i class=\"fa fa-refresh\"></i><a href=\"#\" wicket:id=\"reload\"><wicket:message key=\"connectors.reload\"/></a></li>\n-        <li><i class=\"fa fa-tasks\"></i><a href=\"#\" wicket:id=\"tasks\"><wicket:message key=\"task.custom.list\"/></a></li>\n+        <wicket:enclosure child=\"reload\">\n+          <li><a href=\"#\" wicket:id=\"reload\"><i class=\"fa fa-refresh\"></i><wicket:message key=\"connectors.reload\"/></a></li>\n+        </wicket:enclosure>\n+        <wicket:enclosure child=\"tasks\">\n+          <li><a href=\"#\" wicket:id=\"tasks\"><i class=\"fa fa-tasks\"></i><wicket:message key=\"task.custom.list\"/></a></li>\n+        </wicket:enclosure>\n       </ul>\n     </wicket:fragment>\n "},{"sha":"e20cd71f33086bc00546d9824a0669efdb96a8be","filename":"common/lib/src/main/java/org/apache/syncope/common/lib/types/AnyEntitlement.java","status":"modified","additions":0,"deletions":1,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/common%2Flib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2Ftypes%2FAnyEntitlement.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/common%2Flib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2Ftypes%2FAnyEntitlement.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/common%2Flib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2Ftypes%2FAnyEntitlement.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -20,7 +20,6 @@\n \n public enum AnyEntitlement {\n     SEARCH,\n-    LIST,\n     CREATE,\n     READ,\n     UPDATE,"},{"sha":"ecaa25faa00bdf4c435003876fa21164f790dd91","filename":"common/lib/src/main/java/org/apache/syncope/common/lib/types/StandardEntitlement.java","status":"modified","additions":0,"deletions":2,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/common%2Flib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2Ftypes%2FStandardEntitlement.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/common%2Flib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2Ftypes%2FStandardEntitlement.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/common%2Flib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2Ftypes%2FStandardEntitlement.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -88,8 +88,6 @@ public final class StandardEntitlement {\n \n     public static final String USER_SEARCH = \"USER_SEARCH\";\n \n-    public static final String USER_LIST = \"USER_LIST\";\n-\n     public static final String USER_CREATE = \"USER_CREATE\";\n \n     public static final String USER_READ = \"USER_READ\";"},{"sha":"895b958ed82c2e87ac5afe017c9a7a21b61544a5","filename":"core/logic/src/main/java/org/apache/syncope/core/logic/UserLogic.java","status":"modified","additions":8,"deletions":8,"changes":16,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/core%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FUserLogic.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/core%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FUserLogic.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FUserLogic.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -86,23 +86,23 @@ public class UserLogic extends AbstractAnyLogic<UserTO, UserPatch> {\n     @Autowired\n     protected SyncopeLogic syncopeLogic;\n \n-    @PreAuthorize(\"hasRole('\" + StandardEntitlement.USER_LIST + \"')\")\n+    @PreAuthorize(\"hasRole('\" + StandardEntitlement.USER_SEARCH + \"')\")\n     @Transactional(readOnly = true)\n     @Override\n     public int count(final String realm) {\n         return userDAO.count(\n-                getEffectiveRealms(AuthContextUtils.getAuthorizations().get(StandardEntitlement.USER_LIST), realm));\n+                getEffectiveRealms(AuthContextUtils.getAuthorizations().get(StandardEntitlement.USER_SEARCH), realm));\n     }\n \n-    @PreAuthorize(\"hasRole('\" + StandardEntitlement.USER_LIST + \"')\")\n+    @PreAuthorize(\"hasRole('\" + StandardEntitlement.USER_SEARCH + \"')\")\n     @Transactional(readOnly = true)\n     @Override\n     public List<UserTO> list(\n             final int page, final int size, final List<OrderByClause> orderBy,\n             final String realm, final boolean details) {\n \n         return CollectionUtils.collect(userDAO.findAll(\n-                getEffectiveRealms(AuthContextUtils.getAuthorizations().get(StandardEntitlement.USER_LIST), realm),\n+                getEffectiveRealms(AuthContextUtils.getAuthorizations().get(StandardEntitlement.USER_SEARCH), realm),\n                 page, size, orderBy),\n                 new Transformer<User, UserTO>() {\n \n@@ -194,8 +194,8 @@ protected ProvisioningResult<UserTO> doCreate(\n             securityChecks(effectiveRealms, before.getLeft().getRealm(), null);\n         }\n \n-        Pair<String, List<PropagationStatus>> created =\n-                provisioningManager.create(before.getLeft(), storePassword, nullPriorityAsync);\n+        Pair<String, List<PropagationStatus>> created = provisioningManager.create(before.getLeft(), storePassword,\n+                nullPriorityAsync);\n \n         return after(binder.returnUserTO(binder.getUserTO(created.getKey())), created.getRight(), before.getRight());\n     }\n@@ -506,8 +506,8 @@ public ProvisioningResult<UserTO> provision(\n                 user.getRealm());\n         securityChecks(effectiveRealms, user.getRealm(), user.getKey());\n \n-        List<PropagationStatus> statuses =\n-                provisioningManager.provision(key, changePwd, password, resources, nullPriorityAsync);\n+        List<PropagationStatus> statuses = provisioningManager.provision(key, changePwd, password, resources,\n+                nullPriorityAsync);\n \n         ProvisioningResult<UserTO> result = new ProvisioningResult<>();\n         result.setEntity(binder.returnUserTO(binder.getUserTO(key)));"},{"sha":"75b2fa22cac4eaca97c098a9b4d264c3b650e2b4","filename":"core/logic/src/main/java/org/apache/syncope/core/logic/init/EntitlementAccessor.java","status":"modified","additions":3,"deletions":1,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/core%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2Finit%2FEntitlementAccessor.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/core%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2Finit%2FEntitlementAccessor.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2Finit%2FEntitlementAccessor.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -39,7 +39,9 @@ public class EntitlementAccessor {\n     @Transactional(readOnly = true)\n     public void addEntitlementsForAnyTypes() {\n         for (AnyType anyType : anyTypeDAO.findAll()) {\n-            EntitlementsHolder.getInstance().addFor(anyType.getKey());\n+            if (anyType != anyTypeDAO.findUser() && anyType != anyTypeDAO.findGroup()) {\n+                EntitlementsHolder.getInstance().addFor(anyType.getKey());\n+            }\n         }\n     }\n }"},{"sha":"174eef2bd868af1567c15f23c6827032fe0a9bb4","filename":"core/persistence-jpa/src/test/java/org/apache/syncope/core/persistence/jpa/inner/RoleTest.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/core%2Fpersistence-jpa%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Finner%2FRoleTest.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/core%2Fpersistence-jpa%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Finner%2FRoleTest.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Finner%2FRoleTest.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -50,7 +50,7 @@ public void find() {\n         assertNotNull(role.getKey());\n         assertFalse(role.getRealms().isEmpty());\n         assertFalse(role.getEntitlements().isEmpty());\n-        assertTrue(role.getEntitlements().contains(StandardEntitlement.USER_LIST));\n+        assertTrue(role.getEntitlements().contains(StandardEntitlement.USER_SEARCH));\n     }\n \n     @Test"},{"sha":"9d42df9d315670a4b1b85b43a7651b7776de3939","filename":"fit/core-reference/src/test/java/org/apache/syncope/fit/core/AuthenticationITCase.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FAuthenticationITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f279cd7b836c5d786ed21f5f400ab5d315a55f2/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FAuthenticationITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FAuthenticationITCase.java?ref=3f279cd7b836c5d786ed21f5f400ab5d315a55f2","patch":"@@ -242,7 +242,7 @@ public void delegatedUserCRUD() {\n             role.getEntitlements().add(StandardEntitlement.USER_CREATE);\n             role.getEntitlements().add(StandardEntitlement.USER_UPDATE);\n             role.getEntitlements().add(StandardEntitlement.USER_DELETE);\n-            role.getEntitlements().add(StandardEntitlement.USER_LIST);\n+            role.getEntitlements().add(StandardEntitlement.USER_SEARCH);\n             role.getEntitlements().add(StandardEntitlement.USER_READ);\n             role.getRealms().add(\"/even/two\");\n "}]}