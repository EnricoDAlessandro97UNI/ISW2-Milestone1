{"sha":"05d2985a47cb2104a6b43d553b4707209c261f94","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjA1ZDI5ODVhNDdjYjIxMDRhNmI0M2Q1NTNiNDcwNzIwOWMyNjFmOTQ=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2014-11-03T18:19:21Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2014-11-03T18:19:21Z"},"message":"[SYNCOPE-599] Enhancements to console's authorization parsing","tree":{"sha":"9ec295a1096dde67b148dd1fd6d37301461b8c47","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/9ec295a1096dde67b148dd1fd6d37301461b8c47"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/05d2985a47cb2104a6b43d553b4707209c261f94","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/05d2985a47cb2104a6b43d553b4707209c261f94","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/05d2985a47cb2104a6b43d553b4707209c261f94","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/05d2985a47cb2104a6b43d553b4707209c261f94/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"79ef5134ab33c2b826288a276fae876b89427c2a","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/79ef5134ab33c2b826288a276fae876b89427c2a","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/79ef5134ab33c2b826288a276fae876b89427c2a"}],"stats":{"total":253,"additions":133,"deletions":120},"files":[{"sha":"0fbe521752ce9668bd15838eb7da64637be5b541","filename":"console/src/main/java/org/apache/syncope/console/SyncopeApplication.java","status":"modified","additions":5,"deletions":5,"changes":10,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2FSyncopeApplication.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2FSyncopeApplication.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2FSyncopeApplication.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -120,7 +120,7 @@ public void onClick(final AjaxRequestTarget target) {\n                 : \"\") + \"schema\" + Constants.PNG_EXT)));\n \n         BookmarkablePageLink<Void> usersLink = new BookmarkablePageLink<Void>(\"users\", Users.class);\n-        String allowedUsersRoles = xmlRolesReader.getAllAllowedRoles(\"Users\", \"list\");\n+        String allowedUsersRoles = xmlRolesReader.getEntitlement(\"Users\", \"list\");\n         MetaDataRoleAuthorizationStrategy.authorize(usersLink, WebPage.ENABLE, allowedUsersRoles);\n         page.add(usersLink);\n         usersLink.add(new Image(\"usersIcon\", new ContextRelativeResource(IMG_PREFIX + (notsel\n@@ -142,15 +142,15 @@ public void onClick(final AjaxRequestTarget target) {\n                 : \"\") + \"resources\" + Constants.PNG_EXT)));\n \n         BookmarkablePageLink<Void> todoLink = new BookmarkablePageLink<Void>(\"todo\", Todo.class);\n-        MetaDataRoleAuthorizationStrategy.authorize(todoLink, WebPage.ENABLE, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(todoLink, WebPage.ENABLE, xmlRolesReader.getEntitlement(\n                 \"Approval\", \"list\"));\n         page.add(todoLink);\n         todoLink.add(new Image(\"todoIcon\", new ContextRelativeResource(IMG_PREFIX + (notsel\n                 ? IMG_NOTSEL\n                 : \"\") + \"todo\" + Constants.PNG_EXT)));\n \n         BookmarkablePageLink<Void> reportLink = new BookmarkablePageLink<Void>(\"reports\", Reports.class);\n-        String allowedReportRoles = xmlRolesReader.getAllAllowedRoles(\"Reports\", \"list\");\n+        String allowedReportRoles = xmlRolesReader.getEntitlement(\"Reports\", \"list\");\n         MetaDataRoleAuthorizationStrategy.authorize(reportLink, WebPage.ENABLE, allowedReportRoles);\n         page.add(reportLink);\n         reportLink.add(new Image(\"reportsIcon\", new ContextRelativeResource(IMG_PREFIX + (notsel\n@@ -159,15 +159,15 @@ public void onClick(final AjaxRequestTarget target) {\n \n         BookmarkablePageLink<Void> configurationLink = new BookmarkablePageLink<Void>(\"configuration\",\n                 Configuration.class);\n-        String allowedConfigurationRoles = xmlRolesReader.getAllAllowedRoles(\"Configuration\", \"list\");\n+        String allowedConfigurationRoles = xmlRolesReader.getEntitlement(\"Configuration\", \"list\");\n         MetaDataRoleAuthorizationStrategy.authorize(configurationLink, WebPage.ENABLE, allowedConfigurationRoles);\n         page.add(configurationLink);\n         configurationLink.add(new Image(\"configurationIcon\", new ContextRelativeResource(IMG_PREFIX + (notsel\n                 ? IMG_NOTSEL\n                 : \"\") + \"configuration\" + Constants.PNG_EXT)));\n \n         BookmarkablePageLink<Void> taskLink = new BookmarkablePageLink<Void>(\"tasks\", Tasks.class);\n-        String allowedTasksRoles = xmlRolesReader.getAllAllowedRoles(\"Tasks\", \"list\");\n+        String allowedTasksRoles = xmlRolesReader.getEntitlement(\"Tasks\", \"list\");\n         MetaDataRoleAuthorizationStrategy.authorize(taskLink, WebPage.ENABLE, allowedTasksRoles);\n         page.add(taskLink);\n         taskLink.add(new Image(\"tasksIcon\", new ContextRelativeResource(IMG_PREFIX + (notsel"},{"sha":"69cf4ecf299190b26e74ab5fddaf4f02370495d3","filename":"console/src/main/java/org/apache/syncope/console/commons/XMLRolesReader.java","status":"modified","additions":60,"deletions":44,"changes":104,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fcommons%2FXMLRolesReader.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fcommons%2FXMLRolesReader.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fcommons%2FXMLRolesReader.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -18,17 +18,17 @@\n  */\n package org.apache.syncope.console.commons;\n \n+import java.util.HashMap;\n+import java.util.Map;\n import javax.xml.parsers.DocumentBuilder;\n import javax.xml.parsers.DocumentBuilderFactory;\n-import javax.xml.xpath.XPath;\n-import javax.xml.xpath.XPathConstants;\n-import javax.xml.xpath.XPathExpression;\n-import javax.xml.xpath.XPathExpressionException;\n-import javax.xml.xpath.XPathFactory;\n+import org.apache.commons.lang3.StringUtils;\n+import org.apache.commons.lang3.tuple.ImmutablePair;\n+import org.apache.commons.lang3.tuple.Pair;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n-import org.springframework.beans.factory.annotation.Autowired;\n import org.w3c.dom.Document;\n+import org.w3c.dom.Node;\n import org.w3c.dom.NodeList;\n \n /**\n@@ -41,62 +41,78 @@ public class XMLRolesReader {\n      */\n     private static final Logger LOG = LoggerFactory.getLogger(XMLRolesReader.class);\n \n-    @Autowired\n     private String authorizations;\n \n-    private Document doc;\n+    private Map<Pair<String, String>, String> authMap;\n+\n+    public void setAuthorizations(final String authorizations) {\n+        this.authorizations = authorizations;\n+    }\n+\n+    private void init() {\n+        authMap = new HashMap<Pair<String, String>, String>();\n \n-    public void init() {\n         DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\n         dbf.setNamespaceAware(true);\n         try {\n             DocumentBuilder db = dbf.newDocumentBuilder();\n-            doc = db.parse(getClass().getResource(\"/\" + authorizations).openStream());\n+            Document doc = db.parse(getClass().getResource(\"/\" + authorizations).openStream());\n             doc.getDocumentElement().normalize();\n+\n+            Node authNode = null;\n+            NodeList root = doc.getChildNodes();\n+            for (int i = 0; i < root.getLength() && authNode == null; i++) {\n+                if (\"auth\".equals(root.item(i).getNodeName())) {\n+                    authNode = root.item(i);\n+                }\n+            }\n+            if (authNode == null) {\n+                throw new IllegalArgumentException(\"Could not find root <auth> node\");\n+            }\n+\n+            NodeList pages = authNode.getChildNodes();\n+            for (int i = 0; i < pages.getLength(); i++) {\n+                if (\"page\".equals(pages.item(i).getNodeName())) {\n+                    String page = pages.item(i).getAttributes().getNamedItem(\"id\").getTextContent();\n+\n+                    NodeList actions = pages.item(i).getChildNodes();\n+                    for (int j = 0; j < actions.getLength(); j++) {\n+                        if (\"action\".equals(actions.item(j).getNodeName())) {\n+                            String action = actions.item(j).getAttributes().getNamedItem(\"id\").getTextContent();\n+\n+                            NodeList entitlements = actions.item(j).getChildNodes();\n+                            for (int k = 0; k < entitlements.getLength(); k++) {\n+                                if (\"entitlement\".equals(entitlements.item(k).getNodeName())) {\n+                                    String entitlement = entitlements.item(k).getTextContent();\n+                                    authMap.put(new ImmutablePair<String, String>(page, action), entitlement);\n+                                }\n+                            }\n+                        }\n+                    }\n+                }\n+            }\n         } catch (Exception e) {\n             LOG.error(\"While initializing parsing of {}\", authorizations, e);\n-            doc = null;\n         }\n     }\n \n     /**\n-     * Get all roles allowed for specific page and action requested.\n+     * Get entitlement required for page / action.\n      *\n-     * @param pageId\n-     * @param actionId\n-     * @return roles list comma separated\n+     * @param pageId page\n+     * @param actionId action\n+     * @return entitlement required\n      */\n-    public String getAllAllowedRoles(final String pageId, final String actionId) {\n-\n-        if (doc == null) {\n-            init();\n-        }\n-        if (doc == null) {\n-            return \"\";\n-        }\n-\n-        final StringBuilder roles = new StringBuilder();\n-        try {\n-            XPathFactory factory = XPathFactory.newInstance();\n-            XPath xpath = factory.newXPath();\n-            XPathExpression expr = xpath.compile(\"//page[@id='\" + pageId + \"']/\" + \"action[@id='\" + actionId + \"']/\"\n-                    + \"entitlement/text()\");\n-            Object result = expr.evaluate(doc, XPathConstants.NODESET);\n-\n-            NodeList nodes = (NodeList) result;\n-\n-            for (int i = 0; i < nodes.getLength(); i++) {\n-                if (i > 0) {\n-                    roles.append(\",\");\n-                }\n-                roles.append(nodes.item(i).getNodeValue());\n+    public String getEntitlement(final String pageId, final String actionId) {\n+        synchronized (this) {\n+            if (authMap == null) {\n+                init();\n             }\n-        } catch (XPathExpressionException e) {\n-            LOG.error(\"While parsing authorizations file\", e);\n         }\n \n-        LOG.debug(\"Authorizations found: {}\", roles);\n-\n-        return roles.toString();\n+        Pair<String, String> key = new ImmutablePair<String, String>(pageId, actionId);\n+        return authMap.containsKey(key)\n+                ? authMap.get(key)\n+                : StringUtils.EMPTY;\n     }\n }"},{"sha":"8bd02b9d7bdab2a9184ea60019aaf2d1f98e5ee9","filename":"console/src/main/java/org/apache/syncope/console/pages/AbstractSchedTaskModalPage.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FAbstractSchedTaskModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FAbstractSchedTaskModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FAbstractSchedTaskModalPage.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -129,10 +129,10 @@ protected void onSubmit(final AjaxRequestTarget target, final Form<?> form) {\n         cancel.setDefaultFormProcessing(false);\n \n         if (taskTO.getId() > 0) {\n-            MetaDataRoleAuthorizationStrategy.authorize(submit, RENDER, xmlRolesReader.getAllAllowedRoles(TASKS,\n+            MetaDataRoleAuthorizationStrategy.authorize(submit, RENDER, xmlRolesReader.getEntitlement(TASKS,\n                     \"update\"));\n         } else {\n-            MetaDataRoleAuthorizationStrategy.authorize(submit, RENDER, xmlRolesReader.getAllAllowedRoles(TASKS,\n+            MetaDataRoleAuthorizationStrategy.authorize(submit, RENDER, xmlRolesReader.getEntitlement(TASKS,\n                     \"create\"));\n         }\n "},{"sha":"fae7b42e6e8cd1f808b8ce6ea2fa4e10cf311458","filename":"console/src/main/java/org/apache/syncope/console/pages/ApprovalModalPage.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FApprovalModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FApprovalModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FApprovalModalPage.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -188,7 +188,7 @@ protected void closeAction(final AjaxRequestTarget target, final Form form) {\n                     }\n                 };\n         MetaDataRoleAuthorizationStrategy.authorize(userDetails, ENABLE,\n-                xmlRolesReader.getAllAllowedRoles(\"Users\", \"read\"));\n+                xmlRolesReader.getEntitlement(\"Users\", \"read\"));\n \n         final AjaxButton submit = new IndicatingAjaxButton(APPLY, new Model<String>(getString(SUBMIT))) {\n \n@@ -267,7 +267,7 @@ protected void onError(final AjaxRequestTarget target, final Form form) {\n         form.add(submit);\n         form.add(cancel);\n \n-        MetaDataRoleAuthorizationStrategy.authorize(form, ENABLE, xmlRolesReader.getAllAllowedRoles(\"Approval\",\n+        MetaDataRoleAuthorizationStrategy.authorize(form, ENABLE, xmlRolesReader.getEntitlement(\"Approval\",\n                 SUBMIT));\n \n         editUserWin = new ModalWindow(\"editUserWin\");"},{"sha":"9e4c0fcad6bf58739c92210282b79f9deb834463","filename":"console/src/main/java/org/apache/syncope/console/pages/Configuration.java","status":"modified","additions":8,"deletions":8,"changes":16,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FConfiguration.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FConfiguration.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FConfiguration.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -178,13 +178,13 @@ protected void onError(final AjaxRequestTarget target, final Form<?> form) {\n             }\n         };\n \n-        MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, xmlRolesReader.getAllAllowedRoles(\"Configuration\",\n+        MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, xmlRolesReader.getEntitlement(\"Configuration\",\n                 \"workflowDefUpdate\"));\n         wfForm.add(submit);\n \n         workflowDefContainer.add(wfForm);\n \n-        MetaDataRoleAuthorizationStrategy.authorize(workflowDefContainer, ENABLE, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(workflowDefContainer, ENABLE, xmlRolesReader.getEntitlement(\n                 \"Configuration\", \"workflowDefRead\"));\n         add(workflowDefContainer);\n \n@@ -195,7 +195,7 @@ protected void onError(final AjaxRequestTarget target, final Form<?> form) {\n         coreLoggerContainer.add(coreLoggerList);\n         coreLoggerContainer.setOutputMarkupId(true);\n \n-        MetaDataRoleAuthorizationStrategy.authorize(coreLoggerContainer, ENABLE, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(coreLoggerContainer, ENABLE, xmlRolesReader.getEntitlement(\n                 \"Configuration\", \"logList\"));\n         add(coreLoggerContainer);\n \n@@ -206,7 +206,7 @@ protected void onError(final AjaxRequestTarget target, final Form<?> form) {\n         consoleLoggerContainer.add(consoleLoggerList);\n         consoleLoggerContainer.setOutputMarkupId(true);\n \n-        MetaDataRoleAuthorizationStrategy.authorize(consoleLoggerContainer, ENABLE, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(consoleLoggerContainer, ENABLE, xmlRolesReader.getEntitlement(\n                 \"Configuration\", \"logList\"));\n         add(consoleLoggerContainer);\n     }\n@@ -327,7 +327,7 @@ public Page createPage() {\n             }\n         };\n \n-        MetaDataRoleAuthorizationStrategy.authorize(createConfigurationLink, ENABLE, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(createConfigurationLink, ENABLE, xmlRolesReader.getEntitlement(\n                 \"Configuration\", \"create\"));\n         add(createConfigurationLink);\n \n@@ -351,7 +351,7 @@ public void onClick() {\n             }\n         };\n \n-        MetaDataRoleAuthorizationStrategy.authorize(dbExportLink, ENABLE, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(dbExportLink, ENABLE, xmlRolesReader.getEntitlement(\n                 \"Configuration\", \"read\"));\n         add(dbExportLink);\n \n@@ -502,7 +502,7 @@ public Page createPage() {\n             }\n         };\n \n-        MetaDataRoleAuthorizationStrategy.authorize(createNotificationLink, ENABLE, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(createNotificationLink, ENABLE, xmlRolesReader.getEntitlement(\n                 \"Notification\", \"create\"));\n         add(createNotificationLink);\n \n@@ -673,7 +673,7 @@ protected void onUpdate(final AjaxRequestTarget target) {\n                 }\n             });\n \n-            MetaDataRoleAuthorizationStrategy.authorize(level, ENABLE, xmlRolesReader.getAllAllowedRoles(\n+            MetaDataRoleAuthorizationStrategy.authorize(level, ENABLE, xmlRolesReader.getEntitlement(\n                     \"Configuration\", \"logSetLevel\"));\n \n             item.add(level);"},{"sha":"d61fa3807378e4265e4fd221dfabaedaa2f9e2cb","filename":"console/src/main/java/org/apache/syncope/console/pages/ConfigurationModalPage.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FConfigurationModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FConfigurationModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FConfigurationModalPage.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -121,8 +121,8 @@ protected void onError(final AjaxRequestTarget target, final Form<?> form) {\n         form.add(cancel);\n \n         String allowedRoles = createFlag\n-                ? xmlRolesReader.getAllAllowedRoles(\"Configuration\", \"create\")\n-                : xmlRolesReader.getAllAllowedRoles(\"Configuration\", \"update\");\n+                ? xmlRolesReader.getEntitlement(\"Configuration\", \"create\")\n+                : xmlRolesReader.getEntitlement(\"Configuration\", \"update\");\n \n         MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, allowedRoles);\n "},{"sha":"94027e19377a10b999da38d0c8192c5dbd4101e9","filename":"console/src/main/java/org/apache/syncope/console/pages/ConnectorModalPage.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FConnectorModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FConnectorModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FConnectorModalPage.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -437,8 +437,8 @@ protected void onError(final AjaxRequestTarget target, final Form<?> form) {\n             }\n         };\n         String roles = connInstanceTO.getId() == 0\n-                ? xmlRolesReader.getAllAllowedRoles(\"Connectors\", \"create\")\n-                : xmlRolesReader.getAllAllowedRoles(\"Connectors\", \"update\");\n+                ? xmlRolesReader.getEntitlement(\"Connectors\", \"create\")\n+                : xmlRolesReader.getEntitlement(\"Connectors\", \"update\");\n         MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, roles);\n         connectorForm.add(submit);\n "},{"sha":"edda895d4585db8077adc0cb9490d9ff87df1686","filename":"console/src/main/java/org/apache/syncope/console/pages/DerivedSchemaModalPage.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FDerivedSchemaModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FDerivedSchemaModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FDerivedSchemaModalPage.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -125,8 +125,8 @@ protected void onSubmit(final AjaxRequestTarget target, final Form<?> form) {\n                 false);\n \n         String allowedRoles = createFlag\n-                ? xmlRolesReader.getAllAllowedRoles(\"Schema\", \"create\")\n-                : xmlRolesReader.getAllAllowedRoles(\"Schema\", \"update\");\n+                ? xmlRolesReader.getEntitlement(\"Schema\", \"create\")\n+                : xmlRolesReader.getEntitlement(\"Schema\", \"update\");\n \n         MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, allowedRoles);\n "},{"sha":"9132dda893fe200d5f6ea5f2a689d4f34d0f7e12","filename":"console/src/main/java/org/apache/syncope/console/pages/EditUserModalPage.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FEditUserModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FEditUserModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FEditUserModalPage.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -63,7 +63,7 @@ public EditUserModalPage(final PageReference pageRef, final ModalWindow window,\n             statusPanel = new StatusPanel(\"statuspanel\", userTO, new ArrayList<StatusBean>(), getPageReference());\n             statusPanel.setOutputMarkupId(true);\n             MetaDataRoleAuthorizationStrategy.authorize(\n-                    statusPanel, RENDER, xmlRolesReader.getAllAllowedRoles(\"Resources\", \"getConnectorObject\"));\n+                    statusPanel, RENDER, xmlRolesReader.getEntitlement(\"Resources\", \"getConnectorObject\"));\n             form.addOrReplace(statusPanel);\n \n             form.addOrReplace(new AccountInformationPanel(\"accountinformation\", userTO));"},{"sha":"dc043b8c9916271a38e3fda443c202f0e5575f3c","filename":"console/src/main/java/org/apache/syncope/console/pages/NotificationModalPage.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FNotificationModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FNotificationModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FNotificationModalPage.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -270,8 +270,8 @@ protected void onSubmit(final AjaxRequestTarget target, final Form<?> form) {\n         cancel.setDefaultFormProcessing(false);\n \n         String allowedRoles = createFlag\n-                ? xmlRolesReader.getAllAllowedRoles(\"Notification\", \"create\")\n-                : xmlRolesReader.getAllAllowedRoles(\"Notification\", \"update\");\n+                ? xmlRolesReader.getEntitlement(\"Notification\", \"create\")\n+                : xmlRolesReader.getEntitlement(\"Notification\", \"update\");\n         MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, allowedRoles);\n \n         form.add(submit);"},{"sha":"d76400bb0636db151c026aa1b56fa8ca23598712","filename":"console/src/main/java/org/apache/syncope/console/pages/ReportModalPage.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FReportModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FReportModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FReportModalPage.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -161,10 +161,10 @@ protected void onError(final AjaxRequestTarget target, final Form<?> form) {\n                 };\n \n         if (reportTO.getId() > 0) {\n-            MetaDataRoleAuthorizationStrategy.authorize(submit, RENDER, xmlRolesReader.getAllAllowedRoles(\"Reports\",\n+            MetaDataRoleAuthorizationStrategy.authorize(submit, RENDER, xmlRolesReader.getEntitlement(\"Reports\",\n                     \"update\"));\n         } else {\n-            MetaDataRoleAuthorizationStrategy.authorize(submit, RENDER, xmlRolesReader.getAllAllowedRoles(\"Reports\",\n+            MetaDataRoleAuthorizationStrategy.authorize(submit, RENDER, xmlRolesReader.getEntitlement(\"Reports\",\n                     \"create\"));\n         }\n "},{"sha":"789e37e7a2e2ee194c4ae1b6808a37431d5381ac","filename":"console/src/main/java/org/apache/syncope/console/pages/Reports.java","status":"modified","additions":7,"deletions":7,"changes":14,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FReports.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FReports.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FReports.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -110,7 +110,7 @@ private void setupReport() {\n         reportContainer = new WebMarkupContainer(\"reportContainer\");\n         setWindowClosedCallback(window, reportContainer);\n \n-        MetaDataRoleAuthorizationStrategy.authorize(reportContainer, RENDER, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(reportContainer, RENDER, xmlRolesReader.getEntitlement(\n                 \"Reports\", \"list\"));\n \n         paginatorRows = prefMan.getPaginatorRows(getRequest(), Constants.PREF_REPORT_PAGINATOR_ROWS);\n@@ -223,7 +223,7 @@ public void onClick(final AjaxRequestTarget target) {\n \n         Form paginatorForm = new Form(\"paginatorForm\");\n \n-        MetaDataRoleAuthorizationStrategy.authorize(paginatorForm, RENDER, xmlRolesReader.getAllAllowedRoles(\"Reports\",\n+        MetaDataRoleAuthorizationStrategy.authorize(paginatorForm, RENDER, xmlRolesReader.getEntitlement(\"Reports\",\n                 \"list\"));\n \n         final DropDownChoice rowsChooser = new DropDownChoice(\"rowsChooser\", new PropertyModel(this, \"paginatorRows\"),\n@@ -266,7 +266,7 @@ public Page createPage() {\n             }\n         };\n \n-        MetaDataRoleAuthorizationStrategy.authorize(createLink, RENDER, xmlRolesReader.getAllAllowedRoles(\"Reports\",\n+        MetaDataRoleAuthorizationStrategy.authorize(createLink, RENDER, xmlRolesReader.getEntitlement(\"Reports\",\n                 \"create\"));\n \n         add(createLink);\n@@ -279,7 +279,7 @@ private void setupAudit() {\n         add(auditContainer);\n \n         MetaDataRoleAuthorizationStrategy.authorize(\n-                auditContainer, RENDER, xmlRolesReader.getAllAllowedRoles(\"Audit\", \"list\"));\n+                auditContainer, RENDER, xmlRolesReader.getEntitlement(\"Audit\", \"list\"));\n \n         final Form form = new Form(\"auditForm\");\n         auditContainer.add(form);\n@@ -306,15 +306,15 @@ private void setupAudit() {\n                     @Override\n                     protected String[] getListRoles() {\n                         return new String[] {\n-                            xmlRolesReader.getAllAllowedRoles(\"Audit\", \"list\")\n+                            xmlRolesReader.getEntitlement(\"Audit\", \"list\")\n                         };\n                     }\n \n                     @Override\n                     protected String[] getChangeRoles() {\n                         return new String[] {\n-                            xmlRolesReader.getAllAllowedRoles(\"Audit\", \"enable\"),\n-                            xmlRolesReader.getAllAllowedRoles(\"Audit\", \"disable\")\n+                            xmlRolesReader.getEntitlement(\"Audit\", \"enable\"),\n+                            xmlRolesReader.getEntitlement(\"Audit\", \"disable\")\n                         };\n                     }\n "},{"sha":"ea5864884358b157ca5789981f3a6bb9b45c52dc","filename":"console/src/main/java/org/apache/syncope/console/pages/ResourceModalPage.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FResourceModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FResourceModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FResourceModalPage.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -173,7 +173,7 @@ protected void onError(final AjaxRequestTarget target, final Form<?> form) {\n \n         add(form);\n \n-        MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, xmlRolesReader.getAllAllowedRoles(\"Resources\",\n+        MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, xmlRolesReader.getEntitlement(\"Resources\",\n                 createFlag\n                 ? \"create\"\n                 : \"update\"));"},{"sha":"89aa1ba5a5cbd08d1eb71222671c5a9136eb3219","filename":"console/src/main/java/org/apache/syncope/console/pages/Resources.java","status":"modified","additions":6,"deletions":7,"changes":13,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FResources.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FResources.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FResources.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -139,7 +139,7 @@ public CharSequence getPrecondition(final Component component) {\n                 attributes.getAjaxCallListeners().add(ajaxCallListener);\n             }\n         };\n-        MetaDataRoleAuthorizationStrategy.authorize(reloadLink, ENABLE, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(reloadLink, ENABLE, xmlRolesReader.getEntitlement(\n                 \"Connectors\", \"reload\"));\n         add(reloadLink);\n \n@@ -195,8 +195,7 @@ public Page createPage() {\n \n                         cellItem.add(editConnPanel);\n \n-                        MetaDataRoleAuthorizationStrategy.authorize(editConnPanel, ENABLE, xmlRolesReader.\n-                                getAllAllowedRoles(\n+                        MetaDataRoleAuthorizationStrategy.authorize(editConnPanel, ENABLE, xmlRolesReader.getEntitlement(\n                                         \"Connectors\", \"read\"));\n                     }\n                 });\n@@ -341,7 +340,7 @@ public Page createPage() {\n                     }\n                 };\n \n-        MetaDataRoleAuthorizationStrategy.authorize(createResourceLink, ENABLE, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(createResourceLink, ENABLE, xmlRolesReader.getEntitlement(\n                 \"Resources\", \"create\"));\n \n         add(createResourceLink);\n@@ -459,7 +458,7 @@ public void onClick(final AjaxRequestTarget target) {\n         connectorContainer.add(table);\n         connectorContainer.setOutputMarkupId(true);\n \n-        MetaDataRoleAuthorizationStrategy.authorize(connectorContainer, RENDER, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(connectorContainer, RENDER, xmlRolesReader.getEntitlement(\n                 \"Connectors\", \"list\"));\n \n         add(connectorContainer);\n@@ -499,14 +498,14 @@ public Page createPage() {\n             }\n         };\n \n-        MetaDataRoleAuthorizationStrategy.authorize(createConnectorLink, ENABLE, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(createConnectorLink, ENABLE, xmlRolesReader.getEntitlement(\n                 \"Connectors\", \"create\"));\n \n         add(createConnectorLink);\n \n         Form paginatorForm = new Form(\"connectorPaginatorForm\");\n \n-        MetaDataRoleAuthorizationStrategy.authorize(paginatorForm, RENDER, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(paginatorForm, RENDER, xmlRolesReader.getEntitlement(\n                 \"Connectors\", \"list\"));\n \n         final DropDownChoice rowsChooser = new DropDownChoice(\"rowsChooser\", new PropertyModel(this,"},{"sha":"2495421431b90d055a4e2fbaa62eec0c396d4405","filename":"console/src/main/java/org/apache/syncope/console/pages/RoleModalPage.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FRoleModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FRoleModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FRoleModalPage.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -136,7 +136,7 @@ protected void onSubmit(final AjaxRequestTarget target, final Form<?> form) {\n \n         cancel.setDefaultFormProcessing(false);\n \n-        MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, xmlRolesReader.getAllAllowedRoles(\"Roles\",\n+        MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, xmlRolesReader.getEntitlement(\"Roles\",\n                 createFlag\n                 ? \"create\"\n                 : \"update\"));"},{"sha":"d66d6e2befa26a59a13cb070efadfbb4cab6f57c","filename":"console/src/main/java/org/apache/syncope/console/pages/Schema.java","status":"modified","additions":3,"deletions":3,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FSchema.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FSchema.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FSchema.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -136,11 +136,11 @@ public class Schema extends BasePage {\n     @SpringBean\n     private PreferenceManager prefMan;\n \n-    private final String allowedCreateRoles = xmlRolesReader.getAllAllowedRoles(\"Schema\", \"create\");\n+    private final String allowedCreateRoles = xmlRolesReader.getEntitlement(\"Schema\", \"create\");\n \n-    private final String allowedReadRoles = xmlRolesReader.getAllAllowedRoles(\"Schema\", \"read\");\n+    private final String allowedReadRoles = xmlRolesReader.getEntitlement(\"Schema\", \"read\");\n \n-    private final String allowedDeleteRoles = xmlRolesReader.getAllAllowedRoles(\"Schema\", \"delete\");\n+    private final String allowedDeleteRoles = xmlRolesReader.getEntitlement(\"Schema\", \"delete\");\n \n     public Schema() {\n         super();"},{"sha":"aedba1db1e4f806b1cfe84d383d94d1e06f3018b","filename":"console/src/main/java/org/apache/syncope/console/pages/SchemaModalPage.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FSchemaModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FSchemaModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FSchemaModalPage.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -276,8 +276,8 @@ protected void onSubmit(final AjaxRequestTarget target, final Form<?> form) {\n         cancel.setDefaultFormProcessing(false);\n \n         String allowedRoles = createFlag\n-                ? xmlRolesReader.getAllAllowedRoles(\"Schema\", \"create\")\n-                : xmlRolesReader.getAllAllowedRoles(\"Schema\", \"update\");\n+                ? xmlRolesReader.getEntitlement(\"Schema\", \"create\")\n+                : xmlRolesReader.getEntitlement(\"Schema\", \"update\");\n \n         MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, allowedRoles);\n "},{"sha":"c2fcf5c3b4f15c4ac779496be69e44851e97fb24","filename":"console/src/main/java/org/apache/syncope/console/pages/StatusModalPage.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FStatusModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FStatusModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FStatusModalPage.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -50,7 +50,7 @@ public StatusModalPage(final PageReference pageRef, final ModalWindow window,\n \n         final StatusPanel statusPanel = new StatusPanel(\"statuspanel\", attributable, statuses, null);\n         MetaDataRoleAuthorizationStrategy.authorize(\n-                statusPanel, RENDER, xmlRolesReader.getAllAllowedRoles(\"Resources\", \"getConnectorObject\"));\n+                statusPanel, RENDER, xmlRolesReader.getEntitlement(\"Resources\", \"getConnectorObject\"));\n         form.add(statusPanel);\n \n         final AjaxButton disable;"},{"sha":"06dd6f087c3f480927dba2adec6d73092ea80e87","filename":"console/src/main/java/org/apache/syncope/console/pages/Todo.java","status":"modified","additions":4,"deletions":4,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FTodo.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FTodo.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FTodo.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -105,7 +105,7 @@ public Todo(final PageParameters parameters) {\n     private void setupApproval() {\n         approvalContainer = new WebMarkupContainer(\"approvalContainer\");\n \n-        MetaDataRoleAuthorizationStrategy.authorize(approvalContainer, RENDER, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(approvalContainer, RENDER, xmlRolesReader.getEntitlement(\n                 \"Approval\", \"list\"));\n \n         approvalPaginatorRows = prefMan.getPaginatorRows(getRequest(), Constants.PREF_APPROVAL_PAGINATOR_ROWS);\n@@ -186,7 +186,7 @@ public Page createPage() {\n \n         Form approvalPaginatorForm = new Form(\"approvalPaginatorForm\");\n \n-        MetaDataRoleAuthorizationStrategy.authorize(approvalPaginatorForm, RENDER, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(approvalPaginatorForm, RENDER, xmlRolesReader.getEntitlement(\n                 \"Approval\", \"list\"));\n \n         final DropDownChoice rowsChooser = new DropDownChoice(\"rowsChooser\", new PropertyModel(this,\n@@ -220,7 +220,7 @@ protected void onUpdate(final AjaxRequestTarget target) {\n     private void setupUserRequest() {\n         userRequestContainer = new WebMarkupContainer(\"userRequestContainer\");\n \n-        MetaDataRoleAuthorizationStrategy.authorize(userRequestContainer, RENDER, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(userRequestContainer, RENDER, xmlRolesReader.getEntitlement(\n                 \"UserRequest\", \"list\"));\n \n         userRequestPaginatorRows = prefMan.getPaginatorRows(getRequest(), Constants.PREF_USER_REQUEST_PAGINATOR_ROWS);\n@@ -326,7 +326,7 @@ public void onClick(final AjaxRequestTarget target) {\n \n         Form userRequestPaginatorForm = new Form(\"userRequestPaginatorForm\");\n \n-        MetaDataRoleAuthorizationStrategy.authorize(userRequestPaginatorForm, RENDER, xmlRolesReader.getAllAllowedRoles(\n+        MetaDataRoleAuthorizationStrategy.authorize(userRequestPaginatorForm, RENDER, xmlRolesReader.getEntitlement(\n                 \"UserRequest\", \"list\"));\n \n         final DropDownChoice rowsChooser = new DropDownChoice(\"rowsChooser\", new PropertyModel(this,"},{"sha":"408726637d993657473378220f2837cdb7a12e44","filename":"console/src/main/java/org/apache/syncope/console/pages/UserModalPage.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -149,8 +149,8 @@ protected Form setupEditPanel() {\n \n         if (mode == Mode.ADMIN) {\n             String allowedRoles = userTO.getId() == 0\n-                    ? xmlRolesReader.getAllAllowedRoles(\"Users\", \"create\")\n-                    : xmlRolesReader.getAllAllowedRoles(\"Users\", \"update\");\n+                    ? xmlRolesReader.getEntitlement(\"Users\", \"create\")\n+                    : xmlRolesReader.getEntitlement(\"Users\", \"update\");\n             MetaDataRoleAuthorizationStrategy.authorize(submit, RENDER, allowedRoles);\n         }\n "},{"sha":"4a208de96ebe46d9b125d708f11522145adf2f42","filename":"console/src/main/java/org/apache/syncope/console/pages/Users.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FUsers.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FUsers.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FUsers.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -92,7 +92,7 @@ public Page createPage() {\n             }\n         };\n         MetaDataRoleAuthorizationStrategy.authorize(\n-                createLink, ENABLE, xmlRolesReader.getAllAllowedRoles(\"Users\", \"create\"));\n+                createLink, ENABLE, xmlRolesReader.getEntitlement(\"Users\", \"create\"));\n         add(createLink);\n \n         setWindowClosedReloadCallback(editModalWin);"},{"sha":"a4ab941512fa979ea18a433a736654360ec7454a","filename":"console/src/main/java/org/apache/syncope/console/pages/VirtualSchemaModalPage.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FVirtualSchemaModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FVirtualSchemaModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FVirtualSchemaModalPage.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -111,8 +111,8 @@ protected void onSubmit(final AjaxRequestTarget target, final Form<?> form) {\n         cancel.setDefaultFormProcessing(false);\n \n         String allowedRoles = createFlag\n-                ? xmlRolesReader.getAllAllowedRoles(\"Schema\", \"create\")\n-                : xmlRolesReader.getAllAllowedRoles(\"Schema\", \"update\");\n+                ? xmlRolesReader.getEntitlement(\"Schema\", \"create\")\n+                : xmlRolesReader.getEntitlement(\"Schema\", \"update\");\n \n         MetaDataRoleAuthorizationStrategy.authorize(submit, ENABLE, allowedRoles);\n "},{"sha":"b6f719691ffe76e3664a229cea77b426e7f233fb","filename":"console/src/main/java/org/apache/syncope/console/pages/panels/PoliciesPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FPoliciesPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FPoliciesPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FPoliciesPanel.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -223,7 +223,7 @@ public Page createPage() {\n \n         add(createButton);\n \n-        MetaDataRoleAuthorizationStrategy.authorize(createButton, ENABLE, xmlRolesReader.getAllAllowedRoles(\"Policies\",\n+        MetaDataRoleAuthorizationStrategy.authorize(createButton, ENABLE, xmlRolesReader.getEntitlement(\"Policies\",\n                 \"create\"));\n \n         final Form paginatorForm = new Form(\"PaginatorForm\");"},{"sha":"0b2d6232ac98ad5f095aeab76d0823b88a3fc9cf","filename":"console/src/main/java/org/apache/syncope/console/pages/panels/RolePanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRolePanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRolePanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRolePanel.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -107,7 +107,7 @@ private RolePanel(final Builder builder) {\n                     \"statuspanel\", builder.roleTO, new ArrayList<StatusBean>(), builder.pageReference);\n             statusPanel.setOutputMarkupId(true);\n             MetaDataRoleAuthorizationStrategy.authorize(\n-                    statusPanel, RENDER, xmlRolesReader.getAllAllowedRoles(\"Resources\", \"getConnectorObject\"));\n+                    statusPanel, RENDER, xmlRolesReader.getEntitlement(\"Resources\", \"getConnectorObject\"));\n             this.add(statusPanel);\n         }\n "},{"sha":"f46858621342da30ce600f0c7e25946856de1f01","filename":"console/src/main/java/org/apache/syncope/console/pages/panels/RoleSummaryPanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleSummaryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleSummaryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleSummaryPanel.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -138,7 +138,7 @@ public Page createPage() {\n \n                         builder.window.show(target);\n                     }\n-                }, ActionLink.ActionType.CREATE, xmlRolesReader.getAllAllowedRoles(\"Roles\", \"create\"));\n+                }, ActionLink.ActionType.CREATE, xmlRolesReader.getEntitlement(\"Roles\", \"create\"));\n             } else {\n                 RoleTabPanel roleTabPanel =\n                         new RoleTabPanel(\"nodeViewPanel\", selectedNode, builder.window, builder.callerPageRef);"},{"sha":"9debde4c010fabcbbb504fd6b49d103989b8eb68","filename":"console/src/main/java/org/apache/syncope/console/pages/panels/RoleTabPanel.java","status":"modified","additions":4,"deletions":4,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleTabPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleTabPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleTabPanel.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -91,7 +91,7 @@ public Page createPage() {\n \n                 window.show(target);\n             }\n-        }, ActionLink.ActionType.CREATE, xmlRolesReader.getAllAllowedRoles(\"Roles\", \"create\"));\n+        }, ActionLink.ActionType.CREATE, xmlRolesReader.getEntitlement(\"Roles\", \"create\"));\n         links.addWithRoles(new ActionLink() {\n \n             private static final long serialVersionUID = -3722207913631435501L;\n@@ -110,7 +110,7 @@ public Page createPage() {\n \n                 window.show(target);\n             }\n-        }, ActionLink.ActionType.SEARCH, xmlRolesReader.getAllAllowedRoles(\"Roles\", \"update\"));\n+        }, ActionLink.ActionType.SEARCH, xmlRolesReader.getEntitlement(\"Roles\", \"update\"));\n         links.addWithRoles(new ActionLink() {\n \n             private static final long serialVersionUID = -3722207913631435501L;\n@@ -131,7 +131,7 @@ public Page createPage() {\n \n                 window.show(target);\n             }\n-        }, ActionLink.ActionType.EDIT, xmlRolesReader.getAllAllowedRoles(\"Roles\", \"update\"));\n+        }, ActionLink.ActionType.EDIT, xmlRolesReader.getEntitlement(\"Roles\", \"update\"));\n         links.addWithRoles(new ActionLink() {\n \n             private static final long serialVersionUID = -3722207913631435501L;\n@@ -159,7 +159,7 @@ public Page createPage() {\n                     target.add(((Roles) pageRef.getPage()).getFeedbackPanel());\n                 }\n             }\n-        }, ActionLink.ActionType.DELETE, xmlRolesReader.getAllAllowedRoles(\"Roles\", \"delete\"));\n+        }, ActionLink.ActionType.DELETE, xmlRolesReader.getEntitlement(\"Roles\", \"delete\"));\n \n         final Form form = new Form(\"roleForm\");\n         form.setModel(new CompoundPropertyModel(selectedNode));"},{"sha":"07aa090ce1a7f3775aec16de8c020eeeffee5e3e","filename":"console/src/main/java/org/apache/syncope/console/pages/panels/SchedTasks.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FSchedTasks.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FSchedTasks.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FSchedTasks.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -142,7 +142,7 @@ public Page createPage() {\n         };\n \n         MetaDataRoleAuthorizationStrategy.authorize(\n-                createLink, RENDER, xmlRolesReader.getAllAllowedRoles(TASKS, \"create\"));\n+                createLink, RENDER, xmlRolesReader.getEntitlement(TASKS, \"create\"));\n \n         add(createLink);\n     }"},{"sha":"46b8fc9401ef8632dba6808994feb8ab003751a7","filename":"console/src/main/java/org/apache/syncope/console/pages/panels/SyncTasks.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FSyncTasks.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FSyncTasks.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FSyncTasks.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -145,7 +145,7 @@ public Page createPage() {\n         };\n \n         MetaDataRoleAuthorizationStrategy.authorize(\n-                createLink, RENDER, xmlRolesReader.getAllAllowedRoles(TASKS, \"create\"));\n+                createLink, RENDER, xmlRolesReader.getEntitlement(TASKS, \"create\"));\n \n         add(createLink);\n     }"},{"sha":"e854de1704c3922ccdc497f12f185a836b243aa4","filename":"console/src/main/java/org/apache/syncope/console/wicket/markup/html/form/ActionLinksPanel.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FActionLinksPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FActionLinksPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FActionLinksPanel.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -70,7 +70,7 @@ public ActionLinksPanel(final String componentId, final IModel<?> model, final P\n     public void add(\n             final ActionLink link, final ActionLink.ActionType type, final String pageId, final String actionId) {\n \n-        addWithRoles(link, type, xmlRolesReader.getAllAllowedRoles(pageId, actionId), true);\n+        addWithRoles(link, type, xmlRolesReader.getEntitlement(pageId, actionId), true);\n     }\n \n     public void add(\n@@ -82,7 +82,7 @@ public void add(\n     public void add(\n             final ActionLink link, final ActionLink.ActionType type, final String pageId, final boolean enabled) {\n \n-        addWithRoles(link, type, xmlRolesReader.getAllAllowedRoles(pageId, type.getActionId()), enabled);\n+        addWithRoles(link, type, xmlRolesReader.getEntitlement(pageId, type.getActionId()), enabled);\n     }\n \n     public void addWithRoles("},{"sha":"d860880fb0fb71255fe361c8f5cdf8c93bbc4aba","filename":"console/src/main/java/org/apache/syncope/console/wicket/markup/html/tree/TreeRolePanel.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FTreeRolePanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FTreeRolePanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FTreeRolePanel.java?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -104,7 +104,7 @@ protected void onClick(final AjaxRequestTarget target) {\n \n         DefaultMutableTreeNodeExpansion.get().expandAll();\n \n-        MetaDataRoleAuthorizationStrategy.authorize(tree, ENABLE, xmlRolesReader.getAllAllowedRoles(\"Roles\", \"read\"));\n+        MetaDataRoleAuthorizationStrategy.authorize(tree, ENABLE, xmlRolesReader.getEntitlement(\"Roles\", \"read\"));\n \n         treeContainer.addOrReplace(tree);\n     }"},{"sha":"b58640b2caebdda33b61e7e8df56394d2a9d086e","filename":"console/src/main/resources/applicationContext.xml","status":"modified","additions":3,"deletions":5,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fresources%2FapplicationContext.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/05d2985a47cb2104a6b43d553b4707209c261f94/console%2Fsrc%2Fmain%2Fresources%2FapplicationContext.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2FapplicationContext.xml?ref=05d2985a47cb2104a6b43d553b4707209c261f94","patch":"@@ -63,10 +63,6 @@ under the License.\n     <constructor-arg value=\"${licenseUrl}\"/>\n   </bean>\n \n-  <bean id=\"authorizations\" class=\"java.lang.String\">\n-    <constructor-arg value=\"authorizations.xml\"/>\n-  </bean>\n-\n   <bean id=\"syncopeApplication\" class=\"org.apache.syncope.console.SyncopeApplication\"/>\n \n   <bean id=\"jacksonObjectMapper\" class=\"org.codehaus.jackson.map.ObjectMapper\"/>\n@@ -133,7 +129,9 @@ under the License.\n \n   <bean id=\"preferenceManager\" class=\"org.apache.syncope.console.commons.PreferenceManager\"/>\n \n-  <bean id=\"xmlRolesReader\" class=\"org.apache.syncope.console.commons.XMLRolesReader\"/>\n+  <bean id=\"xmlRolesReader\" class=\"org.apache.syncope.console.commons.XMLRolesReader\" scope=\"singleton\">\n+    <property name=\"authorizations\" value=\"authorizations.xml\"/>\n+  </bean>\n \n   <bean id=\"roleTreeBuilder\" class=\"org.apache.syncope.console.commons.RoleTreeBuilder\"/>\n "}]}