{"sha":"3838763f6eb2a6464786f6b83044c43260558be6","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjM4Mzg3NjNmNmViMmE2NDY0Nzg2ZjZiODMwNDRjNDMyNjA1NThiZTY=","commit":{"author":{"name":"giacomolm","email":"giacomolm@hotmail.it","date":"2015-01-09T13:19:25Z"},"committer":{"name":"giacomolm","email":"giacomolm@hotmail.it","date":"2015-01-09T13:19:25Z"},"message":"[SYNCOPE-627] Updating console counterpart","tree":{"sha":"e0895aebe5273c900f8c3b109f38f66445738792","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/e0895aebe5273c900f8c3b109f38f66445738792"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/3838763f6eb2a6464786f6b83044c43260558be6","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/3838763f6eb2a6464786f6b83044c43260558be6","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/3838763f6eb2a6464786f6b83044c43260558be6","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/3838763f6eb2a6464786f6b83044c43260558be6/comments","author":{"login":"giacomolm","id":4027829,"node_id":"MDQ6VXNlcjQwMjc4Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/4027829?v=4","gravatar_id":"","url":"https://api.github.com/users/giacomolm","html_url":"https://github.com/giacomolm","followers_url":"https://api.github.com/users/giacomolm/followers","following_url":"https://api.github.com/users/giacomolm/following{/other_user}","gists_url":"https://api.github.com/users/giacomolm/gists{/gist_id}","starred_url":"https://api.github.com/users/giacomolm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/giacomolm/subscriptions","organizations_url":"https://api.github.com/users/giacomolm/orgs","repos_url":"https://api.github.com/users/giacomolm/repos","events_url":"https://api.github.com/users/giacomolm/events{/privacy}","received_events_url":"https://api.github.com/users/giacomolm/received_events","type":"User","site_admin":false},"committer":{"login":"giacomolm","id":4027829,"node_id":"MDQ6VXNlcjQwMjc4Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/4027829?v=4","gravatar_id":"","url":"https://api.github.com/users/giacomolm","html_url":"https://github.com/giacomolm","followers_url":"https://api.github.com/users/giacomolm/followers","following_url":"https://api.github.com/users/giacomolm/following{/other_user}","gists_url":"https://api.github.com/users/giacomolm/gists{/gist_id}","starred_url":"https://api.github.com/users/giacomolm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/giacomolm/subscriptions","organizations_url":"https://api.github.com/users/giacomolm/orgs","repos_url":"https://api.github.com/users/giacomolm/repos","events_url":"https://api.github.com/users/giacomolm/events{/privacy}","received_events_url":"https://api.github.com/users/giacomolm/received_events","type":"User","site_admin":false},"parents":[{"sha":"0edb2a245fbd06f06f841e4fc0b0df34d132d892","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/0edb2a245fbd06f06f841e4fc0b0df34d132d892","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/0edb2a245fbd06f06f841e4fc0b0df34d132d892"}],"stats":{"total":567,"additions":68,"deletions":499},"files":[{"sha":"9b6f25f54ef475fc0793eb144c8e5bafc677a530","filename":"common/src/main/java/org/apache/syncope/common/to/RouteTO.java","status":"modified","additions":11,"deletions":0,"changes":11,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3838763f6eb2a6464786f6b83044c43260558be6/common%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Fto%2FRouteTO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3838763f6eb2a6464786f6b83044c43260558be6/common%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Fto%2FRouteTO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/common%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Fto%2FRouteTO.java?ref=3838763f6eb2a6464786f6b83044c43260558be6","patch":"@@ -21,6 +21,7 @@\n import javax.xml.bind.annotation.XmlRootElement;\n import javax.xml.bind.annotation.XmlType;\n import org.apache.syncope.common.AbstractBaseBean;\n+import org.apache.syncope.common.types.SubjectType;\n \n @XmlRootElement(name = \"route\")\n @XmlType\n@@ -32,6 +33,8 @@ public class RouteTO extends AbstractBaseBean {\n \n     private String routeContent;\n \n+    private SubjectType subject;\n+\n     public void setId(Long id) {\n         this.id = id;\n     }\n@@ -47,6 +50,14 @@ public void setName(final String name) {\n     public String getName() {\n         return name;\n     }\n+    \n+    public SubjectType getSubject() {\n+        return subject;\n+    }\n+\n+    public void setSubject(SubjectType subject) {\n+        this.subject = subject;\n+    }\n \n     public String getRouteContent() {\n         return routeContent;"},{"sha":"54c5132d71bc571c7130f2cd2f2d36cb73486e4f","filename":"console/src/main/java/org/apache/syncope/console/pages/Configuration.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3838763f6eb2a6464786f6b83044c43260558be6/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FConfiguration.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3838763f6eb2a6464786f6b83044c43260558be6/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FConfiguration.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FConfiguration.java?ref=3838763f6eb2a6464786f6b83044c43260558be6","patch":"@@ -809,8 +809,8 @@ public void onClick(final AjaxRequestTarget target) {\n \n                             @Override\n                             public Page createPage() {\n-                                return new RouteModalPage(Configuration.this.getPageReference(), editRouteWin, routeRestClient.readRoute(model.getObject().getId()), false);\n-                                //throw new UnsupportedOperationException(\"Not supported yet.\"); //To change body of generated methods, choose Tools | Templates.\n+                                return new RouteModalPage(Configuration.this.getPageReference(), editRouteWin, \n+                                        routeRestClient.readRoute(model.getObject().getId(),model.getObject().getSubject()), false);                                \n                             }\n \n                         });"},{"sha":"79650237eebc73251090c90360b38d2a4f7e0210","filename":"console/src/main/java/org/apache/syncope/console/pages/RouteModalPage.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3838763f6eb2a6464786f6b83044c43260558be6/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FRouteModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3838763f6eb2a6464786f6b83044c43260558be6/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FRouteModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FRouteModalPage.java?ref=3838763f6eb2a6464786f6b83044c43260558be6","patch":"@@ -62,7 +62,7 @@ public RouteModalPage(final PageReference pageRef, final ModalWindow window,\n                     @Override\n                     protected void onSubmit(final AjaxRequestTarget target, final Form<?> form) {\n                         try {\n-                            restClient.updateRoute(routeTO.getId(), ((RouteTO)form.getModelObject()).getRouteContent());\n+                            restClient.updateRoute(routeTO.getId(), ((RouteTO)form.getModelObject()).getRouteContent(), routeTO.getSubject());\n                             info(getString(Constants.OPERATION_SUCCEEDED));\n                             \n                             Configuration callerPage = (Configuration) pageRef.getPage();"},{"sha":"90adc3ec5bbdb0f4314e3717cc7077a8886a85a7","filename":"console/src/main/java/org/apache/syncope/console/rest/RouteRestClient.java","status":"modified","additions":5,"deletions":5,"changes":10,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3838763f6eb2a6464786f6b83044c43260558be6/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Frest%2FRouteRestClient.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3838763f6eb2a6464786f6b83044c43260558be6/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Frest%2FRouteRestClient.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Frest%2FRouteRestClient.java?ref=3838763f6eb2a6464786f6b83044c43260558be6","patch":"@@ -37,14 +37,14 @@ public List<RouteTO> readRoutes(final SubjectType subject){\n         return getService(RouteService.class).getRoutes(subject);\n     }\n     \n-    public RouteTO readRoute(Long id){\n-        return getService(RouteService.class).getRoute(id);\n+    public RouteTO readRoute(final Long id, final SubjectType subject){\n+        return getService(RouteService.class).getRoute(subject,id);\n     }\n     \n-    public void updateRoute(Long id, String definition){\n-        RouteTO routeTO = readRoute(id);        \n+    public void updateRoute(Long id, String definition, final SubjectType subject){\n+        RouteTO routeTO = readRoute(id,subject);        \n         routeTO.setRouteContent(definition);     \n-        getService(RouteService.class).importRoute(routeTO.getId(), routeTO);\n+        getService(RouteService.class).importRoute(subject, routeTO.getId(), routeTO);\n     }\n     \n     public boolean isCamelEnabledForUsers() {"},{"sha":"afd72c8b9583253c23d11b7bb3b1926f9e2230c4","filename":"core/src/main/java/org/apache/syncope/core/init/CamelRouteLoader.java","status":"modified","additions":40,"deletions":10,"changes":50,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3838763f6eb2a6464786f6b83044c43260558be6/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Finit%2FCamelRouteLoader.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3838763f6eb2a6464786f6b83044c43260558be6/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Finit%2FCamelRouteLoader.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Finit%2FCamelRouteLoader.java?ref=3838763f6eb2a6464786f6b83044c43260558be6","patch":"@@ -21,6 +21,10 @@\n import java.io.File;\n import java.io.StringWriter;\n import java.net.URL;\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.Map;\n+import javax.sql.DataSource;\n import javax.xml.parsers.DocumentBuilder;\n import javax.xml.parsers.DocumentBuilderFactory;\n import javax.xml.transform.OutputKeys;\n@@ -36,6 +40,7 @@\n import org.slf4j.LoggerFactory;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.dao.DataAccessException;\n+import org.springframework.jdbc.core.JdbcTemplate;\n import org.springframework.stereotype.Component;\n import org.springframework.transaction.annotation.Transactional;\n import org.w3c.dom.Document;\n@@ -51,27 +56,35 @@ public class CamelRouteLoader {\n     @Autowired\n     private RouteDAO routeDAO;\n     \n+    @Autowired\n+    private DataSource dataSource;\n+    \n     private int size = 0;\n-\n+    \n+    private boolean routeLoaded = false;\n+    \n     @Transactional\n     public void load() {\n-        loadRoutes(\"/userRoute.xml\", SubjectType.USER);\n-        loadRoutes(\"/roleRoute.xml\", SubjectType.ROLE);\n+        if(!routeLoaded){\n+            loadRoutes(\"/userRoute.xml\", SubjectType.USER);\n+            loadRoutes(\"/roleRoute.xml\", SubjectType.ROLE);        \n+            routeLoaded = true;\n+        }\n     }\n     \n     public void loadRoutes(String path, SubjectType subject) {\n \n-        if(routeDAO.findAll(subject).isEmpty()){\n+        if(getRoutes(subject).isEmpty()){\n             URL url = getClass().getResource(path);\n \n             File file = new File(url.getPath());\n-            \n+            String query = \"INSERT INTO CamelRoute(ID, NAME, SUBJECT, ROUTECONTENT) VALUES (?, ?, ?, ?)\";\n             try {\n \n                 DocumentBuilder dBuilder = DocumentBuilderFactory.newInstance().newDocumentBuilder();\n                 Document doc = dBuilder.parse(file);\n                 doc.getDocumentElement().normalize();\n-\n+                JdbcTemplate jdbcTemplate = new JdbcTemplate(dataSource);\n                 NodeList listOfRoutes = doc.getElementsByTagName(\"route\");\n                 for (int s = 0; s < listOfRoutes.getLength(); s++) {\n                     //getting the route node element\n@@ -80,8 +93,9 @@ public void loadRoutes(String path, SubjectType subject) {\n                     CamelRoute route = new CamelRoute();\n                     route.setSubject(subject);\n                     route.setName(((Element) routeEl).getAttribute(\"id\"));\n-                    route.setRouteContent(nodeToString(listOfRoutes.item(s)));                    \n-                    routeDAO.save(route);\n+                    route.setRouteContent(nodeToString(listOfRoutes.item(s)));\n+                    jdbcTemplate.update(query, new Object[] { size++, ((Element) routeEl).getAttribute(\"id\"), \n+                                                             subject.name(), nodeToString(listOfRoutes.item(s)) });\n                     LOG.info(\"Route with id {} Registration Successed\", ((Element) routeEl).getAttribute(\"id\"));\n                 }\n             } catch (DataAccessException e) {\n@@ -91,16 +105,32 @@ public void loadRoutes(String path, SubjectType subject) {\n             }\n         }\n     }\n-\n+    \n     private String nodeToString(Node node) {\n         StringWriter sw = new StringWriter();\n         try {\n             Transformer t = TransformerFactory.newInstance().newTransformer();\n             t.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, \"yes\");\n             t.transform(new DOMSource(node), new StreamResult(sw));\n         } catch (TransformerException te) {\n-            System.out.println(\"nodeToString Transformer Exception\");\n+            LOG.debug(\"nodeToString Transformer Exception\");\n         }\n         return sw.toString();\n     }\n+    \n+    @Transactional(readOnly = true)\n+    public List<CamelRoute> getRoutes(final SubjectType subject) {                        \n+        String sql = \"SELECT * FROM CAMELROUTE WHERE SUBJECT = ?\";\n+        JdbcTemplate jdbcTemplate = new JdbcTemplate(dataSource);\n+        List<CamelRoute> routes = new ArrayList<CamelRoute>();\n+        List<Map<String,Object>> rows = jdbcTemplate.queryForList(sql, new Object[] {subject.name()});\n+        for (Map row : rows) {\n+            CamelRoute route = new CamelRoute();                    \n+            route.setName((String)row.get(\"NAME\"));\n+            route.setSubject(SubjectType.valueOf((String)row.get(\"SUBJECT\")));\n+            route.setRouteContent((String) row.get(\"ROUTECONTENT\"));\n+            routes.add(route);\n+        }\n+        return routes;\n+    }\n }"},{"sha":"ca7521be7a3cef115d432fea70af6c0323d16526","filename":"core/src/main/java/org/apache/syncope/core/provisioning/camel/CamelRoleProvisioningManager.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3838763f6eb2a6464786f6b83044c43260558be6/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fcamel%2FCamelRoleProvisioningManager.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3838763f6eb2a6464786f6b83044c43260558be6/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fcamel%2FCamelRoleProvisioningManager.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fcamel%2FCamelRoleProvisioningManager.java?ref=3838763f6eb2a6464786f6b83044c43260558be6","patch":"@@ -69,7 +69,7 @@ public CamelRoleProvisioningManager() throws Exception {\n     }\n \n     public void startContext() throws Exception {\n-        camelContext.start();\n+        getContext().start();\n     }\n \n     public void stopContext() throws Exception {"},{"sha":"3acea2c92e2da6d7888c3c5f12eb148d97559647","filename":"core/src/main/java/org/apache/syncope/core/provisioning/camel/SyncopeCamelContext.java","status":"modified","additions":5,"deletions":5,"changes":10,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3838763f6eb2a6464786f6b83044c43260558be6/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fcamel%2FSyncopeCamelContext.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3838763f6eb2a6464786f6b83044c43260558be6/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fcamel%2FSyncopeCamelContext.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fcamel%2FSyncopeCamelContext.java?ref=3838763f6eb2a6464786f6b83044c43260558be6","patch":"@@ -33,12 +33,15 @@\n import org.apache.camel.model.RouteDefinition;\n import org.apache.camel.spring.SpringCamelContext;\n import org.apache.syncope.common.types.SubjectType;\n+import org.apache.syncope.core.init.CamelRouteLoader;\n import org.apache.syncope.core.persistence.beans.CamelRoute;\n import org.apache.syncope.core.persistence.dao.RouteDAO;\n import org.apache.syncope.core.util.ApplicationContextProvider;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n+import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.stereotype.Component;\n+import org.springframework.transaction.annotation.Transactional;\n import org.w3c.dom.Document;\n import org.w3c.dom.Node;\n \n@@ -59,12 +62,9 @@ public SpringCamelContext getContext(RouteDAO routeDAO) {\n         }\n         if (camelContext.getRouteDefinitions().isEmpty()) {\n \n-            List<CamelRoute> crl = new ArrayList<CamelRoute>();\n-            crl.addAll(routeDAO.findAll(SubjectType.USER));\n-            crl.addAll(routeDAO.findAll(SubjectType.ROLE));\n-            LOG.info(\"{} route(s) are going to be loaded \", crl.size());\n+            List<CamelRoute> crl = routeDAO.findAll();\n+            LOG.debug(\"{} route(s) are going to be loaded \", crl.size());\n             loadContext(routeDAO, crl);\n-\n             try {\n                 camelContext.start();\n             } catch (Exception ex) {"},{"sha":"8c2de1b6d96934f9a5cbde1d7f81e5026c24b90c","filename":"core/src/main/java/org/apache/syncope/core/services/RouteServiceImpl.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3838763f6eb2a6464786f6b83044c43260558be6/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fservices%2FRouteServiceImpl.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3838763f6eb2a6464786f6b83044c43260558be6/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fservices%2FRouteServiceImpl.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fservices%2FRouteServiceImpl.java?ref=3838763f6eb2a6464786f6b83044c43260558be6","patch":"@@ -69,8 +69,8 @@ public RouteTO getRoute(Long id) {\n     }\n     \n     @Override\n-    public RouteTO getRoute(SubjectType subject, Long Id) {\n-        return controller.readRoute(Id, subject);\n+    public RouteTO getRoute(SubjectType subject, Long id) {\n+        return controller.readRoute(id);\n     }\n \n     @Override"},{"sha":"7cebf73771b9035a4bcb18ebd265816f87206544","filename":"core/src/main/resources/camelRoute.xml","status":"removed","additions":0,"deletions":468,"changes":468,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/0edb2a245fbd06f06f841e4fc0b0df34d132d892/core%2Fsrc%2Fmain%2Fresources%2FcamelRoute.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/0edb2a245fbd06f06f841e4fc0b0df34d132d892/core%2Fsrc%2Fmain%2Fresources%2FcamelRoute.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fresources%2FcamelRoute.xml?ref=0edb2a245fbd06f06f841e4fc0b0df34d132d892","patch":"@@ -1,468 +0,0 @@\n-<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n-<!--\n-Licensed to the Apache Software Foundation (ASF) under one\n-or more contributor license agreements.  See the NOTICE file\n-distributed with this work for additional information\n-regarding copyright ownership.  The ASF licenses this file\n-to you under the Apache License, Version 2.0 (the\n-\"License\"); you may not use this file except in compliance\n-with the License.  You may obtain a copy of the License at\n-\n-  http://www.apache.org/licenses/LICENSE-2.0\n-\n-Unless required by applicable law or agreed to in writing,\n-software distributed under the License is distributed on an\n-\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n-KIND, either express or implied.  See the License for the\n-specific language governing permissions and limitations\n-under the License.\n--->\n-<beans xmlns=\"http://www.springframework.org/schema/beans\"\n-       xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n-       xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n-                           http://www.springframework.org/schema/beans/spring-beans.xsd\n-                           http://camel.apache.org/schema/spring\n-                           http://camel.apache.org/schema/spring/camel-spring.xsd\">\n- \n-  <!--\n-      The default routes define each task involved in user creation:\n-      main operations consist in user workflow creation and its propagation.         \n-  -->\n-  <routeContext id=\"defaultRoutes\" xmlns=\"http://camel.apache.org/schema/spring\">    \n-        \n-    <!--\n-        CREATE USER\n-        This is the entry point of the route and is involved in accepting\n-        the UserTO. When it arrives, the user workflow is created. If the\n-        creation is successfull, the result is sent to propagation, otherwise\n-        if an exception was raised, the exception has to be returned to the\n-        caller. The property actual allows to store the received UserTO in\n-        order to use it later.\n-    -->\n-        \n-    <route id=\"createUser\">\n-      <from uri=\"direct:createUser\"/>\n-      <setProperty propertyName=\"actual\">\n-        <simple>${body}</simple>\n-      </setProperty>\n-      <doTry>\n-        <bean ref=\"uwfAdapter\" method=\"create(${body},${property.disablePwdPolicyCheck},\n-                                 ${property.enabled},${property.storePassword})\"/>\n-        <process ref=\"defaultUserCreatePropagation\" />\n-        <to uri=\"direct:createPort\"/>\n-        <doCatch>        \n-          <exception>java.lang.RuntimeException</exception>\n-          <handled>\n-            <constant>false</constant>\n-          </handled>\n-          <to uri=\"direct:createPort\"/>\n-        </doCatch>\n-      </doTry>\n-    </route> \n-        \n-    <!--\n-        The propagation route deals with propagation of created user. In this\n-        case we used a custom processor to perform this task: it means that\n-        a custom java class contains the propagation strategy.\n-    -->\n-       \n-    <!--\n-        UPDATE USER\n-    -->\n-    <route id=\"updateUser\">\n-      <from uri=\"direct:updateUser\"/>\n-      <setProperty propertyName=\"actual\">\n-        <simple>${body}</simple>\n-      </setProperty>\n-      <doTry>\n-        <bean ref=\"uwfAdapter\" method=\"update(${body})\"/>\n-        <process ref=\"defaultUserUpdatePropagation\" />\n-        <to uri=\"direct:updatePort\"/>\n-        <doCatch>        \n-          <exception>java.lang.RuntimeException</exception>\n-          <handled>\n-            <constant>false</constant>\n-          </handled>\n-          <to uri=\"direct:updatePort\"/>\n-        </doCatch>\n-      </doTry>\n-    </route>\n-        \n-\n-                \n-    <!--\n-        UPDATE SYNC USER\n-    -->\n-    <route id=\"updateSyncUser\">\n-      <from uri=\"direct:updateSyncUser\"/>            \n-      <doTry>\n-        <bean ref=\"uwfAdapter\" method=\"update(${body})\"/>\n-        <to uri=\"direct:syncUserStatus\"/>\n-        <doCatch>        \n-          <exception>java.lang.RuntimeException</exception>\n-          <handled>\n-            <constant>false</constant>\n-          </handled>\n-          <to uri=\"direct:updateSyncPort\"/>\n-        </doCatch>\n-      </doTry>\n-    </route>\n-        \n-    <route id=\"syncUserStatus\">\n-      <from uri=\"direct:syncUserStatus\"/>\n-      <process ref=\"userStatusOnSync\" />\n-      <process ref=\"defaultUserUpdateInSyncPropagation\" />\n-      <to uri=\"direct:updateSyncPort\"/>\n-    </route>\n-    <!--\n-        DELETE USER\n-    -->\n-    <route id=\"deleteUser\">\n-      <from uri=\"direct:deleteUser\"/>\n-      <doTry>\n-        <process ref=\"defaultUserDeletePropagation\" />\n-        <bean ref=\"uwfAdapter\" method=\"delete(${body})\"/>\n-        <setBody>\n-          <simple>${property.statuses}</simple>\n-        </setBody>\n-        <to uri=\"direct:deletePort\"/>\n-        <doCatch>        \n-          <exception>java.lang.RuntimeException</exception>\n-          <handled>\n-            <constant>false</constant>\n-          </handled>\n-          <to uri=\"direct:deletePort\"/>\n-        </doCatch>\n-      </doTry>\n-    </route>\n-        \n-    <!-- \n-        UNLINK USER\n-    -->\n-    <route id=\"unlinkUser\">\n-      <from uri=\"direct:unlinkUser\"/>\n-      <doTry>\n-        <bean ref=\"uwfAdapter\" method=\"update(${body})\"/>\n-        <setBody>\n-          <simple>${body.getResult.getKey}</simple>\n-        </setBody>\n-        <to uri=\"direct:unlinkPort\"/>\n-        <doCatch>        \n-          <exception>java.lang.RuntimeException</exception>\n-          <handled>\n-            <constant>false</constant>\n-          </handled>\n-          <to uri=\"direct:unlinkPort\"/>\n-        </doCatch>\n-      </doTry>            \n-    </route>\n-        \n-    <!--\n-        LINK USER\n-    -->\n-        \n-    <route id=\"linkUser\">\n-      <from uri=\"direct:linkUser\"/>\n-      <doTry>\n-        <bean ref=\"uwfAdapter\" method=\"update(${body})\"/>\n-        <setBody>\n-          <simple>${body.getResult.getKey}</simple>\n-        </setBody>\n-        <to uri=\"direct:linkPort\"/>\n-        <doCatch>        \n-          <exception>java.lang.RuntimeException</exception>\n-          <handled>\n-            <constant>false</constant>\n-          </handled>\n-          <to uri=\"direct:linkPort\"/>\n-        </doCatch>\n-      </doTry>            \n-    </route>\n-        \n-    <!-- \n-        ACTIVATE USER\n-    -->\n-    <route id=\"activateUser\">\n-      <from uri=\"direct:activateUser\"/>\n-      <doTry>\n-        <bean ref=\"uwfAdapter\" method=\"activate(${body}, ${property.token})\"/>\n-        <to uri=\"direct:statusUser\"/>\n-        <doCatch>        \n-          <exception>java.lang.RuntimeException</exception>\n-          <handled>\n-            <constant>false</constant>\n-          </handled>\n-          <to uri=\"direct:statusPort\"/>\n-        </doCatch>\n-      </doTry>    \n-    </route>\n-    <!-- \n-        REACTIVATE USER\n-    -->\n-    <route id=\"reactivateUser\">\n-      <from uri=\"direct:reactivateUser\"/>\n-      <doTry>\n-        <bean ref=\"uwfAdapter\" method=\"reactivate(${body})\"/>\n-        <to uri=\"direct:statusUser\"/>\n-        <doCatch>        \n-          <exception>java.lang.RuntimeException</exception>\n-          <handled>\n-            <constant>false</constant>\n-          </handled>\n-          <to uri=\"direct:statusPort\"/>\n-        </doCatch>\n-      </doTry>    \n-    </route>\n-    <!-- \n-        SUSPEND USER\n-    -->\n-    <route id=\"suspendUser\">\n-      <from uri=\"direct:suspendUser\"/>\n-      <doTry>\n-        <bean ref=\"uwfAdapter\" method=\"suspend(${body})\"/>\n-        <to uri=\"direct:statusUser\"/>\n-        <doCatch>        \n-          <exception>java.lang.RuntimeException</exception>\n-          <handled>\n-            <constant>false</constant>\n-          </handled>\n-          <to uri=\"direct:statusPort\"/>\n-        </doCatch>\n-      </doTry>  \n-    </route>\n-        \n-    <!-- \n-        STATUS PROPAGATION\n-    -->\n-        \n-    <route id=\"statusUser\">\n-      <from uri=\"direct:statusUser\"/>            \n-      <process ref=\"defaultUserStatusPropagation\" />\n-      <to uri=\"direct:statusPort\"/>              \n-    </route>\n-        \n-        \n-    <!--\n-        DEPROVISION USER\n-    -->\n-    <route id=\"deprovisionUser\">\n-      <from uri=\"direct:deprovisionUser\"/>            \n-      <process ref=\"defaultUserDeprovisionPropagation\" />\n-      <to uri=\"direct:deprovisionPort\"/>              \n-    </route>\n-        \n-    <!--\n-        CREATE ROLE\n-    -->\n-        \n-    <route id=\"createRole\">\n-      <from uri=\"direct:createRole\"/>\n-      <setProperty propertyName=\"subject\">\n-        <simple>${body}</simple>\n-      </setProperty>\n-      <doTry>\n-        <bean ref=\"rwfAdapter\" method=\"create(${body})\"/>\n-        <process ref=\"defaultRoleCreatePropagation\" />\n-        <to uri=\"direct:createRolePort\"/>\n-        <doCatch>        \n-          <exception>java.lang.RuntimeException</exception>\n-          <handled>\n-            <constant>false</constant>\n-          </handled>\n-          <to uri=\"direct:createRolePort\"/>\n-        </doCatch>\n-      </doTry>\n-    </route> \n-               \n-    <!--\n-        CREATE ROLE SYNC\n-    -->\n-    <route id=\"createRoleSync\">\n-      <from uri=\"direct:createRoleSync\"/>\n-      <setProperty propertyName=\"subject\">\n-        <simple>${body}</simple>\n-      </setProperty>\n-      <doTry>\n-        <bean ref=\"rwfAdapter\" method=\"create(${body})\"/>\n-        <process ref=\"defaultRoleCreateSyncPropagation\" />\n-        <to uri=\"direct:createRoleSyncPort\"/>\n-        <doCatch>        \n-          <exception>java.lang.RuntimeException</exception>\n-          <handled>\n-            <constant>false</constant>\n-          </handled>\n-          <to uri=\"direct:createRoleSyncPort\"/>\n-        </doCatch>\n-      </doTry>\n-    </route> \n-        \n-         \n-    <!--\n-        UPDATE ROLE\n-    -->\n-    <route id=\"updateRole\">\n-      <from uri=\"direct:updateRole\"/>\n-      <setProperty propertyName=\"subjectMod\">\n-        <simple>${body}</simple>\n-      </setProperty>\n-      <doTry>\n-        <bean ref=\"rwfAdapter\" method=\"update(${body})\"/>\n-        <process ref=\"defaultRoleUpdatePropagation\" />\n-        <to uri=\"direct:updateRolePort\"/>\n-        <doCatch>        \n-          <exception>java.lang.RuntimeException</exception>\n-          <handled>\n-            <constant>false</constant>\n-          </handled>\n-          <to uri=\"direct:updateRolePort\"/>\n-        </doCatch>\n-      </doTry>\n-    </route>\n-               \n-    <!--\n-        DELETE ROLE\n-    -->\n-    <route id=\"deleteRole\">\n-      <from uri=\"direct:deleteRole\"/>\n-      <doTry>\n-        <process ref=\"defaultRoleDeletePropagation\" />\n-        <bean ref=\"rwfAdapter\" method=\"delete(${body})\"/>\n-        <setBody>\n-          <simple>${property.statuses}</simple>\n-        </setBody>\n-        <to uri=\"direct:deleteRolePort\"/>\n-        <doCatch>        \n-          <exception>java.lang.RuntimeException</exception>\n-          <handled>\n-            <constant>false</constant>\n-          </handled>\n-          <to uri=\"direct:deleteRolePort\"/>\n-        </doCatch>\n-      </doTry>\n-    </route>\n-        \n-    <!-- \n-        UNLINK USER\n-    -->\n-    <route id=\"unlinkRole\">\n-      <from uri=\"direct:unlinkRole\"/>\n-      <doTry>\n-        <bean ref=\"rwfAdapter\" method=\"update(${body})\"/>\n-        <setBody>\n-          <simple>${body.getResult}</simple>\n-        </setBody>\n-        <to uri=\"direct:unlinkRolePort\"/>\n-        <doCatch>        \n-          <exception>java.lang.RuntimeException</exception>\n-          <handled>\n-            <constant>false</constant>\n-          </handled>\n-          <to uri=\"direct:unlinkRolePort\"/>\n-        </doCatch>\n-      </doTry>            \n-    </route>\n-        \n-    <!--\n-        LINK USER\n-    -->\n-        \n-    <route id=\"linkRole\">\n-      <from uri=\"direct:linkRole\"/>\n-      <doTry>\n-        <bean ref=\"rwfAdapter\" method=\"update(${body})\"/>\n-        <setBody>\n-          <simple>${body.getResult}</simple>\n-        </setBody>\n-        <to uri=\"direct:linkRolePort\"/>\n-        <doCatch>        \n-          <exception>java.lang.RuntimeException</exception>\n-          <handled>\n-            <constant>false</constant>\n-          </handled>\n-          <to uri=\"direct:linkRolePort\"/>\n-        </doCatch>\n-      </doTry>            \n-    </route>\n-        \n-    <!--\n-        DEPROVISION ROLE\n-    -->\n-    <route id=\"deprovisionRole\">\n-      <from uri=\"direct:deprovisionRole\"/>            \n-      <process ref=\"defaultRoleDeprovisionPropagation\" />\n-      <to uri=\"direct:deprovisionRolePort\"/>              \n-    </route>\n-        \n-    <!--\n-        SUSPEND USER AFTER POLICY VIOLATION\n-    -->\n-        \n-    <route id=\"suspendUserWF\">\n-      <from uri=\"direct:suspendUserWF\"/>\n-      <doTry>\n-        <bean ref=\"uwfAdapter\" method=\"suspend(${body})\"/>\n-        <process ref=\"defaultUserWFSuspendPropagation\"/>\n-        <to uri=\"direct:suspendWFPort\"/>\n-        <doCatch>        \n-          <exception>java.lang.RuntimeException</exception>\n-          <handled>\n-            <constant>false</constant>\n-          </handled>\n-          <to uri=\"direct:suspendWFPort\"/>\n-        </doCatch>\n-      </doTry>  \n-    </route>\n-        \n-    <!--\n-        REQUEST PASSWORD RESET ROUTE\n-    -->\n-        \n-    <route id=\"requestPwdReset\">\n-      <from uri=\"direct:requestPwdReset\"/>\n-      <doTry>\n-        <bean ref=\"uwfAdapter\" method=\"requestPasswordReset(${body})\"/>\n-        <to uri=\"direct:requestPwdResetPort\"/>\n-        <doCatch>        \n-          <exception>java.lang.RuntimeException</exception>\n-          <handled>\n-            <constant>false</constant>\n-          </handled>\n-          <to uri=\"direct:requestPwdResetPort\"/>\n-        </doCatch>\n-      </doTry>  \n-    </route>\n-    <!--\n-        CONFIRM PASSWORD RESET\n-    -->\n-    <route id=\"confirmPwdReset\">\n-      <from uri=\"direct:confirmPwdReset\"/>\n-      <doTry>\n-        <bean ref=\"uwfAdapter\" method=\"confirmPasswordReset(${property.userId},${property.token},${property.password})\"/>\n-        <process ref=\"defaultUserConfirmPwdResetPropagation\" />\n-        <to uri=\"direct:confirmPwdResetPort\"/>\n-        <doCatch>        \n-          <exception>java.lang.RuntimeException</exception>\n-          <handled>\n-            <constant>false</constant>\n-          </handled>\n-          <to uri=\"direct:confirmPwdResetPort\"/>\n-        </doCatch>\n-      </doTry>\n-    </route>\n-        \n-  </routeContext>\n-  <bean id=\"defaultUserCreatePropagation\" class=\"org.apache.syncope.core.provisioning.camel.processors.DefaultUserCreatePropagation\"/>\n-  <bean id=\"defaultUserUpdatePropagation\" class=\"org.apache.syncope.core.provisioning.camel.processors.DefaultUserUpdatePropagation\"/>    \n-  <bean id=\"userStatusOnSync\" class=\"org.apache.syncope.core.provisioning.camel.processors.UserStatusOnSync\"/>\n-  <bean id=\"defaultUserUpdateInSyncPropagation\" class=\"org.apache.syncope.core.provisioning.camel.processors.DefaultUserUpdateInSyncPropagation\"/>\n-  <bean id=\"defaultUserDeletePropagation\" class=\"org.apache.syncope.core.provisioning.camel.processors.DefaultUserDeletePropagation\"/>    \n-  <bean id=\"defaultUserDeprovisionPropagation\" class=\"org.apache.syncope.core.provisioning.camel.processors.DefaultUserDeprovisionPropagation\"/>    \n-  <bean id=\"defaultUserWFSuspendPropagation\" class=\"org.apache.syncope.core.provisioning.camel.processors.DefaultUserWFSuspendPropagation\"/>\n-  <bean id=\"defaultUserStatusPropagation\" class=\"org.apache.syncope.core.provisioning.camel.processors.DefaultUserStatusPropagation\"/>\n-  <bean id=\"defaultUserConfirmPwdResetPropagation\" class=\"org.apache.syncope.core.provisioning.camel.processors.DefaultUserConfirmPwdResetPropagation\"/>\n-  <bean id=\"defaultRoleCreatePropagation\" class=\"org.apache.syncope.core.provisioning.camel.processors.DefaultRoleCreatePropagation\"/>\n-  <bean id=\"defaultRoleCreateSyncPropagation\" class=\"org.apache.syncope.core.provisioning.camel.processors.DefaultRoleCreateSyncPropagation\"/>\n-  <bean id=\"defaultRoleUpdatePropagation\" class=\"org.apache.syncope.core.provisioning.camel.processors.DefaultRoleUpdatePropagation\"/>\n-  <bean id=\"defaultRoleDeletePropagation\" class=\"org.apache.syncope.core.provisioning.camel.processors.DefaultRoleDeletePropagation\"/>    \n-  <bean id=\"defaultRoleDeprovisionPropagation\" class=\"org.apache.syncope.core.provisioning.camel.processors.DefaultRoleDeprovisionPropagation\"/>            \n-</beans>"},{"sha":"3d0d9d7200f6a7ee8bff4b2b8420d170d27f4095","filename":"core/src/main/resources/roleRoute.xml","status":"modified","additions":0,"deletions":2,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3838763f6eb2a6464786f6b83044c43260558be6/core%2Fsrc%2Fmain%2Fresources%2FroleRoute.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3838763f6eb2a6464786f6b83044c43260558be6/core%2Fsrc%2Fmain%2Fresources%2FroleRoute.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fresources%2FroleRoute.xml?ref=3838763f6eb2a6464786f6b83044c43260558be6","patch":"@@ -28,7 +28,6 @@ under the License.\n       The default routes define each task involved in user creation:\n       main operations consist in user workflow creation and its propagation.         \n   -->\n-  <routeContext id=\"defaultRoleRoutes\" xmlns=\"http://camel.apache.org/schema/spring\"> \n     <!--\n         CREATE ROLE\n     -->\n@@ -170,5 +169,4 @@ under the License.\n       <process ref=\"defaultRoleDeprovisionPropagation\" />\n       <to uri=\"direct:deprovisionRolePort\"/>              \n     </route>\n-  </routeContext>\n </beans>"},{"sha":"c95e7fa9eaed1b57a9801dd498ab882419122e58","filename":"core/src/main/resources/userRoute.xml","status":"modified","additions":1,"deletions":3,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3838763f6eb2a6464786f6b83044c43260558be6/core%2Fsrc%2Fmain%2Fresources%2FuserRoute.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3838763f6eb2a6464786f6b83044c43260558be6/core%2Fsrc%2Fmain%2Fresources%2FuserRoute.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fresources%2FuserRoute.xml?ref=3838763f6eb2a6464786f6b83044c43260558be6","patch":"@@ -27,8 +27,7 @@ under the License.\n   <!--\n       The default routes define each task involved in user creation:\n       main operations consist in user workflow creation and its propagation.         \n-  -->\n-  <routeContext id=\"defaultUserRoutes\" xmlns=\"http://camel.apache.org/schema/spring\">  \t\n+  -->  \t\n     <!--\n         CREATE USER\n         This is the entry point of the route and is involved in accepting\n@@ -307,5 +306,4 @@ under the License.\n       </doTry>\n     </route>\n \n-  </routeContext>\n </beans>"}]}