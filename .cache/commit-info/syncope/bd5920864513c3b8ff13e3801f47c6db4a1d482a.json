{"sha":"bd5920864513c3b8ff13e3801f47c6db4a1d482a","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmJkNTkyMDg2NDUxM2MzYjhmZjEzZTM4MDFmNDdjNmRiNGExZDQ4MmE=","commit":{"author":{"name":"Andrea Patricelli","email":"andreapatricelli@apache.org","date":"2017-04-14T08:32:33Z"},"committer":{"name":"Andrea Patricelli","email":"andreapatricelli@apache.org","date":"2017-04-14T08:32:48Z"},"message":"[SYNCOPE-1059] removed final landing page and managed feedback after successful self create/update","tree":{"sha":"121bc988b86c8354e612d94f82ff488c30df95a9","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/121bc988b86c8354e612d94f82ff488c30df95a9"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/bd5920864513c3b8ff13e3801f47c6db4a1d482a","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/bd5920864513c3b8ff13e3801f47c6db4a1d482a","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/bd5920864513c3b8ff13e3801f47c6db4a1d482a","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/bd5920864513c3b8ff13e3801f47c6db4a1d482a/comments","author":{"login":"andrea-patricelli","id":3763111,"node_id":"MDQ6VXNlcjM3NjMxMTE=","avatar_url":"https://avatars.githubusercontent.com/u/3763111?v=4","gravatar_id":"","url":"https://api.github.com/users/andrea-patricelli","html_url":"https://github.com/andrea-patricelli","followers_url":"https://api.github.com/users/andrea-patricelli/followers","following_url":"https://api.github.com/users/andrea-patricelli/following{/other_user}","gists_url":"https://api.github.com/users/andrea-patricelli/gists{/gist_id}","starred_url":"https://api.github.com/users/andrea-patricelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrea-patricelli/subscriptions","organizations_url":"https://api.github.com/users/andrea-patricelli/orgs","repos_url":"https://api.github.com/users/andrea-patricelli/repos","events_url":"https://api.github.com/users/andrea-patricelli/events{/privacy}","received_events_url":"https://api.github.com/users/andrea-patricelli/received_events","type":"User","site_admin":false},"committer":{"login":"andrea-patricelli","id":3763111,"node_id":"MDQ6VXNlcjM3NjMxMTE=","avatar_url":"https://avatars.githubusercontent.com/u/3763111?v=4","gravatar_id":"","url":"https://api.github.com/users/andrea-patricelli","html_url":"https://github.com/andrea-patricelli","followers_url":"https://api.github.com/users/andrea-patricelli/followers","following_url":"https://api.github.com/users/andrea-patricelli/following{/other_user}","gists_url":"https://api.github.com/users/andrea-patricelli/gists{/gist_id}","starred_url":"https://api.github.com/users/andrea-patricelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrea-patricelli/subscriptions","organizations_url":"https://api.github.com/users/andrea-patricelli/orgs","repos_url":"https://api.github.com/users/andrea-patricelli/repos","events_url":"https://api.github.com/users/andrea-patricelli/events{/privacy}","received_events_url":"https://api.github.com/users/andrea-patricelli/received_events","type":"User","site_admin":false},"parents":[{"sha":"46a70c88aebf62c856ab943ac31ba5d44a1df3ed","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/46a70c88aebf62c856ab943ac31ba5d44a1df3ed","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/46a70c88aebf62c856ab943ac31ba5d44a1df3ed"}],"stats":{"total":134,"additions":58,"deletions":76},"files":[{"sha":"ef9ab90fdc910f1e8b578f9806c909355c1860b5","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/pages/HomePage.java","status":"modified","additions":12,"deletions":6,"changes":18,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/bd5920864513c3b8ff13e3801f47c6db4a1d482a/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FHomePage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/bd5920864513c3b8ff13e3801f47c6db4a1d482a/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FHomePage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FHomePage.java?ref=bd5920864513c3b8ff13e3801f47c6db4a1d482a","patch":"@@ -34,13 +34,19 @@ public HomePage(final PageParameters parameters) {\n         StringBuilder redirectUrl = new StringBuilder(\"/app/\");\n         if (!parameters.get(\"errorMessage\").isNull()) {\n             redirectUrl.append(\"#!self?errorMessage=\");\n-            try {\n-                redirectUrl.append(\n-                        URLEncoder.encode(parameters.get(\"errorMessage\").toString(), StandardCharsets.UTF_8.name()));\n-            } catch (Exception e) {\n-                redirectUrl.append(\"Generic error\");\n-            }\n+            appendMessage(redirectUrl, parameters.get(\"errorMessage\").toString());\n+        } else if (!parameters.get(\"successMessage\").isNull()) {\n+            redirectUrl.append(\"#!self?successMessage=\");\n+            appendMessage(redirectUrl, parameters.get(\"successMessage\").toString());\n         }\n         throw new NonResettingRestartException(redirectUrl.toString());\n     }\n+\n+    private void appendMessage(final StringBuilder redirectUrl, final String message) {\n+        try {\n+            redirectUrl.append(URLEncoder.encode(message, StandardCharsets.UTF_8.name()));\n+        } catch (Exception e) {\n+            redirectUrl.append(\"Generic error\");\n+        }\n+    }\n }"},{"sha":"ced26545712be1d1478f761bebfa612b489b4108","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/pages/Logout.java","status":"modified","additions":5,"deletions":4,"changes":9,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/bd5920864513c3b8ff13e3801f47c6db4a1d482a/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FLogout.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/bd5920864513c3b8ff13e3801f47c6db4a1d482a/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FLogout.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FLogout.java?ref=bd5920864513c3b8ff13e3801f47c6db4a1d482a","patch":"@@ -21,22 +21,23 @@\n import org.apache.syncope.client.enduser.SyncopeEnduserSession;\n import org.apache.syncope.client.enduser.commons.Constants;\n import org.apache.wicket.markup.html.WebPage;\n+import org.apache.wicket.request.mapper.parameter.PageParameters;\n \n public class Logout extends WebPage {\n \n     private static final long serialVersionUID = -4514869014471715933L;\n \n-    public Logout() {\n-        super();\n+    public Logout(final PageParameters parameters) {\n+        super(parameters);\n \n         @SuppressWarnings(\"unchecked\")\n         Class<? extends WebPage> beforeLogout = (Class<? extends WebPage>) SyncopeEnduserSession.get().\n                 getAttribute(Constants.BEFORE_LOGOUT);\n         if (beforeLogout == null) {\n             SyncopeEnduserSession.get().invalidateNow();\n-            setResponsePage(getApplication().getHomePage());\n+            setResponsePage(getApplication().getHomePage(), getPageParameters());\n         } else {\n-            setResponsePage(beforeLogout);\n+            setResponsePage(beforeLogout, getPageParameters());\n         }\n     }\n }"},{"sha":"253609a882428eebf65665340b3332c8d638804f","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/app.js","status":"modified","additions":0,"deletions":4,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/bd5920864513c3b8ff13e3801f47c6db4a1d482a/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fapp.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/bd5920864513c3b8ff13e3801f47c6db4a1d482a/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fapp.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fapp.js?ref=bd5920864513c3b8ff13e3801f47c6db4a1d482a","patch":"@@ -119,10 +119,6 @@ app.config(['$stateProvider', '$urlRouterProvider', '$httpProvider', '$translate\n               url: '/finish',\n               templateUrl: 'views/user-form-finish.html'\n             })\n-            .state('success', {\n-              url: '/success',\n-              templateUrl: 'views/success.html'\n-            })\n             .state('update', {\n               url: '/self/update',\n               templateUrl: 'views/editUser.html',"},{"sha":"1b68e075756ed3c4dd4929c2fb2fdd14bc3996c6","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/controllers/LoginController.js","status":"modified","additions":9,"deletions":15,"changes":24,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/bd5920864513c3b8ff13e3801f47c6db4a1d482a/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FLoginController.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/bd5920864513c3b8ff13e3801f47c6db4a1d482a/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FLoginController.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FLoginController.js?ref=bd5920864513c3b8ff13e3801f47c6db4a1d482a","patch":"@@ -67,21 +67,15 @@ angular.module(\"login\").controller(\"LoginController\", ['$scope', '$rootScope', '\n     $scope.passwordReset = function () {\n       $location.path(\"/passwordreset\");\n     };\n-    $scope.errorAPI = function () {\n-      $http.get(\"/syncope-enduser/api/error\").success(function (data) {\n-        console.debug(\"errorAPI response: \", data);\n-      });\n-    };\n-    $scope.sampleAPI = function () {\n-      $http.get(\"/syncope-enduser/api/user-self\").success(function (data) {\n-        console.debug(\"sampleAPI response: \", data);\n-      });\n-    };\n-    $scope.schemaAPI = function () {\n-      $http.get(\"/syncope-enduser/api/schema\").success(function (data) {\n-        console.debug(\"schemaAPI response: \", data);\n-      });\n-    };\n+    $scope.$watch(function () {\n+      return $location.search().successMessage;\n+    }, function (successMessage) {\n+      if (successMessage) {\n+        var message = (' ' + successMessage).slice(1);\n+        $scope.showSuccess(message, $scope.notification);\n+        delete $location.$$search.successMessage;\n+      }\n+    });\n     $scope.$watch(function () {\n       return $location.search().errorMessage;\n     }, function (errorMessage) {"},{"sha":"fbee9364c37cfe7962c84c0c140f7c6f2dbad8ee","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/controllers/UserController.js","status":"modified","additions":32,"deletions":14,"changes":46,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/bd5920864513c3b8ff13e3801f47c6db4a1d482a/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/bd5920864513c3b8ff13e3801f47c6db4a1d482a/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js?ref=bd5920864513c3b8ff13e3801f47c6db4a1d482a","patch":"@@ -23,9 +23,10 @@\n \n angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$location', \"$state\",\n   'UserSelfService', 'SchemaService', 'RealmService', 'ResourceService', 'SecurityQuestionService',\n-  'GroupService', 'AnyService', 'UserUtil', 'GenericUtil', 'ValidationExecutor', '$translate',\n+  'GroupService', 'AnyService', 'UserUtil', 'GenericUtil', 'ValidationExecutor', '$translate', '$filter',\n   function ($scope, $rootScope, $location, $state, UserSelfService, SchemaService, RealmService,\n-          ResourceService, SecurityQuestionService, GroupService, AnyService, UserUtil, GenericUtil, ValidationExecutor, $translate) {\n+          ResourceService, SecurityQuestionService, GroupService, AnyService, UserUtil, GenericUtil, ValidationExecutor,\n+          $translate, $filter) {\n \n     $scope.user = {};\n     $scope.confirmPassword = {\n@@ -228,7 +229,7 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n             return x < y ? -1 : x > y ? 1 : 0;\n           });\n         }, function (e) {\n-          $scope.showError(\"An error occur during retrieving groups \" + e, $scope.notification);\n+          $scope.showError(\"An error occur while retrieving groups \" + e, $scope.notification);\n         });\n       };\n \n@@ -248,10 +249,10 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n               }\n             }\n           }, function (e) {\n-            $scope.showError(\"An error occur during retrieving auxiliary classes \" + e, $scope.notification);\n+            $scope.showError(\"An error occur while retrieving auxiliary classes \" + e, $scope.notification);\n           });\n         }, function (e) {\n-          $scope.showError(\"An error occur during retrieving auxiliary classes \" + e, $scope.notification);\n+          $scope.showError(\"An error occur while retrieving auxiliary classes \" + e, $scope.notification);\n         });\n       };\n \n@@ -302,7 +303,7 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n             initProperties();\n           }\n         }, function (e) {\n-          console.error(\"Error during user read \", e);\n+          console.error(\"Error while user read \", e);\n         });\n       };\n \n@@ -401,10 +402,14 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n       var wrappedUser = UserUtil.getWrappedUser(user);\n       if ($scope.createMode) {\n         UserSelfService.create(wrappedUser, $scope.captchaInput.value).then(function (response) {\n-          console.debug(\"User \" + $scope.user.username + \" SUCCESSFULLY_CREATED\");\n+          console.debug(\"User \" + $scope.user.username + \" successfully CREATED\");\n           $rootScope.currentUser = $scope.user.username;\n           $rootScope.currentOp = \"SUCCESSFULLY_CREATED\";\n-          $state.go('success');\n+          $scope.success({successMessage: $filter('translate')([\"USER\"]).USER\n+                    + \" \"\n+                    + $scope.user.username\n+                    + \" \"\n+                    + $filter('translate')([\"SUCCESSFULLY_CREATED\"]).SUCCESSFULLY_CREATED});\n         }, function (response) {\n           console.error(\"Error during user creation: \", response);\n           var errorMessage;\n@@ -417,12 +422,14 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n         });\n       } else {\n         UserSelfService.update(wrappedUser, $scope.captchaInput.value).then(function (response) {\n-          console.debug(\"User \" + $scope.user.username + \" SUCCESSFULLY_UPDATED\");\n+          console.debug(\"User \" + $scope.user.username + \" successfully UPDATED\");\n           $rootScope.currentUser = $scope.user.username;\n           $rootScope.currentOp = \"SUCCESSFULLY_UPDATED\";\n-          $state.go('success');\n-\n-          $scope.logout();\n+          $scope.logout({successMessage: $filter('translate')([\"USER\"]).USER\n+                    + \" \"\n+                    + $scope.user.username\n+                    + \" \"\n+                    + $filter('translate')([\"SUCCESSFULLY_UPDATED\"]).SUCCESSFULLY_UPDATED});\n         }, function (response) {\n           console.info(\"Error during user update: \", response);\n           var errorMessage;\n@@ -541,10 +548,21 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n       kendo.culture($rootScope.languages.selectedLanguage.code);\n     };\n \n-    $scope.logout = function () {\n+    $scope.logout = function (params) {\n       $translate.use($scope.languages.selectedLanguage.code);\n       $rootScope.endReached = false;\n-      window.location.href = '../wicket/bookmarkable/org.apache.syncope.client.enduser.pages.Logout';\n+      var destination = params && params.successMessage\n+              ? '../wicket/bookmarkable/org.apache.syncope.client.enduser.pages.Logout?successMessage=' + params.successMessage\n+              : '../wicket/bookmarkable/org.apache.syncope.client.enduser.pages.Logout';\n+      window.location.href = destination;\n+    };\n+\n+    $scope.success = function (params) {\n+      $rootScope.endReached = false;\n+      var destination = params && params.successMessage\n+              ? '../wicket/bookmarkable/org.apache.syncope.client.enduser.pages.HomePage?successMessage=' + params.successMessage\n+              : '../wicket/bookmarkable/org.apache.syncope.client.enduser.pages.HomePage';\n+      window.location.href = destination;\n     };\n \n     $scope.redirect = function () {"},{"sha":"1be0c9a93de8d9c8d3649a11bb296ee511266dac","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/success.html","status":"removed","additions":0,"deletions":33,"changes":33,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/46a70c88aebf62c856ab943ac31ba5d44a1df3ed/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fsuccess.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/46a70c88aebf62c856ab943ac31ba5d44a1df3ed/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fsuccess.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fsuccess.html?ref=46a70c88aebf62c856ab943ac31ba5d44a1df3ed","patch":"@@ -1,33 +0,0 @@\n-<!--\n-Licensed to the Apache Software Foundation (ASF) under one\n-or more contributor license agreements.  See the NOTICE file\n-distributed with this work for additional information\n-regarding copyright ownership.  The ASF licenses this file\n-to you under the Apache License, Version 2.0 (the\n-\"License\"); you may not use this file except in compliance\n-with the License.  You may obtain a copy of the License at\n-\n-  http://www.apache.org/licenses/LICENSE-2.0\n-\n-Unless required by applicable law or agreed to in writing,\n-software distributed under the License is distributed on an\n-\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n-KIND, either express or implied.  See the License for the\n-specific language governing permissions and limitations\n-under the License.\n--->\n-\n-<div ng-cloak class=\"container\">\n-  <div class=\"login-container\" style=\"box-sizing: border-box; \">\n-    <div id=\"form-container\" class=\"col-md-6 col-md-offset-3\" style=\"box-sizing: border-box; background-color: #F7F7F7;\">\n-      <div ng-controller=\"UserController\">\n-        <div class=\"page-header\" style=\"text-align: left; font-weight: 700;\">          \n-          <span>{{'USER'| translate}} <b> {{currentUser}}</b> {{currentOp| translate}}</span>\n-        </div>\n-        <span>\n-          <a id=\"redirect\" href=\"javascript:void(0);\" class=\"btn btn-link\" ng-click=\"redirect()\">{{'GOBACKHOME'| translate}}</a>\n-        </span> \n-      </div>\n-    </div>\n-  </div>\n-</div>\n\\ No newline at end of file"}]}