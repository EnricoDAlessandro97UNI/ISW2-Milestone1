{"sha":"2560d7eadac005814c7f708a211b07a1767dafdf","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjI1NjBkN2VhZGFjMDA1ODE0YzdmNzA4YTIxMWIwN2ExNzY3ZGFmZGY=","commit":{"author":{"name":"Christian Schneider","email":"cschneider@apache.org","date":"2013-01-24T09:13:38Z"},"committer":{"name":"Christian Schneider","email":"cschneider@apache.org","date":"2013-01-24T09:13:38Z"},"message":"SYNCOPE-231 Impement db export for cxf\n\ngit-svn-id: https://svn.apache.org/repos/asf/syncope/trunk@1437916 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"02a29d60f2bfaf2de8c5d280e0d7f7fe5f17e6d1","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/02a29d60f2bfaf2de8c5d280e0d7f7fe5f17e6d1"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/2560d7eadac005814c7f708a211b07a1767dafdf","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/2560d7eadac005814c7f708a211b07a1767dafdf","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/2560d7eadac005814c7f708a211b07a1767dafdf","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/2560d7eadac005814c7f708a211b07a1767dafdf/comments","author":{"login":"cschneider","id":484584,"node_id":"MDQ6VXNlcjQ4NDU4NA==","avatar_url":"https://avatars.githubusercontent.com/u/484584?v=4","gravatar_id":"","url":"https://api.github.com/users/cschneider","html_url":"https://github.com/cschneider","followers_url":"https://api.github.com/users/cschneider/followers","following_url":"https://api.github.com/users/cschneider/following{/other_user}","gists_url":"https://api.github.com/users/cschneider/gists{/gist_id}","starred_url":"https://api.github.com/users/cschneider/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cschneider/subscriptions","organizations_url":"https://api.github.com/users/cschneider/orgs","repos_url":"https://api.github.com/users/cschneider/repos","events_url":"https://api.github.com/users/cschneider/events{/privacy}","received_events_url":"https://api.github.com/users/cschneider/received_events","type":"User","site_admin":false},"committer":{"login":"cschneider","id":484584,"node_id":"MDQ6VXNlcjQ4NDU4NA==","avatar_url":"https://avatars.githubusercontent.com/u/484584?v=4","gravatar_id":"","url":"https://api.github.com/users/cschneider","html_url":"https://github.com/cschneider","followers_url":"https://api.github.com/users/cschneider/followers","following_url":"https://api.github.com/users/cschneider/following{/other_user}","gists_url":"https://api.github.com/users/cschneider/gists{/gist_id}","starred_url":"https://api.github.com/users/cschneider/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cschneider/subscriptions","organizations_url":"https://api.github.com/users/cschneider/orgs","repos_url":"https://api.github.com/users/cschneider/repos","events_url":"https://api.github.com/users/cschneider/events{/privacy}","received_events_url":"https://api.github.com/users/cschneider/received_events","type":"User","site_admin":false},"parents":[{"sha":"3bc5d643b45209fd171ab05d3ea616334270dd82","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/3bc5d643b45209fd171ab05d3ea616334270dd82","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/3bc5d643b45209fd171ab05d3ea616334270dd82"}],"stats":{"total":23,"additions":12,"deletions":11},"files":[{"sha":"84ab282d114bea8db6a27d196ab8d6fa44bddd1c","filename":"core/src/main/java/org/apache/syncope/core/rest/controller/ConfigurationController.java","status":"modified","additions":10,"deletions":1,"changes":11,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/2560d7eadac005814c7f708a211b07a1767dafdf/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2Fcontroller%2FConfigurationController.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/2560d7eadac005814c7f708a211b07a1767dafdf/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2Fcontroller%2FConfigurationController.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2Fcontroller%2FConfigurationController.java?ref=2560d7eadac005814c7f708a211b07a1767dafdf","patch":"@@ -19,6 +19,7 @@\n package org.apache.syncope.core.rest.controller;\n \n import java.io.IOException;\n+import java.io.OutputStream;\n import java.util.ArrayList;\n import java.util.HashSet;\n import java.util.List;\n@@ -209,9 +210,17 @@ public ModelAndView getMailTemplates() {\n     public void dbExport(final HttpServletResponse response) {\n         response.setContentType(MediaType.TEXT_XML_VALUE);\n         response.setHeader(\"Content-Disposition\", \"attachment; filename=content.xml\");\n+        try {\n+            dbExportInternal(response.getOutputStream());\n+        } catch (IOException e) {\n+            LOG.error(\"Getting servlet output stream\", e);\n+        }\n+    }\n \n+    @Transactional(readOnly = true)\n+    public void dbExportInternal(OutputStream os) {\n         try {\n-            importExport.export(response.getOutputStream());\n+            importExport.export(os);\n \n             auditManager.audit(Category.configuration, ConfigurationSubCategory.dbExport, Result.success,\n                     \"Successfully exported database content\");"},{"sha":"8ce892c9eaeabf1dd91f9b082993de80f0cbe02e","filename":"core/src/main/java/org/apache/syncope/core/services/ConfigurationServiceImpl.java","status":"modified","additions":2,"deletions":10,"changes":12,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/2560d7eadac005814c7f708a211b07a1767dafdf/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fservices%2FConfigurationServiceImpl.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/2560d7eadac005814c7f708a211b07a1767dafdf/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fservices%2FConfigurationServiceImpl.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fservices%2FConfigurationServiceImpl.java?ref=2560d7eadac005814c7f708a211b07a1767dafdf","patch":"@@ -56,17 +56,9 @@ public Response create(final ConfigurationTO configurationTO) {\n \r\n     @Override\r\n     public Response dbExport() {\r\n-        configurationController.dbExport(new DummyHTTPServletResponse());\r\n-        // TODO catch output-stream and forward it to response\r\n         return Response.ok(new StreamingOutput() {\r\n-\r\n-            @Override\r\n-            public void write(final OutputStream output) throws IOException {\r\n-//                FileInputStream is = new FileInputStream(\"/etc/hosts\");\r\n-//                while (is.available() > 0) {\r\n-//                    output.write(is.read());\r\n-//                }\r\n-//                is.close();\r\n+            public void write(final OutputStream os) throws IOException {\r\n+                configurationController.dbExportInternal(os);\r\n             }\r\n         }).build();\r\n     }\r"}]}