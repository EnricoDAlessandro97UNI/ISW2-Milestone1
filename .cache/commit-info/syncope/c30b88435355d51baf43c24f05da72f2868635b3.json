{"sha":"c30b88435355d51baf43c24f05da72f2868635b3","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmMzMGI4ODQzNTM1NWQ1MWJhZjQzYzI0ZjA1ZGE3MmYyODY4NjM1YjM=","commit":{"author":{"name":"Colm O hEigeartaigh","email":"coheigea@apache.org","date":"2019-02-14T18:17:43Z"},"committer":{"name":"Francesco Chicchiricc√≤","email":"ilgrosso@apache.org","date":"2019-02-15T12:09:01Z"},"message":"Enable security-related HTTP headers in the console","tree":{"sha":"46c11da561df7cae0daf25e07ea68d13e0958462","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/46c11da561df7cae0daf25e07ea68d13e0958462"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/c30b88435355d51baf43c24f05da72f2868635b3","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/c30b88435355d51baf43c24f05da72f2868635b3","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/c30b88435355d51baf43c24f05da72f2868635b3","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/c30b88435355d51baf43c24f05da72f2868635b3/comments","author":{"login":"coheigea","id":472162,"node_id":"MDQ6VXNlcjQ3MjE2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/472162?v=4","gravatar_id":"","url":"https://api.github.com/users/coheigea","html_url":"https://github.com/coheigea","followers_url":"https://api.github.com/users/coheigea/followers","following_url":"https://api.github.com/users/coheigea/following{/other_user}","gists_url":"https://api.github.com/users/coheigea/gists{/gist_id}","starred_url":"https://api.github.com/users/coheigea/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coheigea/subscriptions","organizations_url":"https://api.github.com/users/coheigea/orgs","repos_url":"https://api.github.com/users/coheigea/repos","events_url":"https://api.github.com/users/coheigea/events{/privacy}","received_events_url":"https://api.github.com/users/coheigea/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"cfd50c91697debbab82658874293987db95bf867","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/cfd50c91697debbab82658874293987db95bf867","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/cfd50c91697debbab82658874293987db95bf867"}],"stats":{"total":29,"additions":28,"deletions":1},"files":[{"sha":"fb13f4234a0d7bcd980c5b2e65b3758445e77714","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/SyncopeEnduserApplication.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/c30b88435355d51baf43c24f05da72f2868635b3/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeEnduserApplication.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/c30b88435355d51baf43c24f05da72f2868635b3/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeEnduserApplication.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeEnduserApplication.java?ref=c30b88435355d51baf43c24f05da72f2868635b3","patch":"@@ -58,4 +58,4 @@ public ClassPathScanImplementationLookup classPathScanImplementationLookup() {\n         lookup.load();\n         return lookup;\n     }\n-}\n+}\n\\ No newline at end of file"},{"sha":"b5ed2c2819c082be3fc7d80f49527fa4d213dd5d","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/SyncopeWebApplication.java","status":"modified","additions":14,"deletions":0,"changes":14,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/c30b88435355d51baf43c24f05da72f2868635b3/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/c30b88435355d51baf43c24f05da72f2868635b3/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication.java?ref=c30b88435355d51baf43c24f05da72f2868635b3","patch":"@@ -49,6 +49,9 @@\n import org.apache.wicket.protocol.http.WebApplication;\n import org.apache.wicket.request.Request;\n import org.apache.wicket.request.Response;\n+import org.apache.wicket.request.cycle.IRequestCycleListener;\n+import org.apache.wicket.request.cycle.RequestCycle;\n+import org.apache.wicket.request.http.WebResponse;\n import org.apache.wicket.request.resource.AbstractResource;\n import org.apache.wicket.request.resource.IResource;\n import org.apache.wicket.request.resource.ResourceReference;\n@@ -305,6 +308,17 @@ public IResource getResource() {\n                 }\n             });\n         }\n+\n+        getRequestCycleListeners().add(new IRequestCycleListener() {\n+\n+            @Override\n+            public void onEndRequest(final RequestCycle cycle) {\n+                WebResponse response = (WebResponse) cycle.getResponse();\n+                response.setHeader(\"X-XSS-Protection\", \"1; mode=block\");\n+                response.setHeader(\"X-Content-Type-Options\", \"nosniff\");\n+                response.setHeader(\"X-Frame-Options\", \"sameorigin\");\n+            }\n+        });\n     }\n \n     @Override"},{"sha":"1e814083cb016ae2875ff092c4826a3d6c9a6bfa","filename":"client/idrepo/console/src/main/java/org/apache/syncope/client/console/SyncopeWebApplication.java","status":"modified","additions":13,"deletions":0,"changes":13,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/c30b88435355d51baf43c24f05da72f2868635b3/client%2Fidrepo%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2FSyncopeWebApplication.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/c30b88435355d51baf43c24f05da72f2868635b3/client%2Fidrepo%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2FSyncopeWebApplication.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2FSyncopeWebApplication.java?ref=c30b88435355d51baf43c24f05da72f2868635b3","patch":"@@ -59,6 +59,8 @@\n import org.apache.wicket.markup.html.WebPage;\n import org.apache.wicket.protocol.http.CsrfPreventionRequestCycleListener;\n import org.apache.wicket.protocol.http.WebApplication;\n+import org.apache.wicket.request.cycle.RequestCycle;\n+import org.apache.wicket.request.http.WebResponse;\n import org.apache.wicket.request.resource.AbstractResource;\n import org.apache.wicket.request.resource.IResource;\n import org.apache.wicket.request.resource.ResourceReference;\n@@ -69,6 +71,7 @@\n import org.apache.syncope.client.console.commons.ExternalResourceProvider;\n import org.apache.syncope.client.console.commons.StatusProvider;\n import org.apache.syncope.client.console.commons.VirSchemaDetailsPanelProvider;\n+import org.apache.wicket.request.cycle.IRequestCycleListener;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.stereotype.Component;\n \n@@ -228,6 +231,16 @@ protected void init() {\n             getRequestCycleListeners().add(new CsrfPreventionRequestCycleListener());\n         }\n         getRequestCycleListeners().add(new SyncopeConsoleRequestCycleListener());\n+        getRequestCycleListeners().add(new IRequestCycleListener() {\n+\n+            @Override\n+            public void onEndRequest(final RequestCycle cycle) {\n+                WebResponse response = (WebResponse) cycle.getResponse();\n+                response.setHeader(\"X-XSS-Protection\", \"1; mode=block\");\n+                response.setHeader(\"X-Content-Type-Options\", \"nosniff\");\n+                response.setHeader(\"X-Frame-Options\", \"sameorigin\");\n+            }\n+        });\n \n         mountPage(\"/login\", getSignInPageClass());\n "}]}