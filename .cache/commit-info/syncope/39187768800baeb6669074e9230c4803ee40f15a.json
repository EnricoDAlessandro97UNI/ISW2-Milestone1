{"sha":"39187768800baeb6669074e9230c4803ee40f15a","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjM5MTg3NzY4ODAwYmFlYjY2NjkwNzRlOTIzMGM0ODAzZWU0MGYxNWE=","commit":{"author":{"name":"Unknown","email":"unknown@apache.org","date":"2011-07-28T07:19:55Z"},"committer":{"name":"Unknown","email":"unknown@apache.org","date":"2011-07-28T07:19:55Z"},"message":"Added authorizations management to update and create tasks\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/syncope/trunk@1247052 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"691c57877bb8f9c93baed5d5d0e2aab4bd8622e5","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/691c57877bb8f9c93baed5d5d0e2aab4bd8622e5"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/39187768800baeb6669074e9230c4803ee40f15a","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/39187768800baeb6669074e9230c4803ee40f15a","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/39187768800baeb6669074e9230c4803ee40f15a","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/39187768800baeb6669074e9230c4803ee40f15a/comments","author":null,"committer":null,"parents":[{"sha":"cfacc242127da9543e32d1ee13716624da0aaa04","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/cfacc242127da9543e32d1ee13716624da0aaa04","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/cfacc242127da9543e32d1ee13716624da0aaa04"}],"stats":{"total":58,"additions":31,"deletions":27},"files":[{"sha":"06214a08803d4c3dc543ae36f2905266d5aecd13","filename":"console/src/main/java/org/syncope/console/pages/GenericTasks.java","status":"modified","additions":6,"deletions":9,"changes":15,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/39187768800baeb6669074e9230c4803ee40f15a/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FGenericTasks.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/39187768800baeb6669074e9230c4803ee40f15a/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FGenericTasks.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FGenericTasks.java?ref=39187768800baeb6669074e9230c4803ee40f15a","patch":"@@ -150,8 +150,7 @@ public Page createPage() {\n                 panel.add(viewLink);\n \n                 MetaDataRoleAuthorizationStrategy.authorize(panel, ENABLE,\n-                        xmlRolesReader.getAllAllowedRoles(\"Tasks\",\n-                        \"read\"));\n+                        xmlRolesReader.getAllAllowedRoles(\"Tasks\", \"read\"));\n \n                 cellItem.add(panel);\n             }\n@@ -226,11 +225,8 @@ public void onClick(final AjaxRequestTarget target) {\n                 DeleteLinkPanel panel = new DeleteLinkPanel(componentId, model);\n                 panel.add(deleteLink);\n \n-                String allowedRoles = xmlRolesReader.getAllAllowedRoles(\"Tasks\",\n-                        \"delete\");\n-\n                 MetaDataRoleAuthorizationStrategy.authorize(panel, ENABLE,\n-                        allowedRoles);\n+                        xmlRolesReader.getAllAllowedRoles(\"Tasks\", \"delete\"));\n \n                 cellItem.add(panel);\n             }\n@@ -308,9 +304,10 @@ public Page createPage() {\n                 window.show(target);\n             }\n         };\n-        MetaDataRoleAuthorizationStrategy.authorize(\n-                createLink, ENABLE, xmlRolesReader.getAllAllowedRoles(\n-                \"Tasks\", \"create\"));\n+\n+        MetaDataRoleAuthorizationStrategy.authorize(createLink, RENDER,\n+                xmlRolesReader.getAllAllowedRoles(\"Tasks\", \"create\"));\n+        \n         add(createLink);\n     }\n "},{"sha":"7d3e92d83807ab7ba7e8212890474f38f40c62f6","filename":"console/src/main/java/org/syncope/console/pages/PropagationTasks.java","status":"modified","additions":2,"deletions":6,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/39187768800baeb6669074e9230c4803ee40f15a/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FPropagationTasks.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/39187768800baeb6669074e9230c4803ee40f15a/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FPropagationTasks.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FPropagationTasks.java?ref=39187768800baeb6669074e9230c4803ee40f15a","patch":"@@ -158,8 +158,7 @@ public Page createPage() {\n                 panel.add(viewLink);\n \n                 MetaDataRoleAuthorizationStrategy.authorize(panel, ENABLE,\n-                        xmlRolesReader.getAllAllowedRoles(\"Tasks\",\n-                        \"read\"));\n+                        xmlRolesReader.getAllAllowedRoles(\"Tasks\", \"read\"));\n \n                 cellItem.add(panel);\n             }\n@@ -234,11 +233,8 @@ public void onClick(final AjaxRequestTarget target) {\n                 DeleteLinkPanel panel = new DeleteLinkPanel(componentId, model);\n                 panel.add(deleteLink);\n \n-                String allowedRoles = xmlRolesReader.getAllAllowedRoles(\"Tasks\",\n-                        \"delete\");\n-\n                 MetaDataRoleAuthorizationStrategy.authorize(panel, ENABLE,\n-                        allowedRoles);\n+                        xmlRolesReader.getAllAllowedRoles(\"Tasks\", \"delete\"));\n \n                 cellItem.add(panel);\n             }"},{"sha":"80b66013b128f0f33bdf73e9739bdf89d4f06920","filename":"console/src/main/java/org/syncope/console/pages/SchedTaskModalPage.java","status":"modified","additions":10,"deletions":0,"changes":10,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/39187768800baeb6669074e9230c4803ee40f15a/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FSchedTaskModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/39187768800baeb6669074e9230c4803ee40f15a/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FSchedTaskModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FSchedTaskModalPage.java?ref=39187768800baeb6669074e9230c4803ee40f15a","patch":"@@ -19,6 +19,7 @@\n import java.util.Arrays;\n import org.apache.wicket.ajax.AjaxRequestTarget;\n import org.apache.wicket.ajax.form.AjaxFormComponentUpdatingBehavior;\n+import org.apache.wicket.authorization.strategies.role.metadata.MetaDataRoleAuthorizationStrategy;\n import org.apache.wicket.extensions.ajax.markup.html.IndicatingAjaxButton;\n import org.apache.wicket.extensions.ajax.markup.html.modal.ModalWindow;\n import org.apache.wicket.markup.html.WebMarkupContainer;\n@@ -162,6 +163,15 @@ protected void onError(AjaxRequestTarget target, Form form) {\n             }\n         };\n \n+\n+        if (taskTO.getId() > 0) {\n+            MetaDataRoleAuthorizationStrategy.authorize(submit, RENDER,\n+                    xmlRolesReader.getAllAllowedRoles(\"Tasks\", \"update\"));\n+        } else {\n+            MetaDataRoleAuthorizationStrategy.authorize(submit, RENDER,\n+                    xmlRolesReader.getAllAllowedRoles(\"Tasks\", \"create\"));\n+        }\n+\n         form.add(submit);\n     }\n }"},{"sha":"a98ffb0f81ea1c07d24736e30b031bf9edb6d158","filename":"console/src/main/java/org/syncope/console/pages/SyncTasks.java","status":"modified","additions":6,"deletions":9,"changes":15,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/39187768800baeb6669074e9230c4803ee40f15a/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FSyncTasks.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/39187768800baeb6669074e9230c4803ee40f15a/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FSyncTasks.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FSyncTasks.java?ref=39187768800baeb6669074e9230c4803ee40f15a","patch":"@@ -150,8 +150,7 @@ public Page createPage() {\n                 panel.add(viewLink);\n \n                 MetaDataRoleAuthorizationStrategy.authorize(panel, ENABLE,\n-                        xmlRolesReader.getAllAllowedRoles(\"Tasks\",\n-                        \"read\"));\n+                        xmlRolesReader.getAllAllowedRoles(\"Tasks\", \"read\"));\n \n                 cellItem.add(panel);\n             }\n@@ -226,11 +225,8 @@ public void onClick(final AjaxRequestTarget target) {\n                 DeleteLinkPanel panel = new DeleteLinkPanel(componentId, model);\n                 panel.add(deleteLink);\n \n-                String allowedRoles = xmlRolesReader.getAllAllowedRoles(\"Tasks\",\n-                        \"delete\");\n-\n                 MetaDataRoleAuthorizationStrategy.authorize(panel, ENABLE,\n-                        allowedRoles);\n+                        xmlRolesReader.getAllAllowedRoles(\"Tasks\", \"delete\"));\n \n                 cellItem.add(panel);\n             }\n@@ -308,9 +304,10 @@ public Page createPage() {\n                 window.show(target);\n             }\n         };\n-        MetaDataRoleAuthorizationStrategy.authorize(\n-                createLink, ENABLE, xmlRolesReader.getAllAllowedRoles(\n-                \"Tasks\", \"create\"));\n+\n+        MetaDataRoleAuthorizationStrategy.authorize(createLink, RENDER,\n+                xmlRolesReader.getAllAllowedRoles(\"Tasks\", \"create\"));\n+\n         add(createLink);\n     }\n "},{"sha":"042dff269552baf6f1bdd7617bc2f4bd992091b3","filename":"console/src/main/resources/authorizations.xml","status":"modified","additions":7,"deletions":3,"changes":10,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/39187768800baeb6669074e9230c4803ee40f15a/console%2Fsrc%2Fmain%2Fresources%2Fauthorizations.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/39187768800baeb6669074e9230c4803ee40f15a/console%2Fsrc%2Fmain%2Fresources%2Fauthorizations.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Fauthorizations.xml?ref=39187768800baeb6669074e9230c4803ee40f15a","patch":"@@ -117,7 +117,7 @@ page@id= Schema|Users|Roles|Resources|Connectors|Report|Configuration|Task\n     </page>\n \n     <page id=\"Connectors\">\n-       <action id=\"list\">\n+        <action id=\"list\">\n             <entitlement>CONNECTOR_LIST</entitlement>\n         </action>\n \n@@ -143,7 +143,7 @@ page@id= Schema|Users|Roles|Resources|Connectors|Report|Configuration|Task\n     </page>\n \n     <page id=\"Configuration\">\n-       <action id=\"list\">\n+        <action id=\"list\">\n             <entitlement>CONFIGURATION_LIST</entitlement>\n         </action>\n \n@@ -165,7 +165,7 @@ page@id= Schema|Users|Roles|Resources|Connectors|Report|Configuration|Task\n     </page>\n \n     <page id=\"Tasks\">\n-       <action id=\"list\">\n+        <action id=\"list\">\n             <entitlement>TASK_LIST</entitlement>\n         </action>\n \n@@ -184,5 +184,9 @@ page@id= Schema|Users|Roles|Resources|Connectors|Report|Configuration|Task\n         <action id=\"create\">\n             <entitlement>TASK_CREATE</entitlement>\n         </action>\n+\n+        <action id=\"update\">\n+            <entitlement>TASK_UPDATE</entitlement>\n+        </action>\n     </page>\n </auth>"}]}