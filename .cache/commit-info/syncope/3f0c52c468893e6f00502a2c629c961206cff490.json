{"sha":"3f0c52c468893e6f00502a2c629c961206cff490","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjNmMGM1MmM0Njg4OTNlNmYwMDUwMmEyYzYyOWM5NjEyMDZjZmY0OTA=","commit":{"author":{"name":"dayash","email":"dima.ayash@tirasa.net","date":"2018-05-09T11:08:59Z"},"committer":{"name":"Francesco Chicchiricc√≤","email":"ilgrosso@apache.org","date":"2018-05-10T07:43:33Z"},"message":"[SYNCOPE-1270] OpenID Connect Logout implementation - This closes #75","tree":{"sha":"9f3c70d8e89a9d3d704f35e2531728dc11e3ca21","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/9f3c70d8e89a9d3d704f35e2531728dc11e3ca21"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/3f0c52c468893e6f00502a2c629c961206cff490","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/3f0c52c468893e6f00502a2c629c961206cff490","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/3f0c52c468893e6f00502a2c629c961206cff490","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/3f0c52c468893e6f00502a2c629c961206cff490/comments","author":{"login":"DimaAy","id":19169906,"node_id":"MDQ6VXNlcjE5MTY5OTA2","avatar_url":"https://avatars.githubusercontent.com/u/19169906?v=4","gravatar_id":"","url":"https://api.github.com/users/DimaAy","html_url":"https://github.com/DimaAy","followers_url":"https://api.github.com/users/DimaAy/followers","following_url":"https://api.github.com/users/DimaAy/following{/other_user}","gists_url":"https://api.github.com/users/DimaAy/gists{/gist_id}","starred_url":"https://api.github.com/users/DimaAy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/DimaAy/subscriptions","organizations_url":"https://api.github.com/users/DimaAy/orgs","repos_url":"https://api.github.com/users/DimaAy/repos","events_url":"https://api.github.com/users/DimaAy/events{/privacy}","received_events_url":"https://api.github.com/users/DimaAy/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"5d35c07484026da5d89fe7beb8f4cc4d27d7ff3c","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/5d35c07484026da5d89fe7beb8f4cc4d27d7ff3c","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/5d35c07484026da5d89fe7beb8f4cc4d27d7ff3c"}],"stats":{"total":577,"additions":513,"deletions":64},"files":[{"sha":"6925c0ef133f52e685b537b1dc4b72c5450de6fd","filename":"ext/oidcclient/agent/src/main/java/org/apache/syncope/ext/oidcclient/agent/BeforeLogout.java","status":"added","additions":65,"deletions":0,"changes":65,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Foidcclient%2Fagent%2FBeforeLogout.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Foidcclient%2Fagent%2FBeforeLogout.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Foidcclient%2Fagent%2FBeforeLogout.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -0,0 +1,65 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.ext.oidcclient.agent;\n+\n+import java.io.IOException;\n+import javax.servlet.ServletException;\n+import javax.servlet.annotation.WebServlet;\n+import javax.servlet.http.HttpServlet;\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import javax.ws.rs.core.HttpHeaders;\n+import javax.ws.rs.core.UriBuilder;\n+import org.apache.commons.lang3.StringUtils;\n+import org.apache.syncope.client.lib.SyncopeClient;\n+import org.apache.syncope.client.lib.SyncopeClientFactoryBean;\n+import org.apache.syncope.common.lib.OIDCConstants;\n+import org.apache.syncope.common.lib.to.OIDCLogoutRequestTO;\n+import org.apache.syncope.common.rest.api.service.OIDCClientService;\n+\n+@WebServlet(name = \"oidclientbeforelogout\", urlPatterns = { \"/oidcclient/beforelogout\" })\n+public class BeforeLogout extends HttpServlet {\n+\n+    private static final long serialVersionUID = -5920740403138557179L;\n+\n+    @Override\n+    protected void doGet(final HttpServletRequest request, final HttpServletResponse response)\n+            throws ServletException, IOException {\n+\n+        response.setHeader(HttpHeaders.CACHE_CONTROL, \"no-cache, no-store\");\n+        response.setHeader(\"Pragma\", \"no-cache\");\n+        response.setStatus(HttpServletResponse.SC_SEE_OTHER);\n+\n+        SyncopeClientFactoryBean clientFactory = (SyncopeClientFactoryBean) request.getServletContext().\n+                getAttribute(Constants.SYNCOPE_CLIENT_FACTORY);\n+        String accessToken = (String) request.getSession().getAttribute(Constants.OIDCCLIENTJWT);\n+        if (StringUtils.isBlank(accessToken)) {\n+            throw new IllegalArgumentException(\"No access token found \");\n+        }\n+        SyncopeClient client = clientFactory.create(accessToken);\n+        OIDCLogoutRequestTO requestTO = client.getService(OIDCClientService.class).\n+                createLogoutRequest(request.getSession().getAttribute(OIDCConstants.OP).toString());\n+\n+        String postLogoutRedirectURI = StringUtils.substringBefore(request.getRequestURL().toString(), \"/beforelogout\")\n+                + \"/logout\";\n+        UriBuilder ub = UriBuilder.fromUri(requestTO.getEndSessionEndpoint());\n+        ub.queryParam(OIDCConstants.POST_LOGOUT_REDIRECT_URI, postLogoutRedirectURI);\n+        response.setHeader(HttpHeaders.LOCATION, ub.build().toASCIIString());\n+    }\n+}"},{"sha":"20c39c4ca6d8c55049e5d445123e9c0e588d52e0","filename":"ext/oidcclient/agent/src/main/java/org/apache/syncope/ext/oidcclient/agent/CodeConsumer.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Foidcclient%2Fagent%2FCodeConsumer.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Foidcclient%2Fagent%2FCodeConsumer.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Foidcclient%2Fagent%2FCodeConsumer.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -69,7 +69,7 @@ protected void doGet(final HttpServletRequest request, final HttpServletResponse\n                     request.setAttribute(\"responseTO\", responseTO);\n                     request.getRequestDispatcher(\"loginSuccess.jsp\").forward(request, response);\n                 } else {\n-                    response.sendRedirect(successURL);\n+                    response.sendRedirect(successURL + \"?logoutSupported=\" + responseTO.isLogoutSupported());\n                 }\n             } else {\n                 throw new IllegalArgumentException(\"Invalid \" + OIDCConstants.STATE + \" provided\");"},{"sha":"988b7ccfbd85ac0beee684e9315eb2d1e4c14f13","filename":"ext/oidcclient/agent/src/main/java/org/apache/syncope/ext/oidcclient/agent/Constants.java","status":"modified","additions":4,"deletions":0,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Foidcclient%2Fagent%2FConstants.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Foidcclient%2Fagent%2FConstants.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Foidcclient%2Fagent%2FConstants.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -30,6 +30,10 @@ public final class Constants {\n \n     public static final String CONTEXT_PARAM_LOGIN_ERROR_URL = \"oidcclient.login.error.url\";\n \n+    public static final String CONTEXT_PARAM_LOGOUT_SUCCESS_URL = \"oidcclient.logout.success.url\";\n+\n+    public static final String CONTEXT_PARAM_LOGOUT_ERROR_URL = \"oidcclient.logout.error.url\";\n+\n     public static final String OIDCCLIENTJWT = \"oidcclient.jwt\";\n \n     public static final String OIDCCLIENTJWT_EXPIRE = \"oidcclient.jwt.expire\";"},{"sha":"e05f2f854d38a82e29692e71df49363f0ea034fc","filename":"ext/oidcclient/agent/src/main/java/org/apache/syncope/ext/oidcclient/agent/Login.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Foidcclient%2Fagent%2FLogin.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Foidcclient%2Fagent%2FLogin.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Foidcclient%2Fagent%2FLogin.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -70,7 +70,7 @@ protected void doGet(final HttpServletRequest request, final HttpServletResponse\n             ub.queryParam(OIDCConstants.RESPONSE_TYPE, requestTO.getResponseType());\n             ub.queryParam(OIDCConstants.SCOPE, requestTO.getScope());\n             ub.queryParam(OIDCConstants.STATE, requestTO.getState());\n-            response.setHeader(\"Location\", ub.build().toASCIIString());\n+            response.setHeader(HttpHeaders.LOCATION, ub.build().toASCIIString());\n         } catch (Exception e) {\n             LOG.error(\"While preparing the Authentication Request\", e);\n "},{"sha":"ab7151dfdeb65c3797b67085aa427bd5bd9f5ef8","filename":"ext/oidcclient/agent/src/main/java/org/apache/syncope/ext/oidcclient/agent/Logout.java","status":"added","additions":67,"deletions":0,"changes":67,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Foidcclient%2Fagent%2FLogout.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Foidcclient%2Fagent%2FLogout.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Foidcclient%2Fagent%2FLogout.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -0,0 +1,67 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.ext.oidcclient.agent;\n+\n+import java.io.IOException;\n+import java.net.URLEncoder;\n+import java.nio.charset.StandardCharsets;\n+import javax.servlet.ServletException;\n+import javax.servlet.annotation.WebServlet;\n+import javax.servlet.http.HttpServlet;\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+@WebServlet(name = \"oidcclientlogout\", urlPatterns = { \"/oidcclient/logout\" })\n+public class Logout extends HttpServlet {\n+\n+    private static final long serialVersionUID = 2383239908659843071L;\n+\n+    protected static final Logger LOG = LoggerFactory.getLogger(Logout.class);\n+\n+    @Override\n+    protected void doGet(final HttpServletRequest request, final HttpServletResponse response)\n+            throws ServletException, IOException {\n+\n+        try {\n+            String successURL = getServletContext().getInitParameter(Constants.CONTEXT_PARAM_LOGOUT_SUCCESS_URL);\n+            if (successURL == null) {\n+                request.getRequestDispatcher(\"logoutSuccess.jsp\").forward(request, response);\n+            } else {\n+                response.sendRedirect(successURL);\n+            }\n+            request.getSession().removeAttribute(Constants.OIDCCLIENTJWT);\n+        } catch (Exception e) {\n+            LOG.error(\"While processing authentication response from IdP\", e);\n+\n+            String errorURL = getServletContext().getInitParameter(Constants.CONTEXT_PARAM_LOGOUT_ERROR_URL);\n+            if (errorURL == null) {\n+                request.setAttribute(\"exception\", e);\n+                request.getRequestDispatcher(\"logoutError.jsp\").forward(request, response);\n+\n+                e.printStackTrace(response.getWriter());\n+            } else {\n+                response.sendRedirect(errorURL + \"?errorMessage=\"\n+                        + URLEncoder.encode(e.getMessage(), StandardCharsets.UTF_8.name()));\n+            }\n+        }\n+    }\n+\n+}"},{"sha":"df0cb3df888116322e001182e0679cc04c361bb7","filename":"ext/oidcclient/agent/src/main/resources/META-INF/resources/oidcclient/logoutError.jsp","status":"added","additions":35,"deletions":0,"changes":35,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fagent%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Foidcclient%2FlogoutError.jsp","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fagent%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Foidcclient%2FlogoutError.jsp","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fagent%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Foidcclient%2FlogoutError.jsp?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -0,0 +1,35 @@\n+<%--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+--%>\n+<%@page contentType=\"text/html; charset=UTF-8\" pageEncoding=\"UTF-8\"%>\n+<%\n+    Exception exception = (Exception) request.getAttribute(\"exception\");\n+%>\n+<html>\n+  <head>\n+    <title>Apache Syncope ${syncope.version} - OIDC CLIENT - Logout Error</title>\n+  </head>\n+  <body>\n+    <h1>An error was found</h1>\n+\n+    <h2><%=exception.getMessage()%></h2>\n+    <pre>\n+      <%exception.printStackTrace(new java.io.PrintWriter(out));%>\n+    </pre>\n+  </body>\n+</html>\n\\ No newline at end of file"},{"sha":"ecbdc77088f65bd7b27ee345616bf19036b20df2","filename":"ext/oidcclient/agent/src/main/resources/META-INF/resources/oidcclient/logoutSuccess.jsp","status":"added","additions":27,"deletions":0,"changes":27,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fagent%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Foidcclient%2FlogoutSuccess.jsp","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fagent%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Foidcclient%2FlogoutSuccess.jsp","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fagent%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Foidcclient%2FlogoutSuccess.jsp?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -0,0 +1,27 @@\n+<%--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+--%>\n+<%@page contentType=\"text/html; charset=UTF-8\" pageEncoding=\"UTF-8\"%>\n+<html>\n+  <head>\n+    <title>Apache Syncope ${syncope.version} - OIDC CLIENT - Successful Logout</title>\n+  </head>\n+  <body>\n+    <h1>You have been successfully logged out.</h1>\n+  </body>\n+</html>\n\\ No newline at end of file"},{"sha":"0a5a766319081d87c88c852f69d5a68af581d964","filename":"ext/oidcclient/client-console/src/main/java/org/apache/syncope/client/console/pages/OIDCClientBeforeLogout.java","status":"added","additions":36,"deletions":0,"changes":36,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpages%2FOIDCClientBeforeLogout.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpages%2FOIDCClientBeforeLogout.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpages%2FOIDCClientBeforeLogout.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -0,0 +1,36 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.client.console.pages;\n+\n+import org.apache.wicket.markup.html.WebPage;\n+import org.apache.wicket.request.UrlUtils;\n+import org.apache.wicket.request.cycle.RequestCycle;\n+import org.apache.wicket.request.http.handler.RedirectRequestHandler;\n+\n+public class OIDCClientBeforeLogout extends WebPage {\n+\n+    private static final long serialVersionUID = 4666948447239743855L;\n+\n+    public OIDCClientBeforeLogout() {\n+        super();\n+\n+        RequestCycle.get().scheduleRequestHandlerAfterCurrent(new RedirectRequestHandler(\n+                UrlUtils.rewriteToContextRelative(\"oidcclient/beforelogout\", RequestCycle.get())));\n+    }\n+}"},{"sha":"af979d7546871974b13d2405e6130f51230d137e","filename":"ext/oidcclient/client-console/src/main/java/org/apache/syncope/client/console/pages/OIDCClientLogin.java","status":"modified","additions":5,"deletions":0,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpages%2FOIDCClientLogin.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpages%2FOIDCClientLogin.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpages%2FOIDCClientLogin.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -52,6 +52,11 @@ public OIDCClientLogin(final PageParameters parameters) {\n         IAuthenticationStrategy strategy = getApplication().getSecuritySettings().getAuthenticationStrategy();\n \n         if (SyncopeConsoleSession.get().authenticate(token)) {\n+            if (parameters.get(\"logoutSupported\").toBoolean(false)) {\n+                SyncopeConsoleSession.get().setAttribute(\n+                        org.apache.syncope.client.console.commons.Constants.BEFORE_LOGOUT_PAGE,\n+                        OIDCClientBeforeLogout.class);\n+            }\n \n             // If login has been called because the user was not yet logged in, than continue to the\n             // original destination, otherwise to the Home page"},{"sha":"e13b40c451ea4cf869c8bb7e5723f3e963a652e8","filename":"ext/oidcclient/client-console/src/main/java/org/apache/syncope/client/console/pages/OIDCClientLogout.java","status":"added","additions":38,"deletions":0,"changes":38,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpages%2FOIDCClientLogout.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpages%2FOIDCClientLogout.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpages%2FOIDCClientLogout.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -0,0 +1,38 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.client.console.pages;\n+\n+import org.apache.syncope.client.console.SyncopeConsoleSession;\n+import org.apache.wicket.markup.html.WebPage;\n+\n+public class OIDCClientLogout extends WebPage {\n+\n+    private static final long serialVersionUID = -4862264444058746154L;\n+\n+    public OIDCClientLogout() {\n+        super();\n+\n+        SyncopeConsoleSession.get().cleanup();\n+\n+        SyncopeConsoleSession.get().invalidate();\n+\n+        setResponsePage(getApplication().getHomePage());\n+    }\n+\n+}"},{"sha":"9fec11b7010e8f5d1e8dbdf4de57358b469ebec9","filename":"ext/oidcclient/client-console/src/main/java/org/apache/syncope/client/console/wizards/OIDCProviderWizardBuilder.java","status":"modified","additions":12,"deletions":1,"changes":13,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FOIDCProviderWizardBuilder.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FOIDCProviderWizardBuilder.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FOIDCProviderWizardBuilder.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -180,7 +180,6 @@ public OPContinue(final OIDCProviderTO opTO) {\n \n             final AjaxTextFieldPanel userinfoEndpoint = new AjaxTextFieldPanel(\"userinfoEndpoint\",\n                     \"userinfoEndpoint\", new PropertyModel<String>(opTO, \"userinfoEndpoint\"));\n-            userinfoEndpoint.addRequiredLabel();\n             userinfoEndpoint.addValidator(urlValidator);\n             content.add(userinfoEndpoint);\n \n@@ -196,12 +195,18 @@ public OPContinue(final OIDCProviderTO opTO) {\n             jwksUri.addValidator(urlValidator);\n             content.add(jwksUri);\n \n+            final AjaxTextFieldPanel endSessionEndpoint = new AjaxTextFieldPanel(\"endSessionEndpoint\",\n+                    \"endSessionEndpoint\", new PropertyModel<String>(opTO, \"endSessionEndpoint\"));\n+            endSessionEndpoint.addValidator(urlValidator);\n+            content.add(endSessionEndpoint);\n+\n             final WebMarkupContainer visibleParam = new WebMarkupContainer(\"visibleParams\");\n             visibleParam.setOutputMarkupPlaceholderTag(true);\n             visibleParam.add(authorizationEndpoint);\n             visibleParam.add(userinfoEndpoint);\n             visibleParam.add(tokenEndpoint);\n             visibleParam.add(jwksUri);\n+            visibleParam.add(endSessionEndpoint);\n             content.add(visibleParam);\n \n             showHide(hasDiscovery, visibleParam);\n@@ -256,12 +261,18 @@ public OPContinue(final OIDCProviderTO opTO, final boolean readOnly) {\n             jwksUri.setReadOnly(readOnly);\n             content.add(jwksUri);\n \n+            final AjaxTextFieldPanel endSessionEndpoint = new AjaxTextFieldPanel(\"endSessionEndpoint\",\n+                    \"endSessionEndpoint\", new PropertyModel<String>(opTO, \"endSessionEndpoint\"));\n+            endSessionEndpoint.setReadOnly(readOnly);\n+            content.add(endSessionEndpoint);\n+\n             final WebMarkupContainer visibleParam = new WebMarkupContainer(\"visibleParams\");\n             visibleParam.setOutputMarkupPlaceholderTag(true);\n             visibleParam.add(authorizationEndpoint);\n             visibleParam.add(userinfoEndpoint);\n             visibleParam.add(tokenEndpoint);\n             visibleParam.add(jwksUri);\n+            visibleParam.add(endSessionEndpoint);\n             content.add(visibleParam);\n         }\n     }"},{"sha":"0f8de216f477d353354c679bd547f9306dbe095c","filename":"ext/oidcclient/client-console/src/main/resources/org/apache/syncope/client/console/wizards/OIDCProviderWizardBuilder$OPContinue.html","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FOIDCProviderWizardBuilder%24OPContinue.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FOIDCProviderWizardBuilder%24OPContinue.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FOIDCProviderWizardBuilder%24OPContinue.html?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -27,6 +27,7 @@\n         <span wicket:id=\"tokenEndpoint\">[tokenEndpoint]</span>\n         <span wicket:id=\"jwksUri\">[jwksUri]</span>\n         <span wicket:id=\"userinfoEndpoint\">[userinfoEndpoint]</span>\n+        <span wicket:id=\"endSessionEndpoint\">[endSessionEndpoint]</span>\n       </div>\n     </div>\n   </wicket:panel>"},{"sha":"d41462e2f92a2ccf6115703a5b54cd38de471ea6","filename":"ext/oidcclient/client-console/src/main/resources/org/apache/syncope/client/console/wizards/OIDCProviderWizardBuilder$OPContinue.properties","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FOIDCProviderWizardBuilder%24OPContinue.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FOIDCProviderWizardBuilder%24OPContinue.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FOIDCProviderWizardBuilder%24OPContinue.properties?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -20,6 +20,8 @@ authorizationEndpoint= Authorization Endpoint\n userinfoEndpoint= Userinfo Endpoint\n tokenEndpoint= Token Endpoint\n jwksUri= JWKS URI\n+endSessionEndpoint= EndSession Endpoint\n+\n \n \n "},{"sha":"d41462e2f92a2ccf6115703a5b54cd38de471ea6","filename":"ext/oidcclient/client-console/src/main/resources/org/apache/syncope/client/console/wizards/OIDCProviderWizardBuilder$OPContinue_it.properties","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FOIDCProviderWizardBuilder%24OPContinue_it.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FOIDCProviderWizardBuilder%24OPContinue_it.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FOIDCProviderWizardBuilder%24OPContinue_it.properties?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -20,6 +20,8 @@ authorizationEndpoint= Authorization Endpoint\n userinfoEndpoint= Userinfo Endpoint\n tokenEndpoint= Token Endpoint\n jwksUri= JWKS URI\n+endSessionEndpoint= EndSession Endpoint\n+\n \n \n "},{"sha":"d41462e2f92a2ccf6115703a5b54cd38de471ea6","filename":"ext/oidcclient/client-console/src/main/resources/org/apache/syncope/client/console/wizards/OIDCProviderWizardBuilder$OPContinue_pt_BR.properties","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FOIDCProviderWizardBuilder%24OPContinue_pt_BR.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FOIDCProviderWizardBuilder%24OPContinue_pt_BR.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FOIDCProviderWizardBuilder%24OPContinue_pt_BR.properties?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -20,6 +20,8 @@ authorizationEndpoint= Authorization Endpoint\n userinfoEndpoint= Userinfo Endpoint\n tokenEndpoint= Token Endpoint\n jwksUri= JWKS URI\n+endSessionEndpoint= EndSession Endpoint\n+\n \n \n "},{"sha":"d41462e2f92a2ccf6115703a5b54cd38de471ea6","filename":"ext/oidcclient/client-console/src/main/resources/org/apache/syncope/client/console/wizards/OIDCProviderWizardBuilder$OPContinue_ru.properties","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FOIDCProviderWizardBuilder%24OPContinue_ru.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FOIDCProviderWizardBuilder%24OPContinue_ru.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FOIDCProviderWizardBuilder%24OPContinue_ru.properties?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -20,6 +20,8 @@ authorizationEndpoint= Authorization Endpoint\n userinfoEndpoint= Userinfo Endpoint\n tokenEndpoint= Token Endpoint\n jwksUri= JWKS URI\n+endSessionEndpoint= EndSession Endpoint\n+\n \n \n "},{"sha":"fd22b0ed72e37248f05543528cac56c8b96813bf","filename":"ext/oidcclient/client-enduser/src/main/java/org/apache/syncope/client/enduser/pages/OIDCClientBeforeLogout.java","status":"added","additions":36,"deletions":0,"changes":36,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-enduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FOIDCClientBeforeLogout.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-enduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FOIDCClientBeforeLogout.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fclient-enduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FOIDCClientBeforeLogout.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -0,0 +1,36 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.client.enduser.pages;\n+\n+import org.apache.wicket.markup.html.WebPage;\n+import org.apache.wicket.request.UrlUtils;\n+import org.apache.wicket.request.cycle.RequestCycle;\n+import org.apache.wicket.request.http.handler.RedirectRequestHandler;\n+\n+public class OIDCClientBeforeLogout extends WebPage {\n+\n+    private static final long serialVersionUID = 4666948447239743855L;\n+\n+    public OIDCClientBeforeLogout() {\n+        super();\n+\n+        RequestCycle.get().scheduleRequestHandlerAfterCurrent(new RedirectRequestHandler(\n+                UrlUtils.rewriteToContextRelative(\"oidcclient/beforelogout\", RequestCycle.get())));\n+    }\n+}"},{"sha":"a6c712acd57c9db25940640d668acf2ec4ca97c7","filename":"ext/oidcclient/client-enduser/src/main/java/org/apache/syncope/client/enduser/pages/OIDCClientLogin.java","status":"modified","additions":5,"deletions":0,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-enduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FOIDCClientLogin.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-enduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FOIDCClientLogin.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fclient-enduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FOIDCClientLogin.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -20,6 +20,7 @@\n \n import org.apache.commons.lang3.StringUtils;\n import org.apache.syncope.client.enduser.SyncopeEnduserSession;\n+import org.apache.syncope.client.enduser.commons.Constants;\n import org.apache.wicket.authentication.IAuthenticationStrategy;\n import org.apache.wicket.markup.html.WebPage;\n import org.apache.wicket.protocol.http.servlet.ServletWebRequest;\n@@ -51,6 +52,10 @@ public OIDCClientLogin(final PageParameters parameters) {\n         IAuthenticationStrategy strategy = getApplication().getSecuritySettings().getAuthenticationStrategy();\n \n         if (SyncopeEnduserSession.get().authenticate(token)) {\n+            if (parameters.get(\"logoutSupported\").toBoolean(false)) {\n+                SyncopeEnduserSession.get().setAttribute(Constants.BEFORE_LOGOUT, OIDCClientBeforeLogout.class);\n+            }\n+\n             setResponsePage(getApplication().getHomePage());\n         } else {\n             PageParameters params = new PageParameters();"},{"sha":"4a8900073e56c1c19bd3bef406c1fa6b8c3fa896","filename":"ext/oidcclient/client-enduser/src/main/java/org/apache/syncope/client/enduser/pages/OIDCClientLogout.java","status":"added","additions":36,"deletions":0,"changes":36,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-enduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FOIDCClientLogout.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fclient-enduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FOIDCClientLogout.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fclient-enduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FOIDCClientLogout.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -0,0 +1,36 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.client.enduser.pages;\n+\n+import org.apache.syncope.client.enduser.SyncopeEnduserSession;\n+import org.apache.wicket.markup.html.WebPage;\n+import org.apache.wicket.request.mapper.parameter.PageParameters;\n+\n+public class OIDCClientLogout extends WebPage {\n+\n+    private static final long serialVersionUID = -1453838909720946011L;\n+\n+    public OIDCClientLogout(final PageParameters parameters) {\n+        super(parameters);\n+\n+        SyncopeEnduserSession.get().invalidateNow();\n+\n+        setResponsePage(getApplication().getHomePage());\n+    }\n+}"},{"sha":"78b00b62facf9516eaf265d3effb97b5c5f89fad","filename":"ext/oidcclient/common-lib/src/main/java/org/apache/syncope/common/lib/OIDCConstants.java","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fcommon-lib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2FOIDCConstants.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fcommon-lib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2FOIDCConstants.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fcommon-lib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2FOIDCConstants.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -29,6 +29,8 @@ public final class OIDCConstants {\n     public static final String RESPONSE_TYPE = \"response_type\";\n \n     public static final String STATE = \"state\";\n+    \n+    public static final String POST_LOGOUT_REDIRECT_URI = \"post_logout_redirect_uri\";\n \n     public static final String REDIRECT_URI = \"redirect_uri\";\n "},{"sha":"7b670c4bb9e9452cb5500637076003b9bb515402","filename":"ext/oidcclient/common-lib/src/main/java/org/apache/syncope/common/lib/to/OIDCLoginResponseTO.java","status":"modified","additions":5,"deletions":45,"changes":50,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fcommon-lib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2Fto%2FOIDCLoginResponseTO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fcommon-lib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2Fto%2FOIDCLoginResponseTO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fcommon-lib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2Fto%2FOIDCLoginResponseTO.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -38,15 +38,7 @@ public class OIDCLoginResponseTO extends AbstractBaseBean {\n \n     private String username;\n \n-    private String email;\n-\n-    private String name;\n-\n-    private String subject;\n-\n-    private String givenName;\n-\n-    private String familyName;\n+    private boolean logoutSupported;\n \n     private String accessToken;\n \n@@ -62,44 +54,12 @@ public void setUsername(final String username) {\n         this.username = username;\n     }\n \n-    public String getEmail() {\n-        return email;\n-    }\n-\n-    public void setEmail(final String email) {\n-        this.email = email;\n-    }\n-\n-    public String getName() {\n-        return name;\n-    }\n-\n-    public void setName(final String name) {\n-        this.name = name;\n-    }\n-\n-    public String getSubject() {\n-        return subject;\n-    }\n-\n-    public void setSubject(final String subject) {\n-        this.subject = subject;\n-    }\n-\n-    public String getGivenName() {\n-        return givenName;\n-    }\n-\n-    public void setGivenName(final String givenName) {\n-        this.givenName = givenName;\n-    }\n-\n-    public String getFamilyName() {\n-        return familyName;\n+    public boolean isLogoutSupported() {\n+        return logoutSupported;\n     }\n \n-    public void setFamilyName(final String familyName) {\n-        this.familyName = familyName;\n+    public void setLogoutSupported(final boolean logoutSupported) {\n+        this.logoutSupported = logoutSupported;\n     }\n \n     public String getAccessToken() {"},{"sha":"80d83a16e7b7702495b55836f5353af0f340fa1d","filename":"ext/oidcclient/common-lib/src/main/java/org/apache/syncope/common/lib/to/OIDCLogoutRequestTO.java","status":"added","additions":41,"deletions":0,"changes":41,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fcommon-lib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2Fto%2FOIDCLogoutRequestTO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fcommon-lib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2Fto%2FOIDCLogoutRequestTO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fcommon-lib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2Fto%2FOIDCLogoutRequestTO.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -0,0 +1,41 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.common.lib.to;\n+\n+import javax.xml.bind.annotation.XmlRootElement;\n+import javax.xml.bind.annotation.XmlType;\n+import org.apache.syncope.common.lib.AbstractBaseBean;\n+\n+@XmlRootElement(name = \"oidcLogoutRequest\")\n+@XmlType\n+public class OIDCLogoutRequestTO extends AbstractBaseBean {\n+\n+    private static final long serialVersionUID = -4708360216757961537L;\n+\n+    private String endSessionEndpoint;\n+\n+    public String getEndSessionEndpoint() {\n+        return endSessionEndpoint;\n+    }\n+\n+    public void setEndSessionEndpoint(final String endSessionEndpoint) {\n+        this.endSessionEndpoint = endSessionEndpoint;\n+    }\n+\n+}"},{"sha":"86f55352d1d989baeee34acca3ed3aadce48c28b","filename":"ext/oidcclient/common-lib/src/main/java/org/apache/syncope/common/lib/to/OIDCProviderTO.java","status":"modified","additions":10,"deletions":0,"changes":10,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fcommon-lib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2Fto%2FOIDCProviderTO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fcommon-lib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2Fto%2FOIDCProviderTO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fcommon-lib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2Fto%2FOIDCProviderTO.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -54,6 +54,8 @@ public class OIDCProviderTO extends AbstractBaseBean implements EntityTO, ItemCo\n \n     private String userinfoEndpoint;\n \n+    private String endSessionEndpoint;\n+\n     private boolean hasDiscovery;\n \n     private UserTO userTemplate;\n@@ -141,6 +143,14 @@ public void setUserinfoEndpoint(final String userinfoEndpoint) {\n         this.userinfoEndpoint = userinfoEndpoint;\n     }\n \n+    public String getEndSessionEndpoint() {\n+        return endSessionEndpoint;\n+    }\n+\n+    public void setEndSessionEndpoint(final String endSessionEndpoint) {\n+        this.endSessionEndpoint = endSessionEndpoint;\n+    }\n+\n     public UserTO getUserTemplate() {\n         return userTemplate;\n     }"},{"sha":"8a985857dee4904af5bcf5f6204b777557dd2e57","filename":"ext/oidcclient/logic/src/main/java/org/apache/syncope/core/logic/OIDCClientLogic.java","status":"modified","additions":20,"deletions":14,"changes":34,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FOIDCClientLogic.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FOIDCClientLogic.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FOIDCClientLogic.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -41,6 +41,7 @@\n import org.apache.cxf.rs.security.oauth2.client.Consumer;\n import org.apache.cxf.rs.security.oauth2.common.ClientAccessToken;\n import org.apache.cxf.rs.security.oauth2.utils.OAuthConstants;\n+import org.apache.cxf.rs.security.oidc.common.AbstractUserInfo;\n import org.apache.cxf.rs.security.oidc.common.IdToken;\n import org.apache.cxf.rs.security.oidc.common.UserInfo;\n import org.apache.cxf.rs.security.oidc.rp.IdTokenReader;\n@@ -50,6 +51,7 @@\n import org.apache.syncope.common.lib.to.AttrTO;\n import org.apache.syncope.common.lib.to.OIDCLoginRequestTO;\n import org.apache.syncope.common.lib.to.OIDCLoginResponseTO;\n+import org.apache.syncope.common.lib.to.OIDCLogoutRequestTO;\n import org.apache.syncope.common.lib.types.CipherAlgorithm;\n import org.apache.syncope.common.lib.types.ClientExceptionType;\n import org.apache.syncope.common.lib.types.StandardEntitlement;\n@@ -146,24 +148,22 @@ public OIDCLoginResponseTO login(final String redirectURI, final String authoriz\n             throw sce;\n         }\n \n-        // 1. get OpenID Connect tokens\n         Consumer consumer = new Consumer(op.getClientID(), op.getClientSecret());\n \n         // 2. validate token\n         LOG.debug(\"Id Token to be validated: {}\", tokenEndpointResponse.getIdToken());\n         IdToken idToken = getValidatedIdToken(op, consumer, tokenEndpointResponse.getIdToken());\n \n-        // 3. extract user information\n-        UserInfo userInfo = getUserInfo(op, tokenEndpointResponse.getAccessToken(), idToken, consumer);\n-\n-        // 4. prepare the result: find matching user (if any) and return the received attributes\n+        // 3. prepare the result:\n         final OIDCLoginResponseTO responseTO = new OIDCLoginResponseTO();\n-        responseTO.setEmail(userInfo.getEmail());\n-        responseTO.setFamilyName(userInfo.getFamilyName());\n-        responseTO.setGivenName(userInfo.getGivenName());\n-        responseTO.setName(userInfo.getName());\n-        responseTO.setSubject(userInfo.getSubject());\n+        responseTO.setLogoutSupported(StringUtils.isNotBlank(op.getEndSessionEndpoint()));\n+\n+        // 3a. extract user info from userInfoEndpoint if exists otherwise from idToken\n+        AbstractUserInfo userInfo = StringUtils.isBlank(op.getUserinfoEndpoint())\n+                ? idToken\n+                : getUserInfo(op.getUserinfoEndpoint(), tokenEndpointResponse.getAccessToken(), idToken, consumer);\n \n+        // 3b. find matching user (if any) and return the received attributes\n         String keyValue = userInfo.getEmail();\n         for (OIDCProviderItem item : op.getItems()) {\n             AttrTO attrTO = new AttrTO();\n@@ -335,7 +335,7 @@ public OIDCLoginResponseTO login(final String redirectURI, final String authoriz\n \n         responseTO.setUsername(username);\n \n-        // 5. generate JWT for further access\n+        // 4. generate JWT for further access\n         Map<String, Object> claims = new HashMap<>();\n         claims.put(JWT_CLAIM_OP_ENTITYID, idToken.getIssuer());\n         claims.put(JWT_CLAIM_USERID, idToken.getSubject());\n@@ -393,13 +393,12 @@ private IdToken getValidatedIdToken(final OIDCProvider op, final Consumer consum\n     }\n \n     private UserInfo getUserInfo(\n-            final OIDCProvider op,\n+            final String endpoint,\n             final String accessToken,\n             final IdToken idToken,\n             final Consumer consumer) {\n \n-        WebClient userInfoServiceClient = WebClient.create(\n-                op.getUserinfoEndpoint(), Arrays.asList(new JsonMapObjectProvider())).\n+        WebClient userInfoServiceClient = WebClient.create(endpoint, Arrays.asList(new JsonMapObjectProvider())).\n                 accept(MediaType.APPLICATION_JSON);\n         ClientAccessToken clientAccessToken =\n                 new ClientAccessToken(OAuthConstants.BEARER_AUTHORIZATION_SCHEME, accessToken);\n@@ -417,6 +416,13 @@ private UserInfo getUserInfo(\n         return userInfo;\n     }\n \n+    @PreAuthorize(\"isAuthenticated() and not(hasRole('\" + StandardEntitlement.ANONYMOUS + \"'))\")\n+    public OIDCLogoutRequestTO createLogoutRequest(final String op) {\n+        OIDCLogoutRequestTO logoutRequest = new OIDCLogoutRequestTO();\n+        logoutRequest.setEndSessionEndpoint(getOIDCProvider(op).getEndSessionEndpoint());\n+        return logoutRequest;\n+    }\n+\n     @Override\n     protected AbstractBaseBean resolveReference(\n             final Method method, final Object... args) throws UnresolvedReferenceException {"},{"sha":"6ad664931dd61ed0e15f67886eb745264bfb5fe9","filename":"ext/oidcclient/logic/src/main/java/org/apache/syncope/core/logic/OIDCProviderLogic.java","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FOIDCProviderLogic.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FOIDCProviderLogic.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FOIDCProviderLogic.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -76,6 +76,7 @@ public String createFromDiscovery(final OIDCProviderTO opTO) {\n         opTO.setJwksUri(discoveryDocument.getJwksUri());\n         opTO.setTokenEndpoint(discoveryDocument.getTokenEndpoint());\n         opTO.setUserinfoEndpoint(discoveryDocument.getUserinfoEndpoint());\n+        opTO.setEndSessionEndpoint(discoveryDocument.getEndSessionEndpoint());\n \n         return create(opTO);\n     }"},{"sha":"585ba9a0a1b70a5d34cdceb63b64983fe0f27008","filename":"ext/oidcclient/persistence-api/src/main/java/org/apache/syncope/core/persistence/api/entity/OIDCProvider.java","status":"modified","additions":4,"deletions":0,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fpersistence-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fapi%2Fentity%2FOIDCProvider.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fpersistence-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fapi%2Fentity%2FOIDCProvider.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fpersistence-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fapi%2Fentity%2FOIDCProvider.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -55,6 +55,10 @@ public interface OIDCProvider extends Entity {\n     String getUserinfoEndpoint();\n \n     void setUserinfoEndpoint(String userinfoEndpoint);\n+    \n+    String getEndSessionEndpoint();\n+\n+    void setEndSessionEndpoint(String endSessionEndpoint);\n \n     boolean getHasDiscovery();\n "},{"sha":"9a7224fd96f3a6727ff90491751da28cc40bbe1b","filename":"ext/oidcclient/persistence-jpa/src/main/java/org/apache/syncope/core/persistence/jpa/entity/JPAOIDCProvider.java","status":"modified","additions":14,"deletions":1,"changes":15,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fpersistence-jpa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fentity%2FJPAOIDCProvider.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fpersistence-jpa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fentity%2FJPAOIDCProvider.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fpersistence-jpa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fentity%2FJPAOIDCProvider.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -70,8 +70,11 @@ public class JPAOIDCProvider extends AbstractGeneratedKeyEntity implements OIDCP\n     @Column(nullable = false)\n     private String issuer;\n \n-    @Column(nullable = false)\n+    @Column(nullable = true)\n     private String userinfoEndpoint;\n+    \n+    @Column(nullable = true)\n+    private String endSessionEndpoint;\n \n     @Column(nullable = false)\n     private boolean hasDiscovery;\n@@ -178,6 +181,16 @@ public String getUserinfoEndpoint() {\n     public void setUserinfoEndpoint(final String userinfoEndpoint) {\n         this.userinfoEndpoint = userinfoEndpoint;\n     }\n+    \n+    @Override\n+    public String getEndSessionEndpoint() {\n+        return endSessionEndpoint;\n+    }\n+\n+    @Override\n+    public void setEndSessionEndpoint(final String endSessionEndpoint) {\n+        this.endSessionEndpoint = endSessionEndpoint;\n+    }\n \n     @Override\n     public boolean getHasDiscovery() {"},{"sha":"e2370bbc148a437870b2200b8244320b84ec3579","filename":"ext/oidcclient/provisioning-java/src/main/java/org/apache/syncope/core/provisioning/java/data/OIDCProviderDataBinderImpl.java","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fdata%2FOIDCProviderDataBinderImpl.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fdata%2FOIDCProviderDataBinderImpl.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fdata%2FOIDCProviderDataBinderImpl.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -178,6 +178,7 @@ public OIDCProvider update(final OIDCProvider op, final OIDCProviderTO opTO) {\n         op.setJwksUri(opTO.getJwksUri());\n         op.setTokenEndpoint(opTO.getTokenEndpoint());\n         op.setUserinfoEndpoint(opTO.getUserinfoEndpoint());\n+        op.setEndSessionEndpoint(opTO.getEndSessionEndpoint());\n         op.setHasDiscovery(opTO.getHasDiscovery());\n         op.setCreateUnmatching(opTO.isCreateUnmatching());\n         op.setUpdateMatching(opTO.isUpdateMatching());\n@@ -241,6 +242,7 @@ public OIDCProviderTO getOIDCProviderTO(final OIDCProvider op) {\n         opTO.setJwksUri(op.getJwksUri());\n         opTO.setTokenEndpoint(op.getTokenEndpoint());\n         opTO.setUserinfoEndpoint(op.getUserinfoEndpoint());\n+        opTO.setEndSessionEndpoint(op.getEndSessionEndpoint());\n         opTO.setHasDiscovery(op.getHasDiscovery());\n         opTO.setCreateUnmatching(op.isCreateUnmatching());\n         opTO.setUpdateMatching(op.isUpdateMatching());"},{"sha":"eda848a684829c18fc539415404a314674f5709f","filename":"ext/oidcclient/rest-api/src/main/java/org/apache/syncope/common/rest/api/service/OIDCClientService.java","status":"modified","additions":12,"deletions":0,"changes":12,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Frest-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Frest%2Fapi%2Fservice%2FOIDCClientService.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Frest-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Frest%2Fapi%2Fservice%2FOIDCClientService.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Frest-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Frest%2Fapi%2Fservice%2FOIDCClientService.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -30,6 +30,7 @@\n import org.apache.syncope.common.lib.SyncopeConstants;\n import org.apache.syncope.common.lib.to.OIDCLoginRequestTO;\n import org.apache.syncope.common.lib.to.OIDCLoginResponseTO;\n+import org.apache.syncope.common.lib.to.OIDCLogoutRequestTO;\n \n /**\n  * REST operations for OpenID Connect Clients.\n@@ -72,4 +73,15 @@ OIDCLoginResponseTO login(\n             @QueryParam(\"authorizationCode\") String authorizationCode,\n             @QueryParam(OIDCConstants.OP) String op);\n \n+    /**\n+     * Returns the endSession endpoint for the provided op.\n+     *\n+     * @param op OpenID Connect Provider\n+     * @return endSession endpoint for the provided op\n+     */\n+    @POST\n+    @Path(\"logout\")\n+    @Produces({ MediaType.APPLICATION_JSON, SyncopeConstants.APPLICATION_YAML, MediaType.APPLICATION_XML })\n+    OIDCLogoutRequestTO createLogoutRequest(@QueryParam(OIDCConstants.OP) String op);\n+\n }"},{"sha":"f86de45dc385db54fdc2e2a1247554501f217a24","filename":"ext/oidcclient/rest-cxf/src/main/java/org/apache/syncope/core/rest/cxf/service/OIDCClientServiceImpl.java","status":"modified","additions":6,"deletions":0,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Frest-cxf%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2Fcxf%2Fservice%2FOIDCClientServiceImpl.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Foidcclient%2Frest-cxf%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2Fcxf%2Fservice%2FOIDCClientServiceImpl.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Foidcclient%2Frest-cxf%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2Fcxf%2Fservice%2FOIDCClientServiceImpl.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -24,6 +24,7 @@\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.stereotype.Service;\n import org.apache.syncope.common.lib.to.OIDCLoginResponseTO;\n+import org.apache.syncope.common.lib.to.OIDCLogoutRequestTO;\n \n @Service\n public class OIDCClientServiceImpl extends AbstractServiceImpl implements OIDCClientService {\n@@ -41,4 +42,9 @@ public OIDCLoginResponseTO login(final String redirectURI, final String authoriz\n         return logic.login(redirectURI, authorizationCode, op);\n     }\n \n+    @Override\n+    public OIDCLogoutRequestTO createLogoutRequest(final String op) {\n+        return logic.createLogoutRequest(op);\n+    }\n+\n }"},{"sha":"574d91eb469dd5007003b3b376547e96f8a8bc22","filename":"ext/saml2sp/agent/src/main/java/org/apache/syncope/ext/saml2lsp/agent/AbstractSAML2SPServlet.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Fsaml2sp%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Fsaml2lsp%2Fagent%2FAbstractSAML2SPServlet.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/ext%2Fsaml2sp%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Fsaml2lsp%2Fagent%2FAbstractSAML2SPServlet.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Fsaml2lsp%2Fagent%2FAbstractSAML2SPServlet.java?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -55,7 +55,7 @@ protected void prepare(final HttpServletResponse response, final SAML2RequestTO\n                 ub.queryParam(SSOConstants.SIGNATURE, requestTO.getSignature());\n \n                 response.setStatus(HttpServletResponse.SC_SEE_OTHER);\n-                response.setHeader(\"Location\", ub.build().toASCIIString());\n+                response.setHeader(HttpHeaders.LOCATION, ub.build().toASCIIString());\n                 break;\n \n             case POST:"},{"sha":"4bfe1987d5a66470b44a90c0f45fe48564d0516d","filename":"fit/console-reference/src/main/webapp/WEB-INF/web.xml","status":"modified","additions":9,"deletions":0,"changes":9,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/fit%2Fconsole-reference%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/fit%2Fconsole-reference%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fconsole-reference%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -62,6 +62,15 @@ under the License.\n     <param-name>oidcclient.login.error.url</param-name>\n     <param-value>../wicket/bookmarkable/org.apache.syncope.client.console.pages.Login</param-value>\n   </context-param>\n+  \n+  <context-param>\n+    <param-name>oidcclient.logout.success.url</param-name>\n+    <param-value>../wicket/bookmarkable/org.apache.syncope.client.console.pages.OIDCClientLogout</param-value>\n+  </context-param>\n+  <context-param>\n+    <param-name>oidcclient.logout.error.url</param-name>\n+    <param-value>../wicket/bookmarkable/org.apache.syncope.client.console.pages.Login</param-value>\n+  </context-param>\n \n   <!-- SESSION TIMEOUT (MINUTES)-->\n   <session-config>"},{"sha":"03444d209eee8c20de1edc4b5018c76c76f5226c","filename":"fit/enduser-reference/src/main/webapp/WEB-INF/web.xml","status":"modified","additions":9,"deletions":0,"changes":9,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3f0c52c468893e6f00502a2c629c961206cff490/fit%2Fenduser-reference%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3f0c52c468893e6f00502a2c629c961206cff490/fit%2Fenduser-reference%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fenduser-reference%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml?ref=3f0c52c468893e6f00502a2c629c961206cff490","patch":"@@ -61,6 +61,15 @@ under the License.\n     <param-name>oidcclient.login.error.url</param-name>\n     <param-value>../wicket/bookmarkable/org.apache.syncope.client.enduser.pages.HomePage</param-value>\n   </context-param>\n+  \n+  <context-param>\n+    <param-name>oidcclient.logout.success.url</param-name>\n+    <param-value>../wicket/bookmarkable/org.apache.syncope.client.enduser.pages.OIDCClientLogout</param-value>\n+  </context-param>\n+  <context-param>\n+    <param-name>oidcclient.logout.error.url</param-name>\n+    <param-value>../wicket/bookmarkable/org.apache.syncope.client.enduser.pages.HomePage</param-value>\n+  </context-param>\n \n \n   <!-- SESSION TIMEOUT (MINUTES)-->"}]}