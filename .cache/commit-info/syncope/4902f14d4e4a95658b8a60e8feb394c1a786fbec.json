{"sha":"4902f14d4e4a95658b8a60e8feb394c1a786fbec","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjQ5MDJmMTRkNGU0YTk1NjU4YjhhNjBlOGZlYjM5NGMxYTc4NmZiZWM=","commit":{"author":{"name":"Fabio Martelli","email":"fmartelli@apache.org","date":"2013-01-04T08:27:59Z"},"committer":{"name":"Fabio Martelli","email":"fmartelli@apache.org","date":"2013-01-04T08:27:59Z"},"message":"Fixes SYNCOPE-255\n\ngit-svn-id: https://svn.apache.org/repos/asf/syncope/trunk@1428746 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"e8961649cadab9a75484b3fccadb52c8cd6fe178","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/e8961649cadab9a75484b3fccadb52c8cd6fe178"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/4902f14d4e4a95658b8a60e8feb394c1a786fbec","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/4902f14d4e4a95658b8a60e8feb394c1a786fbec","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/4902f14d4e4a95658b8a60e8feb394c1a786fbec","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/4902f14d4e4a95658b8a60e8feb394c1a786fbec/comments","author":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"committer":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"parents":[{"sha":"1a96e856a2d14441c4f4d802360a440b3d57a601","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/1a96e856a2d14441c4f4d802360a440b3d57a601","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/1a96e856a2d14441c4f4d802360a440b3d57a601"}],"stats":{"total":31,"additions":23,"deletions":8},"files":[{"sha":"5fb621b12fb0aeee80411c1b49a914126526b465","filename":"console/src/main/java/org/apache/syncope/console/pages/panels/PoliciesPanel.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4902f14d4e4a95658b8a60e8feb394c1a786fbec/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FPoliciesPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4902f14d4e4a95658b8a60e8feb394c1a786fbec/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FPoliciesPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FPoliciesPanel.java?ref=4902f14d4e4a95658b8a60e8feb394c1a786fbec","patch":"@@ -283,13 +283,13 @@ public PolicyDataProvider() {\n \n         @Override\n         public long size() {\n-            return policyRestClient.getPolicies(policyType).size();\n+            return policyRestClient.getPolicies(policyType, true).size();\n         }\n \n         @Override\n         public Iterator<PolicyTO> iterator(final long first, final long count) {\n \n-            final List<PolicyTO> policies = policyRestClient.getPolicies(policyType);\n+            final List<PolicyTO> policies = policyRestClient.getPolicies(policyType, true);\n \n             Collections.sort(policies, comparator);\n "},{"sha":"7d6f7e718f5cd14a3ea908f1f27c0bf47465ba87","filename":"console/src/main/java/org/apache/syncope/console/pages/panels/ResourceSecurityPanel.java","status":"modified","additions":3,"deletions":3,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4902f14d4e4a95658b8a60e8feb394c1a786fbec/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FResourceSecurityPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4902f14d4e4a95658b8a60e8feb394c1a786fbec/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FResourceSecurityPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FResourceSecurityPanel.java?ref=4902f14d4e4a95658b8a60e8feb394c1a786fbec","patch":"@@ -69,7 +69,7 @@ public ResourceSecurityPanel(final String id, final ResourceTO resourceTO) {\n             @Override\n             protected Map<Long, String> load() {\n                 Map<Long, String> res = new HashMap<Long, String>();\n-                for (PolicyTO policyTO : policyRestClient.getPolicies(PolicyType.PASSWORD)) {\n+                for (PolicyTO policyTO : policyRestClient.getPolicies(PolicyType.PASSWORD, false)) {\n                     res.put(policyTO.getId(), policyTO.getDescription());\n                 }\n                 return res;\n@@ -83,7 +83,7 @@ protected Map<Long, String> load() {\n             @Override\n             protected Map<Long, String> load() {\n                 Map<Long, String> res = new HashMap<Long, String>();\n-                for (PolicyTO policyTO : policyRestClient.getPolicies(PolicyType.ACCOUNT)) {\n+                for (PolicyTO policyTO : policyRestClient.getPolicies(PolicyType.ACCOUNT, false)) {\n                     res.put(policyTO.getId(), policyTO.getDescription());\n                 }\n                 return res;\n@@ -97,7 +97,7 @@ protected Map<Long, String> load() {\n             @Override\n             protected Map<Long, String> load() {\n                 Map<Long, String> res = new HashMap<Long, String>();\n-                for (PolicyTO policyTO : policyRestClient.getPolicies(PolicyType.SYNC)) {\n+                for (PolicyTO policyTO : policyRestClient.getPolicies(PolicyType.SYNC, false)) {\n                     res.put(policyTO.getId(), policyTO.getDescription());\n                 }\n                 return res;"},{"sha":"0d50c5b890cea06498f4e38a55ab7d3378a9c6ec","filename":"console/src/main/java/org/apache/syncope/console/pages/panels/RoleSecurityPanel.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4902f14d4e4a95658b8a60e8feb394c1a786fbec/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleSecurityPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4902f14d4e4a95658b8a60e8feb394c1a786fbec/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleSecurityPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleSecurityPanel.java?ref=4902f14d4e4a95658b8a60e8feb394c1a786fbec","patch":"@@ -69,7 +69,7 @@ public <T extends AbstractAttributableTO> RoleSecurityPanel(final String id, fin\n             @Override\n             protected Map<Long, String> load() {\n                 Map<Long, String> res = new HashMap<Long, String>();\n-                for (PolicyTO policyTO : policyRestClient.getPolicies(PolicyType.PASSWORD)) {\n+                for (PolicyTO policyTO : policyRestClient.getPolicies(PolicyType.PASSWORD, false)) {\n                     res.put(policyTO.getId(), policyTO.getDescription());\n                 }\n                 return res;\n@@ -83,7 +83,7 @@ protected Map<Long, String> load() {\n             @Override\n             protected Map<Long, String> load() {\n                 Map<Long, String> res = new HashMap<Long, String>();\n-                for (PolicyTO policyTO : policyRestClient.getPolicies(PolicyType.ACCOUNT)) {\n+                for (PolicyTO policyTO : policyRestClient.getPolicies(PolicyType.ACCOUNT, false)) {\n                     res.put(policyTO.getId(), policyTO.getDescription());\n                 }\n                 return res;"},{"sha":"24bf54b72a696b945b05d274d9bc9816918b4c5b","filename":"console/src/main/java/org/apache/syncope/console/rest/PolicyRestClient.java","status":"modified","additions":16,"deletions":1,"changes":17,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4902f14d4e4a95658b8a60e8feb394c1a786fbec/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Frest%2FPolicyRestClient.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4902f14d4e4a95658b8a60e8feb394c1a786fbec/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Frest%2FPolicyRestClient.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Frest%2FPolicyRestClient.java?ref=4902f14d4e4a95658b8a60e8feb394c1a786fbec","patch":"@@ -80,7 +80,7 @@ public <T extends PolicyTO> T getGlobalPolicy(final PolicyType type) {\n         return policy;\n     }\n \n-    public <T extends PolicyTO> List<T> getPolicies(final PolicyType type) {\n+    public <T extends PolicyTO> List<T> getPolicies(final PolicyType type, final boolean includeGlobal) {\n         final List<T> res = new ArrayList<T>();\n \n         T[] policies = null;\n@@ -122,6 +122,21 @@ public <T extends PolicyTO> List<T> getPolicies(final PolicyType type) {\n                 res.addAll(Arrays.asList(policies));\n             }\n \n+            if (includeGlobal) {\n+                PolicyTO globalPolicy = null;\n+\n+                try {\n+                    globalPolicy = (T) SyncopeSession.get().getRestTemplate().getForObject(\n+                            baseURL + \"policy/\" + policy + \"/global/read\", globalReference);\n+                } catch (Exception ignore) {\n+                    LOG.warn(\"No global policy found\", ignore);\n+                }\n+\n+                if (globalPolicy != null) {\n+                    res.add(0, (T) globalPolicy);\n+                }\n+            }\n+\n         } catch (Exception ignore) {\n             LOG.error(\"No policy found\", ignore);\n         }"}]}