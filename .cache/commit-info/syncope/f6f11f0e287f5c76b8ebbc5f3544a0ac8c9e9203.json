{"sha":"f6f11f0e287f5c76b8ebbc5f3544a0ac8c9e9203","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmY2ZjExZjBlMjg3ZjVjNzZiOGViYmM1ZjM1NDRhMGFjOGM5ZTkyMDM=","commit":{"author":{"name":"Unknown","email":"unknown@apache.org","date":"2010-12-15T11:16:47Z"},"committer":{"name":"Unknown","email":"unknown@apache.org","date":"2010-12-15T11:16:47Z"},"message":"Adding user reset feature (useful when overewriting)\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/syncope/trunk@1246696 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"a5cb953aafd6694b0fabfd757e38a61fc2599aa6","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/a5cb953aafd6694b0fabfd757e38a61fc2599aa6"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/f6f11f0e287f5c76b8ebbc5f3544a0ac8c9e9203","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/f6f11f0e287f5c76b8ebbc5f3544a0ac8c9e9203","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/f6f11f0e287f5c76b8ebbc5f3544a0ac8c9e9203","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/f6f11f0e287f5c76b8ebbc5f3544a0ac8c9e9203/comments","author":null,"committer":null,"parents":[{"sha":"8a8c5e2e0885cc7befd6c11721b3c276631d21fb","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/8a8c5e2e0885cc7befd6c11721b3c276631d21fb","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/8a8c5e2e0885cc7befd6c11721b3c276631d21fb"}],"stats":{"total":46,"additions":40,"deletions":6},"files":[{"sha":"447d04d720593069f6853ad180bb625d51d318ee","filename":"core/src/main/java/org/syncope/core/rest/controller/UserController.java","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/f6f11f0e287f5c76b8ebbc5f3544a0ac8c9e9203/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fcontroller%2FUserController.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/f6f11f0e287f5c76b8ebbc5f3544a0ac8c9e9203/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fcontroller%2FUserController.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fcontroller%2FUserController.java?ref=f6f11f0e287f5c76b8ebbc5f3544a0ac8c9e9203","patch":"@@ -414,7 +414,8 @@ public UserTO create(HttpServletResponse response,\n         }\n \n         // The user to be created\n-        SyncopeUser user = userDataBinder.create(userTO);\n+        SyncopeUser user = new SyncopeUser();\n+        userDataBinder.create(user, userTO);\n         user = syncopeUserDAO.save(user);\n \n         // Now that user is created locally, let's propagate"},{"sha":"574f37bea63fc86349cb4462677f449c9d3087ef","filename":"core/src/main/java/org/syncope/core/rest/data/UserDataBinder.java","status":"modified","additions":38,"deletions":5,"changes":43,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/f6f11f0e287f5c76b8ebbc5f3544a0ac8c9e9203/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fdata%2FUserDataBinder.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/f6f11f0e287f5c76b8ebbc5f3544a0ac8c9e9203/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fdata%2FUserDataBinder.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fdata%2FUserDataBinder.java?ref=f6f11f0e287f5c76b8ebbc5f3544a0ac8c9e9203","patch":"@@ -39,6 +39,8 @@\n import org.syncope.core.persistence.beans.membership.MDerAttr;\n import org.syncope.core.persistence.beans.role.SyncopeRole;\n import org.syncope.core.persistence.beans.user.SyncopeUser;\n+import org.syncope.core.persistence.beans.user.UAttr;\n+import org.syncope.core.persistence.beans.user.UDerAttr;\n import org.syncope.core.persistence.propagation.ResourceOperations;\n import org.syncope.types.ResourceOperationType;\n import org.syncope.types.SyncopeClientExceptionType;\n@@ -91,10 +93,43 @@ public CheckInResult checkIn(final UserTO userTO) {\n         return result;\n     }\n \n-    public SyncopeUser create(final UserTO userTO)\n-            throws SyncopeClientCompositeErrorException, NotFoundException {\n+    public void empty(final SyncopeUser user) {\n+        Set<Long> ids = new HashSet<Long>();\n+        for (AbstractAttr attribute : user.getAttributes()) {\n+            ids.add(attribute.getId());\n+        }\n+        for (Long attrId : ids) {\n+            attributeDAO.delete(attrId, UAttr.class);\n+        }\n+        user.getAttributes().clear();\n+\n+        ids.clear();\n+        for (AbstractDerAttr derivedAttribute : user.getDerivedAttributes()) {\n+            ids.add(derivedAttribute.getId());\n+        }\n+        for (Long derAttrId : ids) {\n+            derivedAttributeDAO.delete(derAttrId, UDerAttr.class);\n+        }\n+        user.getDerivedAttributes().clear();\n+\n+        ids.clear();\n+        for (Membership membership : user.getMemberships()) {\n+            ids.add(membership.getId());\n+        }\n+        for (Long membershipId : ids) {\n+            membershipDAO.delete(membershipId);\n+        }\n+\n+        for (TargetResource resource : user.getTargetResources()) {\n+            resource.removeUser(user);\n+        }\n+        user.getTargetResources().clear();\n \n-        SyncopeUser user = new SyncopeUser();\n+        user.setPassword(null);\n+    }\n+\n+    public void create(final SyncopeUser user, final UserTO userTO)\n+            throws SyncopeClientCompositeErrorException, NotFoundException {\n \n         SyncopeClientCompositeErrorException scce =\n                 new SyncopeClientCompositeErrorException(\n@@ -148,8 +183,6 @@ public SyncopeUser create(final UserTO userTO)\n \n         // attributes, derived attributes and resources\n         fill(user, userTO, AttributableUtil.USER, scce);\n-\n-        return user;\n     }\n \n     public ResourceOperations update(SyncopeUser user, UserMod userMod)"}]}