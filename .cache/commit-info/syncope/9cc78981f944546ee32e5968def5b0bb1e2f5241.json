{"sha":"9cc78981f944546ee32e5968def5b0bb1e2f5241","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjljYzc4OTgxZjk0NDU0NmVlMzJlNTk2OGRlZjViMGJiMWUyZjUyNDE=","commit":{"author":{"name":"Matteo Di Carlo","email":"matteo.dicarlo@tirasa.net","date":"2016-08-05T12:06:28Z"},"committer":{"name":"Matteo Di Carlo","email":"matteo.dicarlo@tirasa.net","date":"2016-08-05T12:06:28Z"},"message":"[SYNCOPE-872] shows type extensions in user form grouped in distinct accordions","tree":{"sha":"a34c571a2d6134a1c60baf7149bd822ca9bea543","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/a34c571a2d6134a1c60baf7149bd822ca9bea543"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/9cc78981f944546ee32e5968def5b0bb1e2f5241","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/9cc78981f944546ee32e5968def5b0bb1e2f5241","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/9cc78981f944546ee32e5968def5b0bb1e2f5241","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/9cc78981f944546ee32e5968def5b0bb1e2f5241/comments","author":null,"committer":null,"parents":[{"sha":"0e3ad3cf67c9d5578d6a0b65b2aa7d088c656983","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/0e3ad3cf67c9d5578d6a0b65b2aa7d088c656983","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/0e3ad3cf67c9d5578d6a0b65b2aa7d088c656983"}],"stats":{"total":216,"additions":119,"deletions":97},"files":[{"sha":"4995e264ea82d2614e5d9f81e2d028e43ff137dc","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/controllers/UserController.js","status":"modified","additions":12,"deletions":3,"changes":15,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/9cc78981f944546ee32e5968def5b0bb1e2f5241/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/9cc78981f944546ee32e5968def5b0bb1e2f5241/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js?ref=9cc78981f944546ee32e5968def5b0bb1e2f5241","patch":"@@ -69,7 +69,7 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n           schemaService = SchemaService.getUserSchemas(anyTypeClass);\n         }\n         schemaService.then(function (schemas) {\n-          if(group && ( schemas.plainSchemas.length > 0 || schemas.derSchemas.length > 0 || schemas.virSchemas.length > 0))\n+          if (group && (schemas.plainSchemas.length > 0 || schemas.derSchemas.length > 0 || schemas.virSchemas.length > 0))\n             $scope.dynamicForm.groupSchemas.push(group);\n           //initializing user schemas values\n           initSchemaValues(schemas);\n@@ -264,17 +264,26 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n       };\n \n       var removeUserSchemas = function (anyTypeClass, group) {\n+\n+        //removing plain groupSchemas\n+        for (var i = 0; i < $scope.dynamicForm.groupSchemas.length; i++) {\n+          if ($scope.dynamicForm.groupSchemas[i] === group) {\n+            $scope.dynamicForm.groupSchemas.splice(i, 1);\n+            i--;\n+          }\n+        }\n+\n         //removing plain schemas\n         for (var i = 0; i < $scope.dynamicForm.plainSchemas.length; i++) {\n-          if ((anyTypeClass && $scope.dynamicForm.plainSchemas[i].anyTypeClass == anyTypeClass)\n+          if ((anyTypeClass && $scope.dynamicForm.plainSchemas[i].anyTypeClass === anyTypeClass)\n                   || (group && $scope.dynamicForm.plainSchemas[i].key.includes(group + '#'))) {\n-\n             //cleaning both form and user model\n             delete $scope.user.plainAttrs[$scope.dynamicForm.plainSchemas[i].key];\n             $scope.dynamicForm.plainSchemas.splice(i, 1);\n             i--;\n           }\n         }\n+\n         //removing derived schemas\n         for (var i = 0; i < $scope.dynamicForm.derSchemas.length; i++) {\n           if ((anyTypeClass && $scope.dynamicForm.derSchemas[i].anyTypeClass == anyTypeClass)"},{"sha":"79869b0cf88cd007485f71088d09a267b3e02d61","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/directives/dynamicDerivedAttributes.js","status":"modified","additions":13,"deletions":8,"changes":21,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/9cc78981f944546ee32e5968def5b0bb1e2f5241/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FdynamicDerivedAttributes.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/9cc78981f944546ee32e5968def5b0bb1e2f5241/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FdynamicDerivedAttributes.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FdynamicDerivedAttributes.js?ref=9cc78981f944546ee32e5968def5b0bb1e2f5241","patch":"@@ -32,18 +32,23 @@ angular.module('self')\n               user: \"=\"\n             },\n             controller: function ($scope) {\n-              $scope.getByGroup = function (schema) {\n+\n+              $scope.getByGroup = function (group) {\n                 var currentDerivedSchemas = new Array();\n                 for (var i = 0; i < $scope.dynamicForm.derSchemas.length; i++) {\n-                  if (schema == \"own\" && $scope.dynamicForm.derSchemas[i].key.indexOf('#') == -1) {\n-                    var attr = $scope.dynamicForm.derSchemas[i];\n+                  var attr = $scope.dynamicForm.derSchemas[i];\n+                  if (group === \"own\" && $scope.dynamicForm.derSchemas[i].key.indexOf('#') == -1) {\n                     attr.simpleKey = $scope.dynamicForm.derSchemas[i].key;\n-                    currentDerivedSchemas.push($scope.dynamicForm.derSchemas[i]);\n-                  }\n-                  if ($scope.dynamicForm.derSchemas[i].key.indexOf(schema) > -1) {\n-                    var attr = $scope.dynamicForm.derSchemas[i];\n-                    attr.simpleKey = $scope.dynamicForm.derSchemas[i].key.substring($scope.dynamicForm.derSchemas[i].key.indexOf(\"#\") + 1);\n                     currentDerivedSchemas.push(attr);\n+                  } else {\n+                    var prefix = $scope.dynamicForm.derSchemas[i].key.substr\n+                            (0, $scope.dynamicForm.derSchemas[i].key.indexOf('#'));\n+                    if (prefix === group)\n+                    {\n+                      var shaPosition = $scope.dynamicForm.derSchemas[i].key.indexOf(\"#\") + 1;\n+                      attr.simpleKey = $scope.dynamicForm.derSchemas[i].key.substring(shaPosition);\n+                      currentDerivedSchemas.push(attr);\n+                    }\n                   }\n                 }\n                 return currentDerivedSchemas;"},{"sha":"7f39147725acdfc28db1e711fc491e4f54246af8","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/directives/dynamicPlainAttributes.js","status":"modified","additions":47,"deletions":43,"changes":90,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/9cc78981f944546ee32e5968def5b0bb1e2f5241/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FdynamicPlainAttributes.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/9cc78981f944546ee32e5968def5b0bb1e2f5241/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FdynamicPlainAttributes.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FdynamicPlainAttributes.js?ref=9cc78981f944546ee32e5968def5b0bb1e2f5241","patch":"@@ -20,52 +20,56 @@\n \n angular.module('self')\n         .directive('dynamicPlainAttributes', function () {\n-            var getTemplateUrl = function () {\n-              return 'views/dynamicPlainAttributes.html';\n-            };\n-            return {\n-              restrict: 'E',\n-              templateUrl: getTemplateUrl(),\n-              scope: {\n-                dynamicForm: \"=form\",\n-                user: \"=\"\n-              },\n-              controller: function ($scope) {\n-                \n-                $scope.getByGroup = function (schema) {\n-                  var currentPlainSchemas = new Array();\n-                  for (var i = 0; i < $scope.dynamicForm.plainSchemas.length; i++) {\n-                    if (schema == \"own\" && $scope.dynamicForm.plainSchemas[i].key.indexOf('#') == -1) {\n-                      var attr = $scope.dynamicForm.plainSchemas[i];\n-                      attr.simpleKey = $scope.dynamicForm.plainSchemas[i].key;\n-                      currentPlainSchemas.push($scope.dynamicForm.plainSchemas[i]);\n-                    }\n-                    if ($scope.dynamicForm.plainSchemas[i].key.indexOf(schema) > -1) {\n-                      var attr = $scope.dynamicForm.plainSchemas[i];\n-                      attr.simpleKey = $scope.dynamicForm.plainSchemas[i].key.substring($scope.dynamicForm.plainSchemas[i].key.indexOf(\"#\") + 1);\n+          var getTemplateUrl = function () {\n+            return 'views/dynamicPlainAttributes.html';\n+          };\n+          return {\n+            restrict: 'E',\n+            templateUrl: getTemplateUrl(),\n+            scope: {\n+              dynamicForm: \"=form\",\n+              user: \"=\"\n+            },\n+            controller: function ($scope) {\n+\n+              $scope.getByGroup = function (group) {\n+                var currentPlainSchemas = new Array();\n+                for (var i = 0; i < $scope.dynamicForm.plainSchemas.length; i++) {\n+                  var attr = $scope.dynamicForm.plainSchemas[i];\n+                  if (group === \"own\" && $scope.dynamicForm.plainSchemas[i].key.indexOf('#') == -1) {\n+                    attr.simpleKey = $scope.dynamicForm.plainSchemas[i].key;\n+                    currentPlainSchemas.push(attr);\n+                  } else {\n+                    var prefix = $scope.dynamicForm.plainSchemas[i].key.substr\n+                            (0, $scope.dynamicForm.plainSchemas[i].key.indexOf('#'));\n+                    if (prefix === group)\n+                    {\n+                      var shaPosition = $scope.dynamicForm.plainSchemas[i].key.indexOf(\"#\") + 1;\n+                      attr.simpleKey = $scope.dynamicForm.plainSchemas[i].key.substring(shaPosition);\n                       currentPlainSchemas.push(attr);\n                     }\n                   }\n-                  return currentPlainSchemas;\n-                };\n+                }\n+                return currentPlainSchemas;\n+              };\n \n-                $scope.addAttributeField = function (plainSchemaKey) {\n-                  console.debug(\"Add PLAIN value:\", plainSchemaKey);\n-                  console.debug(\" \", ($scope.dynamicForm.attributeTable[plainSchemaKey].fields.length));\n-                  $scope.dynamicForm.attributeTable[plainSchemaKey].fields.push(plainSchemaKey + \"_\" + ($scope.dynamicForm.attributeTable[plainSchemaKey].fields.length));\n-                };\n+              $scope.addAttributeField = function (plainSchemaKey) {\n+                console.debug(\"Add PLAIN value:\", plainSchemaKey);\n+                console.debug(\" \", ($scope.dynamicForm.attributeTable[plainSchemaKey].fields.length));\n+                $scope.dynamicForm.attributeTable[plainSchemaKey].fields.push(plainSchemaKey + \"_\" + ($scope.dynamicForm.attributeTable[plainSchemaKey].fields.length));\n+              };\n \n-                $scope.removeAttributeField = function (plainSchemaKey, index) {\n-                  console.debug(\"Remove PLAIN value:\", plainSchemaKey);\n-                  console.debug(\"attribute index:\", index);\n-                  $scope.dynamicForm.attributeTable[plainSchemaKey].fields.splice(index, 1);\n-                  // clean user model\n-                  $scope.user.plainAttrs[plainSchemaKey].values.splice(index, 1);\n-                };\n+              $scope.removeAttributeField = function (plainSchemaKey, index) {\n+                console.debug(\"Remove PLAIN value:\", plainSchemaKey);\n+                console.debug(\"attribute index:\", index);\n+                $scope.dynamicForm.attributeTable[plainSchemaKey].fields.splice(index, 1);\n+                // clean user model\n+                $scope.user.plainAttrs[plainSchemaKey].values.splice(index, 1);\n+              };\n \n-                $scope.getTemplateUrl = function () {\n-                  return \"views/dynamicPlainAttributes.html\";\n-                };\n-              }\n-            };\n-          });\n+              $scope.getTemplateUrl = function () {\n+                return \"views/dynamicPlainAttributes.html\";\n+              };\n+            }\n+          };\n+        });"},{"sha":"5e13233243a9ad2daa9b2c6b28177347ea7cff64","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/directives/dynamicVirtualAttributes.js","status":"modified","additions":45,"deletions":41,"changes":86,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/9cc78981f944546ee32e5968def5b0bb1e2f5241/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FdynamicVirtualAttributes.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/9cc78981f944546ee32e5968def5b0bb1e2f5241/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FdynamicVirtualAttributes.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FdynamicVirtualAttributes.js?ref=9cc78981f944546ee32e5968def5b0bb1e2f5241","patch":"@@ -21,48 +21,52 @@\n \n angular.module('self')\n         .directive('dynamicVirtualAttributes', function () {\n-            var getTemplateUrl = function () {\n-              return 'views/dynamicVirtualAttributes.html';\n-            };\n-            return {\n-              restrict: 'E',\n-              templateUrl: getTemplateUrl(),\n-              scope: {\n-                dynamicForm: \"=form\",\n-                user: \"=\"\n-              },\n-              controller: function ($scope) {\n-               \n-                $scope.getByGroup = function (schema) {\n-                  var currentVirSchemas = new Array();\n-                  for (var i = 0; i < $scope.dynamicForm.virSchemas.length; i++) {\n-                    if (schema == \"own\" && $scope.dynamicForm.virSchemas[i].key.indexOf('#') == -1) {\n-                      var attr = $scope.dynamicForm.virSchemas[i];\n-                      attr.simpleKey = $scope.dynamicForm.virSchemas[i].key;\n-                      currentVirSchemas.push($scope.dynamicForm.virSchemas[i]);\n-                    }\n-                    if ($scope.dynamicForm.virSchemas[i].key.indexOf(schema) > -1) {\n-                      var attr = $scope.dynamicForm.virSchemas[i];\n-                      attr.simpleKey = $scope.dynamicForm.virSchemas[i].key.substring($scope.dynamicForm.virSchemas[i].key.indexOf(\"#\") + 1);\n-                      currentVirSchemas.push(attr);\n+          var getTemplateUrl = function () {\n+            return 'views/dynamicVirtualAttributes.html';\n+          };\n+          return {\n+            restrict: 'E',\n+            templateUrl: getTemplateUrl(),\n+            scope: {\n+              dynamicForm: \"=form\",\n+              user: \"=\"\n+            },\n+            controller: function ($scope) {\n+\n+              $scope.getByGroup = function (group) {\n+                var currentVirtualSchemas = new Array();\n+                for (var i = 0; i < $scope.dynamicForm.virSchemas.length; i++) {\n+                  var attr = $scope.dynamicForm.virSchemas[i];\n+                  if (group === \"own\" && $scope.dynamicForm.virSchemas[i].key.indexOf('#') == -1) {\n+                    attr.simpleKey = $scope.dynamicForm.virSchemas[i].key;\n+                    currentVirtualSchemas.push(attr);\n+                  } else {\n+                    var prefix = $scope.dynamicForm.virSchemas[i].key.substr\n+                            (0, $scope.dynamicForm.virSchemas[i].key.indexOf('#'));\n+                    if (prefix === group)\n+                    {\n+                      var shaPosition = $scope.dynamicForm.virSchemas[i].key.indexOf(\"#\") + 1;\n+                      attr.simpleKey = $scope.dynamicForm.virSchemas[i].key.substring(shaPosition);\n+                      currentVirtualSchemas.push(attr);\n                     }\n                   }\n-                  return currentVirSchemas;\n-                };\n+                }\n+                return currentVirtualSchemas;\n+              };\n \n-                $scope.addVirtualAttributeField = function (virSchemaKey) {\n-                  console.debug(\"Add VIRTUAL value:\", virSchemaKey);\n-                  console.debug(\" \", ($scope.dynamicForm.virtualAttributeTable[virSchemaKey].fields.length));\n-                  $scope.dynamicForm.virtualAttributeTable[virSchemaKey].fields.push(virSchemaKey + \"_\" + ($scope.dynamicForm.virtualAttributeTable[virSchemaKey].fields.length));\n-                };\n+              $scope.addVirtualAttributeField = function (virSchemaKey) {\n+                console.debug(\"Add VIRTUAL value:\", virSchemaKey);\n+                console.debug(\" \", ($scope.dynamicForm.virtualAttributeTable[virSchemaKey].fields.length));\n+                $scope.dynamicForm.virtualAttributeTable[virSchemaKey].fields.push(virSchemaKey + \"_\" + ($scope.dynamicForm.virtualAttributeTable[virSchemaKey].fields.length));\n+              };\n \n-                $scope.removeVirtualAttributeField = function (virSchemaKey, index) {\n-                  console.debug(\"Remove VIRTUAL value: \", virSchemaKey);\n-                  console.debug(\"Remove VIRTUAL value: \", index);\n-                  $scope.dynamicForm.virtualAttributeTable[virSchemaKey].fields.splice(index, 1);\n-                  // clean user model\n-                  $scope.user.virAttrs[virSchemaKey].values.splice(index, 1);\n-                };\n-              }\n-            };\n-          });\n+              $scope.removeVirtualAttributeField = function (virSchemaKey, index) {\n+                console.debug(\"Remove VIRTUAL value: \", virSchemaKey);\n+                console.debug(\"Remove VIRTUAL value: \", index);\n+                $scope.dynamicForm.virtualAttributeTable[virSchemaKey].fields.splice(index, 1);\n+                // clean user model\n+                $scope.user.virAttrs[virSchemaKey].values.splice(index, 1);\n+              };\n+            }\n+          };\n+        });"},{"sha":"c64fcbbf7f286d3bb0c848d87dbd73c91bb35f11","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/dynamicDerivedAttributes.html","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/9cc78981f944546ee32e5968def5b0bb1e2f5241/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicDerivedAttributes.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/9cc78981f944546ee32e5968def5b0bb1e2f5241/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicDerivedAttributes.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicDerivedAttributes.html?ref=9cc78981f944546ee32e5968def5b0bb1e2f5241","patch":"@@ -17,7 +17,7 @@\n under the License.\n -->\n <div ng-repeat=\"groupSchema in dynamicForm.groupSchemas\">\n-  <uib-accordion>\n+  <uib-accordion ng-if=\"getByGroup(groupSchema).length > 0\">\n     <div uib-accordion-group heading=\"{{groupSchema| translate}}\"\n          ng-init=\"status = {isOpen: (groupSchema == 'own')}\" is-open=\"status.isOpen\"\n          class=\"breadcrumb-header\">"},{"sha":"8a21985b1d6e4d86f163d18a7840e869ed897ef5","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/dynamicPlainAttributes.html","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/9cc78981f944546ee32e5968def5b0bb1e2f5241/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicPlainAttributes.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/9cc78981f944546ee32e5968def5b0bb1e2f5241/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicPlainAttributes.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicPlainAttributes.html?ref=9cc78981f944546ee32e5968def5b0bb1e2f5241","patch":"@@ -18,7 +18,7 @@\n -->\n \n <div ng-repeat=\"groupSchema in dynamicForm.groupSchemas\">\n-  <uib-accordion>\n+  <uib-accordion ng-if=\"getByGroup(groupSchema).length > 0\">\n     <div uib-accordion-group heading=\"{{groupSchema| translate}}\"\n          ng-init=\"status = {isOpen: (groupSchema == 'own')}\" is-open=\"status.isOpen\"\n          class=\"breadcrumb-header\">"}]}