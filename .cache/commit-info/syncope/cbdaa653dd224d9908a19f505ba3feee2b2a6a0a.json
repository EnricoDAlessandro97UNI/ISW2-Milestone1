{"sha":"cbdaa653dd224d9908a19f505ba3feee2b2a6a0a","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmNiZGFhNjUzZGQyMjRkOTkwOGExOWY1MDViYTNmZWVlMmIyYTZhMGE=","commit":{"author":{"name":"Unknown","email":"unknown@apache.org","date":"2010-11-25T13:47:18Z"},"committer":{"name":"Unknown","email":"unknown@apache.org","date":"2010-11-25T13:47:18Z"},"message":"Some enhancements on paginated search previous added to Users' listings\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/syncope/trunk@1246653 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"27f6dec4e7fe2f852a9d5ba9174ba157eb4569ba","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/27f6dec4e7fe2f852a9d5ba9174ba157eb4569ba"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/cbdaa653dd224d9908a19f505ba3feee2b2a6a0a","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/cbdaa653dd224d9908a19f505ba3feee2b2a6a0a","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/cbdaa653dd224d9908a19f505ba3feee2b2a6a0a","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/cbdaa653dd224d9908a19f505ba3feee2b2a6a0a/comments","author":null,"committer":null,"parents":[{"sha":"bb2ad683c24f2ac0ffc3915e6b56fb5dfc97885b","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/bb2ad683c24f2ac0ffc3915e6b56fb5dfc97885b","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/bb2ad683c24f2ac0ffc3915e6b56fb5dfc97885b"}],"stats":{"total":107,"additions":37,"deletions":70},"files":[{"sha":"dda61c4a51f1ab7d0062548becd0e6a917976cea","filename":"console/src/main/java/org/syncope/console/pages/Users.java","status":"modified","additions":37,"deletions":70,"changes":107,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/cbdaa653dd224d9908a19f505ba3feee2b2a6a0a/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUsers.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/cbdaa653dd224d9908a19f505ba3feee2b2a6a0a/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUsers.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUsers.java?ref=cbdaa653dd224d9908a19f505ba3feee2b2a6a0a","patch":"@@ -93,7 +93,8 @@ public class Users extends BasePage {\n     final int WIN_USER_HEIGHT = 680;\n     final int WIN_USER_WIDTH = 1133;\n \n-    WebMarkupContainer container;\n+    WebMarkupContainer usersTableSearchContainer;\n+    WebMarkupContainer usersTableContainer;\n \n     /*\n      Response flag set by the Modal Window after the operation is completed\n@@ -139,21 +140,6 @@ public Users(PageParameters parameters) {\n \n         add(feedbackPanel);\n \n-        /*try {\n-            paginatorRows = utility.getPaginatorRowsToDisplay(Constants\n-                    .CONF_USERS_PAGINATOR_ROWS);\n-        }\n-        catch(RestClientException e){\n-           PageParameters errorParameters = new PageParameters();\n-\n-           errorParameters.add(\"errorTitle\", getString(\"alert\"));\n-           errorParameters.add(\"errorMessage\", getString(\"connectionError\"));\n-\n-           setResponsePage(new ErrorPage(errorParameters));\n-\n-           return;\n-        }*/\n-\n         //table's columnsList = attributes to view\n         final IModel columns = new LoadableDetachableModel() {\n \n@@ -219,8 +205,9 @@ protected Object load() {\n             }\n         };\n \n-        \n-            final PageableListView usersView = new PageableListView(\"results\",\n+        usersTableContainer = new WebMarkupContainer(\"usersTableContainer\");\n+\n+        final PageableListView usersView = new PageableListView(\"results\",\n                     usersModel, paginatorRows) {\n \n             @Override\n@@ -295,7 +282,7 @@ public void onClick(AjaxRequestTarget target) {\n                         info(getString(\"operation_succeded\"));\n                         target.addComponent(feedbackPanel);\n \n-                        target.addComponent(container);\n+                        target.addComponent(usersTableSearchContainer);\n                     }\n                     \n                     @Override\n@@ -314,9 +301,6 @@ public CharSequence preDecorateScript(CharSequence script) {\n             }\n         };\n \n-        final WebMarkupContainer usersTableContainer = new WebMarkupContainer(\n-                \"usersTableContainer\");\n-\n         usersTableContainer.add(usersView);\n         usersTableContainer.setOutputMarkupId(true);\n \n@@ -345,7 +329,7 @@ public void onClick(AjaxRequestTarget target) {\n             }\n         };\n \n-        //Add to container users' list navigation controls\n+        //Add to usersTableSearchContainer users' list navigation controls\n         usersTableContainer.add(incrementUserViewLink);\n         usersTableContainer.add(currentPageUserViewLabel);\n         usersTableContainer.add(decrementUserViewLink);\n@@ -372,8 +356,8 @@ public void onClick(AjaxRequestTarget target) {\n         changeAttribsViewWin.setPageMapName(\"change-attribs-modal\");\n         changeAttribsViewWin.setCookieName(\"change-attribs-modal\");\n \n-        setWindowClosedCallback(createUserWin, container);\n-        setWindowClosedCallback(editUserWin, container);\n+        setWindowClosedCallback(createUserWin, usersTableSearchContainer);\n+        setWindowClosedCallback(editUserWin, usersTableSearchContainer);\n \n         changeAttribsViewWin.setWindowClosedCallback(\n                 new ModalWindow.WindowClosedCallback() {\n@@ -488,8 +472,8 @@ protected Object load() {\n \n         form.add(new FeedbackPanel(\"feedback\").setOutputMarkupId(true));\n \n-        container = new WebMarkupContainer(\"container\");\n-        container.setOutputMarkupId(true);\n+        usersTableSearchContainer = new WebMarkupContainer(\"container\");\n+        usersTableSearchContainer.setOutputMarkupId(true);\n \n         ListView searchView = new ListView(\"searchView\", searchConditionsList) {\n \n@@ -589,7 +573,7 @@ protected Object load() {\n                         }\n                     });\n                     target.addComponent(filterNameChooser);\n-                    target.addComponent(container);\n+                    target.addComponent(usersTableSearchContainer);\n                 }});\n \n                 filterTypeChooser.setRequired(true);\n@@ -604,7 +588,7 @@ protected void onSubmit(AjaxRequestTarget target,\n                             Form form) {\n                         final int parentId = new Integer(getParent().getId());\n                         searchConditionsList.remove(parentId);\n-                        target.addComponent(container);\n+                        target.addComponent(usersTableSearchContainer);\n                     }\n                 };\n \n@@ -618,7 +602,7 @@ protected void onSubmit(AjaxRequestTarget target,\n             }\n         };\n \n-        container.add(searchView);\n+        usersTableSearchContainer.add(searchView);\n \n         AjaxButton addAndButton = new AjaxButton(\"addAndButton\", new Model(\n                 getString(\"addAndButton\"))) {\n@@ -629,12 +613,12 @@ protected void onSubmit(AjaxRequestTarget target, Form form) {\n                         new SearchConditionWrapper();\n                 conditionWrapper.setOperationType(OperationType.AND);\n                 searchConditionsList.add(conditionWrapper);\n-                target.addComponent(container);\n+                target.addComponent(usersTableSearchContainer);\n             }\n         };\n \n         addAndButton.setDefaultFormProcessing(false);\n-        container.add(addAndButton);\n+        usersTableSearchContainer.add(addAndButton);\n \n         AjaxButton addOrButton = new AjaxButton(\"addOrButton\", new Model(\n                 getString(\"addOrButton\"))) {\n@@ -645,14 +629,14 @@ protected void onSubmit(AjaxRequestTarget target, Form form) {\n                         new SearchConditionWrapper();\n                 conditionWrapper.setOperationType(OperationType.OR);\n                 searchConditionsList.add(conditionWrapper);\n-                target.addComponent(container);\n+                target.addComponent(usersTableSearchContainer);\n             }\n         };\n \n         addOrButton.setDefaultFormProcessing(false);\n-        container.add(addOrButton);\n+        usersTableSearchContainer.add(addOrButton);\n \n-        form.add(container);\n+        form.add(usersTableSearchContainer);\n \n        currentPageUserSearchLabel = new Label(\"currentSearchPage\",\n                 new Model<String>(String.valueOf(currentSearchPage)));\n@@ -697,12 +681,13 @@ protected Object load() {\n             }\n         };\n \n-        final ListView resultsView = new ListView(\"results\", resultsModel) {\n+        final PageableListView resultsView = new PageableListView(\"results\",\n+                resultsModel, paginatorSearchRows) {\n \n             @Override\n             protected void populateItem(final ListItem item) {\n \n-                UserTO userTO = (UserTO) item.getModelObject();\n+                final UserTO userTO = (UserTO) item.getModelObject();\n \n                 item.add(new Label(\"id\", String.valueOf(userTO.getId())));\n \n@@ -720,8 +705,6 @@ protected void populateItem(final ListItem item) {\n \n                     @Override\n                     protected void onSubmit(AjaxRequestTarget target, Form form) {\n-                        final UserTO userTO =\n-                                (UserTO) item.getDefaultModelObject();\n \n                         editUserWin.setPageCreator(new ModalWindow.PageCreator() {\n \n@@ -738,12 +721,20 @@ public Page createPage() {\n \n                 item.add(editButton);\n \n-                item.add(new AjaxButton(\"deleteLink\", new Model(\n+                item.add(new AjaxLink(\"deleteLink\", new Model(\n                         getString(\"delete\"))) {\n \n                     @Override\n-                    protected void onSubmit(AjaxRequestTarget target, Form form) {\n+                    public void onClick(AjaxRequestTarget target) {\n+                        usersRestClient.deleteUser(String\n+                                .valueOf(userTO.getId()));\n+\n+                        info(getString(\"operation_succeded\"));\n+                        target.addComponent(feedbackPanel);\n+\n+                        target.addComponent(usersTableContainer);\n                     }\n+\n                 });\n             }\n         };\n@@ -775,7 +766,7 @@ public void onClick(AjaxRequestTarget target) {\n             }\n         };\n \n-        //Add to container users'search list navigation controls\n+        //Add to usersTableSearchContainer users'search list navigation controls\n         searchResultsContainer.add(incrementUserSearchLink);\n         searchResultsContainer.add(currentPageUserSearchLabel);\n         searchResultsContainer.add(decrementUserSearchLink);\n@@ -836,13 +827,13 @@ protected void onError(AjaxRequestTarget target, Form form) {\n         final DropDownChoice rowsSearchChooser = new DropDownChoice(\"rowsSearchChooser\",\n         new PropertyModel(this,\"paginatorSearchRows\"),utility.paginatorRowsChooser());\n \n-        rowsChooser.add(new AjaxFormComponentUpdatingBehavior( \"onchange\" ){\n+        rowsSearchChooser.add(new AjaxFormComponentUpdatingBehavior( \"onchange\" ){\n           protected void onUpdate( AjaxRequestTarget target )\n             {\n-              utility.updatePaginatorRows(Constants.CONF_USERS_SEARCH_PAGINATOR_ROWS,\n+             utility.updatePaginatorRows(Constants.CONF_USERS_SEARCH_PAGINATOR_ROWS,\n                       paginatorSearchRows);\n \n-             //sea.setRowsPerPage(paginatorSearchRows);\n+              resultsView.setRowsPerPage(paginatorSearchRows);\n \n               target.addComponent(searchResultsContainer);\n             }\n@@ -910,7 +901,7 @@ public List<AttributeWrapper> attributesToDisplay(UserTO user) {\n     /**\n      * Set a WindowClosedCallback for a ModalWindow instance.\n      * @param window\n-     * @param container\n+     * @param usersTableSearchContainer\n      */\n     public void setWindowClosedCallback(final ModalWindow window,\n             final WebMarkupContainer container) {\n@@ -1064,30 +1055,6 @@ public NodeCond buildSearchExpression(\n         }\n     }\n \n-//    private List<IColumn> addCustomizedUserProperties(List<IColumn> columns) {\n-//        ConfigurationTO configuration =\n-//                        configurationsRestClient.readConfiguration(\n-//                        Constants.CONF_USERS_ATTRIBUTES_VIEW);\n-//\n-//                if (configuration != null\n-//                        && configuration.getConfValue() != null) {\n-//\n-//                    String conf = configuration.getConfValue();\n-//                    StringTokenizer st = new StringTokenizer(conf, \";\");\n-//\n-//                    String columnName = null;\n-//\n-//                    while (st.hasMoreTokens()) {\n-//                        columnName = st.nextToken();\n-//\n-//                        columns.add(new PropertyColumn(new Model(columnName),\n-//                        \"attributeMap[\"+columnName+\"]\"));\n-//                    }\n-//                }\n-//\n-//                return columns;\n-//    }\n-\n     /**\n      * Wrapper class for displaying attribute\n      */"}]}