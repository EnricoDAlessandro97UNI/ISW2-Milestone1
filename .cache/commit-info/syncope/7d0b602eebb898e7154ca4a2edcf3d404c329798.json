{"sha":"7d0b602eebb898e7154ca4a2edcf3d404c329798","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjdkMGI2MDJlZWJiODk4ZTcxNTRjYTRhMmVkY2YzZDQwNGMzMjk3OTg=","commit":{"author":{"name":"giacomolm","email":"giacomolm@hotmail.it","date":"2016-02-15T16:12:27Z"},"committer":{"name":"giacomolm","email":"giacomolm@hotmail.it","date":"2016-02-15T16:12:44Z"},"message":"[SYNCOPE-719] A notification error appears in case of form errors","tree":{"sha":"b375be7f9ab01178cc688f47a1f3193a2d32bd9c","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/b375be7f9ab01178cc688f47a1f3193a2d32bd9c"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/7d0b602eebb898e7154ca4a2edcf3d404c329798","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/7d0b602eebb898e7154ca4a2edcf3d404c329798","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/7d0b602eebb898e7154ca4a2edcf3d404c329798","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/7d0b602eebb898e7154ca4a2edcf3d404c329798/comments","author":{"login":"giacomolm","id":4027829,"node_id":"MDQ6VXNlcjQwMjc4Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/4027829?v=4","gravatar_id":"","url":"https://api.github.com/users/giacomolm","html_url":"https://github.com/giacomolm","followers_url":"https://api.github.com/users/giacomolm/followers","following_url":"https://api.github.com/users/giacomolm/following{/other_user}","gists_url":"https://api.github.com/users/giacomolm/gists{/gist_id}","starred_url":"https://api.github.com/users/giacomolm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/giacomolm/subscriptions","organizations_url":"https://api.github.com/users/giacomolm/orgs","repos_url":"https://api.github.com/users/giacomolm/repos","events_url":"https://api.github.com/users/giacomolm/events{/privacy}","received_events_url":"https://api.github.com/users/giacomolm/received_events","type":"User","site_admin":false},"committer":{"login":"giacomolm","id":4027829,"node_id":"MDQ6VXNlcjQwMjc4Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/4027829?v=4","gravatar_id":"","url":"https://api.github.com/users/giacomolm","html_url":"https://github.com/giacomolm","followers_url":"https://api.github.com/users/giacomolm/followers","following_url":"https://api.github.com/users/giacomolm/following{/other_user}","gists_url":"https://api.github.com/users/giacomolm/gists{/gist_id}","starred_url":"https://api.github.com/users/giacomolm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/giacomolm/subscriptions","organizations_url":"https://api.github.com/users/giacomolm/orgs","repos_url":"https://api.github.com/users/giacomolm/repos","events_url":"https://api.github.com/users/giacomolm/events{/privacy}","received_events_url":"https://api.github.com/users/giacomolm/received_events","type":"User","site_admin":false},"parents":[{"sha":"454af56189ae01d061eda672d5392980e285a508","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/454af56189ae01d061eda672d5392980e285a508","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/454af56189ae01d061eda672d5392980e285a508"}],"stats":{"total":61,"additions":45,"deletions":16},"files":[{"sha":"57b45ef292ae8e9738883c66fb4cc8068f1ed520","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/app.js","status":"modified","additions":18,"deletions":3,"changes":21,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7d0b602eebb898e7154ca4a2edcf3d404c329798/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fapp.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7d0b602eebb898e7154ca4a2edcf3d404c329798/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fapp.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fapp.js?ref=7d0b602eebb898e7154ca4a2edcf3d404c329798","patch":"@@ -254,7 +254,7 @@ app.run(['$rootScope', '$location', '$cookies', '$state',\n         $state.go(toState);\n       }\n     });\n-    \n+\n     $rootScope.spinner = {\n       active: false,\n       on: function () {\n@@ -306,14 +306,25 @@ app.controller('ApplicationController', ['$scope', '$rootScope', 'InfoService',\n       $scope.notification.options.position[\"top\"] = 20;\n       $scope.showSuccess = function (message, component) {\n         if (!$scope.notificationExists(message)) {\n+          //forcing scrollTo since kendo doesn't disable scrollTop if pinned is true\n+          window.scrollTo(0, 0);\n           component.options.autoHideAfter = 3000;\n           component.show(message, \"success\");\n         }\n       }\n       $scope.showError = function (message, component) {\n         if (!$scope.notificationExists(message)) {\n+          //forcing scrollTo since kendo doesn't disable scrollTop if pinned is true\n+          window.scrollTo(0, 0);\n           component.options.autoHideAfter = 0;\n-          component.show(message, \"error\");          \n+          component.show(message, \"error\");\n+        }\n+      }\n+      $scope.hideError = function (message, component) {\n+        var popup;\n+        if (popup = $scope.notificationExists(message)) {\n+          popup.hide = true;\n+          popup.close();\n         }\n       }\n       $scope.notificationExists = function (message) {\n@@ -323,7 +334,7 @@ app.controller('ApplicationController', ['$scope', '$rootScope', 'InfoService',\n           pendingNotifications.each(function (idx, element) {\n             var popup = $(element).data(\"kendoPopup\");\n             if (!popup.hide && popup.wrapper.html().indexOf(message) > -1) {\n-              result = true;\n+              result = popup;\n               return false; //breaking the each and storing the real result\n             }\n           });\n@@ -365,6 +376,10 @@ app.controller('ApplicationController', ['$scope', '$rootScope', 'InfoService',\n       $scope.$on('xhrStarted', function (event, next, current) {\n         $scope.hideNotifications(0);\n       });\n+      //Intercepting hide popup errors event\n+      $scope.$on('hideErrorMessage', function (event, popupMessage) {\n+        $scope.hideError(popupMessage, $scope.notification);\n+      });\n     }\n   }]);\n app.factory('AuthenticationHelper', ['$q', '$rootScope',"},{"sha":"e3526b38ada3cb8f0e8a6c8a0dd88b913ec0c1eb","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/directives/validate.js","status":"modified","additions":3,"deletions":2,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7d0b602eebb898e7154ca4a2edcf3d404c329798/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2Fvalidate.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7d0b602eebb898e7154ca4a2edcf3d404c329798/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2Fvalidate.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2Fvalidate.js?ref=7d0b602eebb898e7154ca4a2edcf3d404c329798","patch":"@@ -25,9 +25,10 @@ angular.module('SyncopeEnduserApp').\n           return {\n             require: 'ngModel',\n             link: function (scope, elem, attrs, ngModel) {\n-              scope.$watch(attrs.ngModel, function (value) {                \n+              scope.$watch(attrs.ngModel, function (value) {\n                 //trigger the live validation only if user interacts with the input\n-                if (scope.validationEnabled && !ngModel.$pristine) {\n+                var validationEnabled = scope.validationEnabled || scope.$root.validationEnabled;\n+                if (validationEnabled && !ngModel.$pristine) {\n                   //broadcasting from root scope element validity\n                   scope.$root.$broadcast(attrs.name, {errors: ngModel.$error});\n                 }"},{"sha":"3fc8b33fca2738819082e619bf91cc43d1fafc16","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/directives/validationMessage.js","status":"modified","additions":9,"deletions":3,"changes":12,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7d0b602eebb898e7154ca4a2edcf3d404c329798/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FvalidationMessage.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7d0b602eebb898e7154ca4a2edcf3d404c329798/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FvalidationMessage.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FvalidationMessage.js?ref=7d0b602eebb898e7154ca4a2edcf3d404c329798","patch":"@@ -20,18 +20,24 @@\n 'use strict';\n \n angular.module('SyncopeEnduserApp').\n-        directive('validationMessage', function ($templateRequest, $compile) {\n+        directive('validationMessage', function () {\n           return {\n             templateUrl: 'views/validationMessage.html',\n             scope: {\n               \"name\": \"@\",\n               \"template\": \"@\"\n             },\n+            require: '^form',\n             replace: false,\n-            link: function (scope, el, attrs) {\n+            link: function (scope, el, attrs, formCtrl) {\n+              var popupMessage = \"Data are invalid: please correct accordingly\";\n               //listener\n               scope.$on(attrs.name, function (el, errors) {\n                 scope.errors = errors;\n+                //hide popup error message if there aren't errors\n+                if ($.isEmptyObject(formCtrl.$error)) {\n+                  scope.$emit(\"hideErrorMessage\", popupMessage);\n+                }\n               });\n             }\n           };\n@@ -62,7 +68,7 @@ angular.module('SyncopeEnduserApp').\n                   });\n                 }\n               }\n-              else{\n+              else {\n                 ngswitch.append(\"<div ng-switch-default>{{key}} validation rule is not satisfied</div>\")\n               }\n               $compile(ngswitch)(scope);"},{"sha":"c698ebfd7215ad384cb0355f1b25856bb910a18b","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/util/genericUtil.js","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7d0b602eebb898e7154ca4a2edcf3d404c329798/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Futil%2FgenericUtil.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7d0b602eebb898e7154ca4a2edcf3d404c329798/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Futil%2FgenericUtil.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Futil%2FgenericUtil.js?ref=7d0b602eebb898e7154ca4a2edcf3d404c329798","patch":"@@ -44,7 +44,7 @@ angular.module('SyncopeEnduserApp')\n               return null;\n             };\n \n-            genericUtil.getEnclosingForm = function (element, scope) {\n+            genericUtil.getEnclosingForm = function (element) {\n               var form = $(element).closest('form');\n               if (form.length) {\n                 return form[0];"},{"sha":"e391a29eda422621522a9bd8f313c36ac5f8e7b5","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/validator/validationExecutor.js","status":"modified","additions":14,"deletions":7,"changes":21,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7d0b602eebb898e7154ca4a2edcf3d404c329798/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fvalidator%2FvalidationExecutor.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7d0b602eebb898e7154ca4a2edcf3d404c329798/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fvalidator%2FvalidationExecutor.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fvalidator%2FvalidationExecutor.js?ref=7d0b602eebb898e7154ca4a2edcf3d404c329798","patch":"@@ -23,19 +23,26 @@ angular.module('SyncopeEnduserApp')\n           function (GenericUtil) {\n \n             var validationExecutor = {};\n-            \n-            validationExecutor.validate = function (form, scope) {              \n-              if(scope.validationEnabled){\n-                var currentForm = scope[form.name] || scope[form.$name];              \n+\n+            validationExecutor.validate = function (form, scope) {\n+              if (scope.validationEnabled) {\n+                var currentForm = scope[form.name] || scope[form.$name];\n                 angular.forEach(currentForm.$error, function (field) {\n-                  for (var i in field) {                  \n+                  for (var i in field) {\n                     scope.$root.$broadcast(field[i].$name, {errors: field[i].$error});\n                   }\n                 });\n                 currentForm.$setSubmitted();\n-                return $.isEmptyObject(currentForm.$error);\n+                if ($.isEmptyObject(currentForm.$error)) {\n+                  return true\n+                }\n+                else {\n+                  scope.showError(\"Data are invalid: please correct accordingly\", scope.notification);\n+                  return false;\n+                }\n               }\n-              else return true;\n+              else\n+                return true;\n             };\n             return validationExecutor;\n           }]);\n\\ No newline at end of file"}]}