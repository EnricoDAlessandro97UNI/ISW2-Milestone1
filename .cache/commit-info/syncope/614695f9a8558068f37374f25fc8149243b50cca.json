{"sha":"614695f9a8558068f37374f25fc8149243b50cca","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjYxNDY5NWY5YTg1NTgwNjhmMzczNzRmMjVmYzgxNDkyNDNiNTBjY2E=","commit":{"author":{"name":"Marco Di Sabatino Di Diodoro","email":"mdisabatino@apache.org","date":"2016-01-14T10:48:57Z"},"committer":{"name":"Marco Di Sabatino Di Diodoro","email":"mdisabatino@apache.org","date":"2016-01-14T10:48:57Z"},"message":"[SYNCOPE-735] Deleting unused ACT_GE_BYTEARRAY entries","tree":{"sha":"1fad2c3791faa6f4d2982373cdf0c6cfa4f60e1f","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/1fad2c3791faa6f4d2982373cdf0c6cfa4f60e1f"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/614695f9a8558068f37374f25fc8149243b50cca","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/614695f9a8558068f37374f25fc8149243b50cca","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/614695f9a8558068f37374f25fc8149243b50cca","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/614695f9a8558068f37374f25fc8149243b50cca/comments","author":{"login":"mdisabatino","id":1792527,"node_id":"MDQ6VXNlcjE3OTI1Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/1792527?v=4","gravatar_id":"","url":"https://api.github.com/users/mdisabatino","html_url":"https://github.com/mdisabatino","followers_url":"https://api.github.com/users/mdisabatino/followers","following_url":"https://api.github.com/users/mdisabatino/following{/other_user}","gists_url":"https://api.github.com/users/mdisabatino/gists{/gist_id}","starred_url":"https://api.github.com/users/mdisabatino/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mdisabatino/subscriptions","organizations_url":"https://api.github.com/users/mdisabatino/orgs","repos_url":"https://api.github.com/users/mdisabatino/repos","events_url":"https://api.github.com/users/mdisabatino/events{/privacy}","received_events_url":"https://api.github.com/users/mdisabatino/received_events","type":"User","site_admin":false},"committer":{"login":"mdisabatino","id":1792527,"node_id":"MDQ6VXNlcjE3OTI1Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/1792527?v=4","gravatar_id":"","url":"https://api.github.com/users/mdisabatino","html_url":"https://github.com/mdisabatino","followers_url":"https://api.github.com/users/mdisabatino/followers","following_url":"https://api.github.com/users/mdisabatino/following{/other_user}","gists_url":"https://api.github.com/users/mdisabatino/gists{/gist_id}","starred_url":"https://api.github.com/users/mdisabatino/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mdisabatino/subscriptions","organizations_url":"https://api.github.com/users/mdisabatino/orgs","repos_url":"https://api.github.com/users/mdisabatino/repos","events_url":"https://api.github.com/users/mdisabatino/events{/privacy}","received_events_url":"https://api.github.com/users/mdisabatino/received_events","type":"User","site_admin":false},"parents":[{"sha":"c486bc15ed6a955b103f3a3081bfe86f615702ac","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/c486bc15ed6a955b103f3a3081bfe86f615702ac","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/c486bc15ed6a955b103f3a3081bfe86f615702ac"}],"stats":{"total":9,"additions":9,"deletions":0},"files":[{"sha":"c664f22d05502c8531dfdf6944e095f96c6d27ed","filename":"core/workflow-activiti/src/main/java/org/apache/syncope/core/workflow/activiti/ActivitiUserWorkflowAdapter.java","status":"modified","additions":9,"deletions":0,"changes":9,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/614695f9a8558068f37374f25fc8149243b50cca/core%2Fworkflow-activiti%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fworkflow%2Factiviti%2FActivitiUserWorkflowAdapter.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/614695f9a8558068f37374f25fc8149243b50cca/core%2Fworkflow-activiti%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fworkflow%2Factiviti%2FActivitiUserWorkflowAdapter.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fworkflow-activiti%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fworkflow%2Factiviti%2FActivitiUserWorkflowAdapter.java?ref=614695f9a8558068f37374f25fc8149243b50cca","patch":"@@ -222,6 +222,15 @@ protected void cleanupHistory(final User user) {\n             update.append(\"AND TASK_ID_<>'\").append(taskId).append(\"' \");\n         }\n         jdbcTemplate.execute(update.toString());\n+\n+        List<String> byteArrayIds = jdbcTemplate.queryForList(\n+                \"SELECT BYTEARRAY_ID_ FROM ACT_HI_VARINST WHERE BYTEARRAY_ID_ IS NOT NULL\", String.class);\n+        update.setLength(0);\n+        update.append(\"DELETE FROM ACT_GE_BYTEARRAY WHERE NAME_ LIKE 'hist.%' \");\n+        for (String byteArrayId : byteArrayIds) {\n+            update.append(\"AND ID_<>'\").append(byteArrayId).append(\"' \");\n+        }\n+        jdbcTemplate.execute(update.toString());\n     }\n \n     /**"}]}