{"sha":"b1f7576868c528093c8d28168bedda8ba92738f9","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmIxZjc1NzY4NjhjNTI4MDkzYzhkMjgxNjhiZWRkYThiYTkyNzM4Zjk=","commit":{"author":{"name":"fmartelli","email":"fabio.martelli@gmail.com","date":"2016-07-11T12:50:10Z"},"committer":{"name":"fmartelli","email":"fabio.martelli@gmail.com","date":"2016-07-11T12:50:10Z"},"message":"[SYNCOPE-900] fix inspired by TemplateContentModal","tree":{"sha":"59cb3b552cdee359ac26ab8507470252efe0d8b8","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/59cb3b552cdee359ac26ab8507470252efe0d8b8"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/b1f7576868c528093c8d28168bedda8ba92738f9","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/b1f7576868c528093c8d28168bedda8ba92738f9","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/b1f7576868c528093c8d28168bedda8ba92738f9","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/b1f7576868c528093c8d28168bedda8ba92738f9/comments","author":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"committer":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"parents":[{"sha":"3f1206993548090a3e7c46d2a117017fa3941989","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/3f1206993548090a3e7c46d2a117017fa3941989","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/3f1206993548090a3e7c46d2a117017fa3941989"}],"stats":{"total":54,"additions":26,"deletions":28},"files":[{"sha":"d6a2065cb4b37a07b5601bbab87cfb18227809f9","filename":"ext/camel/client-console/src/main/java/org/apache/syncope/client/console/panels/CamelRoutesDetailsPanel.java","status":"modified","additions":3,"deletions":8,"changes":11,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b1f7576868c528093c8d28168bedda8ba92738f9/ext%2Fcamel%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FCamelRoutesDetailsPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b1f7576868c528093c8d28168bedda8ba92738f9/ext%2Fcamel%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FCamelRoutesDetailsPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fcamel%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FCamelRoutesDetailsPanel.java?ref=b1f7576868c528093c8d28168bedda8ba92738f9","patch":"@@ -21,10 +21,8 @@\n import org.apache.syncope.common.lib.to.CamelRouteTO;\n import org.apache.wicket.markup.head.IHeaderResponse;\n import org.apache.wicket.markup.head.OnLoadHeaderItem;\n-import org.apache.wicket.markup.html.form.Form;\n import org.apache.wicket.markup.html.form.TextArea;\n import org.apache.wicket.markup.html.panel.Panel;\n-import org.apache.wicket.model.CompoundPropertyModel;\n import org.apache.wicket.model.PropertyModel;\n \n public class CamelRoutesDetailsPanel extends Panel {\n@@ -34,12 +32,9 @@ public class CamelRoutesDetailsPanel extends Panel {\n     public CamelRoutesDetailsPanel(final String id, final CamelRouteTO camelRoute) {\n         super(id);\n \n-        Form<CamelRouteTO> routeDefForm = new Form<>(\"routeDefForm\");\n-\n         TextArea<String> routeDefArea = new TextArea<>(\"route\", new PropertyModel<String>(camelRoute, \"content\"));\n-        routeDefForm.add(routeDefArea);\n-        routeDefForm.setModel(new CompoundPropertyModel<>(camelRoute));\n-        add(routeDefForm);\n+        routeDefArea.setMarkupId(\"route\").setOutputMarkupPlaceholderTag(true);\n+        add(routeDefArea);\n     }\n \n     @Override\n@@ -48,10 +43,10 @@ public void renderHead(final IHeaderResponse response) {\n         response.render(OnLoadHeaderItem.forScript(\n                 \"CodeMirror.fromTextArea(document.getElementById('route'), {\"\n                 + \"  lineNumbers: true, \"\n+                + \"  lineWrapping: true, \"\n                 + \"  autoCloseTags: true, \"\n                 + \"  mode: 'text/html', \"\n                 + \"  autoRefresh: true\"\n                 + \"}).on('change', updateTextArea);\"));\n     }\n-\n }"},{"sha":"9c6f201b8d4cb60e849a57fd3798ae94fb54ab34","filename":"ext/camel/client-console/src/main/java/org/apache/syncope/client/console/panels/CamelRoutesDirectoryPanel.java","status":"modified","additions":10,"deletions":10,"changes":20,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b1f7576868c528093c8d28168bedda8ba92738f9/ext%2Fcamel%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FCamelRoutesDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b1f7576868c528093c8d28168bedda8ba92738f9/ext%2Fcamel%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FCamelRoutesDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fcamel%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FCamelRoutesDirectoryPanel.java?ref=b1f7576868c528093c8d28168bedda8ba92738f9","patch":"@@ -81,15 +81,14 @@ protected WizardMgtPanel<CamelRouteTO> newInstance(final String id, final boolea\n \n             @Override\n             public WizardModalPanel<CamelRouteTO> build(final String id, final int index, final AjaxWizard.Mode mode) {\n-                final CamelRouteTO modelObject = newModelObject();\n-                return new CamelRoutesModalPanel(modal, modelObject, pageRef) {\n+                return new CamelRoutesModalPanel(modal, newModelObject(), pageRef) {\n \n                     private static final long serialVersionUID = -6227956682141146095L;\n \n                     @Override\n                     public void onSubmit(final AjaxRequestTarget target, final Form<?> form) {\n                         try {\n-                            restClient.update(modelObject);\n+                            restClient.update(getItem());\n                             info(getString(Constants.OPERATION_SUCCEEDED));\n                             modal.close(target);\n                         } catch (Exception e) {\n@@ -144,14 +143,15 @@ public ActionLinksPanel<CamelRouteTO> getActions(\n                 ActionLinksPanel<CamelRouteTO> panel = ActionLinksPanel.<CamelRouteTO>builder().\n                         add(new ActionLink<CamelRouteTO>() {\n \n-                            private static final long serialVersionUID = -3722207913631435501L;\n+                    private static final long serialVersionUID = -3722207913631435501L;\n \n-                            @Override\n-                            public void onClick(final AjaxRequestTarget target, final CamelRouteTO ignore) {\n-                                send(CamelRoutesDirectoryPanel.this, Broadcast.EXACT,\n-                                        new AjaxWizard.EditItemActionEvent<>(model.getObject(), target));\n-                            }\n-                        }, ActionLink.ActionType.EDIT, CamelEntitlement.ROUTE_UPDATE).\n+                    @Override\n+                    public void onClick(final AjaxRequestTarget target, final CamelRouteTO ignore) {\n+                        CamelRouteTO actual = restClient.read(model.getObject().getKey());\n+                        send(CamelRoutesDirectoryPanel.this, Broadcast.EXACT,\n+                                new AjaxWizard.EditItemActionEvent<>(actual, target));\n+                    }\n+                }, ActionLink.ActionType.EDIT, CamelEntitlement.ROUTE_UPDATE).\n                         build(componentId);\n \n                 return panel;"},{"sha":"67bd1df45cc958e281cbe3bec27fa777de3abb70","filename":"ext/camel/client-console/src/main/java/org/apache/syncope/client/console/rest/CamelRoutesRestClient.java","status":"modified","additions":9,"deletions":4,"changes":13,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b1f7576868c528093c8d28168bedda8ba92738f9/ext%2Fcamel%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Frest%2FCamelRoutesRestClient.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b1f7576868c528093c8d28168bedda8ba92738f9/ext%2Fcamel%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Frest%2FCamelRoutesRestClient.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fcamel%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Frest%2FCamelRoutesRestClient.java?ref=b1f7576868c528093c8d28168bedda8ba92738f9","patch":"@@ -18,6 +18,7 @@\n  */\n package org.apache.syncope.client.console.rest;\n \n+import static org.apache.syncope.client.console.rest.BaseRestClient.getService;\n import java.util.Collections;\n import java.util.List;\n import org.apache.syncope.client.console.SyncopeConsoleSession;\n@@ -37,6 +38,10 @@ public List<CamelRouteTO> list(final AnyTypeKind anyTypeKind) {\n                 : Collections.<CamelRouteTO>emptyList();\n     }\n \n+    public CamelRouteTO read(final String key) {\n+        return getService(CamelRouteService.class).read(key);\n+    }\n+\n     public void update(final CamelRouteTO routeTO) {\n         getService(CamelRouteService.class).update(routeTO);\n     }\n@@ -45,10 +50,10 @@ public boolean isCamelEnabledFor(final AnyTypeKind anyTypeKind) {\n         return anyTypeKind == AnyTypeKind.USER\n                 ? SyncopeConsoleSession.get().getPlatformInfo().getUserProvisioningManager().contains(\"Camel\")\n                 : anyTypeKind == AnyTypeKind.ANY_OBJECT\n-                        ? SyncopeConsoleSession.get().getPlatformInfo().\n-                        getAnyObjectProvisioningManager().contains(\"Camel\")\n-                        : SyncopeConsoleSession.get().getPlatformInfo().\n-                        getGroupProvisioningManager().contains(\"Camel\");\n+                ? SyncopeConsoleSession.get().getPlatformInfo().\n+                getAnyObjectProvisioningManager().contains(\"Camel\")\n+                : SyncopeConsoleSession.get().getPlatformInfo().\n+                getGroupProvisioningManager().contains(\"Camel\");\n \n     }\n }"},{"sha":"663a6b3342b52c5f83b3ada769946cb7bc95bcd8","filename":"ext/camel/client-console/src/main/resources/org/apache/syncope/client/console/panels/CamelRoutesDetailsPanel.html","status":"modified","additions":4,"deletions":6,"changes":10,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b1f7576868c528093c8d28168bedda8ba92738f9/ext%2Fcamel%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FCamelRoutesDetailsPanel.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b1f7576868c528093c8d28168bedda8ba92738f9/ext%2Fcamel%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FCamelRoutesDetailsPanel.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fcamel%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FCamelRoutesDetailsPanel.html?ref=b1f7576868c528093c8d28168bedda8ba92738f9","patch":"@@ -28,7 +28,7 @@\n     <script type=\"text/javascript\" src=\"webjars/codemirror/${codemirror.version}/addon/edit/closetag.js\"></script>\n     <script type=\"text/javascript\">\n       function updateTextArea(editor) {\n-        document.getElementById(\"routeDefForm\").elements[\"route\"].value = editor.getValue();\n+        document.getElementById(\"routeDefForm\").children[\"route\"].value = editor.getValue();\n       }\n     </script>\n     <style>\n@@ -44,11 +44,9 @@\n   </wicket:head>\n   <wicket:panel>\n     <div style=\"padding: 1%;\">\n-      <div class=\"w_content_3\">\n-        <form wicket:id=\"routeDefForm\" id=\"routeDefForm\">\n-          <textarea wicket:id=\"route\" id=\"route\" name=\"route\" style=\"width: 100%; height: 350px;\">\n-          </textarea>\n-        </form>\n+      <div class=\"w_content_3\" id=\"routeDefForm\">\n+        <textarea wicket:id=\"route\" id=\"route\" name=\"route\" style=\"width: 100%; height: 350px;\">\n+        </textarea>\n       </div>\n     </div>\n   </wicket:panel>"}]}