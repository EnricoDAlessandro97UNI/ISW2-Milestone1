{"sha":"cff1b5aeb8acfdcd648f50c2d58cfc5d65e5754a","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmNmZjFiNWFlYjhhY2ZkY2Q2NDhmNTBjMmQ1OGNmYzVkNjVlNTc1NGE=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2019-02-18T11:17:53Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2019-02-18T17:01:41Z"},"message":"Ensuring WebSocketResponse is not involved","tree":{"sha":"10191eb22b0a38c056d4bbb43c536ba9b0d55d5c","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/10191eb22b0a38c056d4bbb43c536ba9b0d55d5c"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/cff1b5aeb8acfdcd648f50c2d58cfc5d65e5754a","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/cff1b5aeb8acfdcd648f50c2d58cfc5d65e5754a","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/cff1b5aeb8acfdcd648f50c2d58cfc5d65e5754a","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/cff1b5aeb8acfdcd648f50c2d58cfc5d65e5754a/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"710d3f83a809ef5a9474bf43922e5d04eb171dad","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/710d3f83a809ef5a9474bf43922e5d04eb171dad","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/710d3f83a809ef5a9474bf43922e5d04eb171dad"}],"stats":{"total":21,"additions":13,"deletions":8},"files":[{"sha":"28707261d1ed405a3a979b936832a6a4d8de6511","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/SyncopeWebApplication.java","status":"modified","additions":6,"deletions":4,"changes":10,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/cff1b5aeb8acfdcd648f50c2d58cfc5d65e5754a/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/cff1b5aeb8acfdcd648f50c2d58cfc5d65e5754a/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeWebApplication.java?ref=cff1b5aeb8acfdcd648f50c2d58cfc5d65e5754a","patch":"@@ -313,10 +313,12 @@ public IResource getResource() {\n \n             @Override\n             public void onEndRequest(final RequestCycle cycle) {\n-                WebResponse response = (WebResponse) cycle.getResponse();\n-                response.setHeader(\"X-XSS-Protection\", \"1; mode=block\");\n-                response.setHeader(\"X-Content-Type-Options\", \"nosniff\");\n-                response.setHeader(\"X-Frame-Options\", \"sameorigin\");\n+                if (cycle.getResponse() instanceof WebResponse) {\n+                    WebResponse response = (WebResponse) cycle.getResponse();\n+                    response.setHeader(\"X-XSS-Protection\", \"1; mode=block\");\n+                    response.setHeader(\"X-Content-Type-Options\", \"nosniff\");\n+                    response.setHeader(\"X-Frame-Options\", \"sameorigin\");\n+                }\n             }\n         });\n     }"},{"sha":"7bcedf95b2594932eb8388e8fdf042213b2698a1","filename":"client/idrepo/console/src/main/java/org/apache/syncope/client/console/SyncopeWebApplication.java","status":"modified","additions":7,"deletions":4,"changes":11,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/cff1b5aeb8acfdcd648f50c2d58cfc5d65e5754a/client%2Fidrepo%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2FSyncopeWebApplication.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/cff1b5aeb8acfdcd648f50c2d58cfc5d65e5754a/client%2Fidrepo%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2FSyncopeWebApplication.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2FSyncopeWebApplication.java?ref=cff1b5aeb8acfdcd648f50c2d58cfc5d65e5754a","patch":"@@ -59,6 +59,7 @@\n import org.apache.wicket.markup.html.WebPage;\n import org.apache.wicket.protocol.http.CsrfPreventionRequestCycleListener;\n import org.apache.wicket.protocol.http.WebApplication;\n+import org.apache.wicket.protocol.ws.api.WebSocketResponse;\n import org.apache.wicket.request.cycle.RequestCycle;\n import org.apache.wicket.request.http.WebResponse;\n import org.apache.wicket.request.resource.AbstractResource;\n@@ -235,10 +236,12 @@ protected void init() {\n \n             @Override\n             public void onEndRequest(final RequestCycle cycle) {\n-                WebResponse response = (WebResponse) cycle.getResponse();\n-                response.setHeader(\"X-XSS-Protection\", \"1; mode=block\");\n-                response.setHeader(\"X-Content-Type-Options\", \"nosniff\");\n-                response.setHeader(\"X-Frame-Options\", \"sameorigin\");\n+                if (cycle.getResponse() instanceof WebResponse && !(cycle.getResponse() instanceof WebSocketResponse)) {\n+                    WebResponse response = (WebResponse) cycle.getResponse();\n+                    response.setHeader(\"X-XSS-Protection\", \"1; mode=block\");\n+                    response.setHeader(\"X-Content-Type-Options\", \"nosniff\");\n+                    response.setHeader(\"X-Frame-Options\", \"sameorigin\");\n+                }\n             }\n         });\n "}]}