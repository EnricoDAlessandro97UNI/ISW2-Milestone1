{"sha":"df5ceff0dce8bc03831e9d967e27564e63c04545","node_id":"C_kwDOJfYA1toAKGRmNWNlZmYwZGNlOGJjMDM4MzFlOWQ5NjdlMjc1NjRlNjNjMDQ1NDU","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@users.noreply.github.com","date":"2023-02-13T10:29:59Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2023-02-13T10:32:11Z"},"message":"[SYNCOPE-1730] Fixing syncope.conf.dir handling (introduced by SYNCOPE-1723) under Windows in all cases (#410)","tree":{"sha":"98054ba27b4ac2aeabea30a3da60b3aa581a77cb","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/98054ba27b4ac2aeabea30a3da60b3aa581a77cb"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/df5ceff0dce8bc03831e9d967e27564e63c04545","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/df5ceff0dce8bc03831e9d967e27564e63c04545","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/df5ceff0dce8bc03831e9d967e27564e63c04545","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/df5ceff0dce8bc03831e9d967e27564e63c04545/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"3c72144ffb89e2fb45dcd490a27ee03e0a720528","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/3c72144ffb89e2fb45dcd490a27ee03e0a720528","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/3c72144ffb89e2fb45dcd490a27ee03e0a720528"}],"stats":{"total":89,"additions":21,"deletions":68},"files":[{"sha":"02293feacae8acdb5399767d2d695bcb79837ca3","filename":"core/persistence-jpa/src/main/java/org/apache/syncope/core/persistence/jpa/content/ContentLoaderHandler.java","status":"modified","additions":5,"deletions":0,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/df5ceff0dce8bc03831e9d967e27564e63c04545/core%2Fpersistence-jpa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fcontent%2FContentLoaderHandler.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/df5ceff0dce8bc03831e9d967e27564e63c04545/core%2Fpersistence-jpa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fcontent%2FContentLoaderHandler.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fcontent%2FContentLoaderHandler.java?ref=df5ceff0dce8bc03831e9d967e27564e63c04545","patch":"@@ -45,6 +45,8 @@ public class ContentLoaderHandler extends DefaultHandler {\n \n     private static final Logger LOG = LoggerFactory.getLogger(ContentLoaderHandler.class);\n \n+    private static final String CONF_DIR = \"syncope.conf.dir\";\n+\n     private final JdbcTemplate jdbcTemplate;\n \n     private final String rootElement;\n@@ -66,6 +68,9 @@ public ContentLoaderHandler(\n         this.continueOnError = continueOnError;\n         this.paramSubstitutor = new StringSubstitutor(key -> {\n             String value = env.getProperty(key, fetches.get(key));\n+            if (value != null && CONF_DIR.equals(key)) {\n+                value = value.replace('\\\\', '/');\n+            }\n             return StringUtils.isBlank(value) ? null : value;\n         });\n     }"},{"sha":"5f7a51ac479accaca763a86af29af615375458e3","filename":"pom.xml","status":"modified","additions":1,"deletions":54,"changes":55,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/df5ceff0dce8bc03831e9d967e27564e63c04545/pom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/df5ceff0dce8bc03831e9d967e27564e63c04545/pom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/pom.xml?ref=df5ceff0dce8bc03831e9d967e27564e63c04545","patch":"@@ -413,7 +413,7 @@ under the License.\n \n     <cxf.version>4.0.0</cxf.version>\n     <bouncycastle.version>1.72</bouncycastle.version>\n-    <nimbus-jose-jwt.version>9.29</nimbus-jose-jwt.version>\n+    <nimbus-jose-jwt.version>9.30.1</nimbus-jose-jwt.version>\n \n     <spring-boot.version>3.0.2</spring-boot.version>\n     <spring-cloud-gateway.version>4.0.0</spring-cloud-gateway.version>\n@@ -2295,59 +2295,6 @@ under the License.\n         <module>docker</module>\n       </modules>\n     </profile>\n-\n-    <profile>\n-      <id>win</id>\n-\n-      <activation>\n-        <os>\n-          <family>Windows</family>\n-        </os>\n-      </activation>\n-\n-      <properties>\n-        <syncope.conf.dir>${project.build.directory}/test-classes</syncope.conf.dir>\n-      </properties>\n-\n-      <build>\n-        <plugins>\n-          <plugin>\n-            <groupId>org.codehaus.gmavenplus</groupId>\n-            <artifactId>gmavenplus-plugin</artifactId>\n-            <executions>\n-              <execution>\n-                <id>convert-win-paths</id>\n-                <phase>generate-resources</phase>\n-                <goals>\n-                  <goal>execute</goal>\n-                </goals>\n-                <configuration>\n-                  <bindAllProjectProperties>true</bindAllProjectProperties>\n-                  <scripts>\n-                    <script><![CDATA[\n-                project.properties['win.syncope.conf.dir'] = project.properties['syncope.conf.dir'].replace(\"\\\\\", \"/\")\n-                ]]></script>\n-                  </scripts>\n-                </configuration>\n-              </execution>\n-            </executions>\n-          </plugin>\n-\n-          <plugin>\n-            <groupId>org.codehaus.cargo</groupId>\n-            <artifactId>cargo-maven3-plugin</artifactId>\n-            <inherited>true</inherited>\n-            <configuration>\n-              <container>\n-                <systemProperties>\n-                  <syncope.conf.dir>${win.syncope.conf.dir}</syncope.conf.dir>\n-                </systemProperties>\n-              </container>\n-            </configuration>\n-          </plugin>\n-        </plugins>\n-      </build>\n-    </profile>\n   </profiles>\n \n   <modules>"},{"sha":"c55f285f7e1504838505c4bcd4080445984017c0","filename":"standalone/src/main/resources/setenv.bat","status":"modified","additions":15,"deletions":14,"changes":29,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/df5ceff0dce8bc03831e9d967e27564e63c04545/standalone%2Fsrc%2Fmain%2Fresources%2Fsetenv.bat","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/df5ceff0dce8bc03831e9d967e27564e63c04545/standalone%2Fsrc%2Fmain%2Fresources%2Fsetenv.bat","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/standalone%2Fsrc%2Fmain%2Fresources%2Fsetenv.bat?ref=df5ceff0dce8bc03831e9d967e27564e63c04545","patch":"@@ -1,16 +1,17 @@\n-# Licensed to the Apache Software Foundation (ASF) under one or more\r\n-# contributor license agreements.  See the NOTICE file distributed with\r\n-# this work for additional information regarding copyright ownership.\r\n-# The ASF licenses this file to You under the Apache License, Version 2.0\r\n-# (the \"License\"); you may not use this file except in compliance with\r\n-# the License.  You may obtain a copy of the License at\r\n-#\r\n-#     http://www.apache.org/licenses/LICENSE-2.0\r\n-#\r\n-# Unless required by applicable law or agreed to in writing, software\r\n-# distributed under the License is distributed on an \"AS IS\" BASIS,\r\n-# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n-# See the License for the specific language governing permissions and\r\n-# limitations under the License.\r\n+@echo off\r\n+rem Licensed to the Apache Software Foundation (ASF) under one or more\r\n+rem contributor license agreements.  See the NOTICE file distributed with\r\n+rem this work for additional information regarding copyright ownership.\r\n+rem The ASF licenses this file to You under the Apache License, Version 2.0\r\n+rem (the \"License\"); you may not use this file except in compliance with\r\n+rem the License.  You may obtain a copy of the License at\r\n+rem\r\n+rem     http://www.apache.org/licenses/LICENSE-2.0\r\n+rem\r\n+rem Unless required by applicable law or agreed to in writing, software\r\n+rem distributed under the License is distributed on an \"AS IS\" BASIS,\r\n+rem WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n+rem See the License for the specific language governing permissions and\r\n+rem limitations under the License.\r\n \r\n set JAVA_OPTS=-Djava.awt.headless=true -Dfile.encoding=UTF-8 -Djavax.net.ssl.trustStore=%CATALINA_HOME%\\conf\\keystore.jks -Dsyncope.connid.location=connid://${testconnectorserver.key}@localhost:${testconnectorserver.port} -Dsyncope.conf.dir=%CATALINA_HOME%\\webapps\\syncope\\WEB-INF\\classes -Dsyncope.log.dir=%CATALINA_HOME%\\logs -Dspring.profiles.active=embedded -server -Xms2048m -Xmx2048m -XX:NewSize=256m -XX:MaxNewSize=256m -DCATALINA_HOME=%CATALINA_HOME%\r"}]}