{"sha":"4a7f9aae086c74f356485107e2bcf7636dfcb112","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjRhN2Y5YWFlMDg2Yzc0ZjM1NjQ4NTEwN2UyYmNmNzYzNmRmY2IxMTI=","commit":{"author":{"name":"Unknown","email":"unknown@apache.org","date":"2011-10-14T10:01:42Z"},"committer":{"name":"Unknown","email":"unknown@apache.org","date":"2011-10-14T10:01:42Z"},"message":"Role rename used to fail in case of parent null.\n\nFixes issue 178\n\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/syncope/trunk@1247133 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"32dc834289b6d9b0990ff5b6b9e55845de5f87f3","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/32dc834289b6d9b0990ff5b6b9e55845de5f87f3"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/4a7f9aae086c74f356485107e2bcf7636dfcb112","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/4a7f9aae086c74f356485107e2bcf7636dfcb112","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/4a7f9aae086c74f356485107e2bcf7636dfcb112","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/4a7f9aae086c74f356485107e2bcf7636dfcb112/comments","author":null,"committer":null,"parents":[{"sha":"5bd8004076e5cc249a4a4864487952d2ed5c49d2","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/5bd8004076e5cc249a4a4864487952d2ed5c49d2","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/5bd8004076e5cc249a4a4864487952d2ed5c49d2"}],"stats":{"total":36,"additions":33,"deletions":3},"files":[{"sha":"2ba1093c6a07caf8f9b686b283bfc458f4d5580e","filename":"core/src/main/java/org/syncope/core/rest/data/AbstractAttributableDataBinder.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4a7f9aae086c74f356485107e2bcf7636dfcb112/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fdata%2FAbstractAttributableDataBinder.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4a7f9aae086c74f356485107e2bcf7636dfcb112/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fdata%2FAbstractAttributableDataBinder.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fdata%2FAbstractAttributableDataBinder.java?ref=4a7f9aae086c74f356485107e2bcf7636dfcb112","patch":"@@ -594,8 +594,8 @@ protected PropagationByResource fill(\n \n             if (virtualSchema != null) {\n                 for (SchemaMapping mapping : resourceDAO.findAllMappings()) {\n-                    if (mapping.getSourceAttrName().equals(\n-                            virtualSchema.getName())\n+                    if (virtualSchema.getName().equals(\n+                            mapping.getSourceAttrName())\n                             && mapping.getSourceMappingType()\n                             == attributableUtil.virtualSourceMappingType()\n                             && mapping.getResource() != null"},{"sha":"e2e924f652c9d265e668cee454c947e46c137d72","filename":"core/src/main/java/org/syncope/core/rest/data/RoleDataBinder.java","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4a7f9aae086c74f356485107e2bcf7636dfcb112/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fdata%2FRoleDataBinder.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4a7f9aae086c74f356485107e2bcf7636dfcb112/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fdata%2FRoleDataBinder.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fdata%2FRoleDataBinder.java?ref=4a7f9aae086c74f356485107e2bcf7636dfcb112","patch":"@@ -117,7 +117,8 @@ public PropagationByResource update(SyncopeRole role, RoleMod roleMod)\n                 SyncopeClientExceptionType.InvalidRoles);\n         if (roleMod.getName() != null) {\n             SyncopeRole otherRole = roleDAO.find(\n-                    roleMod.getName(), role.getParent().getId());\n+                    roleMod.getName(),\n+                    role.getParent() != null ? role.getParent().getId() : 0L);\n \n             if (otherRole != null) {\n                 LOG.error(\"Another role exists with the same name \""},{"sha":"8effd1605ccf56a1f5fd7fd2ab47e31598d8cd5c","filename":"core/src/test/java/org/syncope/core/rest/RoleTestITCase.java","status":"modified","additions":29,"deletions":0,"changes":29,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4a7f9aae086c74f356485107e2bcf7636dfcb112/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2FRoleTestITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4a7f9aae086c74f356485107e2bcf7636dfcb112/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2FRoleTestITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2FRoleTestITCase.java?ref=4a7f9aae086c74f356485107e2bcf7636dfcb112","patch":"@@ -214,4 +214,33 @@ public void updateRemovingDerAttribute() {\n         assertNotNull(roleTO);\n         assertTrue(roleTO.getDerivedAttributes().isEmpty());\n     }\n+\n+    /**\n+     * Role rename used to fail in case of parent null.\n+     *\n+     * http://code.google.com/p/syncope/issues/detail?id=178\n+     */\n+    @Test\n+    public void issue178() {\n+        RoleTO roleTO = new RoleTO();\n+        roleTO.setName(\"torename\");\n+\n+        RoleTO actual = restTemplate.postForObject(\n+                BASE_URL + \"role/create\", roleTO, RoleTO.class);\n+\n+        assertNotNull(actual);\n+        assertEquals(\"torename\", actual.getName());\n+        assertEquals(0L, actual.getParent());\n+\n+        RoleMod roleMod = new RoleMod();\n+        roleMod.setId(actual.getId());\n+        roleMod.setName(\"renamed\");\n+\n+        actual = restTemplate.postForObject(\n+                BASE_URL + \"role/update\", roleMod, RoleTO.class);\n+\n+        assertNotNull(actual);\n+        assertEquals(\"renamed\", actual.getName());\n+        assertEquals(0L, actual.getParent());\n+    }\n }"}]}