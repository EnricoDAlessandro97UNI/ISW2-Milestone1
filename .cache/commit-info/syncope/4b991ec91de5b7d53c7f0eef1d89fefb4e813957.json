{"sha":"4b991ec91de5b7d53c7f0eef1d89fefb4e813957","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjRiOTkxZWM5MWRlNWI3ZDUzYzdmMGVlZjFkODlmZWZiNGU4MTM5NTc=","commit":{"author":{"name":"fmartelli","email":"fabio.martelli@gmail.com","date":"2017-05-09T11:25:11Z"},"committer":{"name":"fmartelli","email":"fabio.martelli@gmail.com","date":"2017-05-09T11:27:24Z"},"message":"[SYNCOPE-1072] fix for entitlement check in action panel","tree":{"sha":"04514b31392e6d59605d4a0736be601cb1d434ac","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/04514b31392e6d59605d4a0736be601cb1d434ac"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/4b991ec91de5b7d53c7f0eef1d89fefb4e813957","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/4b991ec91de5b7d53c7f0eef1d89fefb4e813957","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/4b991ec91de5b7d53c7f0eef1d89fefb4e813957","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/4b991ec91de5b7d53c7f0eef1d89fefb4e813957/comments","author":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"committer":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"parents":[{"sha":"0315ac634bfaedd893f46fbc0184807102cb91c8","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/0315ac634bfaedd893f46fbc0184807102cb91c8","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/0315ac634bfaedd893f46fbc0184807102cb91c8"}],"stats":{"total":127,"additions":92,"deletions":35},"files":[{"sha":"0ec23f1ee0cd997ed2f4f76bdef7e8327d628517","filename":"client/console/src/main/java/org/apache/syncope/client/console/SyncopeConsoleSession.java","status":"modified","additions":25,"deletions":2,"changes":27,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4b991ec91de5b7d53c7f0eef1d89fefb4e813957/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2FSyncopeConsoleSession.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4b991ec91de5b7d53c7f0eef1d89fefb4e813957/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2FSyncopeConsoleSession.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2FSyncopeConsoleSession.java?ref=4b991ec91de5b7d53c7f0eef1d89fefb4e813957","patch":"@@ -30,6 +30,8 @@\n import javax.ws.rs.core.EntityTag;\n import javax.ws.rs.core.MediaType;\n import org.apache.commons.collections4.CollectionUtils;\n+import org.apache.commons.collections4.IterableUtils;\n+import org.apache.commons.collections4.Predicate;\n import org.apache.commons.lang3.StringUtils;\n import org.apache.commons.lang3.time.FastDateFormat;\n import org.apache.commons.lang3.tuple.Pair;\n@@ -234,8 +236,29 @@ public Set<String> getAvailableRealms(final String... entitlements) {\n         return availableRealms;\n     }\n \n-    public boolean owns(final String entitlement) {\n-        return auth != null && auth.containsKey(entitlement);\n+    public boolean owns(final String entitlements) {\n+        return owns(entitlements, \"/\");\n+    }\n+\n+    public boolean owns(final String entitlements, final String realm) {\n+        if (StringUtils.isEmpty(entitlements)) {\n+            return true;\n+        }\n+\n+        for (String entitlement : entitlements.split(\",\")) {\n+            if (auth != null && auth.containsKey(entitlement)\n+                    && (realm == null || IterableUtils.matchesAny(auth.get(entitlement), new Predicate<String>() {\n+\n+                        @Override\n+                        public boolean evaluate(final String ownedRealm) {\n+                            return realm.startsWith(ownedRealm);\n+                        }\n+                    }))) {\n+                return true;\n+            }\n+        }\n+\n+        return false;\n     }\n \n     @Override"},{"sha":"e7e23ae1ca232141f61971c6f8b23fea094e5e83","filename":"client/console/src/main/java/org/apache/syncope/client/console/pages/BasePage.java","status":"modified","additions":16,"deletions":14,"changes":30,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4b991ec91de5b7d53c7f0eef1d89fefb4e813957/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpages%2FBasePage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4b991ec91de5b7d53c7f0eef1d89fefb4e813957/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpages%2FBasePage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpages%2FBasePage.java?ref=4b991ec91de5b7d53c7f0eef1d89fefb4e813957","patch":"@@ -133,7 +133,7 @@ public void onClick() {\n             }\n         };\n         MetaDataRoleAuthorizationStrategy.authorize(\n-                dbExportLink, WebPage.ENABLE, StandardEntitlement.CONFIGURATION_EXPORT);\n+                dbExportLink, WebPage.RENDER, StandardEntitlement.CONFIGURATION_EXPORT);\n         body.add(dbExportLink);\n \n         // menu\n@@ -143,8 +143,10 @@ public void onClick() {\n \n         liContainer = new WebMarkupContainer(getLIContainerId(\"realms\"));\n         body.add(liContainer);\n+\n         BookmarkablePageLink<? extends BasePage> link = BookmarkablePageLinkBuilder.build(\"realms\", Realms.class);\n-        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.ENABLE, StandardEntitlement.REALM_LIST);\n+        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.RENDER, StandardEntitlement.REALM_LIST);\n+\n         liContainer.add(link);\n \n         liContainer = new WebMarkupContainer(getLIContainerId(\"topology\"));\n@@ -153,13 +155,13 @@ public void onClick() {\n         StringBuilder bld = new StringBuilder();\n         bld.append(StandardEntitlement.CONNECTOR_LIST).append(\",\").\n                 append(StandardEntitlement.RESOURCE_LIST).append(\",\");\n-        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.ENABLE, bld.toString());\n+        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.RENDER, bld.toString());\n         liContainer.add(link);\n \n         liContainer = new WebMarkupContainer(getLIContainerId(\"reports\"));\n         body.add(liContainer);\n         link = BookmarkablePageLinkBuilder.build(\"reports\", Reports.class);\n-        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.ENABLE, StandardEntitlement.REPORT_LIST);\n+        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.RENDER, StandardEntitlement.REPORT_LIST);\n         liContainer.add(link);\n \n         WebMarkupContainer confLIContainer = new WebMarkupContainer(getLIContainerId(\"configuration\"));\n@@ -173,19 +175,19 @@ public void onClick() {\n                 SyncopeConsoleSession.get().getPlatformInfo().getUserWorkflowAdapter().contains(\"Activiti\"));\n         confULContainer.add(liContainer);\n         link = BookmarkablePageLinkBuilder.build(\"workflow\", Workflow.class);\n-        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.ENABLE, StandardEntitlement.WORKFLOW_DEF_GET);\n+        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.RENDER, StandardEntitlement.WORKFLOW_DEF_GET);\n         liContainer.add(link);\n \n         liContainer = new WebMarkupContainer(getLIContainerId(\"audit\"));\n         confULContainer.add(liContainer);\n         link = BookmarkablePageLinkBuilder.build(\"audit\", Audit.class);\n-        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.ENABLE, StandardEntitlement.AUDIT_LIST);\n+        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.RENDER, StandardEntitlement.AUDIT_LIST);\n         liContainer.add(link);\n \n         liContainer = new WebMarkupContainer(getLIContainerId(\"logs\"));\n         confULContainer.add(liContainer);\n         link = BookmarkablePageLinkBuilder.build(\"logs\", Logs.class);\n-        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.ENABLE, StandardEntitlement.LOG_LIST);\n+        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.RENDER, StandardEntitlement.LOG_LIST);\n         liContainer.add(link);\n \n         liContainer = new WebMarkupContainer(getLIContainerId(\"securityquestions\"));\n@@ -195,37 +197,37 @@ public void onClick() {\n                 append(StandardEntitlement.SECURITY_QUESTION_DELETE).append(\",\").\n                 append(StandardEntitlement.SECURITY_QUESTION_UPDATE);\n         link = BookmarkablePageLinkBuilder.build(\"securityquestions\", SecurityQuestions.class);\n-        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.ENABLE, bld.toString());\n+        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.RENDER, bld.toString());\n         liContainer.add(link);\n \n         liContainer = new WebMarkupContainer(getLIContainerId(\"types\"));\n         confULContainer.add(liContainer);\n         link = BookmarkablePageLinkBuilder.build(\"types\", Types.class);\n-        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.ENABLE, StandardEntitlement.SCHEMA_LIST);\n+        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.RENDER, StandardEntitlement.SCHEMA_LIST);\n         liContainer.add(link);\n \n         liContainer = new WebMarkupContainer(getLIContainerId(\"roles\"));\n         confULContainer.add(liContainer);\n         link = BookmarkablePageLinkBuilder.build(\"roles\", Roles.class);\n-        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.ENABLE, StandardEntitlement.ROLE_LIST);\n+        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.RENDER, StandardEntitlement.ROLE_LIST);\n         liContainer.add(link);\n \n         liContainer = new WebMarkupContainer(getLIContainerId(\"policies\"));\n         confULContainer.add(liContainer);\n         link = BookmarkablePageLinkBuilder.build(\"policies\", Policies.class);\n-        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.ENABLE, StandardEntitlement.POLICY_LIST);\n+        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.RENDER, StandardEntitlement.POLICY_LIST);\n         liContainer.add(link);\n \n         liContainer = new WebMarkupContainer(getLIContainerId(\"notifications\"));\n         confULContainer.add(liContainer);\n         link = BookmarkablePageLinkBuilder.build(\"notifications\", Notifications.class);\n-        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.ENABLE, StandardEntitlement.NOTIFICATION_LIST);\n+        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.RENDER, StandardEntitlement.NOTIFICATION_LIST);\n         liContainer.add(link);\n \n         liContainer = new WebMarkupContainer(getLIContainerId(\"parameters\"));\n         confULContainer.add(liContainer);\n         link = BookmarkablePageLinkBuilder.build(\"parameters\", Parameters.class);\n-        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.ENABLE, StandardEntitlement.CONFIGURATION_LIST);\n+        MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.RENDER, StandardEntitlement.CONFIGURATION_LIST);\n         liContainer.add(link);\n \n         body.add(new AjaxLink<Void>(\"collapse\") {\n@@ -349,7 +351,7 @@ public void onComponentTag(final Component component, final ComponentTag tag) {\n                 BookmarkablePageLink<Page> link = new BookmarkablePageLink<>(\"extPage\", item.getModelObject());\n                 link.add(new Label(\"extPageLabel\", ann.label()));\n                 if (StringUtils.isNotBlank(ann.listEntitlement())) {\n-                    MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.ENABLE, ann.listEntitlement());\n+                    MetaDataRoleAuthorizationStrategy.authorize(link, WebPage.RENDER, ann.listEntitlement());\n                 }\n                 containingLI.add(link);\n "},{"sha":"64cb0b0f1461ead44f2843d8a15330a7dfb98d0b","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/AnyDirectoryPanel.java","status":"modified","additions":6,"deletions":2,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4b991ec91de5b7d53c7f0eef1d89fefb4e813957/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4b991ec91de5b7d53c7f0eef1d89fefb4e813957/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyDirectoryPanel.java?ref=4b991ec91de5b7d53c7f0eef1d89fefb4e813957","patch":"@@ -91,8 +91,12 @@ protected AnyDirectoryPanel(final String id, final Builder<A, E> builder) {\n \n     protected AnyDirectoryPanel(final String id, final Builder<A, E> builder, final boolean wizardInModal) {\n         super(id, builder, wizardInModal);\n-        MetaDataRoleAuthorizationStrategy.authorize(addAjaxLink, RENDER, String.format(\"%s_CREATE\", builder.type));\n-        setReadOnly(!SyncopeConsoleSession.get().owns(String.format(\"%s_UPDATE\", builder.type)));\n+        if (SyncopeConsoleSession.get().owns(String.format(\"%s_CREATE\", builder.type), builder.realm)) {\n+            MetaDataRoleAuthorizationStrategy.authorizeAll(addAjaxLink, RENDER);\n+        } else {\n+            MetaDataRoleAuthorizationStrategy.unauthorizeAll(addAjaxLink, RENDER);\n+        }\n+        setReadOnly(!SyncopeConsoleSession.get().owns(String.format(\"%s_UPDATE\", builder.type), builder.realm));\n \n         this.realm = builder.realm;\n         this.type = builder.type;"},{"sha":"a8a12070cc48efcf98229b1a7ffd5c9def67a1af","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/AnyObjectDirectoryPanel.java","status":"modified","additions":9,"deletions":4,"changes":13,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4b991ec91de5b7d53c7f0eef1d89fefb4e813957/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyObjectDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4b991ec91de5b7d53c7f0eef1d89fefb4e813957/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyObjectDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FAnyObjectDirectoryPanel.java?ref=4b991ec91de5b7d53c7f0eef1d89fefb4e813957","patch":"@@ -155,7 +155,9 @@ public void onClick(final AjaxRequestTarget target, final AnyObjectTO ignore) {\n                                 new AnyWrapper<>(new AnyObjectRestClient().read(model.getObject().getKey())),\n                                 target));\n             }\n-        }, ActionType.EDIT, AnyEntitlement.READ.getFor(type));\n+        }, ActionType.EDIT, new StringBuilder().append(AnyEntitlement.READ.getFor(type)).append(\",\").\n+                append(AnyEntitlement.UPDATE.getFor(type)).toString()).setRealm(realm);\n+\n         panel.add(new ActionLink<AnyObjectTO>() {\n \n             private static final long serialVersionUID = -7978723352517770645L;\n@@ -172,7 +174,7 @@ public void onClick(final AjaxRequestTarget target, final AnyObjectTO ignore) {\n             protected boolean statusCondition(final AnyObjectTO modelObject) {\n                 return addAjaxLink.isVisibleInHierarchy();\n             }\n-        }, ActionType.CLONE, AnyEntitlement.CREATE.getFor(type));\n+        }, ActionType.CLONE, AnyEntitlement.CREATE.getFor(type)).setRealm(realm);\n \n         if (wizardInModal) {\n             panel.add(new ActionLink<AnyObjectTO>() {\n@@ -197,7 +199,9 @@ public void onClick(final AjaxRequestTarget target, final AnyObjectTO ignore) {\n \n                     altDefaultModal.show(true);\n                 }\n-            }, ActionType.MANAGE_RESOURCES, AnyEntitlement.READ.getFor(type));\n+            }, ActionType.MANAGE_RESOURCES, new StringBuilder().append(AnyEntitlement.READ.getFor(type)).append(\",\").\n+                    append(AnyEntitlement.UPDATE.getFor(type)).toString()).setRealm(realm);\n+\n             panel.add(\n                     new ActionLink<AnyObjectTO>() {\n \n@@ -212,6 +216,7 @@ public void onClick(final AjaxRequestTarget target, final AnyObjectTO ignore) {\n                     utilityModal.show(true);\n                 }\n             }, ActionType.PROPAGATION_TASKS, StandardEntitlement.TASK_LIST);\n+\n             panel.add(new ActionLink<AnyObjectTO>() {\n \n                 private static final long serialVersionUID = -7978723352517770644L;\n@@ -245,7 +250,7 @@ public void onClick(final AjaxRequestTarget target, final AnyObjectTO ignore) {\n                 }\n                 ((BasePage) pageRef.getPage()).getNotificationPanel().refresh(target);\n             }\n-        }, ActionType.DELETE, AnyEntitlement.DELETE.getFor(type), true);\n+        }, ActionType.DELETE, AnyEntitlement.DELETE.getFor(type), true).setRealm(realm);\n \n         return panel;\n     }"},{"sha":"889bf8fcdc68bf258f92b26e9f5ec644aeaa6f0d","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/GroupDirectoryPanel.java","status":"modified","additions":8,"deletions":6,"changes":14,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4b991ec91de5b7d53c7f0eef1d89fefb4e813957/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FGroupDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4b991ec91de5b7d53c7f0eef1d89fefb4e813957/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FGroupDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FGroupDirectoryPanel.java?ref=4b991ec91de5b7d53c7f0eef1d89fefb4e813957","patch":"@@ -256,7 +256,8 @@ public void onClick(final AjaxRequestTarget target, final GroupTO ignore) {\n                         new AjaxWizard.EditItemActionEvent<>(new GroupWrapper(\n                                 restClient.read(model.getObject().getKey())), target));\n             }\n-        }, ActionType.EDIT, StandardEntitlement.GROUP_READ);\n+        }, ActionType.EDIT, new StringBuilder().append(StandardEntitlement.GROUP_READ).append(\",\").\n+                append(StandardEntitlement.GROUP_UPDATE).toString()).setRealm(realm);\n \n         panel.add(new ActionLink<GroupTO>() {\n \n@@ -269,7 +270,7 @@ public void onClick(final AjaxRequestTarget target, final GroupTO ignore) {\n                 send(GroupDirectoryPanel.this, Broadcast.EXACT,\n                         new AjaxWizard.NewItemActionEvent<>(new GroupWrapper(clone), target));\n             }\n-        }, ActionType.CLONE, StandardEntitlement.GROUP_CREATE);\n+        }, ActionType.CLONE, StandardEntitlement.GROUP_CREATE).setRealm(realm);\n \n         panel.add(new ActionLink<GroupTO>() {\n \n@@ -282,7 +283,7 @@ public void onClick(final AjaxRequestTarget target, final GroupTO ignore) {\n                 typeExtensionsModal.header(new StringResourceModel(\"typeExtensions\", model));\n                 typeExtensionsModal.show(true);\n             }\n-        }, ActionType.TYPE_EXTENSIONS, StandardEntitlement.GROUP_UPDATE);\n+        }, ActionType.TYPE_EXTENSIONS, StandardEntitlement.GROUP_UPDATE).setRealm(realm);\n \n         panel.add(new ActionLink<GroupTO>() {\n \n@@ -298,7 +299,8 @@ public void onClick(final AjaxRequestTarget target, final GroupTO ignore) {\n             public boolean isIndicatorEnabled() {\n                 return false;\n             }\n-        }, ActionType.MEMBERS, StandardEntitlement.GROUP_READ);\n+        }, ActionType.MEMBERS, new StringBuilder().append(StandardEntitlement.GROUP_READ).append(\",\").\n+                append(StandardEntitlement.GROUP_UPDATE).toString()).setRealm(realm);\n \n         panel.add(new ActionLink<GroupTO>() {\n \n@@ -363,7 +365,7 @@ public void onClick(final AjaxRequestTarget target, final GroupTO ignore) {\n \n                 altDefaultModal.show(true);\n             }\n-        }, ActionType.MANAGE_RESOURCES, StandardEntitlement.GROUP_READ);\n+        }, ActionType.MANAGE_RESOURCES, StandardEntitlement.GROUP_READ).setRealm(realm);\n \n         panel.add(new ActionLink<GroupTO>() {\n \n@@ -408,7 +410,7 @@ public void onClick(final AjaxRequestTarget target, final GroupTO ignore) {\n                 }\n                 ((BasePage) pageRef.getPage()).getNotificationPanel().refresh(target);\n             }\n-        }, ActionType.DELETE, StandardEntitlement.GROUP_DELETE, true);\n+        }, ActionType.DELETE, StandardEntitlement.GROUP_DELETE, true).setRealm(realm);\n \n         return panel;\n     }"},{"sha":"5a62063cf0dfe27dbf37ababb59a4936b6bffc06","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/UserDirectoryPanel.java","status":"modified","additions":8,"deletions":7,"changes":15,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4b991ec91de5b7d53c7f0eef1d89fefb4e813957/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FUserDirectoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4b991ec91de5b7d53c7f0eef1d89fefb4e813957/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FUserDirectoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FUserDirectoryPanel.java?ref=4b991ec91de5b7d53c7f0eef1d89fefb4e813957","patch":"@@ -181,7 +181,7 @@ public void onClick(final AjaxRequestTarget target, final UserTO ignore) {\n                                 target));\n             }\n         }, ActionType.EDIT, new StringBuilder().append(StandardEntitlement.USER_READ).append(\",\").\n-                append(StandardEntitlement.USER_UPDATE).toString());\n+                append(StandardEntitlement.USER_UPDATE).toString()).setRealm(realm);\n \n         panel.add(new ActionLink<UserTO>() {\n \n@@ -201,7 +201,7 @@ protected boolean statusCondition(final UserTO modelObject) {\n                 return addAjaxLink.isVisibleInHierarchy();\n             }\n \n-        }, ActionType.CLONE, StandardEntitlement.USER_CREATE);\n+        }, ActionType.CLONE, StandardEntitlement.USER_CREATE).setRealm(realm);\n \n         panel.add(new ActionLink<UserTO>() {\n \n@@ -223,7 +223,7 @@ public void onClick(final AjaxRequestTarget target, final UserTO ignore) {\n                 }\n                 ((BasePage) pageRef.getPage()).getNotificationPanel().refresh(target);\n             }\n-        }, ActionType.MUSTCHANGEPASSWORD, StandardEntitlement.USER_UPDATE);\n+        }, ActionType.MUSTCHANGEPASSWORD, StandardEntitlement.USER_UPDATE).setRealm(realm);\n \n         if (wizardInModal) {\n             panel.add(new ActionLink<UserTO>() {\n@@ -247,7 +247,7 @@ public void onClick(final AjaxRequestTarget target, final UserTO ignore) {\n                     displayAttributeModal.show(true);\n                 }\n             }, ActionType.PASSWORD_RESET,\n-                    new StringBuilder().append(StandardEntitlement.USER_UPDATE).toString());\n+                    new StringBuilder().append(StandardEntitlement.USER_UPDATE).toString()).setRealm(realm);\n \n             panel.add(new ActionLink<UserTO>() {\n \n@@ -271,7 +271,7 @@ public void onClick(final AjaxRequestTarget target, final UserTO ignore) {\n \n                     altDefaultModal.show(true);\n                 }\n-            }, ActionType.ENABLE, StandardEntitlement.USER_UPDATE);\n+            }, ActionType.ENABLE, StandardEntitlement.USER_UPDATE).setRealm(realm);\n \n             panel.add(new ActionLink<UserTO>() {\n \n@@ -295,7 +295,7 @@ public void onClick(final AjaxRequestTarget target, final UserTO ignore) {\n \n                     altDefaultModal.show(true);\n                 }\n-            }, ActionType.MANAGE_RESOURCES, StandardEntitlement.USER_UPDATE);\n+            }, ActionType.MANAGE_RESOURCES, StandardEntitlement.USER_UPDATE).setRealm(realm);\n \n             panel.add(new ActionLink<UserTO>() {\n \n@@ -310,6 +310,7 @@ public void onClick(final AjaxRequestTarget target, final UserTO ignore) {\n                     utilityModal.show(true);\n                 }\n             }, ActionType.PROPAGATION_TASKS, StandardEntitlement.TASK_LIST);\n+            \n             panel.add(new ActionLink<UserTO>() {\n \n                 private static final long serialVersionUID = -7978723352517770644L;\n@@ -342,7 +343,7 @@ public void onClick(final AjaxRequestTarget target, final UserTO ignore) {\n                 }\n                 ((BasePage) pageRef.getPage()).getNotificationPanel().refresh(target);\n             }\n-        }, ActionType.DELETE, StandardEntitlement.USER_DELETE, true);\n+        }, ActionType.DELETE, StandardEntitlement.USER_DELETE, true).setRealm(realm);\n \n         return panel;\n     }"},{"sha":"15d99dd2e2b1656777fcce41df2142b658c9521d","filename":"client/console/src/main/java/org/apache/syncope/client/console/wicket/markup/html/form/Action.java","status":"modified","additions":10,"deletions":0,"changes":10,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4b991ec91de5b7d53c7f0eef1d89fefb4e813957/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FAction.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4b991ec91de5b7d53c7f0eef1d89fefb4e813957/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FAction.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FAction.java?ref=4b991ec91de5b7d53c7f0eef1d89fefb4e813957","patch":"@@ -31,6 +31,8 @@\n \n     private static final long serialVersionUID = -7989237020377623993L;\n \n+    private String realm = null;\n+\n     private final ActionLink<T> link;\n \n     private final ActionLink.ActionType type;\n@@ -64,6 +66,14 @@ public Action(final ActionLink<T> link, final ActionLink.ActionType type) {\n         this.indicator = true;\n     }\n \n+    public String getRealm() {\n+        return realm;\n+    }\n+\n+    public void setRealm(final String realm) {\n+        this.realm = realm;\n+    }\n+\n     public ActionLink<T> getLink() {\n         return link;\n     }"},{"sha":"fbe6a7eb77daec8d47357a714980853105c8ce24","filename":"client/console/src/main/java/org/apache/syncope/client/console/wicket/markup/html/form/ActionPanel.java","status":"modified","additions":10,"deletions":0,"changes":10,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4b991ec91de5b7d53c7f0eef1d89fefb4e813957/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FActionPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4b991ec91de5b7d53c7f0eef1d89fefb4e813957/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FActionPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FActionPanel.java?ref=4b991ec91de5b7d53c7f0eef1d89fefb4e813957","patch":"@@ -18,12 +18,16 @@\n  */\n package org.apache.syncope.client.console.wicket.markup.html.form;\n \n+import static org.apache.wicket.Component.RENDER;\n+\n import java.io.Serializable;\n import org.apache.commons.lang3.StringUtils;\n+import org.apache.syncope.client.console.SyncopeConsoleSession;\n import org.apache.syncope.client.console.wicket.markup.html.form.ActionLink.ActionType;\n import org.apache.wicket.AttributeModifier;\n import org.apache.wicket.ajax.AjaxRequestTarget;\n import org.apache.wicket.ajax.markup.html.AjaxLink;\n+import org.apache.wicket.authroles.authorization.strategies.role.metadata.MetaDataRoleAuthorizationStrategy;\n import org.apache.wicket.extensions.ajax.markup.html.IndicatingAjaxLink;\n import org.apache.wicket.markup.html.basic.Label;\n import org.apache.wicket.markup.html.panel.Panel;\n@@ -114,6 +118,12 @@ public String getAjaxIndicatorMarkupId() {\n             };\n         }\n \n+        if (SyncopeConsoleSession.get().owns(action.getEntitlements(), action.getRealm())) {\n+            MetaDataRoleAuthorizationStrategy.authorizeAll(actionLink, RENDER);\n+        } else {\n+            MetaDataRoleAuthorizationStrategy.unauthorizeAll(actionLink, RENDER);\n+        }\n+        \n         actionLink.setVisible(enabled);\n \n         actionIcon = new Label(\"actionIcon\", \"\");"}]}