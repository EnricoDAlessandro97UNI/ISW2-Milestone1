{"sha":"3abddfcc2f959140f04b520a40886228eac9f98b","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjNhYmRkZmNjMmY5NTkxNDBmMDRiNTIwYTQwODg2MjI4ZWFjOWY5OGI=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2013-10-11T07:37:10Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2013-10-11T07:37:10Z"},"message":"Disabling or removing components for 1.0.X -> 1.1.X upgrade\n\ngit-svn-id: https://svn.apache.org/repos/asf/syncope/trunk@1531207 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"6f07edf61d45778880dae10df9acd34b43e44583","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/6f07edf61d45778880dae10df9acd34b43e44583"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/3abddfcc2f959140f04b520a40886228eac9f98b","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/3abddfcc2f959140f04b520a40886228eac9f98b","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/3abddfcc2f959140f04b520a40886228eac9f98b","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/3abddfcc2f959140f04b520a40886228eac9f98b/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"fc5ad54bf23198264a01d72549f9cdd9fa26a768","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/fc5ad54bf23198264a01d72549f9cdd9fa26a768","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/fc5ad54bf23198264a01d72549f9cdd9fa26a768"}],"stats":{"total":89,"additions":24,"deletions":65},"files":[{"sha":"46910209ffc049e02d92d13f2d3122ae3c8324c5","filename":"common/src/main/java/org/apache/syncope/common/types/CipherAlgorithm.java","status":"modified","additions":16,"deletions":9,"changes":25,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3abddfcc2f959140f04b520a40886228eac9f98b/common%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Ftypes%2FCipherAlgorithm.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3abddfcc2f959140f04b520a40886228eac9f98b/common%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Ftypes%2FCipherAlgorithm.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/common%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Ftypes%2FCipherAlgorithm.java?ref=3abddfcc2f959140f04b520a40886228eac9f98b","patch":"@@ -23,24 +23,31 @@\n @XmlEnum\r\n public enum CipherAlgorithm {\r\n \r\n-    SHA1(\"SHA-1\"),\r\n-    SHA256(\"SHA-256\"),\r\n-    AES(\"AES\"),\r\n-    SMD5(\"S-MD5\"),\r\n-    SSHA1(\"S-SHA-1\"),\r\n-    SSHA256(\"S-SHA-256\"),\r\n-    BCRYPT(\"BCRYPT\");\r\n+    SHA1(\"SHA-1\", false),\r\n+    SHA256(\"SHA-256\", false),\r\n+    AES(\"AES\", true),\r\n+    SMD5(\"S-MD5\", false),\r\n+    SSHA1(\"S-SHA-1\", false),\r\n+    SSHA256(\"S-SHA-256\", false),\r\n+    BCRYPT(\"BCRYPT\", false);\r\n \r\n     final private String algorithm;\r\n \r\n-    CipherAlgorithm(final String algorithm) {\r\n+    final private boolean invertible;\r\n+\r\n+    CipherAlgorithm(final String algorithm, final boolean invertible) {\r\n         this.algorithm = algorithm;\r\n+        this.invertible = invertible;\r\n     }\r\n \r\n-    public final String getAlgorithm() {\r\n+    public String getAlgorithm() {\r\n         return algorithm;\r\n     }\r\n \r\n+    public boolean isInvertible() {\r\n+        return invertible;\r\n+    }\r\n+\r\n     public static CipherAlgorithm fromString(final String value) {\r\n         return CipherAlgorithm.valueOf(value.toUpperCase());\r\n     }\r"},{"sha":"e10cdd75722b361bc02e1b391625716e7e323636","filename":"core/src/main/java/org/apache/syncope/core/init/ContentUpgrader.java","status":"modified","additions":5,"deletions":0,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3abddfcc2f959140f04b520a40886228eac9f98b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Finit%2FContentUpgrader.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3abddfcc2f959140f04b520a40886228eac9f98b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Finit%2FContentUpgrader.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Finit%2FContentUpgrader.java?ref=3abddfcc2f959140f04b520a40886228eac9f98b","patch":"@@ -260,6 +260,11 @@ private void upgradeUserRequest() {\n \n     @Transactional\n     public void upgrade() {\n+        // Currently working for 1.0.X -> 1.1.X upgrade, hence forcibly disabled.\n+        if (true) {\n+            return;\n+        }\n+\n         if (ActivitiDetector.isActivitiEnabledForUsers()) {\n             upgradeActiviti();\n         }"},{"sha":"8e35d6d4968beaa6deec5e14a234c0cb913b627b","filename":"core/src/main/java/org/apache/syncope/core/persistence/beans/user/SyncopeUser.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3abddfcc2f959140f04b520a40886228eac9f98b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fbeans%2Fuser%2FSyncopeUser.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3abddfcc2f959140f04b520a40886228eac9f98b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fbeans%2Fuser%2FSyncopeUser.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fbeans%2Fuser%2FSyncopeUser.java?ref=3abddfcc2f959140f04b520a40886228eac9f98b","patch":"@@ -280,7 +280,7 @@ public CipherAlgorithm getCipherAlgorithm() {\n     }\n \n     public boolean canDecodePassword() {\n-        return CipherAlgorithm.AES == this.cipherAlgorithm;\n+        return this.cipherAlgorithm != null && this.cipherAlgorithm.isInvertible();\n     }\n \n     @Override"},{"sha":"b6a12b6cde75034af2427318a84c3bee212cfd15","filename":"core/src/main/java/org/apache/syncope/core/security/SyncopeMD5FallbackAuthenticationProvider.java","status":"removed","additions":0,"deletions":47,"changes":47,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fc5ad54bf23198264a01d72549f9cdd9fa26a768/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fsecurity%2FSyncopeMD5FallbackAuthenticationProvider.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fc5ad54bf23198264a01d72549f9cdd9fa26a768/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fsecurity%2FSyncopeMD5FallbackAuthenticationProvider.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fsecurity%2FSyncopeMD5FallbackAuthenticationProvider.java?ref=fc5ad54bf23198264a01d72549f9cdd9fa26a768","patch":"@@ -1,47 +0,0 @@\n-/*\n- * Licensed to the Apache Software Foundation (ASF) under one\n- * or more contributor license agreements.  See the NOTICE file\n- * distributed with this work for additional information\n- * regarding copyright ownership.  The ASF licenses this file\n- * to you under the Apache License, Version 2.0 (the\n- * \"License\"); you may not use this file except in compliance\n- * with the License.  You may obtain a copy of the License at\n- *\n- *   http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing,\n- * software distributed under the License is distributed on an\n- * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n- * KIND, either express or implied.  See the License for the\n- * specific language governing permissions and limitations\n- * under the License.\n- */\n-package org.apache.syncope.core.security;\n-\n-import org.apache.syncope.common.types.CipherAlgorithm;\n-import org.jasypt.commons.CommonUtils;\n-import org.jasypt.digest.StandardStringDigester;\n-\n-/**\n- * Extend standard authentication by checking passwords using MD5 (not supported anymore as per SYNCOPE-51).\n- */\n-public class SyncopeMD5FallbackAuthenticationProvider extends SyncopeAuthenticationProvider {\n-\n-    @Override\n-    protected boolean authenticate(final String password, final CipherAlgorithm cipherAlgorithm,\n-            final String digestedPassword) {\n-\n-        boolean authenticated = super.authenticate(password, cipherAlgorithm, digestedPassword);\n-        // if \"normal\" authentication fails and cipher is SMD5, we're probably handling an \"old\" MD5 password\n-        if (!authenticated && CipherAlgorithm.SMD5 == cipherAlgorithm) {\n-            StandardStringDigester digester = new StandardStringDigester();\n-            digester.setAlgorithm(\"MD5\");\n-            digester.setIterations(1);\n-            digester.setSaltSizeBytes(0);\n-            digester.setStringOutputType(CommonUtils.STRING_OUTPUT_TYPE_HEXADECIMAL);\n-\n-            authenticated = digester.matches(password, digestedPassword);\n-        }\n-        return authenticated;\n-    }\n-}"},{"sha":"becece6b607057e88a60e778c8fea2b66137b309","filename":"core/src/main/java/org/apache/syncope/core/util/PasswordEncoder.java","status":"modified","additions":2,"deletions":8,"changes":10,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3abddfcc2f959140f04b520a40886228eac9f98b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Futil%2FPasswordEncoder.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3abddfcc2f959140f04b520a40886228eac9f98b/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Futil%2FPasswordEncoder.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Futil%2FPasswordEncoder.java?ref=3abddfcc2f959140f04b520a40886228eac9f98b","patch":"@@ -18,7 +18,6 @@\n  */\n package org.apache.syncope.core.util;\n \n-import java.io.IOException;\n import java.io.InputStream;\n import java.io.UnsupportedEncodingException;\n import java.security.InvalidKeyException;\n@@ -29,6 +28,7 @@\n import javax.crypto.IllegalBlockSizeException;\n import javax.crypto.NoSuchPaddingException;\n import javax.crypto.spec.SecretKeySpec;\n+import org.apache.commons.io.IOUtils;\n import org.apache.commons.lang3.ArrayUtils;\n import org.apache.syncope.common.types.CipherAlgorithm;\n import org.jasypt.commons.CommonUtils;\n@@ -56,13 +56,7 @@ public final class PasswordEncoder {\n         } catch (Exception e) {\n             LOG.error(\"Could not read secretKey\", e);\n         } finally {\n-            if (propStream != null) {\n-                try {\n-                    propStream.close();\n-                } catch (IOException e) {\n-                    LOG.error(\"While closing property stream\", e);\n-                }\n-            }\n+            IOUtils.closeQuietly(propStream);\n         }\n \n         if (secretKey == null) {"}]}