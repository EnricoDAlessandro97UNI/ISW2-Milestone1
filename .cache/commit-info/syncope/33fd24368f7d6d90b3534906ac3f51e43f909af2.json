{"sha":"33fd24368f7d6d90b3534906ac3f51e43f909af2","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjMzZmQyNDM2OGY3ZDZkOTBiMzUzNDkwNmFjM2Y1MWU0M2Y5MDlhZjI=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2016-08-03T07:10:30Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2016-08-03T07:10:30Z"},"message":"Attempt to solve random failures with PullTaskITCase#reconcileFromLDAP","tree":{"sha":"f59659606e206482a81d1d6852ec6a5fdb74273a","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/f59659606e206482a81d1d6852ec6a5fdb74273a"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/33fd24368f7d6d90b3534906ac3f51e43f909af2","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/33fd24368f7d6d90b3534906ac3f51e43f909af2","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/33fd24368f7d6d90b3534906ac3f51e43f909af2","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/33fd24368f7d6d90b3534906ac3f51e43f909af2/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"c633d95d160f6a3e3c2f2d13091ecaa342f85150","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/c633d95d160f6a3e3c2f2d13091ecaa342f85150","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/c633d95d160f6a3e3c2f2d13091ecaa342f85150"}],"stats":{"total":23,"additions":19,"deletions":4},"files":[{"sha":"47a69cd9551bc1c06ffd9bbc8468bce97dd026bd","filename":"fit/core-reference/src/test/java/org/apache/syncope/fit/core/PullTaskITCase.java","status":"modified","additions":19,"deletions":4,"changes":23,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/33fd24368f7d6d90b3534906ac3f51e43f909af2/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FPullTaskITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/33fd24368f7d6d90b3534906ac3f51e43f909af2/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FPullTaskITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FPullTaskITCase.java?ref=33fd24368f7d6d90b3534906ac3f51e43f909af2","patch":"@@ -416,10 +416,25 @@ public void reconcileFromLDAP() {\n         execProvisioningTask(taskService, \"1e419ca4-ea81-4493-a14f-28b90113686d\", 50, false);\n \n         // 4. verify that LDAP group membership is propagated as Syncope membership\n-        PagedResult<UserTO> members = userService.search(new AnyQuery.Builder().realm(SyncopeConstants.ROOT_REALM).\n-                fiql(SyncopeClient.getUserSearchConditionBuilder().inGroups(groupTO.getKey()).query()).\n-                build());\n-        assertNotNull(members);\n+        int i = 0;\n+        int maxit = 50;\n+        PagedResult<UserTO> members;\n+        do {\n+            try {\n+                Thread.sleep(1000);\n+            } catch (InterruptedException e) {\n+            }\n+\n+            members = userService.search(new AnyQuery.Builder().realm(SyncopeConstants.ROOT_REALM).\n+                    fiql(SyncopeClient.getUserSearchConditionBuilder().inGroups(groupTO.getKey()).query()).\n+                    build());\n+            assertNotNull(members);\n+\n+            i++;\n+        } while (members.getResult().isEmpty() && i < maxit);\n+        if (i == maxit) {\n+            fail(\"Timeout while checking for memberships of \" + groupTO.getName());\n+        }\n         assertEquals(1, members.getResult().size());\n     }\n "}]}