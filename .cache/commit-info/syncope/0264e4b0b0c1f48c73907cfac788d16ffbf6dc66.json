{"sha":"0264e4b0b0c1f48c73907cfac788d16ffbf6dc66","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjAyNjRlNGIwYjBjMWY0OGM3MzkwN2NmYWM3ODhkMTZmZmJmNmRjNjY=","commit":{"author":{"name":"Unknown","email":"unknown@apache.org","date":"2010-10-25T16:10:04Z"},"committer":{"name":"Unknown","email":"unknown@apache.org","date":"2010-10-25T16:10:04Z"},"message":"(Fixes issue #61)\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/syncope/trunk@1246607 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"170e3374f7d06f86a6dfafe92a404360470c4f6b","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/170e3374f7d06f86a6dfafe92a404360470c4f6b"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/0264e4b0b0c1f48c73907cfac788d16ffbf6dc66","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/0264e4b0b0c1f48c73907cfac788d16ffbf6dc66","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/0264e4b0b0c1f48c73907cfac788d16ffbf6dc66","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/0264e4b0b0c1f48c73907cfac788d16ffbf6dc66/comments","author":null,"committer":null,"parents":[{"sha":"bab52cd7b18e1654a70f08d636c9811ad6f57656","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/bab52cd7b18e1654a70f08d636c9811ad6f57656","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/bab52cd7b18e1654a70f08d636c9811ad6f57656"}],"stats":{"total":22,"additions":20,"deletions":2},"files":[{"sha":"415408b912746f50d2e4099225af7394956ebd22","filename":"core/src/main/java/org/syncope/core/persistence/dao/ResourceDAO.java","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/0264e4b0b0c1f48c73907cfac788d16ffbf6dc66/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fdao%2FResourceDAO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/0264e4b0b0c1f48c73907cfac788d16ffbf6dc66/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fdao%2FResourceDAO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fdao%2FResourceDAO.java?ref=0264e4b0b0c1f48c73907cfac788d16ffbf6dc66","patch":"@@ -36,5 +36,7 @@ List<SchemaMapping> getMappings(String schemaName, SchemaType schemaType,\n \n     void deleteMappings(String schemaName, SchemaType schemaType);\n \n+    void deleteAllMappings(TargetResource resource);\n+\n     void delete(String name);\n }"},{"sha":"0dbd205a790b360e106044692787bd1cf4ce4298","filename":"core/src/main/java/org/syncope/core/persistence/dao/impl/ResourceDAOImpl.java","status":"modified","additions":14,"deletions":0,"changes":14,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/0264e4b0b0c1f48c73907cfac788d16ffbf6dc66/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fdao%2Fimpl%2FResourceDAOImpl.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/0264e4b0b0c1f48c73907cfac788d16ffbf6dc66/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fdao%2Fimpl%2FResourceDAOImpl.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fdao%2Fimpl%2FResourceDAOImpl.java?ref=0264e4b0b0c1f48c73907cfac788d16ffbf6dc66","patch":"@@ -128,6 +128,20 @@ public void deleteMappings(final String schemaName,\n         }\n     }\n \n+    @Override\n+    public void deleteAllMappings(final TargetResource resource) {\n+        Query query = entityManager.createQuery(\"DELETE FROM \"\n+                + SchemaMapping.class.getSimpleName()\n+                + \" m WHERE m.resource=:resource\");\n+        query.setParameter(\"resource\", resource);\n+        int items = query.executeUpdate();\n+        if (LOG.isDebugEnabled()) {\n+            LOG.debug(\"Removed \" + items + \" schema mappings\");\n+        }\n+\n+        resource.getMappings().clear();\n+    }\n+\n     @Override\n     public void delete(final String name) {\n         TargetResource resource = find(name);"},{"sha":"01f83acd75c99ae56d8af116525e0e62991eb97a","filename":"core/src/main/java/org/syncope/core/rest/controller/ResourceController.java","status":"modified","additions":4,"deletions":2,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/0264e4b0b0c1f48c73907cfac788d16ffbf6dc66/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fcontroller%2FResourceController.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/0264e4b0b0c1f48c73907cfac788d16ffbf6dc66/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fcontroller%2FResourceController.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fcontroller%2FResourceController.java?ref=0264e4b0b0c1f48c73907cfac788d16ffbf6dc66","patch":"@@ -46,8 +46,10 @@ public class ResourceController extends AbstractController {\n \n     @Autowired\n     private ResourceDAO resourceDAO;\n+\n     @Autowired\n     private SyncopeRoleDAO syncopeRoleDAO;\n+\n     @Autowired\n     private ResourceDataBinder binder;\n \n@@ -130,8 +132,8 @@ public ResourceTO update(final HttpServletResponse response,\n         if (LOG.isDebugEnabled()) {\n             LOG.debug(\"Remove old mappings ..\");\n         }\n-        // remove older mappings\n-        resource.getMappings().clear();\n+        // remove old mappings\n+        resourceDAO.deleteAllMappings(resource);\n \n         if (LOG.isDebugEnabled()) {\n             LOG.debug(\"Resource data binder ..\");"}]}