{"sha":"a54bade156ddf0f4da9dd1f188d438aa6c1c8b2a","node_id":"C_kwDOJfYA1toAKGE1NGJhZGUxNTZkZGYwZjRkYTlkZDFmMTg4ZDQzOGFhNmMxYzhiMmE","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2022-01-07T18:17:03Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2022-01-07T18:17:03Z"},"message":"Working around Spring Cloud Gateway tie to Hibernate Validator and not Jakarta Validation API","tree":{"sha":"762e30c5e88a67b90fdf22577fded083fe0084b8","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/762e30c5e88a67b90fdf22577fded083fe0084b8"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/a54bade156ddf0f4da9dd1f188d438aa6c1c8b2a","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/a54bade156ddf0f4da9dd1f188d438aa6c1c8b2a","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/a54bade156ddf0f4da9dd1f188d438aa6c1c8b2a","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/a54bade156ddf0f4da9dd1f188d438aa6c1c8b2a/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"18a21da32c2f6619a099504e54e6d3586dd1b128","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/18a21da32c2f6619a099504e54e6d3586dd1b128","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/18a21da32c2f6619a099504e54e6d3586dd1b128"}],"stats":{"total":109,"additions":101,"deletions":8},"files":[{"sha":"9d559a9d1433418df31c1535218b5b7f4955049b","filename":"sra/src/main/java/org/springframework/cloud/gateway/config/DataSizeMax.java","status":"added","additions":48,"deletions":0,"changes":48,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a54bade156ddf0f4da9dd1f188d438aa6c1c8b2a/sra%2Fsrc%2Fmain%2Fjava%2Forg%2Fspringframework%2Fcloud%2Fgateway%2Fconfig%2FDataSizeMax.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a54bade156ddf0f4da9dd1f188d438aa6c1c8b2a/sra%2Fsrc%2Fmain%2Fjava%2Forg%2Fspringframework%2Fcloud%2Fgateway%2Fconfig%2FDataSizeMax.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/sra%2Fsrc%2Fmain%2Fjava%2Forg%2Fspringframework%2Fcloud%2Fgateway%2Fconfig%2FDataSizeMax.java?ref=a54bade156ddf0f4da9dd1f188d438aa6c1c8b2a","patch":"@@ -0,0 +1,48 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.springframework.cloud.gateway.config;\n+\n+import java.lang.annotation.Documented;\n+import java.lang.annotation.ElementType;\n+import java.lang.annotation.Retention;\n+import java.lang.annotation.RetentionPolicy;\n+import java.lang.annotation.Target;\n+import javax.validation.Constraint;\n+import javax.validation.Payload;\n+import org.springframework.util.unit.DataUnit;\n+\n+// Keep until\n+// https://lists.apache.org/thread/km7c4ojrlw5q5j42cbw7nht6b0f4z5r2\n+// is clear.\n+@Documented\n+@Constraint(validatedBy = DataSizeMaxValidator.class)\n+@Target({ ElementType.FIELD, ElementType.METHOD })\n+@Retention(RetentionPolicy.RUNTIME)\n+public @interface DataSizeMax {\n+\n+    String message() default \"must be less than or equal to {value} {unit}\";\n+\n+    Class<?>[] groups() default {};\n+\n+    Class<? extends Payload>[] payload() default {};\n+\n+    int value();\n+\n+    DataUnit unit();\n+}"},{"sha":"5e3d5aaa57c65d656b9a7ad8adcd17012e1089cc","filename":"sra/src/main/java/org/springframework/cloud/gateway/config/DataSizeMaxValidator.java","status":"added","additions":41,"deletions":0,"changes":41,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a54bade156ddf0f4da9dd1f188d438aa6c1c8b2a/sra%2Fsrc%2Fmain%2Fjava%2Forg%2Fspringframework%2Fcloud%2Fgateway%2Fconfig%2FDataSizeMaxValidator.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a54bade156ddf0f4da9dd1f188d438aa6c1c8b2a/sra%2Fsrc%2Fmain%2Fjava%2Forg%2Fspringframework%2Fcloud%2Fgateway%2Fconfig%2FDataSizeMaxValidator.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/sra%2Fsrc%2Fmain%2Fjava%2Forg%2Fspringframework%2Fcloud%2Fgateway%2Fconfig%2FDataSizeMaxValidator.java?ref=a54bade156ddf0f4da9dd1f188d438aa6c1c8b2a","patch":"@@ -0,0 +1,41 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements. See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership. The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License. You may obtain a copy of the License at\n+ *\n+ * http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied. See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.springframework.cloud.gateway.config;\n+\n+import javax.validation.ConstraintValidator;\n+import javax.validation.ConstraintValidatorContext;\n+import org.springframework.util.unit.DataSize;\n+\n+// Keep until\n+// https://lists.apache.org/thread/km7c4ojrlw5q5j42cbw7nht6b0f4z5r2\n+// is clear.\n+public class DataSizeMaxValidator implements ConstraintValidator<DataSizeMax, DataSize> {\n+\n+    private DataSize dataSizeMax;\n+\n+    @Override\n+    public void initialize(final DataSizeMax dataSizeMax) {\n+        this.dataSizeMax = DataSize.of(dataSizeMax.value(), dataSizeMax.unit());\n+    }\n+\n+    @Override\n+    public boolean isValid(final DataSize value, final ConstraintValidatorContext context) {\n+        return value == null || dataSizeMax.compareTo(value) >= 0;\n+    }\n+}"},{"sha":"1a031028cfb2dbbc9b37653e143db3557e701e7f","filename":"sra/src/main/java/org/springframework/cloud/gateway/config/HttpClientProperties.java","status":"modified","additions":12,"deletions":8,"changes":20,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/a54bade156ddf0f4da9dd1f188d438aa6c1c8b2a/sra%2Fsrc%2Fmain%2Fjava%2Forg%2Fspringframework%2Fcloud%2Fgateway%2Fconfig%2FHttpClientProperties.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/a54bade156ddf0f4da9dd1f188d438aa6c1c8b2a/sra%2Fsrc%2Fmain%2Fjava%2Forg%2Fspringframework%2Fcloud%2Fgateway%2Fconfig%2FHttpClientProperties.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/sra%2Fsrc%2Fmain%2Fjava%2Forg%2Fspringframework%2Fcloud%2Fgateway%2Fconfig%2FHttpClientProperties.java?ref=a54bade156ddf0f4da9dd1f188d438aa6c1c8b2a","patch":"@@ -31,7 +31,6 @@\n import java.util.List;\n \n import javax.net.ssl.KeyManagerFactory;\n-import javax.validation.constraints.Max;\n \n import reactor.netty.resources.ConnectionProvider;\n import reactor.netty.tcp.SslProvider;\n@@ -42,17 +41,19 @@\n import org.springframework.core.style.ToStringCreator;\n import org.springframework.util.ResourceUtils;\n import org.springframework.util.unit.DataSize;\n-//import org.springframework.validation.annotation.Validated;\n+import org.springframework.util.unit.DataUnit;\n+import org.springframework.validation.annotation.Validated;\n \n // CHECKSTYLE:OFF\n-// Semi-blind copy from Spring Cloud Gateway sources, to keep until\n-// https://github.com/spring-cloud/spring-cloud-gateway/issues/2303\n-// is fixed.\n+// Semi-blind copy from Spring Cloud Gateway sources, to keep until they are tied\n+// to Hibernate Validator and not Jakarta Validation API - see\n+// https://lists.apache.org/thread/km7c4ojrlw5q5j42cbw7nht6b0f4z5r2\n+// for details.\n /**\n  * Configuration properties for the Netty {@link reactor.netty.http.client.HttpClient}.\n  */\n @ConfigurationProperties(\"spring.cloud.gateway.httpclient\")\n-//@Validated\n+@Validated\n @SuppressWarnings(\"deprecation\")\n public class HttpClientProperties {\n \n@@ -102,7 +103,7 @@ public void setResponseTimeout(Duration responseTimeout) {\n \t\tthis.responseTimeout = responseTimeout;\n \t}\n \n-\t@Max(Integer.MAX_VALUE)\n+\t@DataSizeMax(value = Integer.MAX_VALUE, unit = DataUnit.BYTES)\n \tpublic DataSize getMaxHeaderSize() {\n \t\treturn maxHeaderSize;\n \t}\n@@ -111,7 +112,7 @@ public void setMaxHeaderSize(DataSize maxHeaderSize) {\n \t\tthis.maxHeaderSize = maxHeaderSize;\n \t}\n \n-\t@Max(Integer.MAX_VALUE)\n+\t@DataSizeMax(value = Integer.MAX_VALUE, unit = DataUnit.BYTES)\n \tpublic DataSize getMaxInitialLineLength() {\n \t\treturn maxInitialLineLength;\n \t}\n@@ -422,6 +423,7 @@ public static class Ssl {\n \t\tprivate Duration closeNotifyReadTimeout = Duration.ZERO;\n \n \t\t/** The default ssl configuration type. Defaults to TCP. */\n+\t\t@Deprecated\n \t\tprivate SslProvider.DefaultConfigurationType defaultConfigurationType = SslProvider.DefaultConfigurationType.TCP;\n \n \t\t/** Keystore path for Netty HttpClient. */\n@@ -587,10 +589,12 @@ public void setCloseNotifyReadTimeout(Duration closeNotifyReadTimeout) {\n \t\t\tthis.closeNotifyReadTimeout = closeNotifyReadTimeout;\n \t\t}\n \n+\t\t@Deprecated\n \t\tpublic SslProvider.DefaultConfigurationType getDefaultConfigurationType() {\n \t\t\treturn defaultConfigurationType;\n \t\t}\n \n+\t\t@Deprecated\n \t\tpublic void setDefaultConfigurationType(SslProvider.DefaultConfigurationType defaultConfigurationType) {\n \t\t\tthis.defaultConfigurationType = defaultConfigurationType;\n \t\t}"}]}