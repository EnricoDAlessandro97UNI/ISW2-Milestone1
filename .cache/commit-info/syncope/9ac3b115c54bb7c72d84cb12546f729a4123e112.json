{"sha":"9ac3b115c54bb7c72d84cb12546f729a4123e112","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjlhYzNiMTE1YzU0YmI3YzcyZDg0Y2IxMjU0NmY3MjlhNDEyM2UxMTI=","commit":{"author":{"name":"Christian Schneider","email":"cschneider@apache.org","date":"2013-02-01T16:24:26Z"},"committer":{"name":"Christian Schneider","email":"cschneider@apache.org","date":"2013-02-01T16:24:26Z"},"message":"SYNCOPE-231 Switched contenttype of UserTest to xml and fixed error in TaskService create location\n\ngit-svn-id: https://svn.apache.org/repos/asf/syncope/trunk@1441509 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"eb68829744d29f4d941cb04658258fc35a2e645f","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/eb68829744d29f4d941cb04658258fc35a2e645f"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/9ac3b115c54bb7c72d84cb12546f729a4123e112","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/9ac3b115c54bb7c72d84cb12546f729a4123e112","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/9ac3b115c54bb7c72d84cb12546f729a4123e112","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/9ac3b115c54bb7c72d84cb12546f729a4123e112/comments","author":{"login":"cschneider","id":484584,"node_id":"MDQ6VXNlcjQ4NDU4NA==","avatar_url":"https://avatars.githubusercontent.com/u/484584?v=4","gravatar_id":"","url":"https://api.github.com/users/cschneider","html_url":"https://github.com/cschneider","followers_url":"https://api.github.com/users/cschneider/followers","following_url":"https://api.github.com/users/cschneider/following{/other_user}","gists_url":"https://api.github.com/users/cschneider/gists{/gist_id}","starred_url":"https://api.github.com/users/cschneider/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cschneider/subscriptions","organizations_url":"https://api.github.com/users/cschneider/orgs","repos_url":"https://api.github.com/users/cschneider/repos","events_url":"https://api.github.com/users/cschneider/events{/privacy}","received_events_url":"https://api.github.com/users/cschneider/received_events","type":"User","site_admin":false},"committer":{"login":"cschneider","id":484584,"node_id":"MDQ6VXNlcjQ4NDU4NA==","avatar_url":"https://avatars.githubusercontent.com/u/484584?v=4","gravatar_id":"","url":"https://api.github.com/users/cschneider","html_url":"https://github.com/cschneider","followers_url":"https://api.github.com/users/cschneider/followers","following_url":"https://api.github.com/users/cschneider/following{/other_user}","gists_url":"https://api.github.com/users/cschneider/gists{/gist_id}","starred_url":"https://api.github.com/users/cschneider/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cschneider/subscriptions","organizations_url":"https://api.github.com/users/cschneider/orgs","repos_url":"https://api.github.com/users/cschneider/repos","events_url":"https://api.github.com/users/cschneider/events{/privacy}","received_events_url":"https://api.github.com/users/cschneider/received_events","type":"User","site_admin":false},"parents":[{"sha":"8928d0001401b5c4e47d8cff38ff8a72b3ae7b04","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/8928d0001401b5c4e47d8cff38ff8a72b3ae7b04","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/8928d0001401b5c4e47d8cff38ff8a72b3ae7b04"}],"stats":{"total":30,"additions":29,"deletions":1},"files":[{"sha":"86e1e1d774301fd0b4f94bb82f127e19b57d567d","filename":"common/src/main/java/org/apache/syncope/common/to/TaskTO.java","status":"modified","additions":10,"deletions":0,"changes":10,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/9ac3b115c54bb7c72d84cb12546f729a4123e112/common%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Fto%2FTaskTO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/9ac3b115c54bb7c72d84cb12546f729a4123e112/common%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Fto%2FTaskTO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/common%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Fto%2FTaskTO.java?ref=9ac3b115c54bb7c72d84cb12546f729a4123e112","patch":"@@ -34,6 +34,16 @@\n @XmlType\r\n @XmlSeeAlso({ SyncTaskTO.class, NotificationTaskTO.class, SyncTaskTO.class,\r\n     SchedTaskTO.class, PropagationTaskTO.class })\r\n+\r\n+/* This will help CXF marshalling but is incompatible with spring services \r\n+@JsonTypeInfo(use=Id.NAME, include=As.PROPERTY, property=\"type\")\r\n+@JsonSubTypes({\r\n+    @JsonSubTypes.Type(value=NotificationTaskTO.class, name=\"notificationTask\"),\r\n+    @JsonSubTypes.Type(value=PropagationTaskTO.class, name=\"propagationTask\"),\r\n+    @JsonSubTypes.Type(value=SchedTaskTO.class, name=\"schedTask\"),\r\n+    @JsonSubTypes.Type(value=SyncTaskTO.class, name=\"syncTask\")\r\n+})\r\n+*/\r\n public abstract class TaskTO extends AbstractBaseBean {\r\n \r\n     private static final long serialVersionUID = 386450127003321197L;\r"},{"sha":"617f4ec43ce211e938eb266d83b406b1e589a504","filename":"core/src/main/java/org/apache/syncope/core/services/TaskServiceImpl.java","status":"modified","additions":18,"deletions":1,"changes":19,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/9ac3b115c54bb7c72d84cb12546f729a4123e112/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fservices%2FTaskServiceImpl.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/9ac3b115c54bb7c72d84cb12546f729a4123e112/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fservices%2FTaskServiceImpl.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fservices%2FTaskServiceImpl.java?ref=9ac3b115c54bb7c72d84cb12546f729a4123e112","patch":"@@ -29,6 +29,8 @@\n import org.apache.syncope.common.SyncopeConstants;\r\n import org.apache.syncope.common.services.TaskService;\r\n import org.apache.syncope.common.to.JobClassTO;\r\n+import org.apache.syncope.common.to.NotificationTaskTO;\r\n+import org.apache.syncope.common.to.PropagationTaskTO;\r\n import org.apache.syncope.common.to.ReportExecTO;\r\n import org.apache.syncope.common.to.SchedTaskTO;\r\n import org.apache.syncope.common.to.SyncActionClassTO;\r\n@@ -63,10 +65,25 @@ public Response create(final TaskTO taskTO) {\n         } else {\r\n             throw new BadRequestException();\r\n         }\r\n-        URI location = uriInfo.getAbsolutePathBuilder().path(createdTask.getId() + \"\").build();\r\n+        TaskType taskType = getTaskType(taskTO.getClass());\r\n+        URI location = uriInfo.getAbsolutePathBuilder().path(taskType.toString() + \"/\" + createdTask.getId()).build();\r\n         return Response.created(location).header(SyncopeConstants.REST_HEADER_ID, createdTask.getId()).build();\r\n     }\r\n \r\n+    private TaskType getTaskType(Class<? extends TaskTO> taskClass) {\r\n+        if (taskClass == PropagationTaskTO.class) {\r\n+            return TaskType.PROPAGATION;\r\n+        } else if (taskClass == NotificationTaskTO.class) {\r\n+            return TaskType.NOTIFICATION;\r\n+        } else if (taskClass == SchedTaskTO.class) {\r\n+            return TaskType.SCHEDULED;\r\n+        } else if (taskClass == SyncTaskTO.class) {\r\n+            return TaskType.SYNCHRONIZATION;\r\n+        } else {\r\n+            throw new IllegalArgumentException(\"Invalid task class: \" + taskClass.getName());\r\n+        }\r\n+    }\r\n+\r\n     @Override\r\n     public void delete(final Long taskId) {\r\n         taskController.delete(taskId);\r"},{"sha":"f4164376054798c3d489cb9648324809d5f86c93","filename":"core/src/test/java/org/apache/syncope/core/rest/jaxrs/UserTestITCaseJAXRS.java","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/9ac3b115c54bb7c72d84cb12546f729a4123e112/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2Fjaxrs%2FUserTestITCaseJAXRS.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/9ac3b115c54bb7c72d84cb12546f729a4123e112/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2Fjaxrs%2FUserTestITCaseJAXRS.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2Fjaxrs%2FUserTestITCaseJAXRS.java?ref=9ac3b115c54bb7c72d84cb12546f729a4123e112","patch":"@@ -28,5 +28,6 @@ public class UserTestITCaseJAXRS extends UserTestITCase {\n     public UserTestITCaseJAXRS() {\r\n         super();\r\n         setEnabledCXF(true);\r\n+        setContentType(CONTENT_TYPE_XML);\r\n     }\r\n }\r"}]}