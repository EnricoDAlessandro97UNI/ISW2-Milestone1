{"sha":"e51fb8346dc5453628a4615ef41534b684446c0f","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmU1MWZiODM0NmRjNTQ1MzYyOGE0NjE1ZWY0MTUzNGI2ODQ0NDZjMGY=","commit":{"author":{"name":"Massimiliano Perrone","email":"massi@apache.org","date":"2014-08-06T14:32:37Z"},"committer":{"name":"Massimiliano Perrone","email":"massi@apache.org","date":"2014-08-06T14:32:37Z"},"message":"merge from branch\n\ngit-svn-id: https://svn.apache.org/repos/asf/syncope/trunk@1616249 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"1f93dd929d43786935666531b5b52c01f6ab36ec","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/1f93dd929d43786935666531b5b52c01f6ab36ec"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/e51fb8346dc5453628a4615ef41534b684446c0f","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/e51fb8346dc5453628a4615ef41534b684446c0f","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/e51fb8346dc5453628a4615ef41534b684446c0f","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/e51fb8346dc5453628a4615ef41534b684446c0f/comments","author":null,"committer":null,"parents":[{"sha":"35a8dbef89f0099c0d20614e3295bd6d32b51c57","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/35a8dbef89f0099c0d20614e3295bd6d32b51c57","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/35a8dbef89f0099c0d20614e3295bd6d32b51c57"},{"sha":"092222cc8c1b809208b20d09d281d7508676a4a4","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/092222cc8c1b809208b20d09d281d7508676a4a4","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/092222cc8c1b809208b20d09d281d7508676a4a4"}],"stats":{"total":52,"additions":25,"deletions":27},"files":[{"sha":"61d9927b508df29d0464b675be60787c410b256a","filename":"installer/src/main/java/org/apache/syncope/installer/containers/AbstractContainer.java","status":"modified","additions":6,"deletions":2,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e51fb8346dc5453628a4615ef41534b684446c0f/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FAbstractContainer.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e51fb8346dc5453628a4615ef41534b684446c0f/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FAbstractContainer.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FAbstractContainer.java?ref=e51fb8346dc5453628a4615ef41534b684446c0f","patch":"@@ -20,8 +20,12 @@\n \n public abstract class AbstractContainer {\n \n-    protected static final String CORE_RELATIVE_PATH = \"%s/%s/core/target/syncope.war\";\n+    protected static final String UNIX_CORE_RELATIVE_PATH = \"%s/%s/core/target/syncope.war\";\n \n-    protected static final String CONSOLE_RELATIVE_PATH = \"%s/%s/console/target/syncope-console.war\";\n+    protected static final String WIN_CORE_RELATIVE_PATH = \"%s\\\\%s\\\\core\\\\target\\\\syncope.war\";\n+\n+    protected static final String UNIX_CONSOLE_RELATIVE_PATH = \"%s/%s/console/target/syncope-console.war\";\n+\n+    protected static final String WIN_CONSOLE_RELATIVE_PATH = \"%s\\\\%s\\\\console\\\\target\\\\syncope-console.war\";\n \n }"},{"sha":"5f174df24bb322519cc743303bc4a60373d526d5","filename":"installer/src/main/java/org/apache/syncope/installer/containers/Glassfish.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e51fb8346dc5453628a4615ef41534b684446c0f/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FGlassfish.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e51fb8346dc5453628a4615ef41534b684446c0f/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FGlassfish.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FGlassfish.java?ref=e51fb8346dc5453628a4615ef41534b684446c0f","patch":"@@ -30,11 +30,11 @@ public Glassfish(final String installPath, final String artifactId) {\n     }\n \n     public String deployCore() {\n-        return deploy(CORE_RELATIVE_PATH);\n+        return deploy(UNIX_CORE_RELATIVE_PATH);\n     }\n \n     public String deployConsole() {\n-        return deploy(CONSOLE_RELATIVE_PATH);\n+        return deploy(UNIX_CONSOLE_RELATIVE_PATH);\n     }\n \n     public String deploy(final String what) {"},{"sha":"3f9b90b1cbae6d923d4042cba3b3d5a32d4ae366","filename":"installer/src/main/java/org/apache/syncope/installer/containers/Tomcat.java","status":"modified","additions":11,"deletions":17,"changes":28,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e51fb8346dc5453628a4615ef41534b684446c0f/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FTomcat.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e51fb8346dc5453628a4615ef41534b684446c0f/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FTomcat.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FTomcat.java?ref=e51fb8346dc5453628a4615ef41534b684446c0f","patch":"@@ -25,17 +25,9 @@\n \n public class Tomcat extends AbstractContainer {\n \n-    private static final String UNIX_DEPLOY_SYNCOPE_CORE_QUERY\n-            = \"/manager/text/deploy?path=/syncope&war=file:\" + CORE_RELATIVE_PATH;\n+    private static final String DEPLOY_SYNCOPE_CORE_QUERY = \"/manager/text/deploy?path=/syncope&war=file:\";\n \n-    private static final String WIN_DEPLOY_SYNCOPE_CORE_QUERY\n-            = \"/manager/text/deploy?path=/syncope&war=file:%s\\\\%s\\\\core\\\\target\\\\syncope.war\";\n-\n-    private static final String UNIX_DEPLOY_SYNCOPE_CONSOLE_QUERY\n-            = \"/manager/text/deploy?path=/syncope-console&war=file:\" + CONSOLE_RELATIVE_PATH;\n-\n-    private static final String WIN_DEPLOY_SYNCOPE_CONSOLE_QUERY\n-            = \"/manager/text/deploy?path=/syncope-console&war=file:%s\\\\%s\\\\console\\\\target\\\\syncope-console.war\";\n+    private static final String DEPLOY_SYNCOPE_CONSOLE_QUERY = \"/manager/text/deploy?path=/syncope-console&war=file:\";\n \n     private final String installPath;\n \n@@ -53,9 +45,10 @@ public Tomcat(final boolean tomcatSsl, final String tomcatHost, final String tom\n     public boolean deployCore() {\n         int status;\n         if (FileSystemUtils.IS_WIN) {\n-            status = httpUtils.getWithBasicAuth(pathEncoded(WIN_DEPLOY_SYNCOPE_CORE_QUERY));\n+            status = httpUtils.getWithBasicAuth(DEPLOY_SYNCOPE_CORE_QUERY\n+                    + pathEncoded(String.format(WIN_CORE_RELATIVE_PATH, installPath, artifactId)));\n         } else {\n-            status = httpUtils.getWithBasicAuth(path(UNIX_DEPLOY_SYNCOPE_CORE_QUERY));\n+            status = httpUtils.getWithBasicAuth(path(DEPLOY_SYNCOPE_CORE_QUERY + UNIX_CORE_RELATIVE_PATH));\n         }\n \n         return status == 200;\n@@ -64,24 +57,25 @@ public boolean deployCore() {\n     public boolean deployConsole() {\n         int status;\n         if (FileSystemUtils.IS_WIN) {\n-            status = httpUtils.getWithBasicAuth(pathEncoded(WIN_DEPLOY_SYNCOPE_CONSOLE_QUERY));\n+            status = httpUtils.getWithBasicAuth(DEPLOY_SYNCOPE_CONSOLE_QUERY\n+                    + pathEncoded(String.format(WIN_CONSOLE_RELATIVE_PATH, installPath, artifactId)));\n         } else {\n-            status = httpUtils.getWithBasicAuth(path(UNIX_DEPLOY_SYNCOPE_CONSOLE_QUERY));\n+            status = httpUtils.getWithBasicAuth(path(DEPLOY_SYNCOPE_CONSOLE_QUERY + UNIX_CONSOLE_RELATIVE_PATH));\n         }\n \n         return status == 200;\n     }\n \n-    public String pathEncoded(final String what) {\n+    private String pathEncoded(final String what) {\n         String path = \"\";\n         try {\n-            path = URLEncoder.encode(String.format(what, installPath, artifactId), \"UTF-8\");\n+            path = URLEncoder.encode(what, \"UTF-8\");\n         } catch (UnsupportedEncodingException uee) {\n         }\n         return path;\n     }\n \n-    public String path(final String what) {\n+    private String path(final String what) {\n         return String.format(what, installPath, artifactId);\n     }\n }"},{"sha":"3560237a1a9a5bc2353631d6e9b34dd168dd2ab6","filename":"installer/src/main/java/org/apache/syncope/installer/containers/jboss/JBoss.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e51fb8346dc5453628a4615ef41534b684446c0f/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2Fjboss%2FJBoss.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e51fb8346dc5453628a4615ef41534b684446c0f/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2Fjboss%2FJBoss.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2Fjboss%2FJBoss.java?ref=e51fb8346dc5453628a4615ef41534b684446c0f","patch":"@@ -53,11 +53,11 @@ public JBoss(final boolean jbossSsl, final String jbossHost, final String jbossP\n     }\n \n     public boolean deployCore() {\n-        return deploy(CORE_RELATIVE_PATH, \"syncope.war\");\n+        return deploy(UNIX_CORE_RELATIVE_PATH, \"syncope.war\");\n     }\n \n     public boolean deployConsole() {\n-        return deploy(CONSOLE_RELATIVE_PATH, \"syncope-console.war\");\n+        return deploy(UNIX_CONSOLE_RELATIVE_PATH, \"syncope-console.war\");\n     }\n \n     public boolean deploy(final String whatDeploy, final String warName) {"},{"sha":"b842c26bcdab723b87ddc90bfe8e9132dfb50673","filename":"installer/src/main/java/org/apache/syncope/installer/processes/ArchetypeProcess.java","status":"modified","additions":3,"deletions":3,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e51fb8346dc5453628a4615ef41534b684446c0f/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fprocesses%2FArchetypeProcess.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e51fb8346dc5453628a4615ef41534b684446c0f/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fprocesses%2FArchetypeProcess.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fprocesses%2FArchetypeProcess.java?ref=e51fb8346dc5453628a4615ef41534b684446c0f","patch":"@@ -43,17 +43,17 @@ public void run(final AbstractUIProcessHandler handler, final String[] args) {\n         if (!new File(installPath).exists()) {\n             FileSystemUtils.createDirectory(installPath, handler, null);\n         }\n-        \n+\n         final MavenUtils mavenUtils = new MavenUtils(mavenDir);\n-        \n+\n         mavenUtils.archetypeGenerate(\n                 syncopeVersion, groupId, artifactId, secretKey, anonymousKey, installPath);\n \n         FileSystemUtils.writeToFile(new File(installPath + \"/\" + artifactId + Pom.PATH),\n                 String.format(Pom.FILE, syncopeVersion, syncopeVersion, groupId, artifactId));\n \n+        FileSystemUtils.createDirectory(confDirectory, handler, null);\n         FileSystemUtils.createDirectory(logsDirectory, handler, null);\n-\n         FileSystemUtils.createDirectory(bundlesDirectory, handler, null);\n \n         mavenUtils.createPackage(installPath + \"/\" + artifactId, confDirectory, logsDirectory, bundlesDirectory);"},{"sha":"a329835b966938869072bb10f23a90af7392c6b5","filename":"installer/src/main/java/org/apache/syncope/installer/utilities/MavenUtils.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e51fb8346dc5453628a4615ef41534b684446c0f/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Futilities%2FMavenUtils.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e51fb8346dc5453628a4615ef41534b684446c0f/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Futilities%2FMavenUtils.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Futilities%2FMavenUtils.java?ref=e51fb8346dc5453628a4615ef41534b684446c0f","patch":"@@ -78,7 +78,7 @@ public void createPackage(final String path, final String confDirectory,\n \n     private Properties packageProperties(final String confDirectory, final String logDirectory,\n             final String bundlesDirectory) {\n-        Properties properties = new Properties();\n+        final Properties properties = new Properties();\n         properties.setProperty(\"conf.directory\", confDirectory);\n         properties.setProperty(\"log.directory\", logDirectory);\n         properties.setProperty(\"bundles.directory\", bundlesDirectory);"}]}