{"sha":"ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmViZDIyZThjM2Y2MzU2ZGFkOTRiYWE2ZjRjNzgyMTIyNGI1ZDJhYWI=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2017-03-24T13:12:38Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2017-03-31T13:38:01Z"},"message":"[SYNCOPE-1041] SAML 2.0 SP extension: enduser components","tree":{"sha":"e2dc91c39525b02ec5a5fc6c00b1f3920761f391","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/e2dc91c39525b02ec5a5fc6c00b1f3920761f391"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"3d7405db84e40dc15a4e65d95667cf6075b1056d","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/3d7405db84e40dc15a4e65d95667cf6075b1056d","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/3d7405db84e40dc15a4e65d95667cf6075b1056d"}],"stats":{"total":750,"additions":571,"deletions":179},"files":[{"sha":"168656cb86972d80719deee1355233bf4983a2e0","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/SyncopeEnduserSession.java","status":"modified","additions":27,"deletions":5,"changes":32,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeEnduserSession.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeEnduserSession.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeEnduserSession.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -94,6 +94,15 @@ public boolean evaluate(final PlainSchemaTO object) {\n         });\n     }\n \n+    private void afterAuthentication() {\n+        Pair<Map<String, Set<String>>, UserTO> self = client.self();\n+        selfTO = self.getValue();\n+\n+        // bind explicitly this session to have a stateful behavior during http requests, unless session will\n+        // expire for every request\n+        this.bind();\n+    }\n+\n     public boolean authenticate(final String username, final String password) {\n         boolean authenticated = false;\n \n@@ -102,12 +111,25 @@ public boolean authenticate(final String username, final String password) {\n                     setDomain(SyncopeEnduserApplication.get().getDomain()).\n                     create(username, password);\n \n-            Pair<Map<String, Set<String>>, UserTO> self = client.self();\n-            selfTO = self.getValue();\n+            afterAuthentication();\n+\n+            authenticated = true;\n+        } catch (Exception e) {\n+            LOG.error(\"Authentication failed\", e);\n+        }\n+\n+        return authenticated;\n+    }\n+\n+    public boolean authenticate(final String jwt) {\n+        boolean authenticated = false;\n+\n+        try {\n+            client = SyncopeEnduserApplication.get().getClientFactory().\n+                    setDomain(SyncopeEnduserApplication.get().getDomain()).create(jwt);\n+\n+            afterAuthentication();\n \n-            // bind explicitly this session to have a stateful behavior during http requests, unless session will\n-            // expire for every request\n-            this.bind();\n             authenticated = true;\n         } catch (Exception e) {\n             LOG.error(\"Authentication failed\", e);"},{"sha":"4a8189ce1ea5e16dce441e8d0d153f356a220bce","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/commons/Constants.java","status":"added","additions":28,"deletions":0,"changes":28,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fcommons%2FConstants.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fcommons%2FConstants.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fcommons%2FConstants.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -0,0 +1,28 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.client.enduser.commons;\n+\n+public final class Constants {\n+\n+    public static final String BEFORE_LOGOUT = \"beforeLogoutPage\";\n+\n+    private Constants() {\n+        // private constructor for static utility class\n+    }\n+}"},{"sha":"4c017ca24f67ce8f03fd8c8933268edafc4d5140","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/pages/HomePage.java","status":"modified","additions":14,"deletions":2,"changes":16,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FHomePage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FHomePage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FHomePage.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -18,6 +18,8 @@\n  */\n package org.apache.syncope.client.enduser.pages;\n \n+import java.net.URLEncoder;\n+import java.nio.charset.StandardCharsets;\n import org.apache.wicket.NonResettingRestartException;\n import org.apache.wicket.markup.html.WebPage;\n import org.apache.wicket.request.mapper.parameter.PageParameters;\n@@ -28,7 +30,17 @@ public class HomePage extends WebPage {\n \n     public HomePage(final PageParameters parameters) {\n         super(parameters);\n-        throw new NonResettingRestartException(\"/app/\");\n-    }\n \n+        StringBuilder redirectUrl = new StringBuilder(\"/app/\");\n+        if (!parameters.get(\"errorMessage\").isNull()) {\n+            redirectUrl.append(\"#!self?errorMessage=\");\n+            try {\n+                redirectUrl.append(\n+                        URLEncoder.encode(parameters.get(\"errorMessage\").toString(), StandardCharsets.UTF_8.name()));\n+            } catch (Exception e) {\n+                redirectUrl.append(\"Generic error\");\n+            }\n+        }\n+        throw new NonResettingRestartException(redirectUrl.toString());\n+    }\n }"},{"sha":"37e3103b51774170696a97df7cb857c09d624fc3","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/pages/Logout.java","status":"added","additions":42,"deletions":0,"changes":42,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FLogout.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FLogout.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FLogout.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -0,0 +1,42 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.client.enduser.pages;\n+\n+import org.apache.syncope.client.enduser.SyncopeEnduserSession;\n+import org.apache.syncope.client.enduser.commons.Constants;\n+import org.apache.wicket.markup.html.WebPage;\n+\n+public class Logout extends WebPage {\n+\n+    private static final long serialVersionUID = -4514869014471715933L;\n+\n+    public Logout() {\n+        super();\n+\n+        @SuppressWarnings(\"unchecked\")\n+        Class<? extends WebPage> beforeLogout = (Class<? extends WebPage>) SyncopeEnduserSession.get().\n+                getAttribute(Constants.BEFORE_LOGOUT);\n+        if (beforeLogout == null) {\n+            SyncopeEnduserSession.get().invalidateNow();\n+            setResponsePage(getApplication().getHomePage());\n+        } else {\n+            setResponsePage(beforeLogout);\n+        }\n+    }\n+}"},{"sha":"f9b906e9941c69620fd12d8583ca9cdec95b54d8","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/resources/AnyTypeClassResource.java","status":"modified","additions":2,"deletions":3,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FAnyTypeClassResource.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FAnyTypeClassResource.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FAnyTypeClassResource.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -22,6 +22,7 @@\n import java.nio.charset.StandardCharsets;\n import java.util.List;\n import javax.servlet.http.HttpServletRequest;\n+import javax.ws.rs.core.MediaType;\n import javax.ws.rs.core.Response;\n import org.apache.syncope.client.enduser.SyncopeEnduserSession;\n import org.apache.syncope.client.enduser.annotations.Resource;\n@@ -36,13 +37,11 @@ public class AnyTypeClassResource extends BaseResource {\n \n     @Override\n     protected ResourceResponse newResourceResponse(final Attributes attributes) {\n-\n         LOG.debug(\"Get all available auxiliary classes\");\n \n         ResourceResponse response = new ResourceResponse();\n-\n+        response.setContentType(MediaType.APPLICATION_JSON);\n         try {\n-\n             HttpServletRequest request = (HttpServletRequest) attributes.getRequest().getContainerRequest();\n             if (!xsrfCheck(request)) {\n                 LOG.error(\"XSRF TOKEN does not match\");"},{"sha":"3af70934d04bf41eac47e008fa75d829dcf78e15","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/resources/AnyTypeResource.java","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FAnyTypeResource.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FAnyTypeResource.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FAnyTypeResource.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -21,6 +21,7 @@\n import java.io.IOException;\n import java.nio.charset.StandardCharsets;\n import javax.servlet.http.HttpServletRequest;\n+import javax.ws.rs.core.MediaType;\n import javax.ws.rs.core.Response;\n import org.apache.syncope.client.enduser.SyncopeEnduserSession;\n import org.apache.syncope.client.enduser.annotations.Resource;\n@@ -38,7 +39,7 @@ protected ResourceResponse newResourceResponse(final Attributes attributes) {\n         LOG.debug(\"Get all available auxiliary classes\");\n \n         ResourceResponse response = new ResourceResponse();\n-\n+        response.setContentType(MediaType.APPLICATION_JSON);\n         try {\n \n             HttpServletRequest request = (HttpServletRequest) attributes.getRequest().getContainerRequest();"},{"sha":"30c518e189cbf63f28ef253cef81df59fcaab371","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/resources/ExternalResourceResource.java","status":"modified","additions":3,"deletions":3,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FExternalResourceResource.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FExternalResourceResource.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FExternalResourceResource.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -22,6 +22,7 @@\n import java.nio.charset.StandardCharsets;\n import java.util.List;\n import javax.servlet.http.HttpServletRequest;\n+import javax.ws.rs.core.MediaType;\n import javax.ws.rs.core.Response;\n import org.apache.syncope.client.enduser.SyncopeEnduserSession;\n import org.apache.syncope.client.enduser.annotations.Resource;\n@@ -39,10 +40,9 @@ public class ExternalResourceResource extends BaseResource {\n     protected AbstractResource.ResourceResponse newResourceResponse(final IResource.Attributes attributes) {\n         LOG.debug(\"Search all available resources\");\n \n-        AbstractResource.ResourceResponse response = new AbstractResource.ResourceResponse();\n-\n+        ResourceResponse response = new AbstractResource.ResourceResponse();\n+        response.setContentType(MediaType.APPLICATION_JSON);\n         try {\n-\n             HttpServletRequest request = (HttpServletRequest) attributes.getRequest().getContainerRequest();\n             if (!xsrfCheck(request)) {\n                 LOG.error(\"XSRF TOKEN does not match\");"},{"sha":"c885e716341698c877b547757d8ebcd0882811f8","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/resources/GroupResource.java","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FGroupResource.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FGroupResource.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FGroupResource.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -23,6 +23,7 @@\n import java.nio.charset.StandardCharsets;\n import java.util.List;\n import javax.servlet.http.HttpServletRequest;\n+import javax.ws.rs.core.MediaType;\n import javax.ws.rs.core.Response;\n import org.apache.syncope.client.enduser.SyncopeEnduserSession;\n import org.apache.syncope.client.enduser.annotations.Resource;\n@@ -43,8 +44,8 @@ protected ResourceResponse newResourceResponse(final Attributes attributes) {\n         LOG.debug(\"Search all available groups\");\n \n         ResourceResponse response = new ResourceResponse();\n+        response.setContentType(MediaType.APPLICATION_JSON);\n         try {\n-\n             HttpServletRequest request = (HttpServletRequest) attributes.getRequest().getContainerRequest();\n             if (!xsrfCheck(request)) {\n                 LOG.error(\"XSRF TOKEN does not match\");"},{"sha":"bd4d30f7cbf435f7bc543c6a852724c3ffe54257","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/resources/InfoResource.java","status":"modified","additions":2,"deletions":0,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FInfoResource.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FInfoResource.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FInfoResource.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -20,6 +20,7 @@\n \n import java.io.IOException;\n import java.nio.charset.StandardCharsets;\n+import javax.ws.rs.core.MediaType;\n import javax.ws.rs.core.Response;\n import org.apache.commons.lang3.StringUtils;\n import org.apache.syncope.client.enduser.SyncopeEnduserConstants;\n@@ -38,6 +39,7 @@ public class InfoResource extends BaseResource {\n     @Override\n     protected ResourceResponse newResourceResponse(final IResource.Attributes attributes) {\n         ResourceResponse response = new ResourceResponse();\n+        response.setContentType(MediaType.APPLICATION_JSON);\n \n         try {\n             final CookieUtils sessionCookieUtils = SyncopeEnduserSession.get().getCookieUtils();"},{"sha":"b3bf91df0f261c6a997a8ff7f4840fd6202524e1","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/resources/LoginResource.java","status":"modified","additions":3,"deletions":2,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FLoginResource.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FLoginResource.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FLoginResource.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -21,6 +21,7 @@\n import java.io.IOException;\n import java.nio.charset.StandardCharsets;\n import javax.servlet.http.HttpServletRequest;\n+import javax.ws.rs.core.MediaType;\n import javax.ws.rs.core.Response;\n import org.apache.commons.lang3.StringUtils;\n import org.apache.syncope.client.enduser.SyncopeEnduserApplication;\n@@ -38,8 +39,8 @@ public class LoginResource extends BaseResource {\n \n     @Override\n     protected ResourceResponse newResourceResponse(final IResource.Attributes attributes) {\n-        AbstractResource.ResourceResponse response = new AbstractResource.ResourceResponse();\n-\n+        ResourceResponse response = new AbstractResource.ResourceResponse();\n+        response.setContentType(MediaType.TEXT_PLAIN);\n         try {\n             HttpServletRequest request = (HttpServletRequest) attributes.getRequest().getContainerRequest();\n "},{"sha":"8c6d74a83c78ce34a20953a52ace576c86eda3fc","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/resources/RealmResource.java","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FRealmResource.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FRealmResource.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FRealmResource.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -22,6 +22,7 @@\n import java.nio.charset.StandardCharsets;\n import java.util.List;\n import javax.servlet.http.HttpServletRequest;\n+import javax.ws.rs.core.MediaType;\n import javax.ws.rs.core.Response;\n import org.apache.syncope.client.enduser.SyncopeEnduserSession;\n import org.apache.syncope.client.enduser.annotations.Resource;\n@@ -39,7 +40,7 @@ protected ResourceResponse newResourceResponse(final Attributes attributes) {\n         LOG.debug(\"Search all available realms\");\n \n         ResourceResponse response = new ResourceResponse();\n-\n+        response.setContentType(MediaType.APPLICATION_JSON);\n         try {\n             HttpServletRequest request = (HttpServletRequest) attributes.getRequest().getContainerRequest();\n             if (!xsrfCheck(request)) {"},{"sha":"a68704d3cd324299cf2d18edb35a913e4b20b1da","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/resources/SchemaResource.java","status":"modified","additions":3,"deletions":2,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FSchemaResource.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FSchemaResource.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FSchemaResource.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -23,6 +23,7 @@\n import java.util.Collections;\n import java.util.List;\n import javax.servlet.http.HttpServletRequest;\n+import javax.ws.rs.core.MediaType;\n import javax.ws.rs.core.Response;\n import org.apache.commons.collections4.IterableUtils;\n import org.apache.commons.collections4.Predicate;\n@@ -52,8 +53,8 @@ public class SchemaResource extends BaseResource {\n     protected AbstractResource.ResourceResponse newResourceResponse(final IResource.Attributes attributes) {\n         LOG.debug(\"Search all {} any type kind related schemas\", AnyTypeKind.USER.name());\n \n-        AbstractResource.ResourceResponse response = new AbstractResource.ResourceResponse();\n-\n+        ResourceResponse response = new AbstractResource.ResourceResponse();\n+        response.setContentType(MediaType.APPLICATION_JSON);\n         try {\n             HttpServletRequest request = (HttpServletRequest) attributes.getRequest().getContainerRequest();\n "},{"sha":"419d51b4c37f177c0e5145f26b62719991ac7c78","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/resources/SecurityQuestionByUsernameResource.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FSecurityQuestionByUsernameResource.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FSecurityQuestionByUsernameResource.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FSecurityQuestionByUsernameResource.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -41,8 +41,8 @@ public class SecurityQuestionByUsernameResource extends BaseResource {\n     protected AbstractResource.ResourceResponse newResourceResponse(final IResource.Attributes attributes) {\n         LOG.debug(\"List available security questions\");\n \n-        AbstractResource.ResourceResponse response = new AbstractResource.ResourceResponse();\n-\n+        ResourceResponse response = new AbstractResource.ResourceResponse();\n+        response.setContentType(MediaType.APPLICATION_JSON);\n         try {\n             HttpServletRequest request = (HttpServletRequest) attributes.getRequest().getContainerRequest();\n "},{"sha":"201da2d8466f6d5149c39e9d58ed6be6418aab74","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/resources/SecurityQuestionsResource.java","status":"modified","additions":1,"deletions":2,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FSecurityQuestionsResource.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FSecurityQuestionsResource.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FSecurityQuestionsResource.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -41,7 +41,7 @@ protected AbstractResource.ResourceResponse newResourceResponse(final IResource.\n         LOG.debug(\"List available security questions\");\n \n         AbstractResource.ResourceResponse response = new AbstractResource.ResourceResponse();\n-\n+        response.setContentType(MediaType.APPLICATION_JSON);\n         try {\n             HttpServletRequest request = (HttpServletRequest) attributes.getRequest().getContainerRequest();\n \n@@ -61,7 +61,6 @@ public void writeData(final IResource.Attributes attributes) throws IOException\n                 }\n             });\n \n-            response.setContentType(MediaType.APPLICATION_JSON);\n             response.setTextEncoding(StandardCharsets.UTF_8.name());\n             response.setStatusCode(Response.Status.OK.getStatusCode());\n         } catch (Exception e) {"},{"sha":"9d8ed9a25366e2becf79576a5eb440169c1d556d","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/resources/UserSelfChangePassword.java","status":"modified","additions":3,"deletions":2,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfChangePassword.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfChangePassword.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfChangePassword.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -22,6 +22,7 @@\n import java.nio.charset.StandardCharsets;\n import java.util.Map;\n import javax.servlet.http.HttpServletRequest;\n+import javax.ws.rs.core.MediaType;\n import javax.ws.rs.core.Response;\n import org.apache.syncope.client.enduser.SyncopeEnduserSession;\n import org.apache.syncope.client.enduser.annotations.Resource;\n@@ -36,8 +37,8 @@ public class UserSelfChangePassword extends BaseResource {\n \n     @Override\n     protected ResourceResponse newResourceResponse(final IResource.Attributes attributes) {\n-        AbstractResource.ResourceResponse response = new AbstractResource.ResourceResponse();\n-\n+        ResourceResponse response = new AbstractResource.ResourceResponse();\n+        response.setContentType(MediaType.APPLICATION_JSON);\n         try {\n             HttpServletRequest request = (HttpServletRequest) attributes.getRequest().getContainerRequest();\n             if (!xsrfCheck(request)) {"},{"sha":"343ed64458c9f56a24838ecea1b4b4bfd1247b34","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/resources/UserSelfConfirmPasswordReset.java","status":"modified","additions":3,"deletions":3,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfConfirmPasswordReset.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfConfirmPasswordReset.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfConfirmPasswordReset.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -22,6 +22,7 @@\n import java.nio.charset.StandardCharsets;\n import java.util.Map;\n import javax.servlet.http.HttpServletRequest;\n+import javax.ws.rs.core.MediaType;\n import javax.ws.rs.core.Response;\n import org.apache.syncope.client.enduser.SyncopeEnduserSession;\n import org.apache.syncope.client.enduser.annotations.Resource;\n@@ -36,8 +37,8 @@ public class UserSelfConfirmPasswordReset extends BaseResource {\n \n     @Override\n     protected ResourceResponse newResourceResponse(final IResource.Attributes attributes) {\n-        AbstractResource.ResourceResponse response = new AbstractResource.ResourceResponse();\n-\n+        ResourceResponse response = new AbstractResource.ResourceResponse();\n+        response.setContentType(MediaType.APPLICATION_JSON);\n         try {\n             HttpServletRequest request = (HttpServletRequest) attributes.getRequest().getContainerRequest();\n             if (!xsrfCheck(request)) {\n@@ -72,7 +73,6 @@ public void writeData(final Attributes attributes) throws IOException {\n             });\n \n             response.setStatusCode(Response.Status.OK.getStatusCode());\n-\n         } catch (final Exception e) {\n             LOG.error(\"Error while updating user\", e);\n             response.setError(Response.Status.BAD_REQUEST.getStatusCode(), new StringBuilder()"},{"sha":"26346406317bd7589277ce003f7076bad977838e","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/resources/UserSelfCreateResource.java","status":"modified","additions":4,"deletions":4,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfCreateResource.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfCreateResource.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfCreateResource.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -28,6 +28,7 @@\n import java.util.Map;\n import java.util.Set;\n import javax.servlet.http.HttpServletRequest;\n+import javax.ws.rs.core.MediaType;\n import javax.ws.rs.core.Response;\n import org.apache.commons.collections4.IterableUtils;\n import org.apache.commons.collections4.Predicate;\n@@ -63,9 +64,8 @@ private boolean isSelfRegistrationAllowed() {\n \n     @Override\n     protected ResourceResponse newResourceResponse(final Attributes attributes) {\n-        final StringBuilder responseMessage = new StringBuilder();\n         ResourceResponse response = new ResourceResponse();\n-\n+        response.setContentType(MediaType.APPLICATION_JSON);\n         try {\n             HttpServletRequest request = (HttpServletRequest) attributes.getRequest().getContainerRequest();\n \n@@ -197,8 +197,8 @@ public boolean evaluate(final MembershipTO item) {\n                     public void writeData(final Attributes attributes) throws IOException {\n                         attributes.getResponse().write(res.getStatusInfo().getFamily().equals(\n                                 Response.Status.Family.SUCCESSFUL)\n-                                        ? responseMessage.append(\"User: \").append(userTO.getUsername()).append(\n-                                                \" successfully created\")\n+                                        ? new StringBuilder().append(\"User: \").append(userTO.getUsername()).\n+                                                append(\" successfully created\")\n                                         : new StringBuilder().append(\"ErrorMessage{{ \").\n                                                 append(res.getStatusInfo().getReasonPhrase()).append(\" }}\"));\n                     }"},{"sha":"e153b813ceb70fd7097d5b39fed38f482f4800ea","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/resources/UserSelfIsLogged.java","status":"modified","additions":3,"deletions":3,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfIsLogged.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfIsLogged.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfIsLogged.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -20,6 +20,7 @@\n \n import java.io.IOException;\n import javax.servlet.http.HttpServletRequest;\n+import javax.ws.rs.core.MediaType;\n import javax.ws.rs.core.Response;\n import org.apache.syncope.client.enduser.SyncopeEnduserSession;\n import org.apache.syncope.client.enduser.annotations.Resource;\n@@ -32,10 +33,10 @@ public class UserSelfIsLogged extends BaseResource {\n \n     @Override\n     protected ResourceResponse newResourceResponse(final Attributes attributes) {\n-        ResourceResponse response = new ResourceResponse();\n-\n         LOG.debug(\"Checking if user is authenticated\");\n \n+        ResourceResponse response = new ResourceResponse();\n+        response.setContentType(MediaType.TEXT_PLAIN);\n         try {\n             HttpServletRequest request = (HttpServletRequest) attributes.getRequest().getContainerRequest();\n             if (!xsrfCheck(request)) {\n@@ -53,7 +54,6 @@ public void writeData(final IResource.Attributes attributes) throws IOException\n                 }\n             });\n             response.setStatusCode(Response.Status.OK.getStatusCode());\n-\n         } catch (Exception e) {\n             LOG.error(\"Could not read credentials from request\", e);\n             response.setError(Response.Status.BAD_REQUEST.getStatusCode(), new StringBuilder()"},{"sha":"f97d348f7a38bdaa858d5db2cd31d727ee8cc27b","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/resources/UserSelfPasswordReset.java","status":"modified","additions":3,"deletions":2,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfPasswordReset.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfPasswordReset.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfPasswordReset.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -22,6 +22,7 @@\n import java.nio.charset.StandardCharsets;\n import java.util.Map;\n import javax.servlet.http.HttpServletRequest;\n+import javax.ws.rs.core.MediaType;\n import javax.ws.rs.core.Response;\n import org.apache.commons.lang3.ArrayUtils;\n import org.apache.syncope.client.enduser.SyncopeEnduserConstants;\n@@ -38,8 +39,8 @@ public class UserSelfPasswordReset extends BaseResource {\n \n     @Override\n     protected ResourceResponse newResourceResponse(final IResource.Attributes attributes) {\n-        AbstractResource.ResourceResponse response = new AbstractResource.ResourceResponse();\n-\n+        ResourceResponse response = new AbstractResource.ResourceResponse();\n+        response.setContentType(MediaType.APPLICATION_JSON);\n         try {\n             HttpServletRequest request = (HttpServletRequest) attributes.getRequest().getContainerRequest();\n             if (!xsrfCheck(request)) {"},{"sha":"8aefb550c9fcd87c85ac6b5d7ef02fa35e39dabc","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/resources/UserSelfReadResource.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfReadResource.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfReadResource.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfReadResource.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -46,9 +46,9 @@ public class UserSelfReadResource extends BaseResource {\n     protected ResourceResponse newResourceResponse(final IResource.Attributes attributes) {\n         LOG.debug(\"Requested user self information\");\n \n-        AbstractResource.ResourceResponse response = new AbstractResource.ResourceResponse();\n+        ResourceResponse response = new AbstractResource.ResourceResponse();\n+        response.setContentType(MediaType.APPLICATION_JSON);\n         try {\n-\n             HttpServletRequest request = (HttpServletRequest) attributes.getRequest().getContainerRequest();\n             if (!xsrfCheck(request)) {\n                 LOG.error(\"XSRF TOKEN does not match\");"},{"sha":"4a7e78c1e1184230b4f41eba4e08002da1daf8fc","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/resources/UserSelfUpdateResource.java","status":"modified","additions":3,"deletions":2,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfUpdateResource.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfUpdateResource.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfUpdateResource.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -26,6 +26,7 @@\n import java.util.Map;\n import java.util.Set;\n import javax.servlet.http.HttpServletRequest;\n+import javax.ws.rs.core.MediaType;\n import javax.ws.rs.core.Response;\n import org.apache.commons.collections4.IterableUtils;\n import org.apache.commons.collections4.Predicate;\n@@ -49,8 +50,8 @@ public class UserSelfUpdateResource extends BaseResource {\n \n     @Override\n     protected ResourceResponse newResourceResponse(final IResource.Attributes attributes) {\n-        AbstractResource.ResourceResponse response = new AbstractResource.ResourceResponse();\n-\n+        ResourceResponse response = new AbstractResource.ResourceResponse();\n+        response.setContentType(MediaType.TEXT_PLAIN);\n         try {\n             HttpServletRequest request = (HttpServletRequest) attributes.getRequest().getContainerRequest();\n             if (!xsrfCheck(request)) {"},{"sha":"a517ae50903fc54ee91602ddafc74932f68099f7","filename":"client/enduser/src/main/resources/META-INF/resources/app/css/login.css","status":"modified","additions":1,"deletions":24,"changes":25,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fcss%2Flogin.css","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fcss%2Flogin.css","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fcss%2Flogin.css?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -18,13 +18,7 @@\n  */\n \n body, html {\n-  /*margin: 45px 0;*/\n-  /*height: 100%;*/\n   background-repeat: no-repeat;\n-  /*background-image: linear-gradient(rgb(104, 145, 162), #00a65a);*/\n-  /*background-color: #00A65A;\n-  height: 100%;\n-  background-image: linear-gradient(#6891A2, #00A65A);*/\n }\n \n body{\n@@ -39,8 +33,6 @@ body{\n   }\n }\n \n-\n-\n .login-btn {\n   background: -moz-linear-gradient(top, #a9db80 0%, #96c56f 100%); /* FF3.6+ */\n   background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#a9db80), color-stop(100%,#96c56f)); /* Chrome,Safari4+ */\n@@ -54,21 +46,6 @@ body{\n   background: #658D5D;\n }\n \n-/*\n-#login {\n-  position: relative;\n-  padding: 25px 25px 50px 25px;\n-  margin-bottom: 1em;\n-}\n-#login #login-form {\n-  margin-top: 2em;\n-  margin-bottom: 2em;\n-  text-align: left;\n-}\n-#login-form{\n-  padding: 0 195px;\n-  margin: 7%;\n-}*/\n #languageContainer {\n   padding: 0 25px;\n }\n@@ -134,4 +111,4 @@ body{\n \n input[type=\"number\"]{\n   padding-right: 0px !important\n-}\n\\ No newline at end of file\n+}"},{"sha":"21a79843c9e20599641c8ad5accea3a72452b979","filename":"client/enduser/src/main/resources/META-INF/resources/app/index.html","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Findex.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Findex.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Findex.html?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -98,6 +98,7 @@\n   <script src=\"js/services/resourceService.js\"></script>\n   <script src=\"js/services/groupService.js\"></script>\n   <script src=\"js/services/anyService.js\"></script>\n+  <script src=\"js/services/saml2IdPService.js\"></script>\n   <!--controllers-->\n   <script src=\"js/controllers/HomeController.js\"></script>\n   <script src=\"js/controllers/LoginController.js\"></script>"},{"sha":"d8ceeb41ce6e03318f8b12c919181b293893e65e","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/app.js","status":"modified","additions":41,"deletions":23,"changes":64,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fapp.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fapp.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fapp.js?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -48,11 +48,11 @@ var app = angular.module('SyncopeEnduserApp', [\n app.config(['$stateProvider', '$urlRouterProvider', '$httpProvider', '$translateProvider', '$translatePartialLoaderProvider',\n   function ($stateProvider, $urlRouterProvider, $httpProvider, $translateProvider, $translatePartialLoaderProvider) {\n     /*\n-       |--------------------------------------------------------------------------\n-       | Syncope Enduser AngularJS providers configuration\n-       |--------------------------------------------------------------------------\n+     |--------------------------------------------------------------------------\n+     | Syncope Enduser AngularJS providers configuration\n+     |--------------------------------------------------------------------------\n      */\n-    \n+\n     /*\n      * i18n provider\n      */\n@@ -70,7 +70,7 @@ app.config(['$stateProvider', '$urlRouterProvider', '$httpProvider', '$translate\n               templateUrl: 'views/self.html'\n             })\n             .state('self', {\n-              url: '/self',\n+              url: '/self?errorMessage',\n               templateUrl: 'views/self.html'\n             })\n             .state('user-self-update', {\n@@ -250,7 +250,7 @@ app.config(['$stateProvider', '$urlRouterProvider', '$httpProvider', '$translate\n         },\n         'responseError': function (response) {\n           $rootScope.spinner.off();\n-          if (response.config.url.indexOf(\"acceptError=true\") === -1) {\n+          if (response.config && response.config.url.indexOf(\"acceptError=true\") === -1) {\n             var status = response.status;\n             if (status === 401) {\n               console.error(\"ERROR \", status);\n@@ -270,12 +270,12 @@ app.config(['$stateProvider', '$urlRouterProvider', '$httpProvider', '$translate\n app.run(['$rootScope', '$location', '$state', 'AuthService',\n   function ($rootScope, $location, $state, AuthService) {\n     /*\n-       |--------------------------------------------------------------------------\n-       | Main of Syncope Enduser application\n-       |\n-       | keep user logged in after page refresh\n-       | If the route change failed due to authentication error, redirect them out\n-       |--------------------------------------------------------------------------\n+     |--------------------------------------------------------------------------\n+     | Main of Syncope Enduser application\n+     |\n+     | keep user logged in after page refresh\n+     | If the route change failed due to authentication error, redirect them out\n+     |--------------------------------------------------------------------------\n      */\n     $rootScope.$on('$routeChangeError', function (event, current, previous, rejection) {\n       if (rejection === 'Not Authenticated') {\n@@ -331,12 +331,12 @@ app.run(['$rootScope', '$location', '$state', 'AuthService',\n       }\n     };\n   }]);\n-app.controller('ApplicationController', ['$scope', '$rootScope', 'InfoService', function ($scope, $rootScope,\n-          InfoService) {\n+app.controller('ApplicationController', ['$scope', '$rootScope', '$location', 'InfoService', 'SAML2IdPService',\n+  function ($scope, $rootScope, $location, InfoService, SAML2IdPService) {\n     $scope.initApplication = function () {\n       /* \n        * disable by default wizard buttons in self-registration\n-       */ \n+       */\n       $rootScope.endReached = false;\n       /*\n        |--------------------------------------------------------------------------\n@@ -345,9 +345,9 @@ app.controller('ApplicationController', ['$scope', '$rootScope', 'InfoService',\n        */\n       $rootScope.languages = {\n         availableLanguages: [\n-          { id: '1', name: 'Italiano', code: 'it', format: 'dd/MM/yyyy HH:mm' },\n-          { id: '2', name: 'English', code: 'en', format: 'MM/dd/yyyy HH:mm' },\n-          { id: '3', name: 'Deutsch', code: 'de', format: 'dd/MM/yyyy HH:mm' }\n+          {id: '1', name: 'Italiano', code: 'it', format: 'dd/MM/yyyy HH:mm'},\n+          {id: '2', name: 'English', code: 'en', format: 'MM/dd/yyyy HH:mm'},\n+          {id: '3', name: 'Deutsch', code: 'de', format: 'dd/MM/yyyy HH:mm'}\n         ]\n       };\n       $rootScope.languages.selectedLanguage = $rootScope.languages.availableLanguages[1];\n@@ -363,6 +363,11 @@ app.controller('ApplicationController', ['$scope', '$rootScope', 'InfoService',\n       $rootScope.pwdResetRequiringSecurityQuestions = false;\n       $rootScope.captchaEnabled = false;\n       $rootScope.validationEnabled = true;\n+      $rootScope.saml2idps = {\n+        available: [],\n+        selected: {}\n+      };\n+\n       InfoService.getInfo().then(\n               function (response) {\n                 $rootScope.pwdResetAllowed = response.pwdResetAllowed;\n@@ -374,28 +379,41 @@ app.controller('ApplicationController', ['$scope', '$rootScope', 'InfoService',\n               function (response) {\n                 console.error(\"Something went wrong while accessing info resource\", response);\n               });\n+      SAML2IdPService.getAvailableSAML2IdPs().then(\n+              function (response) {\n+                $rootScope.saml2idps.available = response;\n+              },\n+              function (response) {\n+                console.debug(\"No SAML 2.0 SP extension available\", response);\n+              });\n       /* \n        * configuration getters\n-       */ \n+       */\n       $rootScope.isSelfRegAllowed = function () {\n         return $rootScope.selfRegAllowed === true;\n       };\n       $rootScope.isPwdResetAllowed = function () {\n         return $rootScope.pwdResetAllowed === true;\n       };\n+      $rootScope.saml2spExtAvailable = function () {\n+        return $rootScope.saml2idps.available.length > 0;\n+      }\n+      $rootScope.saml2login = function () {\n+        window.location.href = '../saml2sp/login?idp=' + $rootScope.saml2idps.selected.entityID;\n+      }\n       $rootScope.getVersion = function () {\n         return $rootScope.version;\n       };\n       /* \n        * USER Attributes sorting strategies\n        */\n       $rootScope.attributesSorting = {\n-        ASC: function ( a, b ) {\n+        ASC: function (a, b) {\n           var schemaNameA = a.key;\n           var schemaNameB = b.key;\n           return schemaNameA < schemaNameB ? -1 : schemaNameA > schemaNameB ? 1 : 0;\n         },\n-        DESC: function ( a, b ) {\n+        DESC: function (a, b) {\n           var schemaNameA = a.key;\n           var schemaNameB = b.key;\n           return schemaNameA < schemaNameB ? 1 : schemaNameA > schemaNameB ? -1 : 0;\n@@ -405,7 +423,7 @@ app.controller('ApplicationController', ['$scope', '$rootScope', 'InfoService',\n        |--------------------------------------------------------------------------\n        | Notification mgmt\n        |--------------------------------------------------------------------------\n-       */    \n+       */\n       $scope.notification = $('#notifications').kendoNotification().data(\"kendoNotification\");\n       $scope.notification.setOptions({stacking: \"down\"});\n       $scope.notification.options.position[\"top\"] = 20;\n@@ -490,7 +508,7 @@ app.controller('ApplicationController', ['$scope', '$rootScope', 'InfoService',\n        |--------------------------------------------------------------------------\n        | Wizard configuration\n        |--------------------------------------------------------------------------\n-       */ \n+       */\n       $scope.wizard = {\n         \"credentials\": {url: \"/credentials\"},\n         \"groups\": {url: \"/groups\"},"},{"sha":"460d12c6bebbdd4d362ff455952a2290ead442ba","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/controllers/LoginController.js","status":"modified","additions":16,"deletions":8,"changes":24,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FLoginController.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FLoginController.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FLoginController.js?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -18,8 +18,8 @@\n  */\n \n 'use strict';\n-angular.module(\"login\").controller(\"LoginController\", ['$scope', '$http', '$location', 'AuthService',\n-  function ($scope, $http, $location, AuthService) {\n+angular.module(\"login\").controller(\"LoginController\", ['$scope', '$rootScope', '$http', '$location', 'AuthService',\n+  function ($scope, $rootScope, $http, $location, AuthService) {\n \n     $scope.credentials = {\n       username: '',\n@@ -32,6 +32,8 @@ angular.module(\"login\").controller(\"LoginController\", ['$scope', '$http', '$loca\n         console.info(\"Login success for: \", user);\n         // reset error message\n         $scope.credentials.errorMessage = '';\n+        // reset SAML 2.0 entityID\n+        $rootScope.saml2idps.selected.entityID = null;\n         // got to update page\n         $location.path(\"/self/update\");\n       }, function (response) {\n@@ -46,14 +48,11 @@ angular.module(\"login\").controller(\"LoginController\", ['$scope', '$http', '$loca\n         $scope.showError($scope.credentials.errorMessage, $scope.notification);\n       });\n     };\n-    \n+\n     $scope.logout = function () {\n-      AuthService.logout().then(function (response) {\n-        console.info(\"Logout successfully\");\n-      }, function (response) {\n-        console.info(\"Logout failed: \", response);\n-      });\n+      window.location.href = '../wicket/bookmarkable/org.apache.syncope.client.enduser.pages.Logout';\n     };\n+\n     $scope.islogged = function () {\n       AuthService.islogged().then(function (response) {\n         console.debug(\"user login status detected\", response);\n@@ -83,4 +82,13 @@ angular.module(\"login\").controller(\"LoginController\", ['$scope', '$http', '$loca\n         console.debug(\"schemaAPI response: \", data);\n       });\n     };\n+    $scope.$watch(function () {\n+      return $location.search().errorMessage;\n+    }, function (errorMessage) {\n+      if (errorMessage) {\n+        var message = (' ' + errorMessage).slice(1);\n+        $scope.showError(message, $scope.notification);\n+        delete $location.$$search.errorMessage;\n+      }\n+    });\n   }]);"},{"sha":"18ae153ad2d1266f4d9e54b7475ff1c7273fe0ba","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/controllers/UserController.js","status":"modified","additions":17,"deletions":30,"changes":47,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -75,15 +75,15 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n           initSchemaValues(schemas);\n         }, function (response) {\n           // parse error response and log\n-          if ( response !== undefined ) {\n-            var errorMessages = response.toString().split( \"ErrorMessage{{\" );\n-            if ( errorMessages.length > 1 ) {\n-              console.error( \"Error retrieving user schemas: \", response.toString().split( \"ErrorMessage{{\" )[1].split( \"}}\" )[0] );\n+          if (response !== undefined) {\n+            var errorMessages = response.toString().split(\"ErrorMessage{{\");\n+            if (errorMessages.length > 1) {\n+              console.error(\"Error retrieving user schemas: \", response.toString().split(\"ErrorMessage{{\")[1].split(\"}}\")[0]);\n             } else {\n-              console.error( \"Error retrieving user schemas: \", errorMessages );\n+              console.error(\"Error retrieving user schemas: \", errorMessages);\n             }\n           }\n-        } );\n+        });\n       };\n \n       var initSchemaValues = function (schemas) {\n@@ -373,7 +373,7 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n       var wrappedUser = UserUtil.getWrappedUser(user);\n       if ($scope.createMode) {\n         UserSelfService.create(wrappedUser, $scope.captchaInput.value).then(function (response) {\n-          console.info(\"User \" + $scope.user.username + \" SUCCESSFULLY_CREATED\");\n+          console.debug(\"User \" + $scope.user.username + \" SUCCESSFULLY_CREATED\");\n           $rootScope.currentUser = $scope.user.username;\n           $rootScope.currentOp = \"SUCCESSFULLY_CREATED\";\n           $state.go('success');\n@@ -389,15 +389,12 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n         });\n       } else {\n         UserSelfService.update(wrappedUser, $scope.captchaInput.value).then(function (response) {\n-          console.debug(\"Updated user: \", response);\n-          AuthService.logout().then(function (response) {\n-            console.info(\"User \" + $scope.user.username + \" SUCCESSFULLY_UPDATED\");\n-            $rootScope.currentUser = $scope.user.username;\n-            $rootScope.currentOp = \"SUCCESSFULLY_UPDATED\";\n-            $state.go('success');\n-          }, function () {\n-            console.error(\"LOGOUT FAILED\");\n-          });\n+          console.debug(\"User \" + $scope.user.username + \" SUCCESSFULLY_UPDATED\");\n+          $rootScope.currentUser = $scope.user.username;\n+          $rootScope.currentOp = \"SUCCESSFULLY_UPDATED\";\n+          $state.go('success');\n+\n+          $scope.logout();\n         }, function (response) {\n           console.info(\"Error during user update: \", response);\n           var errorMessage;\n@@ -459,7 +456,6 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n     };\n \n     $scope.confirmPasswordReset = function (user, event) {\n-\n       //getting the enclosing form in order to access to its controller                \n       var currentForm = GenericUtil.getEnclosingFormController(event.target, $scope);\n       if (currentForm != null) {\n@@ -488,7 +484,6 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n     };\n \n     $scope.changePassword = function (user, event) {\n-\n       //getting the enclosing form in order to access to its controller                \n       var currentForm = GenericUtil.getEnclosingFormController(event.target, $scope);\n       if (currentForm != null) {\n@@ -518,18 +513,10 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n       kendo.culture($rootScope.languages.selectedLanguage.code);\n     };\n \n-    $scope.logout = function (message) {\n-      AuthService.logout().then(function (response) {\n-        console.info(\"Logout successfully\");\n-        $translate.use($scope.languages.selectedLanguage.code);\n-        $rootScope.endReached = false;\n-        $location.path('/self');\n-        if (message) {\n-          $scope.showSuccess(message, $scope.notification);\n-        }\n-      }, function (response) {\n-        console.error(\"Logout failed: \", response);\n-      });\n+    $scope.logout = function () {\n+      $translate.use($scope.languages.selectedLanguage.code);\n+      $rootScope.endReached = false;\n+      window.location.href = '../wicket/bookmarkable/org.apache.syncope.client.enduser.pages.Logout';\n     };\n \n     $scope.redirect = function () {"},{"sha":"593781a2eb44fbbb9ea26b5e3de66a6da8599779","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/services/authService.js","status":"modified","additions":0,"deletions":14,"changes":14,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fservices%2FauthService.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fservices%2FauthService.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fservices%2FauthService.js?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -35,22 +35,10 @@ angular.module('login')\n                       });\n             };\n \n-            authService.logout = function () {\n-              return $http\n-                      .get('/syncope-enduser/api/logout')\n-                      .then(function (response) {\n-                        return response;\n-                      }, function (response) {\n-                        console.error(\"Something went wrong during logout, exit with status: \", response);\n-                      });\n-            };\n-\n-\n             authService.islogged = function () {\n               return $http\n                       .get('/syncope-enduser/api/self/islogged')\n                       .then(function (response) {\n-//                        console.debug(\"user logged:\", response.data);\n                         return response.data;\n                       }, function (response) {\n                         console.error(\"error retrieving user login status\");\n@@ -59,5 +47,3 @@ angular.module('login')\n \n             return authService;\n           }]);\n-\n-"},{"sha":"e8faddd7b0910daaf8911153b7b818b67c02735c","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/services/saml2IdPService.js","status":"added","additions":41,"deletions":0,"changes":41,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fservices%2Fsaml2IdPService.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fservices%2Fsaml2IdPService.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fservices%2Fsaml2IdPService.js?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -0,0 +1,41 @@\n+/* \n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+\n+'use strict';\n+\n+angular.module('self')\n+        .factory('SAML2IdPService', ['$resource', '$q', '$http',\n+          function ($resource, $q, $http) {\n+\n+            var saml2IdPService = {};\n+\n+            saml2IdPService.getAvailableSAML2IdPs = function () {\n+              return $http.get(\"/syncope-enduser/api/saml2IdPs\")\n+                      .then(function (response) {\n+                        return response.data;\n+                      }, function (response) {\n+                        console.error(\"Something went wrong during realms retrieval, exit with status: \", response);\n+                        return $q.reject(response.data || response.statusText);\n+                      });\n+            };\n+\n+            return saml2IdPService;\n+          }]);\n+\n+"},{"sha":"b4ea868ca2966d25c546d1b2698e0e5a3668716f","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/editUser.html","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FeditUser.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FeditUser.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FeditUser.html?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -31,7 +31,7 @@\n           <div class=\"row\">\n             <div growl reference=\"2\" inline=\"true\"></div>              \n             <div id=\"status-buttons\" class=\"btn-group btn-breadcrumb\">\n-              <a href=\"#/self\" class=\"btn btn-default\" ng-show=\"createMode\" ng-click=\"logout()\"><i class=\"glyphicon glyphicon-home\"></i></a>\n+              <a class=\"btn btn-default\" ng-show=\"createMode\" ng-click=\"logout()\"><i class=\"glyphicon glyphicon-home\"></i></a>\n               <a id=\"logout\" class=\"btn btn-default\" ng-show=\"!createMode\" ng-click=\"logout()\"><i class=\"glyphicon glyphicon-off\"style=\"color:red\"></i></a>\n               <!--add class breadcrumb-disabled-link to buttons to prevent click-->              \n               <a ng-repeat=\"(key, value) in wizard\" ui-sref-active=\"active\" ui-sref=\".{{key}}\" class=\"btn btn-default\" "},{"sha":"118b0d4e6f252af8cfef595d4b76c1863cc0fdb7","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/passwordreset.html","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fpasswordreset.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fpasswordreset.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fpasswordreset.html?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -29,7 +29,7 @@\n \n           <div class=\"row\">            \n             <div id=\"status-buttons\" class=\"btn-group btn-breadcrumb\">\n-              <a href=\"#/self\" class=\"btn btn-default\" ng-click=\"logout()\"><i class=\"glyphicon glyphicon-home\"></i></a>\n+              <a class=\"btn btn-default\" ng-click=\"logout()\"><i class=\"glyphicon glyphicon-home\"></i></a>\n               <!--add class breadcrumb-disabled-link to buttons to prevent click-->\n               <a ui-sref-active=\"active\" class=\"btn btn-default\">{{'USERDETAILS'| translate}}</a>\n             </div>\n@@ -63,7 +63,7 @@\n               </div>\n               <button id=\"resetpassword\" type=\"submit\" class=\"btn btn-default pull-right\">{{'SUBMIT'| translate}}</button>\n               <div class=\"pull-left\">\n-                <a id=\"cancel\" href=\"#/self\" class=\"btn btn-danger\" ng-click=\"logout()\">{{'CANCEL'| translate}}</a>\n+                <a id=\"cancel\" class=\"btn btn-danger\" ng-click=\"logout()\">{{'CANCEL'| translate}}</a>\n               </div>\n             </div>\n           </div>"},{"sha":"71c2d012fdf6fa51adfd8ccf3057673ea8b19985","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/self.html","status":"modified","additions":11,"deletions":2,"changes":13,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fself.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fself.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fself.html?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -26,7 +26,7 @@\n   </head>\n   <body>\n     <div ng-cloak class=\"container\">\n-      <div id=\"login-container\" ng-controller=\"LoginController\"  ng-init=\"init\" style=\"box-sizing: border-box; \">\n+      <div id=\"login-container\" ng-controller=\"LoginController\" style=\"box-sizing: border-box;\">\n         <div id=\"login\" class=\"card card-container\">\n           <div>\n             <img class=\"login-logo\" src=\"img/logo-green.png\" />\n@@ -43,10 +43,19 @@\n                          ng-required ng-model=\"credentials.password\">\n                 </div>\n                 <div class=\"form-group\" ng-controller=\"UserController\">\n-                  <select  ng-change=\"switchLanguage()\" id=\"language\" style=\"width: 100%\" class=\"btn dropdown-toggle btn-default\" \n+                  <select  ng-change=\"switchLanguage()\"\n+                           id=\"language\" style=\"width: 100%; text-align: left;\" class=\"btn dropdown-toggle btn-default\" \n                            ng-options=\"language.name for language in languages.availableLanguages track by language.id\" \n                            ng-model=\"languages.selectedLanguage\"></select>\n                 </div>                \n+                <div class=\"form-group\">\n+                  <select id=\"saml2sp\" style=\"width: 100%; text-align: left;\" class=\"btn dropdown-toggle btn-default\"\n+                          ng-if=\"$root.saml2spExtAvailable()\"\n+                          ng-options=\"idp.name for idp in saml2idps.available track by idp.entityID\"\n+                          ng-model=\"saml2idps.selected\" ng-change=\"saml2login()\">\n+                    <option value=\"\" disabled=\"disabled\" selected=\"selected\" hidden=\"hidden\">SAML 2.0</option>\n+                  </select>\n+                </div>\n                 <div class=\"form-group\">\n                   <button type=\"submit\" id=\"login-btn\" class=\"btn btn-default btn-signin login-btn\" \n                           ng-click=\"login(credentials)\">Login</button>"},{"sha":"274e4bdc41fd90e88bf2c69518af47016c4a262d","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/user-credentials.html","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-credentials.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-credentials.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-credentials.html?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -72,6 +72,6 @@\n     </div>\n   </div>\n   <div class=\"pull-left\">\n-    <a id=\"cancel\" href=\"#/self\" class=\"btn btn-danger pull-left\" ng-click=\"logout()\">{{'CANCEL'| translate}}</a>\n+    <a id=\"cancel\" class=\"btn btn-danger pull-left\" ng-click=\"logout()\">{{'CANCEL'| translate}}</a>\n   </div>\n </div>"},{"sha":"5836742a463a6f5a22efc80b82e1691213e363a8","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/user-derived-schemas.html","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-derived-schemas.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-derived-schemas.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-derived-schemas.html?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -31,6 +31,6 @@\n     </div>\n   </div>\n   <div class=\"pull-left\">\n-    <a id=\"cancel\" href=\"#/self\" class=\"btn btn-danger pull-left\" ng-click=\"logout()\">{{'CANCEL'| translate}}</a>\n+    <a id=\"cancel\" class=\"btn btn-danger pull-left\" ng-click=\"logout()\">{{'CANCEL'| translate}}</a>\n   </div>\n </div>"},{"sha":"8e58f23b32b0de7b36d948399b4b63a79f09a339","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/user-form-finish.html","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-form-finish.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-form-finish.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-form-finish.html?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -32,6 +32,6 @@\n     </div>\n   </div>\n   <div class=\"pull-left\">\n-    <a id=\"cancel\" href=\"#/self\" class=\"btn btn-danger pull-left\" ng-click=\"logout()\">{{'CANCEL'| translate}}</a>\n+    <a id=\"cancel\" class=\"btn btn-danger pull-left\" ng-click=\"logout()\">{{'CANCEL'| translate}}</a>\n   </div>\n </div>"},{"sha":"70c3030d70e0b7b946a577d6f416af5f0da07514","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/user-groups.html","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-groups.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-groups.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-groups.html?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -44,6 +44,6 @@\n     </div>\n   </div>\n   <div class=\"pull-left\">\n-    <a id=\"cancel\" href=\"#/self\" class=\"btn btn-danger pull-left\" ng-click=\"logout()\">{{'CANCEL'| translate}}</a>\n+    <a id=\"cancel\" class=\"btn btn-danger pull-left\" ng-click=\"logout()\">{{'CANCEL'| translate}}</a>\n   </div>\n </div>"},{"sha":"b7d93eb930fcf0ee18c19f9088fb3cccaa56fc81","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/user-plain-schemas.html","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-plain-schemas.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-plain-schemas.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-plain-schemas.html?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -31,6 +31,6 @@\n     </div>\n   </div>\n   <div class=\"pull-left\">\n-    <a id=\"cancel\" href=\"#/self\" class=\"btn btn-danger pull-left\" ng-click=\"logout()\">{{'CANCEL'| translate}}</a>\n+    <a id=\"cancel\" class=\"btn btn-danger pull-left\" ng-click=\"logout()\">{{'CANCEL'| translate}}</a>\n   </div>\n </div>"},{"sha":"86ee3bd6e8e4acfa99d0bad535a6bf3c427cb6f1","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/user-resources.html","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-resources.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-resources.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-resources.html?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -31,6 +31,6 @@\n     </div>\n   </div>\n   <div class=\"pull-left\">\n-    <a id=\"cancel\" href=\"#/self\" class=\"btn btn-danger pull-left\" ng-click=\"logout()\">{{'CANCEL'| translate}}</a>\n+    <a id=\"cancel\" class=\"btn btn-danger pull-left\" ng-click=\"logout()\">{{'CANCEL'| translate}}</a>\n   </div>\n </div>"},{"sha":"81e4e784b8b7059098ec1f1cd5e9597537c04015","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/user-virtual-schemas.html","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-virtual-schemas.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-virtual-schemas.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fuser-virtual-schemas.html?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -31,6 +31,6 @@\n     </div>\n   </div>\n   <div class=\"pull-left\">\n-    <a id=\"cancel\" href=\"#/self\" class=\"btn btn-danger pull-left\" ng-click=\"logout()\">{{'CANCEL'| translate}}</a>\n+    <a id=\"cancel\" class=\"btn btn-danger pull-left\" ng-click=\"logout()\">{{'CANCEL'| translate}}</a>\n   </div>\n </div>"},{"sha":"00a853ed2af8e6289d7a5d6b507229ec62a1dc83","filename":"ext/saml2sp/agent/src/main/java/org/apache/syncope/ext/saml2lsp/agent/AssertionConsumer.java","status":"modified","additions":4,"deletions":1,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/ext%2Fsaml2sp%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Fsaml2lsp%2Fagent%2FAssertionConsumer.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/ext%2Fsaml2sp%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Fsaml2lsp%2Fagent%2FAssertionConsumer.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Fsaml2lsp%2Fagent%2FAssertionConsumer.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -19,6 +19,8 @@\n package org.apache.syncope.ext.saml2lsp.agent;\n \n import java.io.IOException;\n+import java.net.URLEncoder;\n+import java.nio.charset.StandardCharsets;\n import javax.servlet.ServletException;\n import javax.servlet.annotation.WebServlet;\n import javax.servlet.http.HttpServlet;\n@@ -66,7 +68,8 @@ protected void doPost(final HttpServletRequest request, final HttpServletRespons\n \n                 e.printStackTrace(response.getWriter());\n             } else {\n-                response.sendRedirect(errorURL + \"?errorMessage=\" + e.getMessage());\n+                response.sendRedirect(errorURL + \"?errorMessage=\"\n+                        + URLEncoder.encode(e.getMessage(), StandardCharsets.UTF_8.name()));\n             }\n         }\n     }"},{"sha":"a675ca7eca66f600121b45772841da66897b820e","filename":"ext/saml2sp/agent/src/main/java/org/apache/syncope/ext/saml2lsp/agent/Login.java","status":"modified","additions":4,"deletions":1,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/ext%2Fsaml2sp%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Fsaml2lsp%2Fagent%2FLogin.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/ext%2Fsaml2sp%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Fsaml2lsp%2Fagent%2FLogin.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Fsaml2lsp%2Fagent%2FLogin.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -19,6 +19,8 @@\n package org.apache.syncope.ext.saml2lsp.agent;\n \n import java.io.IOException;\n+import java.net.URLEncoder;\n+import java.nio.charset.StandardCharsets;\n import javax.servlet.ServletException;\n import javax.servlet.annotation.WebServlet;\n import javax.servlet.http.HttpServletRequest;\n@@ -56,7 +58,8 @@ protected void doGet(final HttpServletRequest request, final HttpServletResponse\n \n                 e.printStackTrace(response.getWriter());\n             } else {\n-                response.sendRedirect(errorURL + \"?errorMessage=\" + e.getMessage());\n+                response.sendRedirect(errorURL + \"?errorMessage=\"\n+                        + URLEncoder.encode(e.getMessage(), StandardCharsets.UTF_8.name()));\n             }\n         }\n     }"},{"sha":"df4c5e5212be69d6ef5046e432b99f4e45108e4f","filename":"ext/saml2sp/agent/src/main/java/org/apache/syncope/ext/saml2lsp/agent/Logout.java","status":"modified","additions":6,"deletions":2,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/ext%2Fsaml2sp%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Fsaml2lsp%2Fagent%2FLogout.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/ext%2Fsaml2sp%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Fsaml2lsp%2Fagent%2FLogout.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fagent%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fext%2Fsaml2lsp%2Fagent%2FLogout.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -19,6 +19,8 @@\n package org.apache.syncope.ext.saml2lsp.agent;\n \n import java.io.IOException;\n+import java.net.URLEncoder;\n+import java.nio.charset.StandardCharsets;\n import javax.servlet.ServletException;\n import javax.servlet.annotation.WebServlet;\n import javax.servlet.http.HttpServletRequest;\n@@ -61,7 +63,8 @@ protected void doGet(final HttpServletRequest request, final HttpServletResponse\n \n                 e.printStackTrace(response.getWriter());\n             } else {\n-                response.sendRedirect(errorURL + \"?errorMessage=\" + e.getMessage());\n+                response.sendRedirect(errorURL + \"?errorMessage=\"\n+                        + URLEncoder.encode(e.getMessage(), StandardCharsets.UTF_8.name()));\n             }\n         }\n     }\n@@ -98,7 +101,8 @@ protected void doPost(final HttpServletRequest request, final HttpServletRespons\n \n                 e.printStackTrace(response.getWriter());\n             } else {\n-                response.sendRedirect(errorURL + \"?errorMessage=\" + e.getMessage());\n+                response.sendRedirect(errorURL + \"?errorMessage=\"\n+                        + URLEncoder.encode(e.getMessage(), StandardCharsets.UTF_8.name()));\n             }\n         }\n     }"},{"sha":"69f8294e0381f5d7c607bd93fe9fdfc9856a343d","filename":"ext/saml2sp/client-console/src/main/java/org/apache/syncope/client/console/pages/SAML2SPLogin.java","status":"modified","additions":4,"deletions":2,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpages%2FSAML2SPLogin.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpages%2FSAML2SPLogin.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpages%2FSAML2SPLogin.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -33,6 +33,8 @@ public class SAML2SPLogin extends WebPage {\n \n     private static final Logger LOG = LoggerFactory.getLogger(SAML2SPLogin.class);\n \n+    private static final String SAML_ACCESS_ERROR = \"SAML 2.0 access error\";\n+\n     public SAML2SPLogin(final PageParameters parameters) {\n         super(parameters);\n \n@@ -42,7 +44,7 @@ public SAML2SPLogin(final PageParameters parameters) {\n             LOG.error(\"No JWT found, redirecting to default greeter\");\n \n             PageParameters params = new PageParameters();\n-            params.add(\"errorMessage\", \"accessControlException\");\n+            params.add(\"errorMessage\", SAML_ACCESS_ERROR);\n             setResponsePage(Login.class, params);\n         }\n \n@@ -61,7 +63,7 @@ public SAML2SPLogin(final PageParameters parameters) {\n             setResponsePage(getApplication().getHomePage());\n         } else {\n             PageParameters params = new PageParameters();\n-            params.add(\"errorMessage\", \"accessControlException\");\n+            params.add(\"errorMessage\", SAML_ACCESS_ERROR);\n             setResponsePage(Login.class, params);\n         }\n         strategy.remove();"},{"sha":"eecfba877cc041cafabceab38b9f55c5b6bd20f7","filename":"ext/saml2sp/client-enduser/src/main/java/org/apache/syncope/client/enduser/pages/SAML2SPBeforeLogout.java","status":"added","additions":37,"deletions":0,"changes":37,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/ext%2Fsaml2sp%2Fclient-enduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FSAML2SPBeforeLogout.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/ext%2Fsaml2sp%2Fclient-enduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FSAML2SPBeforeLogout.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fclient-enduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FSAML2SPBeforeLogout.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -0,0 +1,37 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.client.enduser.pages;\n+\n+import org.apache.wicket.markup.html.WebPage;\n+import org.apache.wicket.request.UrlUtils;\n+import org.apache.wicket.request.cycle.RequestCycle;\n+import org.apache.wicket.request.http.handler.RedirectRequestHandler;\n+\n+public class SAML2SPBeforeLogout extends WebPage {\n+\n+    private static final long serialVersionUID = 3727183730959367707L;\n+\n+    public SAML2SPBeforeLogout() {\n+        super();\n+\n+        RequestCycle.get().scheduleRequestHandlerAfterCurrent(new RedirectRequestHandler(\n+                UrlUtils.rewriteToContextRelative(\"saml2sp/logout\", RequestCycle.get())));\n+    }\n+\n+}"},{"sha":"66739eeb8a89630e788987e0f8a77f051cfbc14e","filename":"ext/saml2sp/client-enduser/src/main/java/org/apache/syncope/client/enduser/pages/SAML2SPLogin.java","status":"added","additions":67,"deletions":0,"changes":67,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/ext%2Fsaml2sp%2Fclient-enduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FSAML2SPLogin.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/ext%2Fsaml2sp%2Fclient-enduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FSAML2SPLogin.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fclient-enduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FSAML2SPLogin.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -0,0 +1,67 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.client.enduser.pages;\n+\n+import org.apache.commons.lang3.StringUtils;\n+import org.apache.syncope.client.enduser.SyncopeEnduserSession;\n+import org.apache.syncope.client.enduser.commons.Constants;\n+import org.apache.wicket.authentication.IAuthenticationStrategy;\n+import org.apache.wicket.markup.html.WebPage;\n+import org.apache.wicket.protocol.http.servlet.ServletWebRequest;\n+import org.apache.wicket.request.mapper.parameter.PageParameters;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+public class SAML2SPLogin extends WebPage {\n+\n+    private static final long serialVersionUID = 8581614051773949262L;\n+\n+    private static final Logger LOG = LoggerFactory.getLogger(SAML2SPLogin.class);\n+\n+    private static final String SAML_ACCESS_ERROR = \"SAML 2.0 access error\";\n+\n+    public SAML2SPLogin(final PageParameters parameters) {\n+        super(parameters);\n+\n+        String token = (String) ((ServletWebRequest) getRequest()).getContainerRequest().\n+                getSession().getAttribute(org.apache.syncope.ext.saml2lsp.agent.Constants.SAML2SPJWT);\n+        if (StringUtils.isBlank(token)) {\n+            LOG.error(\"No JWT found, redirecting to default greeter\");\n+\n+            PageParameters params = new PageParameters();\n+            params.add(\"errorMessage\", SAML_ACCESS_ERROR);\n+            setResponsePage(getApplication().getHomePage(), params);\n+        }\n+\n+        IAuthenticationStrategy strategy = getApplication().getSecuritySettings().getAuthenticationStrategy();\n+\n+        if (SyncopeEnduserSession.get().authenticate(token)) {\n+            if (parameters.get(\"sloSupported\").toBoolean(false)) {\n+                SyncopeEnduserSession.get().setAttribute(Constants.BEFORE_LOGOUT, SAML2SPBeforeLogout.class);\n+            }\n+\n+            setResponsePage(getApplication().getHomePage());\n+        } else {\n+            PageParameters params = new PageParameters();\n+            params.add(\"errorMessage\", SAML_ACCESS_ERROR);\n+            setResponsePage(getApplication().getHomePage(), params);\n+        }\n+        strategy.remove();\n+    }\n+}"},{"sha":"39ac276b4af1f11b863f3794342aa8025ebcac97","filename":"ext/saml2sp/client-enduser/src/main/java/org/apache/syncope/client/enduser/pages/SAML2SPLogout.java","status":"renamed","additions":8,"deletions":12,"changes":20,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/ext%2Fsaml2sp%2Fclient-enduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FSAML2SPLogout.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/ext%2Fsaml2sp%2Fclient-enduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FSAML2SPLogout.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fclient-enduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FSAML2SPLogout.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -16,25 +16,21 @@\n  * specific language governing permissions and limitations\n  * under the License.\n  */\n-package org.apache.syncope.client.enduser.resources;\n+package org.apache.syncope.client.enduser.pages;\n \n import org.apache.syncope.client.enduser.SyncopeEnduserSession;\n-import org.apache.syncope.client.enduser.annotations.Resource;\n+import org.apache.wicket.markup.html.WebPage;\n+import org.apache.wicket.request.mapper.parameter.PageParameters;\n \n-@Resource(key = \"logout\", path = \"/api/logout\")\n-public class LogoutResource extends BaseResource {\n+public class SAML2SPLogout extends WebPage {\n \n-    private static final long serialVersionUID = -648841355644985051L;\n+    private static final long serialVersionUID = 8581614051773949262L;\n \n-    @Override\n-    protected ResourceResponse newResourceResponse(final Attributes attributes) {\n-        LOG.debug(\"Logout from enduser application\");\n+    public SAML2SPLogout(final PageParameters parameters) {\n+        super(parameters);\n \n         SyncopeEnduserSession.get().invalidateNow();\n \n-        ResourceResponse response = new ResourceResponse();\n-        response.setStatusCode(204);\n-        return response;\n+        setResponsePage(getApplication().getHomePage());\n     }\n-\n }","previous_filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/resources/LogoutResource.java"},{"sha":"7926802c75e4ef7ab58a4fc4816ec7fc0ae283bb","filename":"ext/saml2sp/client-enduser/src/main/java/org/apache/syncope/client/enduser/resources/SAML2IdPsResource.java","status":"added","additions":72,"deletions":0,"changes":72,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/ext%2Fsaml2sp%2Fclient-enduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FSAML2IdPsResource.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/ext%2Fsaml2sp%2Fclient-enduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FSAML2IdPsResource.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fclient-enduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FSAML2IdPsResource.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -0,0 +1,72 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.client.enduser.resources;\n+\n+import com.fasterxml.jackson.databind.node.ArrayNode;\n+import com.fasterxml.jackson.databind.node.ObjectNode;\n+import java.io.IOException;\n+import java.nio.charset.StandardCharsets;\n+import javax.ws.rs.core.MediaType;\n+import javax.ws.rs.core.Response;\n+import org.apache.syncope.client.enduser.SyncopeEnduserSession;\n+import org.apache.syncope.client.enduser.annotations.Resource;\n+import org.apache.syncope.common.lib.to.SAML2IdPTO;\n+import org.apache.syncope.common.rest.api.service.SAML2IdPService;\n+import org.apache.wicket.request.resource.AbstractResource;\n+\n+@Resource(key = \"saml2IdPs\", path = \"/api/saml2IdPs\")\n+public class SAML2IdPsResource extends BaseResource {\n+\n+    private static final long serialVersionUID = -1538214102767503491L;\n+\n+    @Override\n+    protected ResourceResponse newResourceResponse(final Attributes attributes) {\n+        ResourceResponse response = new ResourceResponse();\n+        response.setContentType(MediaType.APPLICATION_JSON);\n+        response.setTextEncoding(StandardCharsets.UTF_8.name());\n+        try {\n+            final ArrayNode result = MAPPER.createArrayNode();\n+\n+            for (SAML2IdPTO idp : SyncopeEnduserSession.get().getService(SAML2IdPService.class).list()) {\n+                ObjectNode idpNode = MAPPER.createObjectNode();\n+                idpNode.put(\"name\", idp.getName());\n+                idpNode.put(\"entityID\", idp.getEntityID());\n+                idpNode.put(\"logout\", idp.isLogoutSupported());\n+                result.add(idpNode);\n+            }\n+\n+            response.setWriteCallback(new AbstractResource.WriteCallback() {\n+\n+                @Override\n+                public void writeData(final Attributes attributes) throws IOException {\n+                    attributes.getResponse().write(MAPPER.writeValueAsString(result));\n+                }\n+            });\n+            response.setStatusCode(Response.Status.OK.getStatusCode());\n+        } catch (Exception e) {\n+            LOG.error(\"Error retrieving available SAML 2.0 Identity Providers\", e);\n+            response.setError(\n+                    Response.Status.BAD_REQUEST.getStatusCode(),\n+                    \"ErrorMessage{{ \" + e.getMessage() + \"}}\");\n+        }\n+\n+        return response;\n+    }\n+\n+}"},{"sha":"7c8417e4abfa1aa1f8ac98eda146c508556f6158","filename":"ext/saml2sp/logic/src/main/java/org/apache/syncope/core/logic/SAML2IdPLogic.java","status":"modified","additions":18,"deletions":7,"changes":25,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/ext%2Fsaml2sp%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FSAML2IdPLogic.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/ext%2Fsaml2sp%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FSAML2IdPLogic.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FSAML2IdPLogic.java?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -69,10 +69,20 @@ public class SAML2IdPLogic extends AbstractSAML2Logic<SAML2IdPTO> {\n     @Autowired\n     private SAML2ReaderWriter saml2rw;\n \n-    private SAML2IdPTO complete(final SAML2IdPTO input) {\n-        SAML2IdPEntity idp = cache.get(input.getEntityID());\n-        input.setLogoutSupported(idp.getSLOLocation(SAMLConstants.SAML2_POST_BINDING_URI) != null);\n-        return input;\n+    private SAML2IdPTO complete(final SAML2IdP idp, final SAML2IdPTO idpTO) {\n+        SAML2IdPEntity idpEntity = cache.get(idpTO.getEntityID());\n+        if (idpEntity == null) {\n+            try {\n+                idpEntity = cache.put(idp);\n+            } catch (Exception e) {\n+                LOG.error(\"Could not build SAML 2.0 IdP with key \", idp.getEntityID(), e);\n+            }\n+        }\n+\n+        idpTO.setLogoutSupported(idpEntity == null\n+                ? false\n+                : idpEntity.getSLOLocation(SAMLConstants.SAML2_POST_BINDING_URI) != null);\n+        return idpTO;\n     }\n \n     @PreAuthorize(\"isAuthenticated()\")\n@@ -82,7 +92,7 @@ public List<SAML2IdPTO> list() {\n \n             @Override\n             public SAML2IdPTO transform(final SAML2IdP input) {\n-                return complete(binder.getIdPTO(input));\n+                return complete(input, binder.getIdPTO(input));\n             }\n         }, new ArrayList<SAML2IdPTO>());\n     }\n@@ -97,7 +107,7 @@ public SAML2IdPTO read(final String key) {\n             throw new NotFoundException(\"SAML 2.0 IdP '\" + key + \"'\");\n         }\n \n-        return complete(binder.getIdPTO(idp));\n+        return complete(idp, binder.getIdPTO(idp));\n     }\n \n     private List<SAML2IdPTO> importIdPs(final InputStream input) throws Exception {\n@@ -224,7 +234,8 @@ protected SAML2IdPTO resolveReference(final Method method, final Object... args)\n \n         if (key != null) {\n             try {\n-                return complete(binder.getIdPTO(idpDAO.find(key)));\n+                SAML2IdP idp = idpDAO.find(key);\n+                return complete(idp, binder.getIdPTO(idp));\n             } catch (Throwable ignore) {\n                 LOG.debug(\"Unresolved reference\", ignore);\n                 throw new UnresolvedReferenceException(ignore);"},{"sha":"3d243f2b9a83af3ee4dd5b904f35152786c6864a","filename":"fit/enduser-reference/pom.xml","status":"modified","additions":6,"deletions":0,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/fit%2Fenduser-reference%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/fit%2Fenduser-reference%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fenduser-reference%2Fpom.xml?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -61,6 +61,12 @@ under the License.\n       <artifactId>jstl</artifactId>\n     </dependency>\n \n+    <dependency>\n+      <groupId>org.apache.syncope.ext.saml2sp</groupId>\n+      <artifactId>syncope-ext-saml2sp-client-enduser</artifactId>\n+      <version>${project.version}</version>\n+    </dependency>\n+\n     <dependency>\n       <groupId>org.slf4j</groupId>\n       <artifactId>slf4j-api</artifactId>"},{"sha":"1d53d49db4816f429b6e3c6af4a088d5f5dc8ffb","filename":"fit/enduser-reference/src/main/resources/saml2sp-agent.properties","status":"added","additions":26,"deletions":0,"changes":26,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/fit%2Fenduser-reference%2Fsrc%2Fmain%2Fresources%2Fsaml2sp-agent.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/fit%2Fenduser-reference%2Fsrc%2Fmain%2Fresources%2Fsaml2sp-agent.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fenduser-reference%2Fsrc%2Fmain%2Fresources%2Fsaml2sp-agent.properties?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -0,0 +1,26 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+conf.directory=${conf.directory}\n+\n+anonymousUser=${anonymousUser}\n+anonymousKey=${anonymousKey}\n+\n+scheme=http\n+host=localhost\n+port=9080\n+rootPath=/syncope/rest/\n+useGZIPCompression=true"},{"sha":"fa4720d42a875164092abbfb20d5ba91333fd69a","filename":"fit/enduser-reference/src/main/webapp/WEB-INF/web.xml","status":"modified","additions":19,"deletions":1,"changes":20,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/fit%2Fenduser-reference%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/fit%2Fenduser-reference%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fenduser-reference%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -30,9 +30,27 @@ under the License.\n     <param-value>deployment</param-value>\n   </context-param>\n \n+  <context-param>\n+    <param-name>saml2sp.login.success.url</param-name>\n+    <param-value>../wicket/bookmarkable/org.apache.syncope.client.enduser.pages.SAML2SPLogin</param-value>\n+  </context-param>\n+  <context-param>\n+    <param-name>saml2sp.login.error.url</param-name>\n+    <param-value>../wicket/bookmarkable/org.apache.syncope.client.enduser.pages.HomePage</param-value>\n+  </context-param>\n+  \n+  <context-param>\n+    <param-name>saml2sp.logout.success.url</param-name>\n+    <param-value>../wicket/bookmarkable/org.apache.syncope.client.enduser.pages.SAML2SPLogout</param-value>\n+  </context-param>\n+  <context-param>\n+    <param-name>saml2sp.logout.error.url</param-name>\n+    <param-value>../wicket/bookmarkable/org.apache.syncope.client.enduser.pages.HomePage</param-value>\n+  </context-param>\n+\n   <!-- SESSION TIMEOUT (MINUTES)-->\n   <session-config>\n     <session-timeout>30</session-timeout>\n   </session-config>\n \n-</web-app>\n\\ No newline at end of file\n+</web-app>"},{"sha":"da15397d0880f80a91c22b106100c6719272b026","filename":"fit/enduser-reference/src/test/resources/rebel.xml","status":"modified","additions":8,"deletions":0,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/fit%2Fenduser-reference%2Fsrc%2Ftest%2Fresources%2Frebel.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ebd22e8c3f6356dad94baa6f4c7821224b5d2aab/fit%2Fenduser-reference%2Fsrc%2Ftest%2Fresources%2Frebel.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fenduser-reference%2Fsrc%2Ftest%2Fresources%2Frebel.xml?ref=ebd22e8c3f6356dad94baa6f4c7821224b5d2aab","patch":"@@ -26,6 +26,10 @@ under the License.\n     </dir>\n     <dir name=\"${basedir}/../../client/enduser/target/classes\">\n     </dir>\n+    <dir name=\"${basedir}/../../ext/saml2sp/agent/target/classes\">\n+    </dir>\n+    <dir name=\"${basedir}/../../ext/saml2sp/client-enduser/target/classes\">\n+    </dir>\n   </classpath>\n \n   <web>\n@@ -37,6 +41,10 @@ under the License.\n       <dir name=\"${basedir}/../../client/enduser/target/classes/META-INF/resources\">\n       </dir>\n     </link>\n+    <link target=\"/\">\n+      <dir name=\"${basedir}/../../ext/saml2sp/client-enduser/target/classes\">\n+      </dir>\n+    </link>\n   </web>\n \n </application>"}]}