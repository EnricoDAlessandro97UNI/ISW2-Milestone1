{"sha":"faba42e2ff3fb725bd05205e5c8b22930e8af7a1","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmZhYmE0MmUyZmYzZmI3MjViZDA1MjA1ZTVjOGIyMjkzMGU4YWY3YTE=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2017-09-05T08:02:09Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2017-09-05T08:04:33Z"},"message":"[SYNCOPE-1203] Now considering realms too","tree":{"sha":"97de63b3938df850c6af672791657dc4f76ef0ef","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/97de63b3938df850c6af672791657dc4f76ef0ef"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/faba42e2ff3fb725bd05205e5c8b22930e8af7a1","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/faba42e2ff3fb725bd05205e5c8b22930e8af7a1","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/faba42e2ff3fb725bd05205e5c8b22930e8af7a1","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/faba42e2ff3fb725bd05205e5c8b22930e8af7a1/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"df4bd83c9d4c8374991a57e33a496e93aeaa0f12","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/df4bd83c9d4c8374991a57e33a496e93aeaa0f12","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/df4bd83c9d4c8374991a57e33a496e93aeaa0f12"}],"stats":{"total":15,"additions":8,"deletions":7},"files":[{"sha":"194bd5aa0808444e646bc66dbc6249d28b82c201","filename":"client/console/src/main/java/org/apache/syncope/client/console/wizards/resources/ResourceProvisionPanel.java","status":"modified","additions":8,"deletions":7,"changes":15,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/faba42e2ff3fb725bd05205e5c8b22930e8af7a1/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2Fresources%2FResourceProvisionPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/faba42e2ff3fb725bd05205e5c8b22930e8af7a1/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2Fresources%2FResourceProvisionPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2Fresources%2FResourceProvisionPanel.java?ref=faba42e2ff3fb725bd05205e5c8b22930e8af7a1","patch":"@@ -40,7 +40,6 @@\n import org.apache.syncope.common.lib.SyncopeClientException;\n import org.apache.syncope.common.lib.SyncopeConstants;\n import org.apache.syncope.common.lib.to.ItemTO;\n-import org.apache.syncope.common.lib.to.ProvisionTO;\n import org.apache.syncope.common.lib.to.ResourceTO;\n import org.apache.syncope.common.lib.types.StandardEntitlement;\n import org.apache.wicket.PageReference;\n@@ -316,13 +315,15 @@ private LoadableDetachableModel<List<String>> getAnyTypes() {\n \n             @Override\n             protected List<String> load() {\n-                final List<String> currentlyAdded = new ArrayList<>();\n-\n-                currentlyAdded.addAll(resourceTO.getProvisions().stream().\n-                        map(ProvisionTO::getAnyType).collect(Collectors.toList()));\n+                List<String> anyTypes = new AnyTypeRestClient().list().stream().\n+                        filter(anyType -> !resourceTO.getProvision(anyType).isPresent()).\n+                        collect(Collectors.toList());\n+                if (resourceTO.getOrgUnit() == null) {\n+                    anyTypes.add(SyncopeConstants.REALM_ANYTYPE);\n+                }\n \n-                return new AnyTypeRestClient().list().stream().\n-                        filter(anyType -> !currentlyAdded.contains(anyType)).collect(Collectors.toList());\n+                Collections.sort(anyTypes, new AnyTypeRestClient.AnyTypeKeyComparator());\n+                return anyTypes;\n             }\n         };\n     }"}]}