{"sha":"4c2269e519f61f3bae0bff346872b9a96180883a","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjRjMjI2OWU1MTlmNjFmM2JhZTBiZmYzNDY4NzJiOWE5NjE4MDg4M2E=","commit":{"author":{"name":"fmartelli","email":"fabio.martelli@gmail.com","date":"2016-05-16T14:38:43Z"},"committer":{"name":"fmartelli","email":"fabio.martelli@gmail.com","date":"2016-05-16T14:38:43Z"},"message":"[SYNCOPE-847] fixes table refresh after schema creation","tree":{"sha":"e820379fd9ffc1896a775c67f43e5c0557f0fcfa","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/e820379fd9ffc1896a775c67f43e5c0557f0fcfa"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/4c2269e519f61f3bae0bff346872b9a96180883a","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/4c2269e519f61f3bae0bff346872b9a96180883a","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/4c2269e519f61f3bae0bff346872b9a96180883a","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/4c2269e519f61f3bae0bff346872b9a96180883a/comments","author":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"committer":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"parents":[{"sha":"5ee30a666a67eff9192c1eed37001b0924563c19","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/5ee30a666a67eff9192c1eed37001b0924563c19","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/5ee30a666a67eff9192c1eed37001b0924563c19"}],"stats":{"total":66,"additions":64,"deletions":2},"files":[{"sha":"94230325f5f1454be35a1319eae080895668adcc","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/SchemaTypePanel.java","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4c2269e519f61f3bae0bff346872b9a96180883a/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSchemaTypePanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4c2269e519f61f3bae0bff346872b9a96180883a/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSchemaTypePanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSchemaTypePanel.java?ref=4c2269e519f61f3bae0bff346872b9a96180883a","patch":"@@ -115,6 +115,7 @@ public void onSubmit(final AjaxRequestTarget target, final Form<?> form) {\n                                             SchemaService.class).update(schemaType, modelObject);\n                                 }\n \n+                                updateResultTable(target);\n                                 info(getString(Constants.OPERATION_SUCCEEDED));\n                                 modal.close(target);\n                             } catch (Exception e) {"},{"sha":"575345d4d012f7dc8267b8bca85511412e7fcc33","filename":"fit/core-reference/src/test/java/org/apache/syncope/fit/console/AbstractTypesITCase.java","status":"modified","additions":12,"deletions":0,"changes":12,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4c2269e519f61f3bae0bff346872b9a96180883a/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fconsole%2FAbstractTypesITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4c2269e519f61f3bae0bff346872b9a96180883a/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fconsole%2FAbstractTypesITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fconsole%2FAbstractTypesITCase.java?ref=4c2269e519f61f3bae0bff346872b9a96180883a","patch":"@@ -28,6 +28,9 @@ public abstract class AbstractTypesITCase extends AbstractConsoleITCase {\n \n     protected static final String PLAIN_DATATABLE_PATH = \"body:content:tabbedPanel:panel:\"\n             + \"accordionPanel:tabs:0:body:content:container:content:searchContainer:resultTable\";\n+    \n+    protected static final String VIRTUAL_DATATABLE_PATH = \"body:content:tabbedPanel:panel:\"\n+            + \"accordionPanel:tabs:2:body:content:container:content:searchContainer:resultTable\";\n \n     protected static final String DATATABLE_PATH =\n             \"body:content:tabbedPanel:panel:container:content:searchContainer:resultTable\";\n@@ -72,6 +75,15 @@ protected void browsingToPlainSchemas() {\n         wicketTester.assertComponent(PLAIN_DATATABLE_PATH + \":tablePanel:groupForm:checkgroup:dataTable\",\n                 AjaxFallbackDataTable.class);\n     }\n+    \n+    protected void browsingToVirtualSchemas() {\n+        wicketTester.clickLink(\"body:configurationLI:configurationUL:typesLI:types\");\n+        wicketTester.assertRenderedPage(Types.class);\n+\n+        wicketTester.clickLink(\"body:content:tabbedPanel:tabs-container:tabs:3:link\");\n+        wicketTester.assertComponent(VIRTUAL_DATATABLE_PATH + \":tablePanel:groupForm:checkgroup:dataTable\",\n+                AjaxFallbackDataTable.class);\n+    }\n \n     protected void createPlainSchema(final String key) {\n         browsingToPlainSchemas();"},{"sha":"c6c524d3f7f67f622ff3f2b8b0afa75542ba5b99","filename":"fit/core-reference/src/test/java/org/apache/syncope/fit/console/ReportsITCase.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4c2269e519f61f3bae0bff346872b9a96180883a/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fconsole%2FReportsITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4c2269e519f61f3bae0bff346872b9a96180883a/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fconsole%2FReportsITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fconsole%2FReportsITCase.java?ref=4c2269e519f61f3bae0bff346872b9a96180883a","patch":"@@ -22,9 +22,9 @@\n import static org.junit.Assert.assertNull;\n \n import de.agilecoders.wicket.core.markup.html.bootstrap.dialog.Modal;\n+import org.apache.syncope.client.console.commons.Constants;\n import org.apache.syncope.client.console.pages.Reports;\n import org.apache.wicket.Component;\n-import org.apache.wicket.ajax.markup.html.AjaxLink;\n import org.apache.wicket.markup.html.form.TextField;\n import org.apache.wicket.util.tester.FormTester;\n import org.junit.Before;\n@@ -75,7 +75,7 @@ private void delete(final String name) {\n                         result.getPageRelativePath() + \":cells:10:cell:panelDelete:deleteLink\"));\n \n         wicketTester.executeAjaxEvent(wicketTester.getComponentFromLastRenderedPage(\n-                result.getPageRelativePath() + \":cells:10:cell:panelDelete:deleteLink\"), \"onclick\");\n+                result.getPageRelativePath() + \":cells:10:cell:panelDelete:deleteLink\"), Constants.ON_CLICK);\n \n         wicketTester.assertInfoMessages(\"Operation executed successfully\");\n         wicketTester.cleanupFeedbackMessages();"},{"sha":"fb55ef6de7e908ea6b28d63f4b9bc5a4c4de13e4","filename":"fit/core-reference/src/test/java/org/apache/syncope/fit/console/SchemasITCase.java","status":"modified","additions":49,"deletions":0,"changes":49,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4c2269e519f61f3bae0bff346872b9a96180883a/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fconsole%2FSchemasITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4c2269e519f61f3bae0bff346872b9a96180883a/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fconsole%2FSchemasITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fconsole%2FSchemasITCase.java?ref=4c2269e519f61f3bae0bff346872b9a96180883a","patch":"@@ -18,9 +18,11 @@\n  */\n package org.apache.syncope.fit.console;\n \n+import static org.junit.Assert.assertNotNull;\n import static org.junit.Assert.assertNull;\n \n import de.agilecoders.wicket.core.markup.html.bootstrap.dialog.Modal;\n+import org.apache.syncope.client.console.commons.Constants;\n import org.apache.syncope.client.console.pages.Types;\n import org.apache.syncope.client.console.panels.AjaxDataTablePanel;\n import org.apache.syncope.client.console.wicket.markup.html.form.IndicatingOnConfirmAjaxLink;\n@@ -160,4 +162,51 @@ public void deletePlainSchema() {\n \n         assertNull(findComponentByProp(KEY, PLAIN_DATATABLE_PATH, schemaName));\n     }\n+\n+    @Test\n+    public void createVirtualSchema() {\n+        browsingToVirtualSchemas();\n+        wicketTester.clickLink(\n+                \"body:content:tabbedPanel:panel:accordionPanel:tabs:2:body:content:container:content:add\");\n+\n+        wicketTester.assertComponent(\n+                \"body:content:tabbedPanel:panel:accordionPanel:tabs:2:body:content:outerObjectsRepeater:0:outer\",\n+                Modal.class);\n+\n+        final FormTester formTester = wicketTester.newFormTester(\"body:content:tabbedPanel:panel:\"\n+                + \"accordionPanel:tabs:2:body:content:outerObjectsRepeater:0:outer:form\");\n+\n+        formTester.setValue(\"content:details:form:resource:dropDownChoiceField\", \"0\");\n+        wicketTester.executeAjaxEvent(\"body:content:tabbedPanel:panel:\"\n+                + \"accordionPanel:tabs:2:body:content:outerObjectsRepeater:0:outer:form:\"\n+                + \"content:details:form:resource:dropDownChoiceField\", Constants.ON_CHANGE);\n+\n+        formTester.setValue(\"content:details:form:key:textField\", \"mynewvir\");\n+        formTester.setValue(\"content:details:form:resource:dropDownChoiceField\", \"0\");\n+        formTester.setValue(\"content:details:form:anyType:dropDownChoiceField\", \"0\");\n+        formTester.setValue(\"content:details:form:extAttrName:textField\", \"virattr\");\n+\n+        wicketTester.executeAjaxEvent(\"body:content:tabbedPanel:panel:\"\n+                + \"accordionPanel:tabs:2:body:content:outerObjectsRepeater:0:outer:dialog:footer:inputs:0:submit\",\n+                Constants.ON_CLICK);\n+\n+        wicketTester.assertInfoMessages(\"Operation executed successfully\");\n+        wicketTester.cleanupFeedbackMessages();\n+        wicketTester.assertRenderedPage(Types.class);\n+\n+        Component result = findComponentByProp(KEY, VIRTUAL_DATATABLE_PATH, \"mynewvir\");\n+        assertNotNull(result);\n+\n+        wicketTester.getRequest().addParameter(\"confirm\", \"true\");\n+        wicketTester.clickLink(wicketTester.getComponentFromLastRenderedPage(\n+                result.getPageRelativePath() + \":cells:6:cell:panelDelete:deleteLink\"));\n+\n+        wicketTester.executeAjaxEvent(wicketTester.getComponentFromLastRenderedPage(\n+                result.getPageRelativePath() + \":cells:6:cell:panelDelete:deleteLink\"), \"onclick\");\n+        wicketTester.assertInfoMessages(\"Operation executed successfully\");\n+        wicketTester.cleanupFeedbackMessages();\n+\n+        result = findComponentByProp(KEY, VIRTUAL_DATATABLE_PATH, \"mynewvir\");\n+        assertNull(result);\n+    }\n }"}]}