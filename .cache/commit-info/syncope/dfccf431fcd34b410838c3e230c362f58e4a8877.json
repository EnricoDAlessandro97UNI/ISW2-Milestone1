{"sha":"dfccf431fcd34b410838c3e230c362f58e4a8877","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmRmY2NmNDMxZmNkMzRiNDEwODM4YzNlMjMwYzM2MmY1OGU0YTg4Nzc=","commit":{"author":{"name":"Unknown","email":"craigmarti@gmail.com","date":"2018-08-28T19:36:32Z"},"committer":{"name":"Francesco Chicchiricc√≤","email":"ilgrosso@apache.org","date":"2018-10-12T10:24:49Z"},"message":"Kubernetes Install - This closes #83\n\nThe helm charts and instructions for how to install in Kubernetes.   This is a bare bones install and can be updated to include self healing and auto scaling.  It currently works with Postgres","tree":{"sha":"8dda14774a11761a4510213f43aacf1683166124","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/8dda14774a11761a4510213f43aacf1683166124"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/dfccf431fcd34b410838c3e230c362f58e4a8877","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/dfccf431fcd34b410838c3e230c362f58e4a8877","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/dfccf431fcd34b410838c3e230c362f58e4a8877","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/dfccf431fcd34b410838c3e230c362f58e4a8877/comments","author":{"login":"mornindew","id":3130791,"node_id":"MDQ6VXNlcjMxMzA3OTE=","avatar_url":"https://avatars.githubusercontent.com/u/3130791?v=4","gravatar_id":"","url":"https://api.github.com/users/mornindew","html_url":"https://github.com/mornindew","followers_url":"https://api.github.com/users/mornindew/followers","following_url":"https://api.github.com/users/mornindew/following{/other_user}","gists_url":"https://api.github.com/users/mornindew/gists{/gist_id}","starred_url":"https://api.github.com/users/mornindew/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mornindew/subscriptions","organizations_url":"https://api.github.com/users/mornindew/orgs","repos_url":"https://api.github.com/users/mornindew/repos","events_url":"https://api.github.com/users/mornindew/events{/privacy}","received_events_url":"https://api.github.com/users/mornindew/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"b82f6c13386a41d6e78ebb6412c318c6b5733601","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/b82f6c13386a41d6e78ebb6412c318c6b5733601","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/b82f6c13386a41d6e78ebb6412c318c6b5733601"}],"stats":{"total":539,"additions":539,"deletions":0},"files":[{"sha":"0eb26f55c18499f212f5253645129b5a6a527ff6","filename":"docker/src/main/resources/docker-compose/docker-compose-ha.yml","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fdocker-compose%2Fdocker-compose-ha.yml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fdocker-compose%2Fdocker-compose-ha.yml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fdocker-compose%2Fdocker-compose-ha.yml?ref=dfccf431fcd34b410838c3e230c362f58e4a8877","previous_filename":"docker/src/main/resources/docker-compose-ha.yml"},{"sha":"65851bb69b1c5b9547b866eb6b3404dbd41c6369","filename":"docker/src/main/resources/docker-compose/docker-compose-mariadb.yml","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fdocker-compose%2Fdocker-compose-mariadb.yml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fdocker-compose%2Fdocker-compose-mariadb.yml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fdocker-compose%2Fdocker-compose-mariadb.yml?ref=dfccf431fcd34b410838c3e230c362f58e4a8877","previous_filename":"docker/src/main/resources/docker-compose-mariadb.yml"},{"sha":"462f7491cc8ae181858b9823e084c39f9e513aec","filename":"docker/src/main/resources/docker-compose/docker-compose-mssql.yml","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fdocker-compose%2Fdocker-compose-mssql.yml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fdocker-compose%2Fdocker-compose-mssql.yml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fdocker-compose%2Fdocker-compose-mssql.yml?ref=dfccf431fcd34b410838c3e230c362f58e4a8877","previous_filename":"docker/src/main/resources/docker-compose-mssql.yml"},{"sha":"d2af8c0b54435f565620ae343268579eee10a6ae","filename":"docker/src/main/resources/docker-compose/docker-compose-mysql.yml","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fdocker-compose%2Fdocker-compose-mysql.yml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fdocker-compose%2Fdocker-compose-mysql.yml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fdocker-compose%2Fdocker-compose-mysql.yml?ref=dfccf431fcd34b410838c3e230c362f58e4a8877","previous_filename":"docker/src/main/resources/docker-compose-mysql.yml"},{"sha":"862a051b22bfdef79fb085b9ae687c82b3bff1ed","filename":"docker/src/main/resources/docker-compose/docker-compose-postgresql.yml","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fdocker-compose%2Fdocker-compose-postgresql.yml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fdocker-compose%2Fdocker-compose-postgresql.yml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fdocker-compose%2Fdocker-compose-postgresql.yml?ref=dfccf431fcd34b410838c3e230c362f58e4a8877","previous_filename":"docker/src/main/resources/docker-compose-postgresql.yml"},{"sha":"cac74c82398342ecb5edc9cab9bab7f89dcdc2ee","filename":"docker/src/main/resources/k8s/helm/README.adoc","status":"added","additions":25,"deletions":0,"changes":25,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2FREADME.adoc","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2FREADME.adoc","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2FREADME.adoc?ref=dfccf431fcd34b410838c3e230c362f58e4a8877","patch":"@@ -0,0 +1,25 @@\n+= Install Commands\n+\n+Open a terminal and navigate to the \"helm\" folder.  \n+\n+[WARNING]\n+Do not forget to set your `values.yaml`!\n+\n+.Install postgres\n+[source,bash]\n+----\n+helm install postgres --name postgres --namespace <YOUR_NAMESPACE> -f postgres/values.yaml\n+----\n+\n+Let Postgres initialize (about 20-30 seconds).  You can watch logs to confirm\n+\n+.Install syncope\n+[source,bash]\n+----\n+helm install syncope --name syncope --namespace <YOUR_NAMESPACE> -f syncope/values.yaml\n+----\n+=== Todo\n+Still more to do:\n+\n+* Have some value parameters that are not plumbed in (e.g. resources)\n+* Need to put in liveness and readyness checks\n\\ No newline at end of file"},{"sha":"a7c8b8fcd79e9ec5e8c47789bf55d43800cba492","filename":"docker/src/main/resources/k8s/helm/postgres/Chart.yaml","status":"added","additions":30,"deletions":0,"changes":30,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fpostgres%2FChart.yaml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fpostgres%2FChart.yaml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fpostgres%2FChart.yaml?ref=dfccf431fcd34b410838c3e230c362f58e4a8877","patch":"@@ -0,0 +1,30 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+apiVersion: v1\n+name: basic\n+description: Deploys Postgres For Syncope\n+version: 1\n+appVersion: 2.0\n+keywords:\n+- postgresql\n+- postgres\n+- database\n+- sql\n+home: https://syncope.apache.org/\n+icon: https://syncope.apache.org/images/apache-syncope-logo-medium.png\n+sources:\n+- https://github.com/apache/syncope"},{"sha":"55f8755b4d7725de75576b59fdc7c91bc3dc2785","filename":"docker/src/main/resources/k8s/helm/postgres/templates/db-deployment.yaml","status":"added","additions":141,"deletions":0,"changes":141,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fpostgres%2Ftemplates%2Fdb-deployment.yaml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fpostgres%2Ftemplates%2Fdb-deployment.yaml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fpostgres%2Ftemplates%2Fdb-deployment.yaml?ref=dfccf431fcd34b410838c3e230c362f58e4a8877","patch":"@@ -0,0 +1,141 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+apiVersion: v1\n+kind: ConfigMap\n+metadata:\n+ name: postgres-environment-config\n+data:\n+ PG_DATABASE: \"{{.Values.databaseEnvironment.pgDatabase}}\"\n+ PG_MODE: \"{{.Values.databaseEnvironment.pgMode}}\"\n+ PG_PASSWORD: \"{{.Values.databaseEnvironment.pgPassword}}\"\n+ PG_PRIMARY_HOST: \"{{.Values.databaseEnvironment.pgPrimaryHost}}\"\n+ PG_PRIMARY_PASSWORD: \"{{.Values.databaseEnvironment.pgPrimaryPassword}}\"\n+ PG_PRIMARY_PORT: \"{{.Values.databaseEnvironment.pgPrimaryPort}}\"\n+ PG_PRIMARY_USER: \"{{.Values.databaseEnvironment.pgPrimaryUser}}\"\n+ PG_ROOT_PASSWORD: \"{{.Values.databaseEnvironment.pgRootPassword}}\"\n+ PG_USER: \"{{.Values.databaseEnvironment.pgUser}}\"\n+ PGDATA_PATH_OVERRIDE: \"{{.Values.databaseEnvironment.pgdataPathOverride}}\"\n+---\n+apiVersion: v1\n+kind: PersistentVolume\n+metadata:\n+  name: {{.Values.pv.name}}\n+spec:\n+  storageClassName: \"\"\n+  capacity:\n+    storage: {{.Values.pv.storage}}\n+  accessModes:\n+    - {{.Values.pv.mode}}\n+  hostPath:\n+    path: \"{{.Values.pv.path}}\"\n+  persistentVolumeReclaimPolicy: Retain\n+#  gcePersistentDisk:\n+#    pdName: postgres-data\n+#    fsType: ext4\n+---\n+apiVersion: v1\n+kind: PersistentVolumeClaim\n+metadata:\n+  name: {{.Values.pvc.name}}\n+spec:\n+  accessModes:\n+    - {{.Values.pv.mode}}\n+  resources:\n+    requests:\n+      storage: {{.Values.pv.storage}}\n+---\n+apiVersion: extensions/v1beta1\n+kind: Deployment\n+metadata:\n+  name: \"{{.Values.databaseConfig.name}}\"\n+  labels:\n+    name: \"{{.Values.databaseConfig.name}}\"\n+    heritage: {{.Release.Service | quote }}\n+    release: {{.Release.Name | quote }}\n+    chart: \"{{.Chart.Name}}-{{.Chart.Version}}\"\n+  annotations:\n+    \"helm.sh/created\": {{.Release.Time.Seconds | quote }}\n+spec:\n+  replicas: 1\n+  strategy: {}\n+  template:\n+    metadata:\n+      creationTimestamp: null\n+      labels:\n+        name: \"{{.Values.databaseConfig.name}}\"\n+    spec:\n+      securityContext:\n+        fsGroup: 1000\n+      containers:\n+      - image: \"{{.Values.databaseConfig.repository}}/{{.Values.databaseConfig.container}}:{{.Values.databaseConfig.tag}}\"\n+        name: {{.Values.databaseConfig.name}}\n+#TODO: Need to impliment the readiness probe\n+#        readinessProbe:\n+#          exec:\n+#            command:\n+#            - \"/opt/cpm/bin/readiness.sh\"\n+#          initialDelaySeconds: 10\n+#          timeoutSeconds: 1\n+#        livenessProbe:\n+#          exec:\n+#            command:\n+#            - \"/opt/cpm/bin/liveness.sh\"\n+#          initialDelaySeconds: 120\n+#          timeoutSeconds: 1\n+        envFrom:\n+        - configMapRef:\n+           name: postgres-environment-config\n+        volumeMounts:\n+          - mountPath: {{.Values.pv.path}}\n+            name: {{.Values.pv.name}}\n+        ports:\n+          - containerPort: {{.Values.databaseConfig.port}}\n+            protocol: TCP\n+        resources:\n+          requests:\n+            cpu: {{ .Values.databaseConfig.cpu }}\n+            memory: {{ .Values.databaseConfig.memory }}\n+      volumes:\n+        - name: {{.Values.pv.name}}\n+          persistentVolumeClaim:\n+            claimName: {{.Values.pvc.name}}\n+            readOnly: false\n+      restartPolicy: Always\n+status: {}\n+---\n+apiVersion: v1\n+kind: Service\n+metadata:\n+  name: \"{{.Values.databaseConfig.name}}\"\n+  labels:\n+    name: \"{{.Values.databaseConfig.name}}\"\n+    heritage: {{ .Release.Service | quote }}\n+    release: {{ .Release.Name | quote }}\n+    chart: \"{{.Chart.Name}}-{{.Chart.Version}}\"\n+spec:\n+  type: \"{{.Values.serviceType}}\"\n+  ports:\n+  - protocol: TCP\n+    port: {{.Values.databaseConfig.port}}\n+    targetPort: {{.Values.databaseConfig.port}}\n+    nodePort: 0\n+    name: \"{{.Values.databaseConfig.name}}\"\n+  selector:\n+    name: \"{{.Values.databaseConfig.name}}\"\n+  sessionAffinity: None\n+status:\n+  loadBalancer: {}\n\\ No newline at end of file"},{"sha":"51a60b3416a2fa8ed17eb68d0cd84cf8db903aa4","filename":"docker/src/main/resources/k8s/helm/postgres/values.yaml","status":"added","additions":47,"deletions":0,"changes":47,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fpostgres%2Fvalues.yaml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fpostgres%2Fvalues.yaml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fpostgres%2Fvalues.yaml?ref=dfccf431fcd34b410838c3e230c362f58e4a8877","patch":"@@ -0,0 +1,47 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+### Environment Variables that will be pumped into postgres\n+databaseEnvironment:\n+  pgDatabase: syncope\n+  pgMode: primary\n+  pgPassword: <YOURPASSWORD>\n+  pgPrimaryHost: localhost\n+  pgPrimaryPassword: <YOURPASSWORD>\n+  pgPrimaryPort: 5432\n+  pgPrimaryUser: postgres\n+  pgRootPassword: <YOURPASSWORD>\n+  pgUser: syncope\n+  pgdataPathOverride: postgres-data\n+### Database container information\n+databaseConfig:\n+  port: 5432\n+  name: postgres\n+  serviceType: ClusterIP\n+  repository: crunchydata\n+  container: crunchy-postgres\n+  tag: centos7-10.3-1.8.2\n+  cpu: 200m\n+  memory: 512Mi\n+### Persistent Volume Config\n+pv:\n+  storage: 20Gi\n+  name: primary-pv\n+  mode: ReadWriteOnce\n+  path: /pgdata\n+### The PVC that will be used by postgres\n+pvc:\n+  name: postgres-readwriteonce-pvc\n\\ No newline at end of file"},{"sha":"7f697a2b4584d8ef9918a2f047cb7637410cd5e0","filename":"docker/src/main/resources/k8s/helm/syncope/Chart.yaml","status":"added","additions":29,"deletions":0,"changes":29,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fsyncope%2FChart.yaml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fsyncope%2FChart.yaml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fsyncope%2FChart.yaml?ref=dfccf431fcd34b410838c3e230c362f58e4a8877","patch":"@@ -0,0 +1,29 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+apiVersion: v1\n+name: basic\n+description: Deploys Syncope\n+version: 1\n+appVersion: 2.0\n+keywords:\n+- syncope\n+- syncope-enduser\n+- syncope-console\n+home: https://syncope.apache.org/\n+icon: https://syncope.apache.org/images/apache-syncope-logo-medium.png\n+sources:\n+- https://github.com/apache/syncope"},{"sha":"2daf9f25ba4aedd5818df6d64c43c26a6fa3c337","filename":"docker/src/main/resources/k8s/helm/syncope/templates/syncope-console-deployment.yaml","status":"added","additions":51,"deletions":0,"changes":51,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fsyncope%2Ftemplates%2Fsyncope-console-deployment.yaml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fsyncope%2Ftemplates%2Fsyncope-console-deployment.yaml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fsyncope%2Ftemplates%2Fsyncope-console-deployment.yaml?ref=dfccf431fcd34b410838c3e230c362f58e4a8877","patch":"@@ -0,0 +1,51 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+apiVersion: extensions/v1beta1\n+kind: Deployment\n+metadata:\n+  name: {{.Values.syncopeConsoleConfig.name}}\n+spec:\n+  replicas: 1\n+  strategy: {}\n+  template:\n+    metadata:\n+      labels:\n+        name: {{.Values.syncopeConsoleConfig.name}}\n+    spec:\n+      containers:\n+      - name: {{.Values.syncopeConsoleConfig.name}}\n+        envFrom:\n+        - configMapRef:\n+           name: syncope-environment-config\n+        image: \"{{.Values.syncopeConsoleConfig.repository}}/{{.Values.syncopeConsoleConfig.container}}:{{.Values.syncopeConsoleConfig.tag}}\"\n+        ports:\n+        - containerPort: {{.Values.syncopeConsoleConfig.containerPort}}\n+        resources: {}\n+      restartPolicy: Always\n+status: {}\n+---\n+apiVersion: v1\n+kind: Service\n+metadata:\n+  name: \"{{.Values.syncopeConsoleConfig.name}}\"\n+spec:\n+  type: \"{{.Values.syncopeConsoleConfig.serviceType}}\"\n+  selector:\n+    name: \"{{.Values.syncopeConsoleConfig.name}}\"\n+  ports:\n+  - port: {{.Values.syncopeConsoleConfig.containerPort}}\n+    name: http-api"},{"sha":"ecbf13f5bb9e51d2a33535fe16b7dd687b0f1573","filename":"docker/src/main/resources/k8s/helm/syncope/templates/syncope-deployment.yaml","status":"added","additions":67,"deletions":0,"changes":67,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fsyncope%2Ftemplates%2Fsyncope-deployment.yaml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fsyncope%2Ftemplates%2Fsyncope-deployment.yaml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fsyncope%2Ftemplates%2Fsyncope-deployment.yaml?ref=dfccf431fcd34b410838c3e230c362f58e4a8877","patch":"@@ -0,0 +1,67 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+apiVersion: v1\n+kind: ConfigMap\n+metadata:\n+ name: syncope-environment-config\n+data:\n+ DBMS: postgresql\n+ DB_URL: {{.Values.syncopeEnvironment.dbUrl}}\n+ DB_USER: {{.Values.syncopeEnvironment.dbUser}}\n+ DB_PASSWORD: {{.Values.syncopeEnvironment.userCreds}}\n+ DB_POOL_MAX: \"{{.Values.syncopeEnvironment.dbPoolMax}}\"\n+ DB_POOL_MIN: \"{{.Values.syncopeEnvironment.dbPoolMin}}\"\n+ OPENJPA_REMOTE_COMMIT: sjvm\n+ CORE_SCHEME: \"{{.Values.syncopeEnvironment.coreScheme}}\"\n+ CORE_HOST: \"{{.Values.syncopeEnvironment.coreHost}}\"\n+ CORE_PORT: \"{{.Values.syncopeEnvironment.corePort}}\"\n+---\n+apiVersion: extensions/v1beta1\n+kind: Deployment\n+metadata:\n+  name: {{.Values.syncopeConfig.name}}\n+spec:\n+  replicas: 1\n+  strategy: {}\n+  template:\n+    metadata:\n+      labels:\n+        name: {{.Values.syncopeConfig.name}}\n+    spec:\n+      containers:\n+      - name: {{.Values.syncopeConfig.name}}\n+        envFrom:\n+        - configMapRef:\n+           name: syncope-environment-config\n+        image: \"{{.Values.syncopeConfig.repository}}/{{.Values.syncopeConfig.container}}:{{.Values.syncopeConfig.tag}}\"\n+        ports:\n+        - containerPort: {{.Values.syncopeConfig.containerPort}}\n+        resources: {}\n+      restartPolicy: Always\n+status: {}\n+---\n+apiVersion: v1\n+kind: Service\n+metadata:\n+  name: \"{{.Values.syncopeConfig.name}}\"\n+spec:\n+  type: \"{{.Values.syncopeConfig.serviceType}}\"\n+  selector:\n+    name: \"{{.Values.syncopeConfig.name}}\"\n+  ports:\n+  - port: {{.Values.syncopeConfig.containerPort}}\n+    name: http-api"},{"sha":"2a28cfca6d2c0136318f19a46f9a70fc6942ce5b","filename":"docker/src/main/resources/k8s/helm/syncope/templates/syncope-enduser-deployment.yaml","status":"added","additions":51,"deletions":0,"changes":51,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fsyncope%2Ftemplates%2Fsyncope-enduser-deployment.yaml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fsyncope%2Ftemplates%2Fsyncope-enduser-deployment.yaml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fsyncope%2Ftemplates%2Fsyncope-enduser-deployment.yaml?ref=dfccf431fcd34b410838c3e230c362f58e4a8877","patch":"@@ -0,0 +1,51 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+apiVersion: extensions/v1beta1\n+kind: Deployment\n+metadata:\n+  name: {{.Values.syncopeEndUserConfig.name}}\n+spec:\n+  replicas: 1\n+  strategy: {}\n+  template:\n+    metadata:\n+      labels:\n+        name: {{.Values.syncopeEndUserConfig.name}}\n+    spec:\n+      containers:\n+      - name: {{.Values.syncopeEndUserConfig.name}}\n+        envFrom:\n+        - configMapRef:\n+           name: syncope-environment-config\n+        image: \"{{.Values.syncopeEndUserConfig.repository}}/{{.Values.syncopeEndUserConfig.container}}:{{.Values.syncopeEndUserConfig.tag}}\"\n+        ports:\n+        - containerPort: {{.Values.syncopeEndUserConfig.containerPort}}\n+        resources: {}\n+      restartPolicy: Always\n+status: {}\n+---\n+apiVersion: v1\n+kind: Service\n+metadata:\n+  name: \"{{.Values.syncopeEndUserConfig.name}}\"\n+spec:\n+  type: \"{{.Values.syncopeEndUserConfig.serviceType}}\"\n+  selector:\n+    name: \"{{.Values.syncopeEndUserConfig.name}}\"\n+  ports:\n+  - port: {{.Values.syncopeEndUserConfig.containerPort}}\n+    name: http-api"},{"sha":"54e9129ba231376404b802b4eadecddad1c6b6cf","filename":"docker/src/main/resources/k8s/helm/syncope/values.yaml","status":"added","additions":56,"deletions":0,"changes":56,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fsyncope%2Fvalues.yaml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fsyncope%2Fvalues.yaml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2Fsyncope%2Fvalues.yaml?ref=dfccf431fcd34b410838c3e230c362f58e4a8877","patch":"@@ -0,0 +1,56 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+### Environment Variables that will be set on all 3 syncope docker containers (core, console, enduser)\n+syncopeEnvironment:\n+  dbUrl: jdbc:postgresql://postgres:5432/syncope\n+  dbUser: syncope\n+  dbPoolMax: 10\n+  dbPoolMin: 2\n+  coreScheme: http # valid values are http and https\n+  coreHost: syncope # Host that syncope will use to connect to core.  Needs to match .Values.syncopeConfig.name\n+  corePort: 8080\n+  userCreds: <YOURPASSWORD> # Needs to match the databaseEnvironment.pgPassword that was provided to the database\n+### Config Params for the syncope container (A.K.A. Core)\n+syncopeConfig:\n+  name: syncope\n+  replicas: 1\n+  repository: apache\n+  container: syncope\n+  tag: 2.1.0\n+  containerPort: 8080\n+  memoryLimit: 512Mi\n+  serviceType: ClusterIP\n+### Config Params for the syncope-console containers\n+syncopeConsoleConfig:\n+  name: syncope-console\n+  replicas: 1\n+  repository: apache\n+  container: syncope-console\n+  tag: 2.1.0\n+  containerPort: 8080\n+  memoryLimit: 512Mi\n+  serviceType: ClusterIP\n+### Config Params for the syncope-enduser containers\n+syncopeEndUserConfig:\n+  name: syncope-enduser\n+  replicas: 1\n+  repository: apache\n+  container: syncope-enduser\n+  tag: 2.1.0\n+  containerPort: 8080\n+  memoryLimit: 512Mi\n+  serviceType: ClusterIP\n\\ No newline at end of file"},{"sha":"14e767762bc816d8745cd3d58dd6db94be9ba7a9","filename":"src/main/asciidoc/getting-started/obtain.adoc","status":"modified","additions":42,"deletions":0,"changes":42,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/dfccf431fcd34b410838c3e230c362f58e4a8877/src%2Fmain%2Fasciidoc%2Fgetting-started%2Fobtain.adoc","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/dfccf431fcd34b410838c3e230c362f58e4a8877/src%2Fmain%2Fasciidoc%2Fgetting-started%2Fobtain.adoc","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/src%2Fmain%2Fasciidoc%2Fgetting-started%2Fobtain.adoc?ref=dfccf431fcd34b410838c3e230c362f58e4a8877","patch":"@@ -453,6 +453,48 @@ Credentials: `admin` / `password`\n \n |===\n \n+==== Kubernetes Install\n+\n+Using the same images above it is possible to install in Kubernetes.  Provided is a set of example helm charts that can be used to install Syncope directly in Kubernetes.  Your specific setup might be different but ideally these can be a baseline install for your specific needs.  This will walk you through the installation of syncope via helm.\n+\n+It makes a couple assumptions:\n+\n+* Have a working Kubernetes Cluster to install into.\n+** If you don't have one then GCP has a decent https://kubernetes.io/docs/setup/[tutorial] .  **NOTE:** You could also use any other Cloud Provider or Local install (e.g. AWS, Minikub, Openshift)\n+* Have helm installed\n+** Follow these https://docs.helm.sh/using_helm/[instructions] if you don't\n+* You have your kubernetes cluster to allow for dynamic provisioning of persistent volumes in K8s\n+** If you don't have it then you will need to manually create the volume or turn on dynamic provisioning.  Refer to this link https://kubernetes.io/docs/concepts/storage/dynamic-provisioning/[here]\n+\n+===== Overview Of Install\n+\n+The install is broken into two separate helm charts.  This is due to the fact that syncope doesn't startup properly is the database isn't fully initialized yet.\n+\n+* Postgres Chart - this will install the postgres database.  It will also configure a persistent volume and persistent volume claim to store the data\n+* Syncope Chart - This is the actual syncope install.  It will install 3 separate pods (Core, Console, and Enduser)\n+\n+image::SyncopeLayoutInK8s.png[]\n+\n+**Values.yaml** - Each Helm Chart has a values.yaml.  These are the configurable parameters for your specific install.  Before running the install you need to update the values.yaml for your needs\n+\n+===== Install Commands\n+\n+Open a terminal and navigate to the \"helm\" https://github.com/apache/syncope/tree/master/docker/src/main/resources/k8s/helm[folder] wherever you downloaded the code.  **REMINDER:  SET YOUR VALUES.YAML!!!**\n+\n+.Install postgres\n+[source,bash]\n+----\n+helm install postgres --name postgres --namespace <YOUR_NAMESPACE> -f postgres/values.yaml\n+----\n+\n+Let Postgres initialize (about 20-30 seconds).  You can watch logs to confirm\n+\n+.Install syncope\n+[source,bash]\n+----\n+helm install syncope --name syncope --namespace <YOUR_NAMESPACE> -f syncope/values.yaml\n+----\n+\n === Maven Project\n \n This is the *preferred method* for working with Apache Syncope, giving access to the whole set of customization"},{"sha":"9bfee5e21758c4c32de7da8c73ae2e3705d8a8bc","filename":"src/main/asciidoc/images/SyncopeLayoutInK8s.png","status":"added","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/dfccf431fcd34b410838c3e230c362f58e4a8877/src%2Fmain%2Fasciidoc%2Fimages%2FSyncopeLayoutInK8s.png","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/dfccf431fcd34b410838c3e230c362f58e4a8877/src%2Fmain%2Fasciidoc%2Fimages%2FSyncopeLayoutInK8s.png","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/src%2Fmain%2Fasciidoc%2Fimages%2FSyncopeLayoutInK8s.png?ref=dfccf431fcd34b410838c3e230c362f58e4a8877"}]}