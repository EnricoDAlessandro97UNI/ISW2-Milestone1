{"sha":"5758aa8e332bf48d5db687a09c424fda01cc7aa8","node_id":"C_kwDOJfYA1toAKDU3NThhYThlMzMyYmY0OGQ1ZGI2ODdhMDljNDI0ZmRhMDFjYzdhYTg","commit":{"author":{"name":"Misagh Moayyed","email":"mm1844@gmail.com","date":"2022-09-05T09:26:03Z"},"committer":{"name":"GitHub","email":"noreply@github.com","date":"2022-09-05T09:26:03Z"},"message":"Upgrade CAS/WA in prep for the final 6.6 release (#369)","tree":{"sha":"576556a708cf7251f81fda0fcf4c987eceda44eb","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/576556a708cf7251f81fda0fcf4c987eceda44eb"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/5758aa8e332bf48d5db687a09c424fda01cc7aa8","comment_count":0,"verification":{"verified":true,"reason":"valid","signature":"-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJjFcCrCRBK7hj4Ov3rIwAAsDsIAK1Ckt/0tHm3tkjCZTzdpPpc\nEXhbPorrstTUKye0QWUkE6vrrQA+WAoWUdT/YBshTj7ib9/YuaDU0HhRmI8gsJjq\nbL1g9HEwIKc07RfBXfAW55XBumY6iVvegK+trBNz3w8ydI0aDEqKAeWYar65o0AY\nPOq8bI6/0ShdzImxpm5XxWmQuwBgIdVA4XOoDDUmlqCfh8t0aP/pjBkV41xUQVbW\nfoqm/i5IiVjBGwemJU7KfqDMGw/s2gN8Loo5sHYPN2qbCgqKO2MD5e7uqhqQvN+d\ny5eLmW38rjWwuDPx9fJQa0EZYCElVgKgkty0POkh6BqGFi0f95MeuF7+2YEK150=\n=Zdbf\n-----END PGP SIGNATURE-----\n","payload":"tree 576556a708cf7251f81fda0fcf4c987eceda44eb\nparent 2e7db2c883145b6c315046d87a09df31df55548a\nauthor Misagh Moayyed <mm1844@gmail.com> 1662369963 +0400\ncommitter GitHub <noreply@github.com> 1662369963 +0400\n\nUpgrade CAS/WA in prep for the final 6.6 release (#369)\n\n"}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/5758aa8e332bf48d5db687a09c424fda01cc7aa8","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/5758aa8e332bf48d5db687a09c424fda01cc7aa8","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/5758aa8e332bf48d5db687a09c424fda01cc7aa8/comments","author":{"login":"mmoayyed","id":1205228,"node_id":"MDQ6VXNlcjEyMDUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/1205228?v=4","gravatar_id":"","url":"https://api.github.com/users/mmoayyed","html_url":"https://github.com/mmoayyed","followers_url":"https://api.github.com/users/mmoayyed/followers","following_url":"https://api.github.com/users/mmoayyed/following{/other_user}","gists_url":"https://api.github.com/users/mmoayyed/gists{/gist_id}","starred_url":"https://api.github.com/users/mmoayyed/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmoayyed/subscriptions","organizations_url":"https://api.github.com/users/mmoayyed/orgs","repos_url":"https://api.github.com/users/mmoayyed/repos","events_url":"https://api.github.com/users/mmoayyed/events{/privacy}","received_events_url":"https://api.github.com/users/mmoayyed/received_events","type":"User","site_admin":false},"committer":{"login":"web-flow","id":19864447,"node_id":"MDQ6VXNlcjE5ODY0NDQ3","avatar_url":"https://avatars.githubusercontent.com/u/19864447?v=4","gravatar_id":"","url":"https://api.github.com/users/web-flow","html_url":"https://github.com/web-flow","followers_url":"https://api.github.com/users/web-flow/followers","following_url":"https://api.github.com/users/web-flow/following{/other_user}","gists_url":"https://api.github.com/users/web-flow/gists{/gist_id}","starred_url":"https://api.github.com/users/web-flow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/web-flow/subscriptions","organizations_url":"https://api.github.com/users/web-flow/orgs","repos_url":"https://api.github.com/users/web-flow/repos","events_url":"https://api.github.com/users/web-flow/events{/privacy}","received_events_url":"https://api.github.com/users/web-flow/received_events","type":"User","site_admin":false},"parents":[{"sha":"2e7db2c883145b6c315046d87a09df31df55548a","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/2e7db2c883145b6c315046d87a09df31df55548a","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/2e7db2c883145b6c315046d87a09df31df55548a"}],"stats":{"total":24,"additions":12,"deletions":12},"files":[{"sha":"4d957fe3800bfe9ed50550ad4e53d3e87dc26956","filename":"pom.xml","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/5758aa8e332bf48d5db687a09c424fda01cc7aa8/pom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/5758aa8e332bf48d5db687a09c424fda01cc7aa8/pom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/pom.xml?ref=5758aa8e332bf48d5db687a09c424fda01cc7aa8","patch":"@@ -450,7 +450,7 @@ under the License.\n \n     <pac4j.version>5.4.6</pac4j.version>\n \n-    <cas.version>6.6.0-RC5</cas.version>\n+    <cas.version>6.6.0</cas.version>\n     <cas-client.version>3.6.4</cas-client.version>\n \n     <h2.version>2.1.214</h2.version>"},{"sha":"913999d84962142f6001183c341a7b13aa71aaf6","filename":"wa/starter/src/main/java/org/apache/syncope/wa/starter/mapping/OIDCRPClientAppTOMapper.java","status":"modified","additions":6,"deletions":6,"changes":12,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/5758aa8e332bf48d5db687a09c424fda01cc7aa8/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fmapping%2FOIDCRPClientAppTOMapper.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/5758aa8e332bf48d5db687a09c424fda01cc7aa8/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fmapping%2FOIDCRPClientAppTOMapper.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fmapping%2FOIDCRPClientAppTOMapper.java?ref=5758aa8e332bf48d5db687a09c424fda01cc7aa8","patch":"@@ -87,13 +87,13 @@ public RegisteredService map(\n         } else {\n             chain = new ChainingAttributeReleasePolicy();\n             if (attributeReleasePolicy != null) {\n-                chain.addPolicy(attributeReleasePolicy);\n+                chain.addPolicies(attributeReleasePolicy);\n             }\n \n-            chain.addPolicy(new OidcProfileScopeAttributeReleasePolicy());\n-            chain.addPolicy(new OidcEmailScopeAttributeReleasePolicy());\n-            chain.addPolicy(new OidcAddressScopeAttributeReleasePolicy());\n-            chain.addPolicy(new OidcPhoneScopeAttributeReleasePolicy());\n+            chain.addPolicies(new OidcProfileScopeAttributeReleasePolicy(),\n+                new OidcEmailScopeAttributeReleasePolicy(),\n+                new OidcAddressScopeAttributeReleasePolicy(),\n+                new OidcPhoneScopeAttributeReleasePolicy());\n \n             Set<String> customClaims = clientApp.getReleaseAttrs().values().stream().\n                     map(Objects::toString).collect(Collectors.toCollection(HashSet::new));\n@@ -110,7 +110,7 @@ public RegisteredService map(\n                                     distinct().collect(Collectors.toList()));\n                 }\n \n-                chain.addPolicy(new OidcCustomScopeAttributeReleasePolicy(\n+                chain.addPolicies(new OidcCustomScopeAttributeReleasePolicy(\n                         CUSTOM_SCOPE, customClaims.stream().collect(Collectors.toList())));\n             }\n         }"},{"sha":"ad4c0833f2b9acf8cf4d4849c50678af0308237d","filename":"wa/starter/src/main/java/org/apache/syncope/wa/starter/surrogate/WASurrogateAuthenticationService.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/5758aa8e332bf48d5db687a09c424fda01cc7aa8/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fsurrogate%2FWASurrogateAuthenticationService.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/5758aa8e332bf48d5db687a09c424fda01cc7aa8/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fsurrogate%2FWASurrogateAuthenticationService.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fsurrogate%2FWASurrogateAuthenticationService.java?ref=5758aa8e332bf48d5db687a09c424fda01cc7aa8","patch":"@@ -41,7 +41,7 @@ public WASurrogateAuthenticationService(final WARestClient waRestClient) {\n     }\n \n     @Override\n-    public boolean canAuthenticateAs(\n+    public boolean canImpersonate(\n             final String surrogate, final Principal principal, final Optional<Service> service) {\n \n         try {\n@@ -55,7 +55,7 @@ public boolean canAuthenticateAs(\n     }\n \n     @Override\n-    public Collection<String> getEligibleAccountsForSurrogateToProxy(final String username) {\n+    public Collection<String> getImpersonationAccounts(final String username) {\n         return getImpersonationService().read(username).\n                 stream().\n                 map(ImpersonationAccount::getImpersonated)."},{"sha":"fd99d9e45b530fe71896ac7ddb922a02d542fd60","filename":"wa/starter/src/test/java/org/apache/syncope/wa/starter/surrogate/WASurrogateAuthenticationServiceTest.java","status":"modified","additions":3,"deletions":3,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/5758aa8e332bf48d5db687a09c424fda01cc7aa8/wa%2Fstarter%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fsurrogate%2FWASurrogateAuthenticationServiceTest.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/5758aa8e332bf48d5db687a09c424fda01cc7aa8/wa%2Fstarter%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fsurrogate%2FWASurrogateAuthenticationServiceTest.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fstarter%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fsurrogate%2FWASurrogateAuthenticationServiceTest.java?ref=5758aa8e332bf48d5db687a09c424fda01cc7aa8","patch":"@@ -51,10 +51,10 @@ public void verifyImpersonation() {\n \n         impersonationService.create(owner, account);\n \n-        assertFalse(surrogateService.getEligibleAccountsForSurrogateToProxy(owner).isEmpty());\n+        assertFalse(surrogateService.getImpersonationAccounts(owner).isEmpty());\n \n         Principal principal = PrincipalFactoryUtils.newPrincipalFactory().createPrincipal(owner);\n-        assertFalse(surrogateService.canAuthenticateAs(\"unknown\", principal, Optional.empty()));\n-        assertTrue(surrogateService.canAuthenticateAs(account.getImpersonated(), principal, Optional.empty()));\n+        assertFalse(surrogateService.canImpersonate(\"unknown\", principal, Optional.empty()));\n+        assertTrue(surrogateService.canImpersonate(account.getImpersonated(), principal, Optional.empty()));\n     }\n }"}]}