{"sha":"af6f161b52b961f05f65d686f26cb86cac4f6142","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmFmNmYxNjFiNTJiOTYxZjA1ZjY1ZDY4NmYyNmNiODZjYWM0ZjYxNDI=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2013-09-23T12:08:28Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2013-09-23T12:08:28Z"},"message":"[SYNCOPE-405] Completing log4j2 conf with latest features from 2.0-beta9\n\ngit-svn-id: https://svn.apache.org/repos/asf/syncope/trunk@1525566 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"a3705aa0da3e9b1478c375e40551dd58d37b2aee","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/a3705aa0da3e9b1478c375e40551dd58d37b2aee"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/af6f161b52b961f05f65d686f26cb86cac4f6142","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/af6f161b52b961f05f65d686f26cb86cac4f6142","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/af6f161b52b961f05f65d686f26cb86cac4f6142","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/af6f161b52b961f05f65d686f26cb86cac4f6142/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"f6bbf957ab7f69d35785ee7dd4a3e3a6ccb42be9","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/f6bbf957ab7f69d35785ee7dd4a3e3a6ccb42be9","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/f6bbf957ab7f69d35785ee7dd4a3e3a6ccb42be9"}],"stats":{"total":82,"additions":56,"deletions":26},"files":[{"sha":"3263514c031394ff7a3b435010dfa8d548a93ef8","filename":"console/src/main/resources/log4j2.xml","status":"modified","additions":4,"deletions":4,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/af6f161b52b961f05f65d686f26cb86cac4f6142/console%2Fsrc%2Fmain%2Fresources%2Flog4j2.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/af6f161b52b961f05f65d686f26cb86cac4f6142/console%2Fsrc%2Fmain%2Fresources%2Flog4j2.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Flog4j2.xml?ref=af6f161b52b961f05f65d686f26cb86cac4f6142","patch":"@@ -21,17 +21,17 @@ under the License.\n \n   <appenders>\n \n-    <RollingFile name=\"main\" fileName=\"${log.directory}/console.log\"\n-                 filePattern=\"${log.directory}/console-%d{yyyy-MM-dd}.log.gz\"\n-                 immediateFlush=\"false\" append=\"false\">\n+    <RollingRandomAccessFile name=\"main\" fileName=\"${log.directory}/console.log\"\n+                             filePattern=\"${log.directory}/console-%d{yyyy-MM-dd}.log.gz\"\n+                             immediateFlush=\"false\" append=\"false\">\n       <PatternLayout>\n         <pattern>%d{HH:mm:ss.SSS} %-5level %logger - %msg%n</pattern>\n       </PatternLayout>\n       <Policies>\n         <TimeBasedTriggeringPolicy/>\n         <SizeBasedTriggeringPolicy size=\"250 MB\"/>\n       </Policies>\n-    </RollingFile>\n+    </RollingRandomAccessFile>\n     \n   </appenders>\n "},{"sha":"fc6096f04785c0550dd36bbb61a20580be802db3","filename":"console/src/main/webapp/WEB-INF/web.xml","status":"modified","additions":18,"deletions":3,"changes":21,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/af6f161b52b961f05f65d686f26cb86cac4f6142/console%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/af6f161b52b961f05f65d686f26cb86cac4f6142/console%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml?ref=af6f161b52b961f05f65d686f26cb86cac4f6142","patch":"@@ -41,7 +41,10 @@ under the License.\n   <listener>\n     <listener-class>org.springframework.web.context.request.RequestContextListener</listener-class>\n   </listener>\n-\n+  <listener>\n+    <listener-class>org.apache.logging.log4j.core.web.Log4jServletContextListener</listener-class>\n+  </listener>\n+    \n   <filter>\n     <filter-name>SyncopeConsole</filter-name>\n     <filter-class>org.apache.wicket.protocol.http.WicketFilter</filter-class>\n@@ -50,15 +53,27 @@ under the License.\n       <param-value>org.apache.wicket.spring.SpringWebApplicationFactory</param-value>\n     </init-param>\n   </filter>\n+  <filter>\n+    <filter-name>log4jServletFilter</filter-name>\n+    <filter-class>org.apache.logging.log4j.core.web.Log4jServletFilter</filter-class>\n+  </filter>\n     \n   <filter-mapping>\n     <filter-name>SyncopeConsole</filter-name>\n     <url-pattern>/*</url-pattern>\n     <dispatcher>REQUEST</dispatcher>\n     <dispatcher>INCLUDE</dispatcher>\n   </filter-mapping>\n-\n-    <!-- SESSION TIMEOUT (MINUTES)-->\n+  <filter-mapping>\n+    <filter-name>log4jServletFilter</filter-name>\n+    <url-pattern>/*</url-pattern>\n+    <dispatcher>REQUEST</dispatcher>\n+    <dispatcher>FORWARD</dispatcher>\n+    <dispatcher>INCLUDE</dispatcher>\n+    <dispatcher>ERROR</dispatcher>\n+  </filter-mapping>\n+    \n+  <!-- SESSION TIMEOUT (MINUTES)-->\n   <session-config>\n     <session-timeout>30</session-timeout>\n   </session-config>"},{"sha":"4b940a7c0306ad69425cdcc4885dde30a0c4a250","filename":"core/pom.xml","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/af6f161b52b961f05f65d686f26cb86cac4f6142/core%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/af6f161b52b961f05f65d686f26cb86cac4f6142/core%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpom.xml?ref=af6f161b52b961f05f65d686f26cb86cac4f6142","patch":"@@ -1089,8 +1089,8 @@ under the License.\n                 </goals>\n               </execution>\n               <!-- This complex setup is needed because \n-                     (a) JBoss 7.2 is needed (and RedHat does not provide a build release yet)\n-                     (b) it seems there is no clean way to upgrade JBoss' JAX-RS APIs. -->\n+              (a) JBoss 7.2 is needed (and RedHat does not provide a build release yet)\n+              (b) it seems there is no clean way to upgrade JBoss' JAX-RS APIs. -->\n               <execution>\n                 <id>setupJBoss72</id>\n                 <phase>pre-integration-test</phase>"},{"sha":"76b85ec3e7469c6b7348f95fb52047b4bf37162b","filename":"core/src/main/resources/log4j2.xml","status":"modified","additions":16,"deletions":16,"changes":32,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/af6f161b52b961f05f65d686f26cb86cac4f6142/core%2Fsrc%2Fmain%2Fresources%2Flog4j2.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/af6f161b52b961f05f65d686f26cb86cac4f6142/core%2Fsrc%2Fmain%2Fresources%2Flog4j2.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fresources%2Flog4j2.xml?ref=af6f161b52b961f05f65d686f26cb86cac4f6142","patch":"@@ -21,53 +21,53 @@ under the License.\n \n   <appenders>\n     \n-    <RollingFile name=\"main\" fileName=\"${log.directory}/core.log\"\n-                 filePattern=\"${log.directory}/core-%d{yyyy-MM-dd}.log.gz\"\n-                 immediateFlush=\"false\" append=\"false\">\n+    <RollingRandomAccessFile name=\"main\" fileName=\"${log.directory}/core.log\"\n+                             filePattern=\"${log.directory}/core-%d{yyyy-MM-dd}.log.gz\"\n+                             immediateFlush=\"false\" append=\"false\">\n       <PatternLayout>\n         <pattern>%d{HH:mm:ss.SSS} %-5level %logger - %msg%n</pattern>\n       </PatternLayout>\n       <Policies>\n         <TimeBasedTriggeringPolicy/>\n         <SizeBasedTriggeringPolicy size=\"250 MB\"/>\n       </Policies>\n-    </RollingFile>\n+    </RollingRandomAccessFile>\n \n-    <RollingFile name=\"persistence\" fileName=\"${log.directory}/core-persistence.log\"\n-                 filePattern=\"${log.directory}/core-persistence-%d{yyyy-MM-dd}.log.gz\"\n-                 immediateFlush=\"false\" append=\"false\">\n+    <RollingRandomAccessFile name=\"persistence\" fileName=\"${log.directory}/core-persistence.log\"\n+                             filePattern=\"${log.directory}/core-persistence-%d{yyyy-MM-dd}.log.gz\"\n+                             immediateFlush=\"false\" append=\"false\">\n       <PatternLayout>\n         <pattern>%d{HH:mm:ss.SSS} %-5level %logger - %msg%n</pattern>\n       </PatternLayout>\n       <Policies>\n         <TimeBasedTriggeringPolicy/>\n         <SizeBasedTriggeringPolicy size=\"250 MB\"/>\n       </Policies>\n-    </RollingFile>\n+    </RollingRandomAccessFile>\n \n-    <RollingFile name=\"rest\" fileName=\"${log.directory}/core-rest.log\"\n-                 filePattern=\"${log.directory}/core-rest-%d{yyyy-MM-dd}.log.gz\"\n-                 immediateFlush=\"false\" append=\"false\">\n+    <RollingRandomAccessFile name=\"rest\" fileName=\"${log.directory}/core-rest.log\"\n+                             filePattern=\"${log.directory}/core-rest-%d{yyyy-MM-dd}.log.gz\"\n+                             immediateFlush=\"false\" append=\"false\">\n       <PatternLayout>\n         <pattern>%d{HH:mm:ss.SSS} %-5level %logger - %msg%n</pattern>\n       </PatternLayout>\n       <Policies>\n         <TimeBasedTriggeringPolicy/>\n         <SizeBasedTriggeringPolicy size=\"250 MB\"/>\n       </Policies>\n-    </RollingFile>\n+    </RollingRandomAccessFile>\n \n-    <RollingFile name=\"connid\" fileName=\"${log.directory}/core-connid.log\"\n-                 filePattern=\"${log.directory}/core-connid-%d{yyyy-MM-dd}.log.gz\"\n-                 immediateFlush=\"false\" append=\"false\">\n+    <RollingRandomAccessFile name=\"connid\" fileName=\"${log.directory}/core-connid.log\"\n+                             filePattern=\"${log.directory}/core-connid-%d{yyyy-MM-dd}.log.gz\"\n+                             immediateFlush=\"false\" append=\"false\">\n       <PatternLayout>\n         <pattern>%d{HH:mm:ss.SSS} %-5level %msg%n</pattern>\n       </PatternLayout>\n       <Policies>\n         <TimeBasedTriggeringPolicy/>\n         <SizeBasedTriggeringPolicy size=\"250 MB\"/>\n       </Policies>\n-    </RollingFile>\n+    </RollingRandomAccessFile>\n \n     <!-- Audit -->    \n     <Jdbc name=\"audit\" tableName=\"SYNCOPEAUDIT\">"},{"sha":"8b2248fef74a49d15eabd8a931cc2d1d1b93068a","filename":"core/src/main/webapp/WEB-INF/web.xml","status":"modified","additions":16,"deletions":1,"changes":17,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/af6f161b52b961f05f65d686f26cb86cac4f6142/core%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/af6f161b52b961f05f65d686f26cb86cac4f6142/core%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fweb.xml?ref=af6f161b52b961f05f65d686f26cb86cac4f6142","patch":"@@ -36,7 +36,10 @@ under the License.\n   <listener>\n     <listener-class>org.apache.syncope.core.init.ThreadLocalCleanupListener</listener-class>\n   </listener>\n-  \n+  <listener>\n+    <listener-class>org.apache.logging.log4j.core.web.Log4jServletContextListener</listener-class>\n+  </listener>\n+    \n   <servlet>\n     <servlet-name>CXFServlet</servlet-name>\n     <servlet-class>org.apache.cxf.transport.servlet.CXFServlet</servlet-class>\n@@ -63,6 +66,10 @@ under the License.\n     <filter-name>springSecurityFilterChain</filter-name>\n     <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>\n   </filter>\n+  <filter>\n+    <filter-name>log4jServletFilter</filter-name>\n+    <filter-class>org.apache.logging.log4j.core.web.Log4jServletFilter</filter-class>\n+  </filter>\n \n   <filter-mapping>\n     <filter-name>encodingFilter</filter-name>\n@@ -72,6 +79,14 @@ under the License.\n     <filter-name>springSecurityFilterChain</filter-name>\n     <url-pattern>/*</url-pattern>\n   </filter-mapping>\n+  <filter-mapping>\n+    <filter-name>log4jServletFilter</filter-name>\n+    <url-pattern>/*</url-pattern>\n+    <dispatcher>REQUEST</dispatcher>\n+    <dispatcher>FORWARD</dispatcher>\n+    <dispatcher>INCLUDE</dispatcher>\n+    <dispatcher>ERROR</dispatcher>\n+  </filter-mapping>\n \n   <login-config>\n     <auth-method>CLIENT-CERT</auth-method>"}]}