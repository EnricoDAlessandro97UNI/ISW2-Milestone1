{"sha":"9706adc12e046a2a29e724eda621ab5844bcf737","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjk3MDZhZGMxMmUwNDZhMmEyOWU3MjRlZGE2MjFhYjU4NDRiY2Y3Mzc=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2016-06-15T06:07:28Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2016-06-15T06:07:28Z"},"message":"[SYNCOPE-862] Updating conf migration from 1.2","tree":{"sha":"b696464064b2282c069fe3411c4288ef51a64097","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/b696464064b2282c069fe3411c4288ef51a64097"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/9706adc12e046a2a29e724eda621ab5844bcf737","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/9706adc12e046a2a29e724eda621ab5844bcf737","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/9706adc12e046a2a29e724eda621ab5844bcf737","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/9706adc12e046a2a29e724eda621ab5844bcf737/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"89ae8b0fa2f905be34b4e0b881bcce4027901658","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/89ae8b0fa2f905be34b4e0b881bcce4027901658","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/89ae8b0fa2f905be34b4e0b881bcce4027901658"}],"stats":{"total":128,"additions":74,"deletions":54},"files":[{"sha":"db4d5338da9ceb4c6b99cd8e54ff896567a22795","filename":"client/cli/src/main/java/org/apache/syncope/client/cli/commands/migrate/MigrateConf.java","status":"modified","additions":51,"deletions":34,"changes":85,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/9706adc12e046a2a29e724eda621ab5844bcf737/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Fmigrate%2FMigrateConf.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/9706adc12e046a2a29e724eda621ab5844bcf737/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Fmigrate%2FMigrateConf.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Fmigrate%2FMigrateConf.java?ref=9706adc12e046a2a29e724eda621ab5844bcf737","patch":"@@ -89,43 +89,40 @@ private static String getAttributeValue(final XMLStreamReader streamReader, fina\n         return value;\n     }\n \n-    private static String toNewIntMappingType(final String oldIntMappingType) {\n-        String newIntMappingType;\n-        switch (oldIntMappingType) {\n+    private static void writeIntAttrName(\n+            final String intMappingType,\n+            final String intAttrNameKey,\n+            final String intAttrNameValue,\n+            final XMLStreamWriter writer)\n+            throws XMLStreamException {\n+\n+        switch (intMappingType) {\n             case \"UserId\":\n-                newIntMappingType = \"UserKey\";\n+            case \"RoleId\":\n+                writer.writeAttribute(intAttrNameKey, \"key\");\n                 break;\n \n-            case \"UserSchema\":\n-            case \"MembershipSchema\":\n-                newIntMappingType = \"UserPlainSchema\";\n+            case \"Username\":\n+                writer.writeAttribute(intAttrNameKey, \"username\");\n                 break;\n \n-            case \"MembershipDerivedSchema\":\n-                newIntMappingType = \"UserDerivedSchema\";\n-                break;\n-\n-            case \"RoleId\":\n-                newIntMappingType = \"GroupKey\";\n+            case \"Password\":\n+                writer.writeAttribute(intAttrNameKey, \"password\");\n                 break;\n \n             case \"RoleName\":\n-                newIntMappingType = \"GroupName\";\n+                writer.writeAttribute(intAttrNameKey, \"name\");\n                 break;\n \n             case \"RoleOwnerSchema\":\n-                newIntMappingType = \"GroupOwnerSchema\";\n-                break;\n-\n-            case \"RoleSchema\":\n-                newIntMappingType = \"RolePlainSchema\";\n+                writer.writeAttribute(intAttrNameKey, \"userOwner\");\n                 break;\n \n             default:\n-                newIntMappingType = oldIntMappingType;\n+                if (StringUtils.isNotBlank(intAttrNameValue)) {\n+                    writer.writeAttribute(intAttrNameKey, intAttrNameValue);\n+                }\n         }\n-\n-        return newIntMappingType;\n     }\n \n     private static void exec(final String src, final String dst) throws XMLStreamException, IOException {\n@@ -505,15 +502,23 @@ private static void exec(final String src, final String dst) throws XMLStreamExc\n                         String uIntMappingType = getAttributeValue(reader, \"intMappingType\");\n                         if (uIntMappingType.endsWith(\"VirtualSchema\")) {\n                             reporter.writeStartElement(\"MappingItem\");\n-                            copyAttrs(reader, reporter, \"accountid\");\n+                            copyAttrs(reader, reporter, \"accountid\", \"intMappingType\");\n                             reporter.writeEndElement();\n                         } else {\n                             writer.writeStartElement(\"MappingItem\");\n-                            copyAttrs(reader, writer, \"accountid\", \"intMappingType\", \"mapping_id\");\n+                            copyAttrs(reader, writer,\n+                                    \"accountid\", \"intMappingType\", \"mapping_id\", \"intMappingType\", \"intAttrName\");\n                             writer.writeAttribute(\"id\", UUID.randomUUID().toString());\n-                            writer.writeAttribute(\"mapping_id\", mappings.get(getAttributeValue(reader, \"mapping_id\")));\n-                            writer.writeAttribute(\"intMappingType\", toNewIntMappingType(uIntMappingType));\n+                            writer.writeAttribute(\"mapping_id\", mappings.\n+                                    get(getAttributeValue(reader, \"mapping_id\")));\n                             writer.writeAttribute(\"connObjectKey\", getAttributeValue(reader, \"accountid\"));\n+\n+                            writeIntAttrName(\n+                                    uIntMappingType,\n+                                    \"intAttrName\",\n+                                    mappings.get(getAttributeValue(reader, \"intAttrName\")),\n+                                    writer);\n+\n                             writer.writeEndElement();\n                         }\n                         break;\n@@ -548,16 +553,23 @@ private static void exec(final String src, final String dst) throws XMLStreamExc\n                         String rIntMappingType = getAttributeValue(reader, \"intMappingType\");\n                         if (rIntMappingType.endsWith(\"VirtualSchema\")) {\n                             reporter.writeStartElement(\"MappingItem\");\n-                            copyAttrs(reader, reporter, \"accountid\");\n+                            copyAttrs(reader, reporter, \"accountid\", \"intMappingType\");\n                             reporter.writeEndElement();\n                         } else {\n                             writer.writeStartElement(\"MappingItem\");\n-                            copyAttrs(reader, writer, \"accountid\", \"intMappingType\", \"mapping_id\");\n+                            copyAttrs(reader, writer,\n+                                    \"accountid\", \"intMappingType\", \"mapping_id\", \"intAttrName\");\n                             writer.writeAttribute(\"id\", UUID.randomUUID().toString());\n                             writer.writeAttribute(\n                                     \"mapping_id\", mappings.get(\"10\" + getAttributeValue(reader, \"mapping_id\")));\n-                            writer.writeAttribute(\"intMappingType\", toNewIntMappingType(rIntMappingType));\n                             writer.writeAttribute(\"connObjectKey\", getAttributeValue(reader, \"accountid\"));\n+\n+                            writeIntAttrName(\n+                                    rIntMappingType,\n+                                    \"intAttrName\",\n+                                    mappings.get(getAttributeValue(reader, \"intAttrName\")),\n+                                    writer);\n+\n                             writer.writeEndElement();\n                         }\n                         break;\n@@ -723,12 +735,17 @@ private static void exec(final String src, final String dst) throws XMLStreamExc\n \n                         writer.writeAttribute(\"id\", lastUUID);\n \n-                        copyAttrs(reader, writer, \"recipientAttrType\", \"template\",\n-                                \"userAbout\", \"roleAbout\", \"recipients\");\n+                        copyAttrs(reader, writer,\n+                                \"recipientAttrType\", \"template\", \"userAbout\", \"roleAbout\", \"recipients\",\n+                                \"recipientAttrName\");\n+\n                         String recipientAttrType = getAttributeValue(reader, \"recipientAttrType\");\n-                        if (StringUtils.isNotBlank(recipientAttrType)) {\n-                            writer.writeAttribute(\"recipientAttrType\", toNewIntMappingType(recipientAttrType));\n-                        }\n+                        writeIntAttrName(\n+                                recipientAttrType,\n+                                \"recipientAttrName\",\n+                                mappings.get(getAttributeValue(reader, \"recipientAttrName\")),\n+                                writer);\n+\n                         String recipients = getAttributeValue(reader, \"recipients\");\n                         if (StringUtils.isNotBlank(recipients)) {\n                             writer.writeAttribute(\"recipientsFIQL\", getAttributeValue(reader, \"recipients\"));"},{"sha":"6beb717bd7161861c0ca03da79e8630c08884a65","filename":"client/cli/src/test/resources/schema20.sql","status":"modified","additions":23,"deletions":20,"changes":43,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/9706adc12e046a2a29e724eda621ab5844bcf737/client%2Fcli%2Fsrc%2Ftest%2Fresources%2Fschema20.sql","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/9706adc12e046a2a29e724eda621ab5844bcf737/client%2Fcli%2Fsrc%2Ftest%2Fresources%2Fschema20.sql","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fsrc%2Ftest%2Fresources%2Fschema20.sql?ref=9706adc12e046a2a29e724eda621ab5844bcf737","patch":"@@ -22,21 +22,21 @@ CREATE TABLE ADynGroupMembership (id VARCHAR(36) NOT NULL, fiql VARCHAR(255), GR\n CREATE TABLE ADynGroupMembership_AnyObject (aDynGroupMembership_id VARCHAR(36), anyObject_id VARCHAR(36));\n CREATE TABLE AMembership (id VARCHAR(36) NOT NULL, anyObject_id VARCHAR(36), group_id VARCHAR(36), PRIMARY KEY (id));\n CREATE TABLE AnyAbout (id VARCHAR(36) NOT NULL, filter CLOB, ANYTYPE_ID VARCHAR(255), NOTIFICATION_ID VARCHAR(36), PRIMARY KEY (id), CONSTRAINT U_NYABOUT_NOTIFICATION_ID UNIQUE (NOTIFICATION_ID, ANYTYPE_ID));\n-CREATE TABLE AnyObject (id VARCHAR(36) NOT NULL, creationDate TIMESTAMP NOT NULL, creator VARCHAR(255) NOT NULL, lastChangeDate TIMESTAMP NOT NULL, lastModifier VARCHAR(255) NOT NULL, status VARCHAR(255), workflowId VARCHAR(255), REALM_ID VARCHAR(36), TYPE_ID VARCHAR(255), PRIMARY KEY (id));\n+CREATE TABLE AnyObject (id VARCHAR(36) NOT NULL, creationDate TIMESTAMP NOT NULL, creator VARCHAR(255) NOT NULL, lastChangeDate TIMESTAMP NOT NULL, lastModifier VARCHAR(255) NOT NULL, status VARCHAR(255), workflowId VARCHAR(255), name VARCHAR(255), REALM_ID VARCHAR(36), TYPE_ID VARCHAR(255), PRIMARY KEY (id), CONSTRAINT U_NYOBJCT_NAME UNIQUE (name));\n CREATE TABLE AnyObject_AnyTypeClass (anyObject_id VARCHAR(36), anyTypeClass_id VARCHAR(255));\n CREATE TABLE AnyObject_ExternalResource (anyObject_id VARCHAR(36), resource_id VARCHAR(255));\n CREATE TABLE AnyTemplatePullTask (id VARCHAR(36) NOT NULL, template CLOB, PULLTASK_ID VARCHAR(36), ANYTYPE_ID VARCHAR(255), PRIMARY KEY (id), CONSTRAINT U_NYTMTSK_PULLTASK_ID UNIQUE (PULLTASK_ID, ANYTYPE_ID));\n-CREATE TABLE AnyTemplateRealm (id VARCHAR(36) NOT NULL, template CLOB, REALM_ID VARCHAR(36), ANYTYPE_ID VARCHAR(255), PRIMARY KEY (id), CONSTRAINT U_NYTMRLM_REALM_ID UNIQUE (REALM_ID, ANYTYPE_ID));\n+CREATE TABLE AnyTemplateRealm (id VARCHAR(36) NOT NULL, template CLOB, ANYTYPE_ID VARCHAR(255), REALM_ID VARCHAR(36), PRIMARY KEY (id), CONSTRAINT U_NYTMRLM_REALM_ID UNIQUE (REALM_ID, ANYTYPE_ID));\n CREATE TABLE AnyType (id VARCHAR(255) NOT NULL, kind VARCHAR(20), PRIMARY KEY (id));\n CREATE TABLE AnyTypeClass (id VARCHAR(255) NOT NULL, PRIMARY KEY (id));\n CREATE TABLE AnyType_AnyTypeClass (anyType_id VARCHAR(255), anyTypeClass_id VARCHAR(255));\n-CREATE TABLE APlainAttr (id VARCHAR(36) NOT NULL, OWNER_ID VARCHAR(36), schema_id VARCHAR(255), PRIMARY KEY (id));\n+CREATE TABLE APlainAttr (id VARCHAR(36) NOT NULL, OWNER_ID VARCHAR(36), schema_id VARCHAR(255), MEMBERSHIP_ID VARCHAR(36), PRIMARY KEY (id), CONSTRAINT U_PLINTTR_OWNER_ID UNIQUE (OWNER_ID, MEMBERSHIP_ID, schema_id));\n CREATE TABLE APlainAttrUniqueValue (id VARCHAR(36) NOT NULL, binaryValue BLOB, booleanValue INTEGER, dateValue TIMESTAMP, doubleValue DOUBLE, longValue BIGINT, stringValue VARCHAR(255), ATTRIBUTE_ID VARCHAR(36), schema_id VARCHAR(255), PRIMARY KEY (id), CONSTRAINT U_PLNTQVL_BOOLEANVALUE1 UNIQUE (booleanValue, schema_id), CONSTRAINT U_PLNTQVL_DATEVALUE1 UNIQUE (dateValue, schema_id), CONSTRAINT U_PLNTQVL_STRINGVALUE1 UNIQUE (stringValue, schema_id), CONSTRAINT U_PLNTQVL_DOUBLEVALUE1 UNIQUE (doubleValue, schema_id), CONSTRAINT U_PLNTQVL_LONGVALUE1 UNIQUE (longValue, schema_id));\n CREATE TABLE APlainAttrValue (id VARCHAR(36) NOT NULL, binaryValue BLOB, booleanValue INTEGER, dateValue TIMESTAMP, doubleValue DOUBLE, longValue BIGINT, stringValue VARCHAR(255), ATTRIBUTE_ID VARCHAR(36), PRIMARY KEY (id));\n CREATE TABLE ARelationship (id VARCHAR(36) NOT NULL, left_anyObject_id VARCHAR(36), right_anyObject_id VARCHAR(36), TYPE_ID VARCHAR(255), PRIMARY KEY (id), CONSTRAINT U_RLTNSHP_TYPE_ID1 UNIQUE (TYPE_ID, left_anyObject_id, right_anyObject_id));\n CREATE TABLE ConnInstance (id VARCHAR(36) NOT NULL, bundleName VARCHAR(255), connRequestTimeout INTEGER, connectorName VARCHAR(255), displayName VARCHAR(255), jsonConf CLOB, location VARCHAR(255), version VARCHAR(255), maxIdle INTEGER, maxObjects INTEGER, maxWait BIGINT, minEvictableIdleTimeMillis BIGINT, minIdle INTEGER, PRIMARY KEY (id), CONSTRAINT U_CNNNTNC_DISPLAYNAME UNIQUE (displayName));\n CREATE TABLE ConnInstance_capabilities (connInstance_id VARCHAR(36), capability VARCHAR(20));\n-CREATE TABLE CPlainAttr (id VARCHAR(36) NOT NULL, schema_id VARCHAR(255), OWNER_ID VARCHAR(255), PRIMARY KEY (id));\n+CREATE TABLE CPlainAttr (id VARCHAR(36) NOT NULL, OWNER_ID VARCHAR(255), schema_id VARCHAR(255), PRIMARY KEY (id));\n CREATE TABLE CPlainAttrUniqueValue (id VARCHAR(36) NOT NULL, binaryValue BLOB, booleanValue INTEGER, dateValue TIMESTAMP, doubleValue DOUBLE, longValue BIGINT, stringValue VARCHAR(255), ATTRIBUTE_ID VARCHAR(36), schema_id VARCHAR(255), PRIMARY KEY (id), CONSTRAINT U_CPLNQVL_BOOLEANVALUE UNIQUE (booleanValue, schema_id), CONSTRAINT U_CPLNQVL_DATEVALUE UNIQUE (dateValue, schema_id), CONSTRAINT U_CPLNQVL_STRINGVALUE UNIQUE (stringValue, schema_id), CONSTRAINT U_CPLNQVL_DOUBLEVALUE UNIQUE (doubleValue, schema_id), CONSTRAINT U_CPLNQVL_LONGVALUE UNIQUE (longValue, schema_id));\n CREATE TABLE CPlainAttrValue (id VARCHAR(36) NOT NULL, binaryValue BLOB, booleanValue INTEGER, dateValue TIMESTAMP, doubleValue DOUBLE, longValue BIGINT, stringValue VARCHAR(255), ATTRIBUTE_ID VARCHAR(36), PRIMARY KEY (id));\n CREATE TABLE DerSchema (id VARCHAR(255) NOT NULL, expression VARCHAR(255), ANYTYPECLASS_ID VARCHAR(255), PRIMARY KEY (id));\n@@ -45,29 +45,29 @@ CREATE TABLE DynRoleMembership_User (dynRoleMembership_id VARCHAR(36), user_id V\n CREATE TABLE ExternalResource (id VARCHAR(255) NOT NULL, createTraceLevel VARCHAR(20), deleteTraceLevel VARCHAR(20), enforceMandatoryCondition INTEGER, jsonConf CLOB, overrideCapabilities INTEGER, propagationPriority INTEGER, pullTraceLevel VARCHAR(20), randomPwdIfNotProvided INTEGER, updateTraceLevel VARCHAR(20), ACCOUNTPOLICY_ID VARCHAR(36), CONNECTOR_ID VARCHAR(36), PASSWORDPOLICY_ID VARCHAR(36), PULLPOLICY_ID VARCHAR(36), PRIMARY KEY (id));\n CREATE TABLE ExternalResource_capOverride (resource_id VARCHAR(255), capabilityOverride VARCHAR(20));\n CREATE TABLE ExternalResource_PropActions (resource_id VARCHAR(255), actionClassName VARCHAR(255));\n-CREATE TABLE GPlainAttr (id VARCHAR(36) NOT NULL, schema_id VARCHAR(255), OWNER_ID VARCHAR(36), PRIMARY KEY (id));\n+CREATE TABLE GPlainAttr (id VARCHAR(36) NOT NULL, OWNER_ID VARCHAR(36), schema_id VARCHAR(255), PRIMARY KEY (id), CONSTRAINT U_GPLNTTR_OWNER_ID UNIQUE (OWNER_ID, schema_id));\n CREATE TABLE GPlainAttrUniqueValue (id VARCHAR(36) NOT NULL, binaryValue BLOB, booleanValue INTEGER, dateValue TIMESTAMP, doubleValue DOUBLE, longValue BIGINT, stringValue VARCHAR(255), ATTRIBUTE_ID VARCHAR(36), schema_id VARCHAR(255), PRIMARY KEY (id), CONSTRAINT U_GPLNQVL_BOOLEANVALUE UNIQUE (booleanValue, schema_id), CONSTRAINT U_GPLNQVL_DATEVALUE UNIQUE (dateValue, schema_id), CONSTRAINT U_GPLNQVL_STRINGVALUE UNIQUE (stringValue, schema_id), CONSTRAINT U_GPLNQVL_DOUBLEVALUE UNIQUE (doubleValue, schema_id), CONSTRAINT U_GPLNQVL_LONGVALUE UNIQUE (longValue, schema_id));\n CREATE TABLE GPlainAttrValue (id VARCHAR(36) NOT NULL, binaryValue BLOB, booleanValue INTEGER, dateValue TIMESTAMP, doubleValue DOUBLE, longValue BIGINT, stringValue VARCHAR(255), ATTRIBUTE_ID VARCHAR(36), PRIMARY KEY (id));\n CREATE TABLE MailTemplate (id VARCHAR(255) NOT NULL, htmlTemplate CLOB, textTemplate CLOB, PRIMARY KEY (id));\n CREATE TABLE Mapping (id VARCHAR(36) NOT NULL, connObjectLink VARCHAR(255), PROVISION_ID VARCHAR(36), PRIMARY KEY (id));\n-CREATE TABLE MappingItem (id VARCHAR(36) NOT NULL, connObjectKey INTEGER, extAttrName VARCHAR(255), intAttrName VARCHAR(255), intMappingType VARCHAR(22), mandatoryCondition VARCHAR(255), password INTEGER, purpose VARCHAR(20), MAPPING_ID VARCHAR(36), PRIMARY KEY (id));\n+CREATE TABLE MappingItem (id VARCHAR(36) NOT NULL, connObjectKey INTEGER, extAttrName VARCHAR(255), intAttrName VARCHAR(255), mandatoryCondition VARCHAR(255), password INTEGER, propJEXL VARCHAR(255), pullJEXL VARCHAR(255), purpose VARCHAR(20), MAPPING_ID VARCHAR(36), PRIMARY KEY (id));\n CREATE TABLE MappingItem_Transformer (mappingItem_id VARCHAR(36), transformerClassName VARCHAR(255));\n-CREATE TABLE Notification (id VARCHAR(36) NOT NULL, active INTEGER, recipientAttrName VARCHAR(255), recipientAttrType VARCHAR(22), recipientsFIQL VARCHAR(255), recipientsProviderClassName VARCHAR(255), selfAsRecipient INTEGER, sender VARCHAR(255), subject VARCHAR(255), traceLevel VARCHAR(20), template_id VARCHAR(255), PRIMARY KEY (id));\n+CREATE TABLE Notification (id VARCHAR(36) NOT NULL, active INTEGER, recipientAttrName VARCHAR(255), recipientsFIQL VARCHAR(255), recipientsProviderClassName VARCHAR(255), selfAsRecipient INTEGER, sender VARCHAR(255), subject VARCHAR(255), traceLevel VARCHAR(20), template_id VARCHAR(255), PRIMARY KEY (id));\n CREATE TABLE NotificationTask_recipients (notificationTask_id VARCHAR(36), address VARCHAR(255));\n CREATE TABLE Notification_events (notification_id VARCHAR(36), event VARCHAR(255));\n CREATE TABLE Notification_staticRecipients (notification_id VARCHAR(36), staticRecipients VARCHAR(255));\n CREATE TABLE PasswordPolicy (id VARCHAR(36) NOT NULL, description VARCHAR(255), allowNullPassword INTEGER, historyLength INTEGER, PRIMARY KEY (id));\n CREATE TABLE PasswordRuleConfInstance (id VARCHAR(36) NOT NULL, serializedInstance CLOB, PASSWORDPOLICY_ID VARCHAR(36), PRIMARY KEY (id));\n CREATE TABLE PlainSchema (id VARCHAR(255) NOT NULL, cipherAlgorithm VARCHAR(20), conversionPattern VARCHAR(255), enumerationKeys CLOB, enumerationValues CLOB, mandatoryCondition VARCHAR(255), mimeType VARCHAR(255), multivalue INTEGER, readonly INTEGER, secretKey VARCHAR(255), type VARCHAR(20), uniqueConstraint INTEGER, validatorClass VARCHAR(255), ANYTYPECLASS_ID VARCHAR(255), PRIMARY KEY (id));\n-CREATE TABLE Provision (id VARCHAR(36) NOT NULL, objectClass VARCHAR(255), serializedSyncToken CLOB, RESOURCE_ID VARCHAR(255), ANYTYPE_ID VARCHAR(255), PRIMARY KEY (id), CONSTRAINT U_PROVSON_RESOURCE_ID UNIQUE (RESOURCE_ID, ANYTYPE_ID));\n+CREATE TABLE Provision (id VARCHAR(36) NOT NULL, objectClass VARCHAR(255), serializedSyncToken CLOB, ANYTYPE_ID VARCHAR(255), RESOURCE_ID VARCHAR(255), PRIMARY KEY (id), CONSTRAINT U_PROVSON_RESOURCE_ID UNIQUE (RESOURCE_ID, ANYTYPE_ID));\n CREATE TABLE Provision_AnyTypeClass (provision_id VARCHAR(36), anyTypeClass_id VARCHAR(255));\n CREATE TABLE PullPolicy (id VARCHAR(36) NOT NULL, description VARCHAR(255), specification CLOB, PRIMARY KEY (id));\n CREATE TABLE PullTask_actionsClassNames (pullTask_id VARCHAR(36), actionClassName VARCHAR(255));\n CREATE TABLE PushPolicy (id VARCHAR(36) NOT NULL, description VARCHAR(255), specification CLOB, PRIMARY KEY (id));\n-CREATE TABLE PushTaskAnyFilter (id VARCHAR(36) NOT NULL, fiql VARCHAR(255), ANYTYPE_ID VARCHAR(255), PUSHTASK_ID VARCHAR(36), PRIMARY KEY (id), CONSTRAINT U_PSHTLTR_PUSHTASK_ID UNIQUE (PUSHTASK_ID, ANYTYPE_ID));\n-CREATE TABLE PushTask_actionsClassNames (pushTask_key VARCHAR(36), actionClassName VARCHAR(255));\n+CREATE TABLE PushTaskAnyFilter (id VARCHAR(36) NOT NULL, fiql VARCHAR(255), PUSHTASK_ID VARCHAR(36), ANYTYPE_ID VARCHAR(255), PRIMARY KEY (id), CONSTRAINT U_PSHTLTR_PUSHTASK_ID UNIQUE (PUSHTASK_ID, ANYTYPE_ID));\n+CREATE TABLE PushTask_actionsClassNames (pushTask_id VARCHAR(36), actionClassName VARCHAR(255));\n CREATE TABLE Realm (id VARCHAR(36) NOT NULL, name VARCHAR(255), ACCOUNTPOLICY_ID VARCHAR(36), PARENT_ID VARCHAR(36), PASSWORDPOLICY_ID VARCHAR(36), PRIMARY KEY (id), CONSTRAINT U_REALM_ID UNIQUE (id, PARENT_ID));\n-CREATE TABLE Realm_actionsClassNames (realm_key VARCHAR(36), actionClassName VARCHAR(255));\n+CREATE TABLE Realm_actionsClassNames (realm_id VARCHAR(36), actionClassName VARCHAR(255));\n CREATE TABLE RelationshipType (id VARCHAR(255) NOT NULL, description VARCHAR(255), PRIMARY KEY (id));\n CREATE TABLE Report (id VARCHAR(36) NOT NULL, active INTEGER, cronExpression VARCHAR(255), name VARCHAR(255) NOT NULL, template_id VARCHAR(255), PRIMARY KEY (id), CONSTRAINT U_REPORT_NAME UNIQUE (name));\n CREATE TABLE ReportExec (id VARCHAR(36) NOT NULL, endDate TIMESTAMP, message CLOB, startDate TIMESTAMP, status VARCHAR(255), execResult BLOB, REPORT_ID VARCHAR(36), PRIMARY KEY (id));\n@@ -80,22 +80,23 @@ CREATE TABLE SyncopeGroup (id VARCHAR(36) NOT NULL, creationDate TIMESTAMP NOT N\n CREATE TABLE SyncopeGroup_AnyTypeClass (group_id VARCHAR(36), anyTypeClass_id VARCHAR(255));\n CREATE TABLE SyncopeGroup_ExternalResource (group_id VARCHAR(36), resource_id VARCHAR(255));\n CREATE TABLE SyncopeLogger (logName VARCHAR(255) NOT NULL, logLevel VARCHAR(20) NOT NULL, logType VARCHAR(20) NOT NULL, PRIMARY KEY (logName));\n-CREATE TABLE SyncopeRole (id VARCHAR(255) NOT NULL, PRIMARY KEY (id));\n+CREATE TABLE SyncopeRole (id VARCHAR(255) NOT NULL, consoleLayoutInfo CLOB, PRIMARY KEY (id));\n CREATE TABLE SyncopeRole_entitlements (role_id VARCHAR(255), entitlement VARCHAR(255));\n CREATE TABLE SyncopeRole_Realm (role_id VARCHAR(255), realm_id VARCHAR(36));\n+CREATE TABLE SyncopeSchema (id VARCHAR(255) NOT NULL, PRIMARY KEY (id));\n CREATE TABLE SyncopeUser (id VARCHAR(36) NOT NULL, creationDate TIMESTAMP NOT NULL, creator VARCHAR(255) NOT NULL, lastChangeDate TIMESTAMP NOT NULL, lastModifier VARCHAR(255) NOT NULL, status VARCHAR(255), workflowId VARCHAR(255), changePwdDate TIMESTAMP, cipherAlgorithm VARCHAR(20), failedLogins INTEGER, lastLoginDate TIMESTAMP, mustChangePassword INTEGER, password VARCHAR(255), securityAnswer VARCHAR(255), suspended INTEGER, token CLOB, tokenExpireTime TIMESTAMP, username VARCHAR(255), REALM_ID VARCHAR(36), SECURITYQUESTION_ID VARCHAR(36), PRIMARY KEY (id), CONSTRAINT U_SYNCPSR_USERNAME UNIQUE (username));\n CREATE TABLE SyncopeUser_AnyTypeClass (user_id VARCHAR(36), anyTypeClass_id VARCHAR(255));\n CREATE TABLE SyncopeUser_ExternalResource (user_id VARCHAR(36), resource_id VARCHAR(255));\n CREATE TABLE SyncopeUser_passwordHistory (user_id VARCHAR(36), passwordHistoryValue VARCHAR(255));\n CREATE TABLE SyncopeUser_SyncopeRole (user_id VARCHAR(36), role_id VARCHAR(255));\n-CREATE TABLE Task (id VARCHAR(36) NOT NULL, DTYPE VARCHAR(31), active INTEGER, cronExpression VARCHAR(255), description VARCHAR(255), jobDelegateClassName VARCHAR(255), name VARCHAR(255), startAt TIMESTAMP, anyKey VARCHAR(255), anyTypeKind VARCHAR(20), executed INTEGER, htmlBody CLOB, sender VARCHAR(255), subject VARCHAR(255), textBody CLOB, traceLevel VARCHAR(20), NOTIFICATION_ID VARCHAR(36), matchingRule VARCHAR(20), performCreate INTEGER, performDelete INTEGER, performUpdate INTEGER, pullStatus INTEGER, unmatchingRule VARCHAR(20), RESOURCE_ID VARCHAR(255), pullMode VARCHAR(23), reconciliationFilterBuilderClassName VARCHAR(255), DESTINATIONREALM_ID VARCHAR(36), anyType VARCHAR(255), attributes CLOB, connObjectKey VARCHAR(255), objectClassName VARCHAR(255), oldConnObjectKey VARCHAR(255), operation VARCHAR(20), PRIMARY KEY (id));\n+CREATE TABLE Task (id VARCHAR(36) NOT NULL, DTYPE VARCHAR(31), anyKey VARCHAR(255), anyType VARCHAR(255), anyTypeKind VARCHAR(20), attributes CLOB, connObjectKey VARCHAR(255), objectClassName VARCHAR(255), oldConnObjectKey VARCHAR(255), operation VARCHAR(20), RESOURCE_ID VARCHAR(255), active INTEGER, cronExpression VARCHAR(255), description VARCHAR(255), jobDelegateClassName VARCHAR(255), name VARCHAR(255), startAt TIMESTAMP, matchingRule VARCHAR(20), performCreate INTEGER, performDelete INTEGER, performUpdate INTEGER, pullStatus INTEGER, unmatchingRule VARCHAR(20), pullMode VARCHAR(23), reconciliationFilterBuilderClassName VARCHAR(255), DESTINATIONREALM_ID VARCHAR(36), executed INTEGER, htmlBody CLOB, sender VARCHAR(255), subject VARCHAR(255), textBody CLOB, traceLevel VARCHAR(20), NOTIFICATION_ID VARCHAR(36), PRIMARY KEY (id));\n CREATE TABLE TaskExec (id VARCHAR(36) NOT NULL, endDate TIMESTAMP, message CLOB, startDate TIMESTAMP, status VARCHAR(255), TASK_ID VARCHAR(36), PRIMARY KEY (id));\n CREATE TABLE TypeExtension (id VARCHAR(36) NOT NULL, GROUP_ID VARCHAR(36), ANYTYPE_ID VARCHAR(255), PRIMARY KEY (id), CONSTRAINT U_TYPXNSN_GROUP_ID UNIQUE (GROUP_ID, ANYTYPE_ID));\n CREATE TABLE TypeExtension_AnyTypeClass (typeExtension_id VARCHAR(36), anyTypeClass_id VARCHAR(255));\n CREATE TABLE UDynGroupMembership (id VARCHAR(36) NOT NULL, fiql VARCHAR(255), GROUP_ID VARCHAR(36), PRIMARY KEY (id));\n CREATE TABLE UDynGroupMembership_User (uDynGroupMembership_id VARCHAR(36), user_id VARCHAR(36));\n CREATE TABLE UMembership (id VARCHAR(36) NOT NULL, user_id VARCHAR(36), group_id VARCHAR(36), PRIMARY KEY (id));\n-CREATE TABLE UPlainAttr (id VARCHAR(36) NOT NULL, OWNER_ID VARCHAR(36), schema_id VARCHAR(255), PRIMARY KEY (id));\n+CREATE TABLE UPlainAttr (id VARCHAR(36) NOT NULL, OWNER_ID VARCHAR(36), schema_id VARCHAR(255), MEMBERSHIP_ID VARCHAR(36), PRIMARY KEY (id), CONSTRAINT U_UPLNTTR_OWNER_ID UNIQUE (OWNER_ID, MEMBERSHIP_ID, schema_id));\n CREATE TABLE UPlainAttrUniqueValue (id VARCHAR(36) NOT NULL, binaryValue BLOB, booleanValue INTEGER, dateValue TIMESTAMP, doubleValue DOUBLE, longValue BIGINT, stringValue VARCHAR(255), ATTRIBUTE_ID VARCHAR(36), schema_id VARCHAR(255), PRIMARY KEY (id), CONSTRAINT U_PLNTQVL_BOOLEANVALUE UNIQUE (booleanValue, schema_id), CONSTRAINT U_PLNTQVL_DATEVALUE UNIQUE (dateValue, schema_id), CONSTRAINT U_PLNTQVL_STRINGVALUE UNIQUE (stringValue, schema_id), CONSTRAINT U_PLNTQVL_DOUBLEVALUE UNIQUE (doubleValue, schema_id), CONSTRAINT U_PLNTQVL_LONGVALUE UNIQUE (longValue, schema_id));\n CREATE TABLE UPlainAttrValue (id VARCHAR(36) NOT NULL, binaryValue BLOB, booleanValue INTEGER, dateValue TIMESTAMP, doubleValue DOUBLE, longValue BIGINT, stringValue VARCHAR(255), ATTRIBUTE_ID VARCHAR(36), PRIMARY KEY (id));\n CREATE TABLE URelationship (id VARCHAR(36) NOT NULL, user_id VARCHAR(36), anyObject_id VARCHAR(36), TYPE_ID VARCHAR(255), PRIMARY KEY (id), CONSTRAINT U_RLTNSHP_TYPE_ID UNIQUE (TYPE_ID, user_id, anyObject_id));\n@@ -123,6 +124,7 @@ CREATE INDEX I_NYTMRLM_ANYTYPE ON AnyTemplateRealm (ANYTYPE_ID);\n CREATE INDEX I_NYTMRLM_REALM ON AnyTemplateRealm (REALM_ID);\n CREATE INDEX I_NYTYLSS_ANYTYPE_ID ON AnyType_AnyTypeClass (anyType_id);\n CREATE INDEX I_NYTYLSS_ELEMENT ON AnyType_AnyTypeClass (anyTypeClass_id);\n+CREATE INDEX I_PLINTTR_MEMBERSHIP ON APlainAttr (MEMBERSHIP_ID);\n CREATE INDEX I_PLINTTR_OWNER ON APlainAttr (OWNER_ID);\n CREATE INDEX I_PLINTTR_SCHEMA ON APlainAttr (schema_id);\n CREATE INDEX I_PLNTQVL_ATTRIBUTE1 ON APlainAttrUniqueValue (ATTRIBUTE_ID);\n@@ -168,29 +170,29 @@ CREATE INDEX I_PRVSLSS_PROVISION_ID ON Provision_AnyTypeClass (provision_id);\n CREATE INDEX I_PLLTNMS_PULLTASK_ID ON PullTask_actionsClassNames (pullTask_id);\n CREATE INDEX I_PSHTLTR_ANYTYPE ON PushTaskAnyFilter (ANYTYPE_ID);\n CREATE INDEX I_PSHTLTR_PUSHTASK ON PushTaskAnyFilter (PUSHTASK_ID);\n-CREATE INDEX I_PSHTNMS_PUSHTASK_KEY ON PushTask_actionsClassNames (pushTask_key);\n+CREATE INDEX I_PSHTNMS_PUSHTASK_ID ON PushTask_actionsClassNames (pushTask_id);\n CREATE INDEX I_REALM_ACCOUNTPOLICY ON Realm (ACCOUNTPOLICY_ID);\n CREATE INDEX I_REALM_PARENT ON Realm (PARENT_ID);\n CREATE INDEX I_REALM_PASSWORDPOLICY ON Realm (PASSWORDPOLICY_ID);\n-CREATE INDEX I_RLM_NMS_REALM_KEY ON Realm_actionsClassNames (realm_key);\n+CREATE INDEX I_RLM_NMS_REALM_ID ON Realm_actionsClassNames (realm_id);\n CREATE INDEX I_REPORT_TEMPLATE ON Report (template_id);\n CREATE INDEX I_RPORTXC_REPORT ON ReportExec (REPORT_ID);\n CREATE INDEX I_RPRTTNC_REPORT ON ReportletConfInstance (REPORT_ID);\n CREATE INDEX I_SYNCGRP_GROUPOWNER ON SyncopeGroup (GROUPOWNER_ID);\n CREATE INDEX I_SYNCGRP_REALM ON SyncopeGroup (REALM_ID);\n CREATE INDEX I_SYNCGRP_USEROWNER ON SyncopeGroup (USEROWNER_ID);\n-CREATE INDEX I_SYNCLSS_ELEMENT ON SyncopeGroup_AnyTypeClass (anyTypeClass_id);\n+CREATE INDEX I_SYNCLSS_ELEMENT1 ON SyncopeGroup_AnyTypeClass (anyTypeClass_id);\n CREATE INDEX I_SYNCLSS_GROUP_ID ON SyncopeGroup_AnyTypeClass (group_id);\n-CREATE INDEX I_SYNCSRC_ELEMENT ON SyncopeGroup_ExternalResource (resource_id);\n+CREATE INDEX I_SYNCSRC_ELEMENT1 ON SyncopeGroup_ExternalResource (resource_id);\n CREATE INDEX I_SYNCSRC_GROUP_ID ON SyncopeGroup_ExternalResource (group_id);\n CREATE INDEX I_SYNCNTS_ROLE_ID ON SyncopeRole_entitlements (role_id);\n CREATE INDEX I_SYNCRLM_ELEMENT ON SyncopeRole_Realm (realm_id);\n CREATE INDEX I_SYNCRLM_ROLE_ID ON SyncopeRole_Realm (role_id);\n CREATE INDEX I_SYNCPSR_REALM ON SyncopeUser (REALM_ID);\n CREATE INDEX I_SYNCPSR_SECURITYQUESTION ON SyncopeUser (SECURITYQUESTION_ID);\n-CREATE INDEX I_SYNCLSS_ELEMENT1 ON SyncopeUser_AnyTypeClass (anyTypeClass_id);\n+CREATE INDEX I_SYNCLSS_ELEMENT ON SyncopeUser_AnyTypeClass (anyTypeClass_id);\n CREATE INDEX I_SYNCLSS_USER_ID ON SyncopeUser_AnyTypeClass (user_id);\n-CREATE INDEX I_SYNCSRC_ELEMENT1 ON SyncopeUser_ExternalResource (resource_id);\n+CREATE INDEX I_SYNCSRC_ELEMENT ON SyncopeUser_ExternalResource (resource_id);\n CREATE INDEX I_SYNCSRC_USER_ID ON SyncopeUser_ExternalResource (user_id);\n CREATE INDEX I_SYNCTRY_USER_ID ON SyncopeUser_passwordHistory (user_id);\n CREATE INDEX I_SYNCPRL_ELEMENT ON SyncopeUser_SyncopeRole (role_id);\n@@ -209,6 +211,7 @@ CREATE INDEX I_DYNG_SR_ELEMENT ON UDynGroupMembership_User (user_id);\n CREATE INDEX I_DYNG_SR_UDYNGROUPMEMBERSHIP_ID ON UDynGroupMembership_User (uDynGroupMembership_id);\n CREATE INDEX I_MMBRSHP_LEFTEND ON UMembership (user_id);\n CREATE INDEX I_MMBRSHP_RIGHTEND ON UMembership (group_id);\n+CREATE INDEX I_UPLNTTR_MEMBERSHIP ON UPlainAttr (MEMBERSHIP_ID);\n CREATE INDEX I_UPLNTTR_OWNER ON UPlainAttr (OWNER_ID);\n CREATE INDEX I_UPLNTTR_SCHEMA ON UPlainAttr (schema_id);\n CREATE INDEX I_PLNTQVL_ATTRIBUTE ON UPlainAttrUniqueValue (ATTRIBUTE_ID);"}]}