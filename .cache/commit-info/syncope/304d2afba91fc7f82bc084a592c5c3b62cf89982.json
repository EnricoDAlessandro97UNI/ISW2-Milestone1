{"sha":"304d2afba91fc7f82bc084a592c5c3b62cf89982","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjMwNGQyYWZiYTkxZmM3ZjgyYmMwODRhNTkyYzVjM2I2MmNmODk5ODI=","commit":{"author":{"name":"Marco Di Sabatino Di Diodoro","email":"mdisabatino@apache.org","date":"2012-03-22T12:41:13Z"},"committer":{"name":"Marco Di Sabatino Di Diodoro","email":"mdisabatino@apache.org","date":"2012-03-22T12:41:13Z"},"message":"SYNCOPE-39 Add NotificationManager into SyncJob\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/syncope/trunk@1303756 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"ff47596c92cd77f62b6a0186945972d96eea8b56","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/ff47596c92cd77f62b6a0186945972d96eea8b56"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/304d2afba91fc7f82bc084a592c5c3b62cf89982","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/304d2afba91fc7f82bc084a592c5c3b62cf89982","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/304d2afba91fc7f82bc084a592c5c3b62cf89982","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/304d2afba91fc7f82bc084a592c5c3b62cf89982/comments","author":{"login":"mdisabatino","id":1792527,"node_id":"MDQ6VXNlcjE3OTI1Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/1792527?v=4","gravatar_id":"","url":"https://api.github.com/users/mdisabatino","html_url":"https://github.com/mdisabatino","followers_url":"https://api.github.com/users/mdisabatino/followers","following_url":"https://api.github.com/users/mdisabatino/following{/other_user}","gists_url":"https://api.github.com/users/mdisabatino/gists{/gist_id}","starred_url":"https://api.github.com/users/mdisabatino/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mdisabatino/subscriptions","organizations_url":"https://api.github.com/users/mdisabatino/orgs","repos_url":"https://api.github.com/users/mdisabatino/repos","events_url":"https://api.github.com/users/mdisabatino/events{/privacy}","received_events_url":"https://api.github.com/users/mdisabatino/received_events","type":"User","site_admin":false},"committer":{"login":"mdisabatino","id":1792527,"node_id":"MDQ6VXNlcjE3OTI1Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/1792527?v=4","gravatar_id":"","url":"https://api.github.com/users/mdisabatino","html_url":"https://github.com/mdisabatino","followers_url":"https://api.github.com/users/mdisabatino/followers","following_url":"https://api.github.com/users/mdisabatino/following{/other_user}","gists_url":"https://api.github.com/users/mdisabatino/gists{/gist_id}","starred_url":"https://api.github.com/users/mdisabatino/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mdisabatino/subscriptions","organizations_url":"https://api.github.com/users/mdisabatino/orgs","repos_url":"https://api.github.com/users/mdisabatino/repos","events_url":"https://api.github.com/users/mdisabatino/events{/privacy}","received_events_url":"https://api.github.com/users/mdisabatino/received_events","type":"User","site_admin":false},"parents":[{"sha":"fa87947a1f681a37fdc4619ee9066945819ca50c","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/fa87947a1f681a37fdc4619ee9066945819ca50c","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/fa87947a1f681a37fdc4619ee9066945819ca50c"}],"stats":{"total":51,"additions":50,"deletions":1},"files":[{"sha":"e9a31205eaf9782ef1a79348076adce332bd57ed","filename":"console/src/main/resources/org/syncope/console/pages/NotificationTaskModalPage.properties","status":"added","additions":32,"deletions":0,"changes":32,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/304d2afba91fc7f82bc084a592c5c3b62cf89982/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FNotificationTaskModalPage.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/304d2afba91fc7f82bc084a592c5c3b62cf89982/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FNotificationTaskModalPage.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FNotificationTaskModalPage.properties?ref=304d2afba91fc7f82bc084a592c5c3b62cf89982","patch":"@@ -0,0 +1,32 @@\n+# Licensed to the Apache Software Foundation (ASF) under one\n+# or more contributor license agreements.  See the NOTICE file\n+# distributed with this work for additional information\n+# regarding copyright ownership.  The ASF licenses this file\n+# to you under the Apache License, Version 2.0 (the\n+# \"License\"); you may not use this file except in compliance\n+# with the License.  You may obtain a copy of the License at\n+#\n+#   http://www.apache.org/licenses/LICENSE-2.0\n+#\n+# Unless required by applicable law or agreed to in writing,\n+# software distributed under the License is distributed on an\n+# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+# KIND, either express or implied.  See the License for the\n+# specific language governing permissions and limitations\n+# under the License.\n+profile=Profile\n+executions=Executions\n+title=Title\n+startDate=Start date\n+endDate=End date\n+status=Status\n+message=Message\n+taskExecutions=Task executions\n+delete=Delete\n+showMessage=Show message\n+sender=Sender\n+subject=Subject\n+recipients=Recipients\n+traceLevel=Trace level\n+htmlBody=E-mail body (HTML)\n+textBody=E-mail body (TEXT)\n\\ No newline at end of file"},{"sha":"804195cef4efd275e481d82f6664b5cb4274d5b9","filename":"core/src/main/java/org/syncope/core/scheduling/SyncJob.java","status":"modified","additions":18,"deletions":1,"changes":19,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/304d2afba91fc7f82bc084a592c5c3b62cf89982/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fscheduling%2FSyncJob.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/304d2afba91fc7f82bc084a592c5c3b62cf89982/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fscheduling%2FSyncJob.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fscheduling%2FSyncJob.java?ref=304d2afba91fc7f82bc084a592c5c3b62cf89982","patch":"@@ -45,6 +45,7 @@\n import org.syncope.client.search.SyncopeUserCond;\n import org.syncope.client.to.UserTO;\n import org.syncope.core.init.ConnInstanceLoader;\n+import org.syncope.core.notification.NotificationManager;\n import org.syncope.core.persistence.beans.Entitlement;\n import org.syncope.core.persistence.beans.ExternalResource;\n import org.syncope.core.persistence.beans.PropagationTask;\n@@ -141,6 +142,12 @@ public class SyncJob extends AbstractTaskJob {\n     @Autowired\n     private ConnObjectUtil connObjectUtil;\n \n+    /**\n+     * Notification Manager.\n+     */\n+    @Autowired\n+    private NotificationManager notificationManager;\n+\n     public void setActions(final SyncJobActions actions) {\n         this.actions = actions;\n     }\n@@ -171,7 +178,7 @@ private List<Long> findExistingUsers(final SyncDelta delta) {\n \n         if (policySpec != null && !policySpec.getAlternativeSearchAttrs().isEmpty()) {\n \n-            // search external attribute name/value \n+            // search external attribute name/value\n             // about each specified name\n             final ConnectorObject object = delta.getObject();\n \n@@ -320,6 +327,9 @@ private SyncResult createUser(SyncDelta delta, final boolean dryRun) throws JobE\n \n                 propagationManager.execute(tasks);\n \n+                notificationManager.createTasks(new WorkflowResult<Long>(created.getResult().getKey(),\n+                        created.getPropByRes(), created.getPerformedTasks()));\n+\n                 userTO = userDataBinder.getUserTO(created.getResult().getKey());\n \n                 result.setUserId(created.getResult().getKey());\n@@ -373,6 +383,10 @@ private void updateUsers(SyncDelta delta, final List<Long> users, final boolean\n                                 .getResource().getName()));\n \n                         propagationManager.execute(tasks);\n+\n+                        notificationManager.createTasks(new WorkflowResult<Long>(updated.getResult().getKey(),\n+                                updated.getPropByRes(), updated.getPerformedTasks()));\n+\n                         userTO = userDataBinder.getUserTO(updated.getResult().getKey());\n                     }\n                 } catch (PropagationException e) {\n@@ -419,6 +433,9 @@ private void deleteUsers(SyncDelta delta, final List<Long> users, final boolean\n                         List<PropagationTask> tasks = propagationManager.getDeleteTaskIds(userId,\n                                 ((SyncTask) this.task).getResource().getName());\n                         propagationManager.execute(tasks);\n+\n+                        notificationManager.createTasks(new WorkflowResult<Long>(userId, null, \"delete\"));\n+\n                     } catch (Exception e) {\n                         LOG.error(\"Could not propagate user \" + userId, e);\n                     }"}]}