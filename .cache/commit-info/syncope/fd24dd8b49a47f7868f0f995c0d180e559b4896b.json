{"sha":"fd24dd8b49a47f7868f0f995c0d180e559b4896b","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmZkMjRkZDhiNDlhNDdmNzg2OGYwZjk5NWMwZDE4MGU1NTliNDg5NmI=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2018-10-15T13:39:12Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2018-10-15T13:52:05Z"},"message":"[SYNCOPE-1384] Add RequestedAuthnContextProvider","tree":{"sha":"372920cd980ee13f0e51cb8f5ce2680a68e4137c","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/372920cd980ee13f0e51cb8f5ce2680a68e4137c"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/fd24dd8b49a47f7868f0f995c0d180e559b4896b","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/fd24dd8b49a47f7868f0f995c0d180e559b4896b","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/fd24dd8b49a47f7868f0f995c0d180e559b4896b","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/fd24dd8b49a47f7868f0f995c0d180e559b4896b/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"4ae9a74c1381c16e9bab8ae0099afa2b2eca59ae","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/4ae9a74c1381c16e9bab8ae0099afa2b2eca59ae","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/4ae9a74c1381c16e9bab8ae0099afa2b2eca59ae"}],"stats":{"total":259,"additions":235,"deletions":24},"files":[{"sha":"06090a0b6b9b420030682a1e6c8fb02a3d2294d9","filename":"ext/saml2sp/client-console/src/main/java/org/apache/syncope/client/console/rest/SAML2IdPsRestClient.java","status":"modified","additions":4,"deletions":1,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Frest%2FSAML2IdPsRestClient.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Frest%2FSAML2IdPsRestClient.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Frest%2FSAML2IdPsRestClient.java?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -38,6 +38,10 @@ public Set<String> getActionsClasses() {\n         return getService(SAML2IdPService.class).getActionsClasses();\n     }\n \n+    public Set<String> getRequestedAuthnContextProviderClasses() {\n+        return getService(SAML2IdPService.class).getRequestedAuthnContextProviderClasses();\n+    }\n+\n     public void importIdPs(final InputStream input) {\n         SyncopeConsoleSession.get().\n                 getService(MediaType.APPLICATION_XML_TYPE, SAML2IdPService.class).importFromMetadata(input);\n@@ -54,5 +58,4 @@ public void update(final SAML2IdPTO idp) {\n     public void delete(final String key) {\n         getService(SAML2IdPService.class).delete(key);\n     }\n-\n }"},{"sha":"3d6fc14378d1275ed7dad6128d5c9e6316a5a5d2","filename":"ext/saml2sp/client-console/src/main/java/org/apache/syncope/client/console/wizards/SAML2IdPWizardBuilder.java","status":"modified","additions":7,"deletions":0,"changes":7,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FSAML2IdPWizardBuilder.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FSAML2IdPWizardBuilder.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwizards%2FSAML2IdPWizardBuilder.java?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -131,6 +131,13 @@ private final class IdP extends WizardStep {\n             bindingType.setChoices(Arrays.asList(SAML2BindingType.values()));\n             fields.add(bindingType);\n \n+            AjaxTextFieldPanel requestedAuthnContextProviderClassName = new AjaxTextFieldPanel(\n+                    \"field\", \"requestedAuthnContextProviderClassName\",\n+                    new PropertyModel<String>(idpTO, \"requestedAuthnContextProviderClassName\"));\n+            requestedAuthnContextProviderClassName.setChoices(\n+                    new ArrayList<>(restClient.getRequestedAuthnContextProviderClasses()));\n+            fields.add(requestedAuthnContextProviderClassName);\n+\n             AjaxPalettePanel<String> actionsClassNames = new AjaxPalettePanel.Builder<String>().\n                     setAllowMoveAll(true).setAllowOrder(true).\n                     setName(new StringResourceModel(\"actionsClassNames\", directoryPanel).getString())."},{"sha":"3010eaac2fdc7375edbe7f784a8cd61069327496","filename":"ext/saml2sp/client-console/src/main/resources/org/apache/syncope/client/console/panels/SAML2IdPsDirectoryPanel.properties","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSAML2IdPsDirectoryPanel.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSAML2IdPsDirectoryPanel.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSAML2IdPsDirectoryPanel.properties?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -27,3 +27,4 @@ updateMatching=Update matching users\n actionsClassNames=Actions\n template.title=user template\n selfRegUnmatching=SAML-initiated self-registration\n+requestedAuthnContextProviderClassName=RequestedAuthnContext provider"},{"sha":"fe2dc04ca311ebe2a982b1402c9d3cd68be728ee","filename":"ext/saml2sp/client-console/src/main/resources/org/apache/syncope/client/console/panels/SAML2IdPsDirectoryPanel_it.properties","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSAML2IdPsDirectoryPanel_it.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSAML2IdPsDirectoryPanel_it.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSAML2IdPsDirectoryPanel_it.properties?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -27,3 +27,4 @@ updateMatching=Update matching users\n actionsClassNames=Azioni\n template.title=template utenti\n selfRegUnmatching=SAML-initiated self-registration\n+requestedAuthnContextProviderClassName=RequestedAuthnContext provider"},{"sha":"9f4b9b0665cf949e4a282cf5706cd74ae082808a","filename":"ext/saml2sp/client-console/src/main/resources/org/apache/syncope/client/console/panels/SAML2IdPsDirectoryPanel_pt_BR.properties","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSAML2IdPsDirectoryPanel_pt_BR.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSAML2IdPsDirectoryPanel_pt_BR.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSAML2IdPsDirectoryPanel_pt_BR.properties?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -27,3 +27,4 @@ updateMatching=Update matching users\n actionsClassNames=Actions\n template.title=user template\n selfRegUnmatching=SAML-initiated self-registration\n+requestedAuthnContextProviderClassName=RequestedAuthnContext provider"},{"sha":"e8de69f820f8fadd6d708d2af7c0013d44da3988","filename":"ext/saml2sp/client-console/src/main/resources/org/apache/syncope/client/console/panels/SAML2IdPsDirectoryPanel_ru.properties","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSAML2IdPsDirectoryPanel_ru.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSAML2IdPsDirectoryPanel_ru.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fclient-console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FSAML2IdPsDirectoryPanel_ru.properties?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -27,3 +27,4 @@ updateMatching=Update matching users\n actionsClassNames=\\u0414\\u0435\\u0439\\u0441\\u0442\\u0432\\u0438\\u044f\n template.title=user template\n selfRegUnmatching=SAML-initiated self-registration\n+requestedAuthnContextProviderClassName=RequestedAuthnContext provider"},{"sha":"609f01262b1eb2ccd0807ad5795f022a58aaf4c6","filename":"ext/saml2sp/common-lib/src/main/java/org/apache/syncope/common/lib/to/SAML2IdPTO.java","status":"modified","additions":14,"deletions":5,"changes":19,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fcommon-lib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2Fto%2FSAML2IdPTO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fcommon-lib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2Fto%2FSAML2IdPTO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fcommon-lib%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Flib%2Fto%2FSAML2IdPTO.java?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -63,6 +63,8 @@ public class SAML2IdPTO extends AbstractBaseBean implements EntityTO, ItemContai\n \n     private final List<String> actionsClassNames = new ArrayList<>();\n \n+    private String requestedAuthnContextProviderClassName;\n+\n     @Override\n     public String getKey() {\n         return key;\n@@ -130,6 +132,14 @@ public void setUseDeflateEncoding(final boolean useDeflateEncoding) {\n         this.useDeflateEncoding = useDeflateEncoding;\n     }\n \n+    public boolean isSupportUnsolicited() {\n+        return supportUnsolicited;\n+    }\n+\n+    public void setSupportUnsolicited(final boolean supportUnsolicited) {\n+        this.supportUnsolicited = supportUnsolicited;\n+    }\n+\n     public SAML2BindingType getBindingType() {\n         return bindingType;\n     }\n@@ -197,12 +207,11 @@ public List<String> getActionsClassNames() {\n         return actionsClassNames;\n     }\n \n-    public boolean isSupportUnsolicited() {\n-        return supportUnsolicited;\n+    public String getRequestedAuthnContextProviderClassName() {\n+        return requestedAuthnContextProviderClassName;\n     }\n \n-    public void setSupportUnsolicited(final boolean supportUnsolicited) {\n-        this.supportUnsolicited = supportUnsolicited;\n+    public void setRequestedAuthnContextProviderClassName(final String requestedAuthnContextProviderClassName) {\n+        this.requestedAuthnContextProviderClassName = requestedAuthnContextProviderClassName;\n     }\n-\n }"},{"sha":"4abfefa441a8eea46abe30264ae1023949bc61fd","filename":"ext/saml2sp/logic/pom.xml","status":"modified","additions":0,"deletions":5,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Flogic%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Flogic%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Flogic%2Fpom.xml?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -54,11 +54,6 @@ under the License.\n       <groupId>org.apache.cxf</groupId>\n       <artifactId>cxf-rt-rs-security-sso-saml</artifactId>\n     </dependency>\n-\n-    <dependency>\n-      <groupId>org.opensaml</groupId>\n-      <artifactId>opensaml-saml-impl</artifactId>\n-    </dependency>\n   </dependencies>\n \n   <build>"},{"sha":"ef9d2c53a65929302a30183e98964e9b07f4fccd","filename":"ext/saml2sp/logic/src/main/java/org/apache/syncope/core/logic/SAML2IdPLogic.java","status":"modified","additions":5,"deletions":0,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FSAML2IdPLogic.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FSAML2IdPLogic.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FSAML2IdPLogic.java?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -79,6 +79,11 @@ public Set<String> getActionsClasses() {\n         return implLookup.getActionsClasses();\n     }\n \n+    @PreAuthorize(\"isAuthenticated()\")\n+    public Set<String> getRequestedAuthnContextProviderClasses() {\n+        return implLookup.getRequestedAuthnContextProvidersClasses();\n+    }\n+\n     private SAML2IdPTO complete(final SAML2IdP idp, final SAML2IdPTO idpTO) {\n         SAML2IdPEntity idpEntity = cache.get(idpTO.getEntityID());\n         if (idpEntity == null) {"},{"sha":"4ae24d7940c8f509c5c6d6b46ee046e2dbb12089","filename":"ext/saml2sp/logic/src/main/java/org/apache/syncope/core/logic/SAML2SPLogic.java","status":"modified","additions":17,"deletions":12,"changes":29,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FSAML2SPLogic.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FSAML2SPLogic.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FSAML2SPLogic.java?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -55,6 +55,7 @@\n import org.apache.syncope.core.persistence.api.dao.NotFoundException;\n import org.apache.syncope.core.persistence.api.dao.SAML2IdPDAO;\n import org.apache.syncope.core.persistence.api.entity.SAML2IdP;\n+import org.apache.syncope.core.provisioning.api.RequestedAuthnContextProvider;\n import org.apache.syncope.core.provisioning.api.data.AccessTokenDataBinder;\n import org.joda.time.DateTime;\n import org.opensaml.core.xml.XMLObject;\n@@ -64,27 +65,21 @@\n import org.opensaml.saml.saml2.core.Assertion;\n import org.opensaml.saml.saml2.core.Attribute;\n import org.opensaml.saml.saml2.core.AttributeStatement;\n-import org.opensaml.saml.saml2.core.AuthnContext;\n-import org.opensaml.saml.saml2.core.AuthnContextClassRef;\n-import org.opensaml.saml.saml2.core.AuthnContextComparisonTypeEnumeration;\n import org.opensaml.saml.saml2.core.AuthnRequest;\n import org.opensaml.saml.saml2.core.Issuer;\n import org.opensaml.saml.saml2.core.LogoutRequest;\n import org.opensaml.saml.saml2.core.LogoutResponse;\n import org.opensaml.saml.saml2.core.NameID;\n import org.opensaml.saml.saml2.core.NameIDPolicy;\n import org.opensaml.saml.saml2.core.NameIDType;\n-import org.opensaml.saml.saml2.core.RequestedAuthnContext;\n import org.opensaml.saml.saml2.core.Response;\n import org.opensaml.saml.saml2.core.SessionIndex;\n import org.opensaml.saml.saml2.core.StatusCode;\n-import org.opensaml.saml.saml2.core.impl.AuthnContextClassRefBuilder;\n import org.opensaml.saml.saml2.core.impl.AuthnRequestBuilder;\n import org.opensaml.saml.saml2.core.impl.IssuerBuilder;\n import org.opensaml.saml.saml2.core.impl.LogoutRequestBuilder;\n import org.opensaml.saml.saml2.core.impl.NameIDBuilder;\n import org.opensaml.saml.saml2.core.impl.NameIDPolicyBuilder;\n-import org.opensaml.saml.saml2.core.impl.RequestedAuthnContextBuilder;\n import org.opensaml.saml.saml2.core.impl.SessionIndexBuilder;\n import org.opensaml.saml.saml2.metadata.AssertionConsumerService;\n import org.opensaml.saml.saml2.metadata.EntityDescriptor;\n@@ -104,10 +99,13 @@\n import org.springframework.security.access.prepost.PreAuthorize;\n import org.springframework.stereotype.Component;\n import org.apache.syncope.core.provisioning.api.serialization.POJOHelper;\n+import org.apache.syncope.core.provisioning.java.DefaultRequestedAuthnContextProvider;\n+import org.apache.syncope.core.spring.ApplicationContextProvider;\n import org.apache.syncope.core.spring.security.AuthContextUtils;\n import org.apache.syncope.core.spring.security.AuthDataAccessor;\n import org.apache.syncope.core.spring.security.Encryptor;\n import org.opensaml.core.xml.schema.XSAny;\n+import org.springframework.beans.factory.support.AbstractBeanDefinition;\n import org.springframework.util.ResourceUtils;\n \n @Component\n@@ -298,11 +296,18 @@ public SAML2RequestTO createLoginRequest(final String spEntityID, final String i\n         nameIDPolicy.setAllowCreate(true);\n         nameIDPolicy.setSPNameQualifier(spEntityID);\n \n-        AuthnContextClassRef authnContextClassRef = new AuthnContextClassRefBuilder().buildObject();\n-        authnContextClassRef.setAuthnContextClassRef(AuthnContext.PPT_AUTHN_CTX);\n-        RequestedAuthnContext requestedAuthnContext = new RequestedAuthnContextBuilder().buildObject();\n-        requestedAuthnContext.setComparison(AuthnContextComparisonTypeEnumeration.EXACT);\n-        requestedAuthnContext.getAuthnContextClassRefs().add(authnContextClassRef);\n+        RequestedAuthnContextProvider requestedAuthnContextProvider = new DefaultRequestedAuthnContextProvider();\n+        if (idp.getRequestedAuthnContextProviderClassName() != null) {\n+            try {\n+                Class<?> actionsClass = Class.forName(idp.getRequestedAuthnContextProviderClassName());\n+                requestedAuthnContextProvider = (RequestedAuthnContextProvider) ApplicationContextProvider.\n+                        getBeanFactory().createBean(actionsClass, AbstractBeanDefinition.AUTOWIRE_BY_TYPE, true);\n+            } catch (Exception e) {\n+                LOG.warn(\"Cannot instantiate '{}', reverting to {}\",\n+                        idp.getRequestedAuthnContextProviderClassName(),\n+                        DefaultRequestedAuthnContextProvider.class.getName(), e);\n+            }\n+        }\n \n         AuthnRequest authnRequest = new AuthnRequestBuilder().buildObject();\n         authnRequest.setID(\"_\" + UUID_GENERATOR.generate().toString());\n@@ -313,7 +318,7 @@ public SAML2RequestTO createLoginRequest(final String spEntityID, final String i\n         authnRequest.setIssueInstant(new DateTime());\n         authnRequest.setIssuer(issuer);\n         authnRequest.setNameIDPolicy(nameIDPolicy);\n-        authnRequest.setRequestedAuthnContext(requestedAuthnContext);\n+        authnRequest.setRequestedAuthnContext(requestedAuthnContextProvider.provide());\n         authnRequest.setDestination(idp.getSSOLocation(idp.getBindingType()).getLocation());\n \n         SAML2RequestTO requestTO = new SAML2RequestTO();"},{"sha":"ce8fb5aa6406503c53e74fef6442883825d4e020","filename":"ext/saml2sp/logic/src/main/java/org/apache/syncope/core/logic/init/SAML2SPClassPathScanImplementationLookup.java","status":"modified","additions":11,"deletions":0,"changes":11,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2Finit%2FSAML2SPClassPathScanImplementationLookup.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2Finit%2FSAML2SPClassPathScanImplementationLookup.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2Finit%2FSAML2SPClassPathScanImplementationLookup.java?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -24,6 +24,7 @@\n import java.util.Set;\n import org.apache.syncope.core.persistence.api.ImplementationLookup;\n import org.apache.syncope.core.persistence.api.SyncopeLoader;\n+import org.apache.syncope.core.provisioning.api.RequestedAuthnContextProvider;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n import org.springframework.beans.factory.config.BeanDefinition;\n@@ -42,6 +43,8 @@ public class SAML2SPClassPathScanImplementationLookup implements SyncopeLoader {\n \n     private Set<String> actionsClasses;\n \n+    private Set<String> requestedAuthnContextProvidersClasses;\n+\n     @Override\n     public Integer getPriority() {\n         return Integer.MIN_VALUE;\n@@ -50,9 +53,11 @@ public Integer getPriority() {\n     @Override\n     public void load() {\n         actionsClasses = new HashSet<>();\n+        requestedAuthnContextProvidersClasses = new HashSet<>();\n \n         ClassPathScanningCandidateComponentProvider scanner = new ClassPathScanningCandidateComponentProvider(false);\n         scanner.addIncludeFilter(new AssignableTypeFilter(SAML2IdPActions.class));\n+        scanner.addIncludeFilter(new AssignableTypeFilter(RequestedAuthnContextProvider.class));\n \n         for (BeanDefinition bd : scanner.findCandidateComponents(DEFAULT_BASE_PACKAGE)) {\n             try {\n@@ -62,17 +67,23 @@ public void load() {\n \n                 if (SAML2IdPActions.class.isAssignableFrom(clazz) && !isAbstractClazz) {\n                     actionsClasses.add(clazz.getName());\n+                } else if (RequestedAuthnContextProvider.class.isAssignableFrom(clazz) && !isAbstractClazz) {\n+                    requestedAuthnContextProvidersClasses.add(clazz.getName());\n                 }\n             } catch (Throwable t) {\n                 LOG.warn(\"Could not inspect class {}\", bd.getBeanClassName(), t);\n             }\n         }\n \n         actionsClasses = Collections.unmodifiableSet(actionsClasses);\n+        requestedAuthnContextProvidersClasses = Collections.unmodifiableSet(requestedAuthnContextProvidersClasses);\n     }\n \n     public Set<String> getActionsClasses() {\n         return actionsClasses;\n     }\n \n+    public Set<String> getRequestedAuthnContextProvidersClasses() {\n+        return requestedAuthnContextProvidersClasses;\n+    }\n }"},{"sha":"18bb1688268b26c1d0d21a855461fc9edd7e8d2b","filename":"ext/saml2sp/logic/src/main/java/org/apache/syncope/core/logic/saml2/SAML2IdPEntity.java","status":"modified","additions":4,"deletions":1,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2Fsaml2%2FSAML2IdPEntity.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2Fsaml2%2FSAML2IdPEntity.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2Fsaml2%2FSAML2IdPEntity.java?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -162,6 +162,10 @@ public List<String> getActionsClassNames() {\n         return idpTO.getActionsClassNames();\n     }\n \n+    public String getRequestedAuthnContextProviderClassName() {\n+        return idpTO.getRequestedAuthnContextProviderClassName();\n+    }\n+\n     public Endpoint getSSOLocation(final SAML2BindingType bindingType) {\n         return ssoBindings.get(bindingType.getUri());\n     }\n@@ -177,5 +181,4 @@ public boolean supportsNameIDFormat(final String nameIDFormat) {\n     public KeyStore getTrustStore() {\n         return trustStore;\n     }\n-\n }"},{"sha":"3cf9ddce42993ffadf081d52e9708517b1fcbcd2","filename":"ext/saml2sp/persistence-api/src/main/java/org/apache/syncope/core/persistence/api/entity/SAML2IdP.java","status":"modified","additions":4,"deletions":0,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fpersistence-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fapi%2Fentity%2FSAML2IdP.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fpersistence-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fapi%2Fentity%2FSAML2IdP.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fpersistence-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fapi%2Fentity%2FSAML2IdP.java?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -73,4 +73,8 @@ public interface SAML2IdP extends Entity {\n     List<? extends SAML2IdPItem> getItems();\n \n     List<String> getActionsClassNames();\n+\n+    String getRequestedAuthnContextProviderClassName();\n+\n+    void setRequestedAuthnContextProviderClassName(String requestedAuthnContextProviderClassName);\n }"},{"sha":"a2cc963d58a29d5b7264b80c5fcea4ee445d9e6c","filename":"ext/saml2sp/persistence-jpa/src/main/java/org/apache/syncope/core/persistence/jpa/entity/JPASAML2IdP.java","status":"modified","additions":12,"deletions":0,"changes":12,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fpersistence-jpa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fentity%2FJPASAML2IdP.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fpersistence-jpa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fentity%2FJPASAML2IdP.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fpersistence-jpa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fentity%2FJPASAML2IdP.java?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -93,6 +93,8 @@ public class JPASAML2IdP extends AbstractGeneratedKeyEntity implements SAML2IdP\n             @JoinColumn(name = \"saml2IdP_id\", referencedColumnName = \"id\"))\n     private List<String> actionsClassNames = new ArrayList<>();\n \n+    private String requestedAuthnContextProviderClassName;\n+\n     @Override\n     public String getEntityID() {\n         return entityID;\n@@ -220,4 +222,14 @@ public void setConnObjectKeyItem(final SAML2IdPItem item) {\n     public List<String> getActionsClassNames() {\n         return actionsClassNames;\n     }\n+\n+    @Override\n+    public String getRequestedAuthnContextProviderClassName() {\n+        return requestedAuthnContextProviderClassName;\n+    }\n+\n+    @Override\n+    public void setRequestedAuthnContextProviderClassName(final String requestedAuthnContextProviderClassName) {\n+        this.requestedAuthnContextProviderClassName = requestedAuthnContextProviderClassName;\n+    }\n }"},{"sha":"6d1cc80ecaaeffb11c8ed7866a2c8ea2eb694744","filename":"ext/saml2sp/provisioning-api/pom.xml","status":"modified","additions":5,"deletions":0,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fprovisioning-api%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fprovisioning-api%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fprovisioning-api%2Fpom.xml?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -54,6 +54,11 @@ under the License.\n       <artifactId>syncope-ext-saml2sp-common-lib</artifactId>\n       <version>${project.version}</version>\n     </dependency>\n+    \n+    <dependency>\n+      <groupId>org.opensaml</groupId>\n+      <artifactId>opensaml-saml-api</artifactId>\n+    </dependency>\n   </dependencies>\n \n   <build>"},{"sha":"0905fd99c543ef972b2fa58b258c6060e4f791af","filename":"ext/saml2sp/provisioning-api/src/main/java/org/apache/syncope/core/provisioning/api/RequestedAuthnContextProvider.java","status":"added","additions":26,"deletions":0,"changes":26,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fprovisioning-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fapi%2FRequestedAuthnContextProvider.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fprovisioning-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fapi%2FRequestedAuthnContextProvider.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fprovisioning-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fapi%2FRequestedAuthnContextProvider.java?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -0,0 +1,26 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.core.provisioning.api;\n+\n+import org.opensaml.saml.saml2.core.RequestedAuthnContext;\n+\n+public interface RequestedAuthnContextProvider {\n+\n+    RequestedAuthnContext provide();\n+}"},{"sha":"f20030e384d87c7fdc1a3ed8eaca30d204669cf0","filename":"ext/saml2sp/provisioning-java/pom.xml","status":"modified","additions":5,"deletions":0,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fprovisioning-java%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fprovisioning-java%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fprovisioning-java%2Fpom.xml?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -48,6 +48,11 @@ under the License.\n       <artifactId>syncope-ext-saml2sp-provisioning-api</artifactId>\n       <version>${project.version}</version>\n     </dependency>\n+   \n+    <dependency>\n+      <groupId>org.opensaml</groupId>\n+      <artifactId>opensaml-saml-impl</artifactId>\n+    </dependency>\n   </dependencies>\n \n   <build>"},{"sha":"ec54a9b33277618b0c2ff7f8e3b87550c860a6f5","filename":"ext/saml2sp/provisioning-java/src/main/java/org/apache/syncope/core/provisioning/java/DefaultRequestedAuthnContextProvider.java","status":"added","additions":41,"deletions":0,"changes":41,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2FDefaultRequestedAuthnContextProvider.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2FDefaultRequestedAuthnContextProvider.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2FDefaultRequestedAuthnContextProvider.java?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -0,0 +1,41 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.core.provisioning.java;\n+\n+import org.apache.syncope.core.provisioning.api.RequestedAuthnContextProvider;\n+import org.opensaml.saml.saml2.core.AuthnContext;\n+import org.opensaml.saml.saml2.core.AuthnContextClassRef;\n+import org.opensaml.saml.saml2.core.AuthnContextComparisonTypeEnumeration;\n+import org.opensaml.saml.saml2.core.RequestedAuthnContext;\n+import org.opensaml.saml.saml2.core.impl.AuthnContextClassRefBuilder;\n+import org.opensaml.saml.saml2.core.impl.RequestedAuthnContextBuilder;\n+\n+public class DefaultRequestedAuthnContextProvider implements RequestedAuthnContextProvider {\n+\n+    @Override\n+    public RequestedAuthnContext provide() {\n+        AuthnContextClassRef authnContextClassRef = new AuthnContextClassRefBuilder().buildObject();\n+        authnContextClassRef.setAuthnContextClassRef(AuthnContext.PPT_AUTHN_CTX);\n+        RequestedAuthnContext requestedAuthnContext = new RequestedAuthnContextBuilder().buildObject();\n+        requestedAuthnContext.setComparison(AuthnContextComparisonTypeEnumeration.EXACT);\n+        requestedAuthnContext.getAuthnContextClassRefs().add(authnContextClassRef);\n+\n+        return requestedAuthnContext;\n+    }\n+}"},{"sha":"e95922a0ad234d44f20ae1a8f8277ec23603055b","filename":"ext/saml2sp/provisioning-java/src/main/java/org/apache/syncope/core/provisioning/java/NullRequestedAuthnContextProvider.java","status":"added","additions":30,"deletions":0,"changes":30,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2FNullRequestedAuthnContextProvider.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2FNullRequestedAuthnContextProvider.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2FNullRequestedAuthnContextProvider.java?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -0,0 +1,30 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.core.provisioning.java;\n+\n+import org.apache.syncope.core.provisioning.api.RequestedAuthnContextProvider;\n+import org.opensaml.saml.saml2.core.RequestedAuthnContext;\n+\n+public class NullRequestedAuthnContextProvider implements RequestedAuthnContextProvider {\n+\n+    @Override\n+    public RequestedAuthnContext provide() {\n+        return null;\n+    }\n+}"},{"sha":"85c693a343479304e83e2cdc20b32c981dac7aa0","filename":"ext/saml2sp/provisioning-java/src/main/java/org/apache/syncope/core/provisioning/java/data/SAML2IdPDataBinderImpl.java","status":"modified","additions":4,"deletions":0,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fdata%2FSAML2IdPDataBinderImpl.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fdata%2FSAML2IdPDataBinderImpl.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fdata%2FSAML2IdPDataBinderImpl.java?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -208,6 +208,8 @@ public SAML2IdP update(final SAML2IdP idp, final SAML2IdPTO idpTO) {\n         idp.getActionsClassNames().clear();\n         idp.getActionsClassNames().addAll(idpTO.getActionsClassNames());\n \n+        idp.setRequestedAuthnContextProviderClassName(idpTO.getRequestedAuthnContextProviderClassName());\n+\n         return saml2IdPDAO.save(idp);\n     }\n \n@@ -249,6 +251,8 @@ public SAML2IdPTO getIdPTO(final SAML2IdP idp) {\n \n         idpTO.getActionsClassNames().addAll(idp.getActionsClassNames());\n \n+        idpTO.setRequestedAuthnContextProviderClassName(idp.getRequestedAuthnContextProviderClassName());\n+\n         return idpTO;\n     }\n }"},{"sha":"ac117c741ad449af082eabde81e5de9cbf89e47c","filename":"ext/saml2sp/rest-api/src/main/java/org/apache/syncope/common/rest/api/service/SAML2IdPService.java","status":"modified","additions":10,"deletions":0,"changes":10,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Frest-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Frest%2Fapi%2Fservice%2FSAML2IdPService.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Frest-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Frest%2Fapi%2Fservice%2FSAML2IdPService.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Frest-api%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Frest%2Fapi%2Fservice%2FSAML2IdPService.java?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -63,6 +63,16 @@ public interface SAML2IdPService extends JAXRSService {\n     @Produces({ MediaType.APPLICATION_JSON })\n     Set<String> getActionsClasses();\n \n+    /**\n+     * Returns the list of available RequestedAuthnContextProviders implementations.\n+     *\n+     * @return the list of available RequestedAuthnContextProviders implementations\n+     */\n+    @GET\n+    @Path(\"requestedAuthnContextProviders\")\n+    @Produces({ MediaType.APPLICATION_JSON })\n+    Set<String> getRequestedAuthnContextProviderClasses();\n+\n     /**\n      * Returns a list of all defined SAML 2.0 Identity Providers.\n      *"},{"sha":"5952bec16c3636bf2e5b6d07e7be57eb2c18336c","filename":"ext/saml2sp/rest-cxf/src/main/java/org/apache/syncope/core/rest/cxf/service/SAML2IdPServiceImpl.java","status":"modified","additions":5,"deletions":0,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Frest-cxf%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2Fcxf%2Fservice%2FSAML2IdPServiceImpl.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/ext%2Fsaml2sp%2Frest-cxf%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2Fcxf%2Fservice%2FSAML2IdPServiceImpl.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fsaml2sp%2Frest-cxf%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2Fcxf%2Fservice%2FSAML2IdPServiceImpl.java?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -40,6 +40,11 @@ public Set<String> getActionsClasses() {\n         return logic.getActionsClasses();\n     }\n \n+    @Override\n+    public Set<String> getRequestedAuthnContextProviderClasses() {\n+        return logic.getRequestedAuthnContextProviderClasses();\n+    }\n+\n     @Override\n     public List<SAML2IdPTO> list() {\n         return logic.list();"},{"sha":"ef68dce25868ab9dac471cc65939771876e18777","filename":"pom.xml","status":"modified","additions":27,"deletions":0,"changes":27,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fd24dd8b49a47f7868f0f995c0d180e559b4896b/pom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fd24dd8b49a47f7868f0f995c0d180e559b4896b/pom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/pom.xml?ref=fd24dd8b49a47f7868f0f995c0d180e559b4896b","patch":"@@ -694,6 +694,33 @@ under the License.\n       <!-- /Camel -->\n       \n       <!-- OpenSAML -->\n+      <dependency>\n+        <groupId>org.opensaml</groupId>\n+        <artifactId>opensaml-saml-api</artifactId>\n+        <version>${opensaml.version}</version>\n+        <exclusions>\n+          <exclusion>\n+            <groupId>org.opensaml</groupId>\n+            <artifactId>opensaml-storage-api</artifactId>\n+          </exclusion>\n+          <exclusion>\n+            <groupId>org.opensaml</groupId>\n+            <artifactId>opensaml-messaging-api</artifactId>\n+          </exclusion>\n+          <exclusion>\n+            <groupId>org.apache.velocity</groupId>\n+            <artifactId>velocity</artifactId>\n+          </exclusion>\n+          <exclusion>\n+            <groupId>org.apache.httpcomponents</groupId>\n+            <artifactId>httpclient</artifactId>\n+          </exclusion>\n+          <exclusion>\n+            <groupId>com.google.code.findbugs</groupId>\n+            <artifactId>jsr305</artifactId>\n+          </exclusion>\n+        </exclusions>\n+      </dependency>\n       <dependency>\n         <groupId>org.opensaml</groupId>\n         <artifactId>opensaml-saml-impl</artifactId>"}]}