{"sha":"8494fc73f911d4e3f18c8d00bc15a1f40ae06450","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjg0OTRmYzczZjkxMWQ0ZTNmMThjOGQwMGJjMTVhMWY0MGFlMDY0NTA=","commit":{"author":{"name":"Fabio Martelli","email":"fmartelli@apache.org","date":"2013-11-05T16:31:02Z"},"committer":{"name":"Fabio Martelli","email":"fmartelli@apache.org","date":"2013-11-05T16:31:02Z"},"message":"console improvement about SYNCOPE-422 and SYNCOPE-423\n\ngit-svn-id: https://svn.apache.org/repos/asf/syncope/branches/1_1_X@1539049 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"f10baa14e5d8b3d17e30c6aa19e784c41091ed6f","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/f10baa14e5d8b3d17e30c6aa19e784c41091ed6f"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/8494fc73f911d4e3f18c8d00bc15a1f40ae06450","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/8494fc73f911d4e3f18c8d00bc15a1f40ae06450","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/8494fc73f911d4e3f18c8d00bc15a1f40ae06450","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/8494fc73f911d4e3f18c8d00bc15a1f40ae06450/comments","author":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"committer":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"parents":[{"sha":"ca5b676d6614ce8b408ae841919ece5d85f742d2","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/ca5b676d6614ce8b408ae841919ece5d85f742d2","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/ca5b676d6614ce8b408ae841919ece5d85f742d2"}],"stats":{"total":146,"additions":118,"deletions":28},"files":[{"sha":"f45540314f508cc0d7c2280bb80a8912250f830b","filename":"console/src/main/java/org/apache/syncope/console/pages/panels/EventSelectionPanel.java","status":"modified","additions":10,"deletions":1,"changes":11,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/8494fc73f911d4e3f18c8d00bc15a1f40ae06450/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FEventSelectionPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/8494fc73f911d4e3f18c8d00bc15a1f40ae06450/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FEventSelectionPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FEventSelectionPanel.java?ref=8494fc73f911d4e3f18c8d00bc15a1f40ae06450","patch":"@@ -228,6 +228,15 @@ private List<String> getEvents(final EventCategoryTO eventCategoryTO) {\n         return res;\n     }\n \n+    /**\n+     * To be extended in order to add actions on events.\n+     *\n+     * @param event event.\n+     */\n+    protected abstract void onEventAction(final IEvent<?> event);\n+\n     @Override\n-    public abstract void onEvent(final IEvent<?> event);\n+    public void onEvent(final IEvent<?> event) {\n+        onEventAction(event);\n+    }\n }"},{"sha":"d8a85d46cbab6fccff44e64ce61411a0d10d49d1","filename":"console/src/main/java/org/apache/syncope/console/pages/panels/LoggerCategoryPanel.java","status":"modified","additions":39,"deletions":10,"changes":49,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/8494fc73f911d4e3f18c8d00bc15a1f40ae06450/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FLoggerCategoryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/8494fc73f911d4e3f18c8d00bc15a1f40ae06450/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FLoggerCategoryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FLoggerCategoryPanel.java?ref=8494fc73f911d4e3f18c8d00bc15a1f40ae06450","patch":"@@ -25,11 +25,15 @@\n import java.util.HashSet;\n import java.util.Iterator;\n import java.util.List;\n+import java.util.Map;\n import java.util.Set;\n import org.apache.commons.lang.StringUtils;\n import org.apache.syncope.common.to.EventCategoryTO;\n+import org.apache.syncope.common.types.AuditElements;\n import org.apache.syncope.common.types.AuditElements.EventCategoryType;\n+import org.apache.syncope.common.util.LoggerEventUtils;\n import org.apache.syncope.console.commons.Constants;\n+import org.apache.syncope.console.pages.panels.SelectedEventsPanel.InspectSelectedEvent;\n import org.apache.syncope.console.wicket.markup.html.form.AjaxDropDownChoicePanel;\n import org.apache.wicket.ajax.AjaxRequestTarget;\n import org.apache.wicket.ajax.form.AjaxFormComponentUpdatingBehavior;\n@@ -178,7 +182,7 @@ protected void onUpdate(final AjaxRequestTarget target) {\n             private static final long serialVersionUID = 3513194801190026082L;\n \n             @Override\n-            public void onEvent(final IEvent<?> event) {\n+            protected void onEventAction(final IEvent<?> event) {\n                 onEventAction(event);\n             }\n         });\n@@ -241,18 +245,28 @@ public void onEvent(final IEvent<?> event) {\n                 eventCategoryTO.setSubcategory(subcategory.getModelObject());\n             }\n \n-            setEvents();\n+            updateEventsContainer(change.getTarget());\n+        } else if (event.getPayload() instanceof InspectSelectedEvent) {\n+            // update objects ....\n+            eventCategoryTO.getEvents().clear();\n+\n+            final InspectSelectedEvent inspectSelectedEvent = (InspectSelectedEvent) event.getPayload();\n+\n+            final Map.Entry<EventCategoryTO, AuditElements.Result> categoryEvent =\n+                    LoggerEventUtils.parseEventCategory(inspectSelectedEvent.getEvent());\n \n-            eventsContainer.addOrReplace(new EventSelectionPanel(\"eventsPanel\", eventCategoryTO, model) {\n+            eventCategoryTO.setType(categoryEvent.getKey().getType());\n+            category.setChoices(filter(eventCategoryTOs, type.getModelObject()));\n \n-                private static final long serialVersionUID = 3513194801190026082L;\n+            eventCategoryTO.setCategory(categoryEvent.getKey().getCategory());\n+            subcategory.setChoices(filter(eventCategoryTOs, type.getModelObject(), category.getModelObject()));\n \n-                @Override\n-                public void onEvent(final IEvent<?> event) {\n-                    onEventAction(event);\n-                }\n-            });\n-            change.getTarget().add(eventsContainer);\n+            eventCategoryTO.setSubcategory(categoryEvent.getKey().getSubcategory());\n+\n+\n+\n+            inspectSelectedEvent.getTarget().add(categoryContainer);\n+            updateEventsContainer(inspectSelectedEvent.getTarget());\n         }\n     }\n \n@@ -310,6 +324,21 @@ private void authorizeChanges() {\n         }\n     }\n \n+    private void updateEventsContainer(final AjaxRequestTarget target) {\n+        setEvents();\n+\n+        eventsContainer.addOrReplace(new EventSelectionPanel(\"eventsPanel\", eventCategoryTO, model) {\n+\n+            private static final long serialVersionUID = 3513194801190026082L;\n+\n+            @Override\n+            public void onEventAction(final IEvent<?> event) {\n+                LoggerCategoryPanel.this.onEventAction(event);\n+            }\n+        });\n+        target.add(eventsContainer);\n+    }\n+\n     protected abstract String[] getListRoles();\n \n     protected abstract String[] getChangeRoles();"},{"sha":"ded15c2f56b26ff766cbebba4fe9d928bc3b3e8c","filename":"console/src/main/java/org/apache/syncope/console/pages/panels/SelectedEventsPanel.java","status":"modified","additions":63,"deletions":9,"changes":72,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/8494fc73f911d4e3f18c8d00bc15a1f40ae06450/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FSelectedEventsPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/8494fc73f911d4e3f18c8d00bc15a1f40ae06450/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FSelectedEventsPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FSelectedEventsPanel.java?ref=8494fc73f911d4e3f18c8d00bc15a1f40ae06450","patch":"@@ -17,23 +17,26 @@\n \n import java.util.List;\n import java.util.Set;\n+import org.apache.syncope.console.commons.Constants;\n import org.apache.wicket.ajax.AjaxRequestTarget;\n+import org.apache.wicket.ajax.form.AjaxFormComponentUpdatingBehavior;\n+import org.apache.wicket.event.Broadcast;\n import org.apache.wicket.event.IEvent;\n+import org.apache.wicket.markup.ComponentTag;\n import org.apache.wicket.markup.html.WebMarkupContainer;\n-import org.apache.wicket.markup.html.basic.Label;\n-import org.apache.wicket.markup.html.list.ListItem;\n-import org.apache.wicket.markup.html.list.ListView;\n+import org.apache.wicket.markup.html.form.IChoiceRenderer;\n+import org.apache.wicket.markup.html.form.ListMultipleChoice;\n import org.apache.wicket.markup.html.panel.Panel;\n import org.apache.wicket.model.IModel;\n-import org.apache.wicket.model.ResourceModel;\n+import org.apache.wicket.model.util.ListModel;\n \n public class SelectedEventsPanel extends Panel {\n \n     private static final long serialVersionUID = -4832450230348213500L;\n \n     private final WebMarkupContainer selectionContainer;\n \n-    private ListView<String> selectedEvents;\n+    private ListMultipleChoice<String> selectedEvents;\n \n     private final IModel<List<String>> model;\n \n@@ -46,16 +49,47 @@ public SelectedEventsPanel(final String id, final IModel<List<String>> model) {\n         selectionContainer.setOutputMarkupId(true);\n         add(selectionContainer);\n \n-        selectedEvents = new ListView<String>(\"selectedEvents\", model.getObject()) {\n+        selectedEvents = new ListMultipleChoice<String>(\"selectedEvents\", new ListModel<String>(), model) {\n \n-            private static final long serialVersionUID = 4949588177564901031L;\n+            private static final long serialVersionUID = 1226677544225737338L;\n \n             @Override\n-            protected void populateItem(final ListItem<String> item) {\n-                item.add(new Label(\"selectedEvent\", new ResourceModel(item.getModelObject(), item.getModelObject())));\n+            protected void onComponentTag(final ComponentTag tag) {\n+                super.onComponentTag(tag);\n+                tag.remove(\"size\");\n+                tag.remove(\"multiple\");\n+                tag.put(\"size\", 5);\n             }\n         };\n \n+        selectedEvents.setMaxRows(5);\n+        selectedEvents.setChoiceRenderer(new IChoiceRenderer<String>() {\n+\n+            private static final long serialVersionUID = -4288397951948436434L;\n+\n+            @Override\n+            public Object getDisplayValue(final String object) {\n+                return object;\n+            }\n+\n+            @Override\n+            public String getIdValue(final String object, final int index) {\n+                return object;\n+            }\n+        });\n+\n+        selectedEvents.add(new AjaxFormComponentUpdatingBehavior(Constants.ON_CHANGE) {\n+\n+            private static final long serialVersionUID = -151291731388673682L;\n+\n+            @Override\n+            protected void onUpdate(final AjaxRequestTarget target) {\n+                send(SelectedEventsPanel.this.getPage(),\n+                        Broadcast.BREADTH,\n+                        new InspectSelectedEvent(target, selectedEvents.getModelValue()));\n+            }\n+        });\n+\n         selectionContainer.add(selectedEvents);\n     }\n \n@@ -78,6 +112,26 @@ public void onEvent(final IEvent<?> event) {\n         }\n     }\n \n+    public static class InspectSelectedEvent {\n+\n+        private final AjaxRequestTarget target;\n+\n+        private final String event;\n+\n+        public InspectSelectedEvent(final AjaxRequestTarget target, final String event) {\n+            this.target = target;\n+            this.event = event;\n+        }\n+\n+        public AjaxRequestTarget getTarget() {\n+            return target;\n+        }\n+\n+        public String getEvent() {\n+            return event;\n+        }\n+    }\n+\n     public static class EventSelectionChanged {\n \n         private final AjaxRequestTarget target;"},{"sha":"12c2f87f4ffadc54de6b85e8120fb000d1ce0fb5","filename":"console/src/main/resources/org/apache/syncope/console/pages/panels/LoggerCategoryPanel.html","status":"modified","additions":0,"deletions":3,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/8494fc73f911d4e3f18c8d00bc15a1f40ae06450/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FLoggerCategoryPanel.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/8494fc73f911d4e3f18c8d00bc15a1f40ae06450/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FLoggerCategoryPanel.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FLoggerCategoryPanel.html?ref=8494fc73f911d4e3f18c8d00bc15a1f40ae06450","patch":"@@ -26,12 +26,9 @@\n       }\n \n       .selectedEvents{\n-        border: 1px solid #DDDDDD;\n         display: inline-block;\n         height: 100px;\n         margin: 10px 10px 0 10px;\n-        min-width: 585px;\n-        width: 585px;\n         overflow-y: auto;\n       }\n "},{"sha":"3ef03546cdb564dedcef56dda4842c5a96bf8b60","filename":"console/src/main/resources/org/apache/syncope/console/pages/panels/SelectedEventsPanel.html","status":"modified","additions":6,"deletions":5,"changes":11,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/8494fc73f911d4e3f18c8d00bc15a1f40ae06450/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FSelectedEventsPanel.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/8494fc73f911d4e3f18c8d00bc15a1f40ae06450/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FSelectedEventsPanel.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FSelectedEventsPanel.html?ref=8494fc73f911d4e3f18c8d00bc15a1f40ae06450","patch":"@@ -19,14 +19,15 @@\n <html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:wicket=\"http://wicket.apache.org\">\n   <wicket:head>\n     <style>\n-\n+      div#selectionContainer select{\n+        width: 585px;\n+        min-width: 585px;\n+      }\n     </style>\n   </wicket:head>\n   <wicket:panel>\n-    <div wicket:id=\"selectionContainer\">\n-      <div wicket:id=\"selectedEvents\">\n-        <label wicket:id=\"selectedEvent\"/>\n-      </div>\n+    <div id=\"selectionContainer\" wicket:id=\"selectionContainer\">\n+      <select wicket:id=\"selectedEvents\" ></select>\n     </div>\n   </wicket:panel>\n </html>"}]}