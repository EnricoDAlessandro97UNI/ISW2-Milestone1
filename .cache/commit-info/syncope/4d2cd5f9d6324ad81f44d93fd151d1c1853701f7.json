{"sha":"4d2cd5f9d6324ad81f44d93fd151d1c1853701f7","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjRkMmNkNWY5ZDYzMjRhZDgxZjQ0ZDkzZmQxNTFkMWMxODUzNzAxZjc=","commit":{"author":{"name":"Andrea Patricelli","email":"andrea.patricelli@tirasa.net","date":"2015-12-30T10:26:56Z"},"committer":{"name":"Andrea Patricelli","email":"andrea.patricelli@tirasa.net","date":"2015-12-30T10:26:56Z"},"message":"[SYNCOPE-719] aligned derived attibutes to admin console's","tree":{"sha":"4fb59672010e9f02c8120035518388ba68ff3608","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/4fb59672010e9f02c8120035518388ba68ff3608"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/comments","author":{"login":"andrea-patricelli","id":3763111,"node_id":"MDQ6VXNlcjM3NjMxMTE=","avatar_url":"https://avatars.githubusercontent.com/u/3763111?v=4","gravatar_id":"","url":"https://api.github.com/users/andrea-patricelli","html_url":"https://github.com/andrea-patricelli","followers_url":"https://api.github.com/users/andrea-patricelli/followers","following_url":"https://api.github.com/users/andrea-patricelli/following{/other_user}","gists_url":"https://api.github.com/users/andrea-patricelli/gists{/gist_id}","starred_url":"https://api.github.com/users/andrea-patricelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrea-patricelli/subscriptions","organizations_url":"https://api.github.com/users/andrea-patricelli/orgs","repos_url":"https://api.github.com/users/andrea-patricelli/repos","events_url":"https://api.github.com/users/andrea-patricelli/events{/privacy}","received_events_url":"https://api.github.com/users/andrea-patricelli/received_events","type":"User","site_admin":false},"committer":{"login":"andrea-patricelli","id":3763111,"node_id":"MDQ6VXNlcjM3NjMxMTE=","avatar_url":"https://avatars.githubusercontent.com/u/3763111?v=4","gravatar_id":"","url":"https://api.github.com/users/andrea-patricelli","html_url":"https://github.com/andrea-patricelli","followers_url":"https://api.github.com/users/andrea-patricelli/followers","following_url":"https://api.github.com/users/andrea-patricelli/following{/other_user}","gists_url":"https://api.github.com/users/andrea-patricelli/gists{/gist_id}","starred_url":"https://api.github.com/users/andrea-patricelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrea-patricelli/subscriptions","organizations_url":"https://api.github.com/users/andrea-patricelli/orgs","repos_url":"https://api.github.com/users/andrea-patricelli/repos","events_url":"https://api.github.com/users/andrea-patricelli/events{/privacy}","received_events_url":"https://api.github.com/users/andrea-patricelli/received_events","type":"User","site_admin":false},"parents":[{"sha":"cb1ac36d80e83f6d06eb44897e5c56dc3ec931b0","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/cb1ac36d80e83f6d06eb44897e5c56dc3ec931b0","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/cb1ac36d80e83f6d06eb44897e5c56dc3ec931b0"}],"stats":{"total":423,"additions":367,"deletions":56},"files":[{"sha":"8dd99616731412e9ddb9beaf33994ce71cda19ea","filename":"client/enduser/src/main/resources/META-INF/resources/app/index.html","status":"modified","additions":5,"deletions":3,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Findex.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Findex.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Findex.html?ref=4d2cd5f9d6324ad81f44d93fd151d1c1853701f7","patch":"@@ -69,7 +69,7 @@\n     <script src=\"../webjars/angular-cookies/${angular-cookies.version}/angular-cookies.js\"></script>\n     <script src=\"../webjars/angular-sanitize/${angular-sanitize.version}/angular-sanitize.js\"></script>\n     <script src=\"../webjars/angular-ui-bootstrap/${angular-ui-bootstrap.version}/ui-bootstrap-tpls.js\"></script>\n-    <script src=\"../webjars/angular-ui-select/${angular-ui-select.version}/select.js\"></script>\n+    <!--<script src=\"../webjars/angular-ui-select/${angular-ui-select.version}/select.js\"></script>-->\n     <script src=\"../webjars/angular-growl-2/${angular-growl-2.version}/angular-growl.js\"></script>\n     <script type=\"text/javascript\" src=\"../webjars/bootstrap-select/${bootstrap-select.version}/js/bootstrap-select.min.js\"></script>\n     <script src=\"../webjars/FileSaver.js/${FileSaver.version}/FileSaver.js\" type=\"text/javascript\"></script>\n@@ -89,7 +89,9 @@\n     <script src=\"js/controllers/LanguageController.js\"></script>\n     <script src=\"js/controllers/UserController.js\"></script>\n     <!--directives-->\n-    <script src=\"js/directives/dynamicAttribute.js\"></script>\n+    <script src=\"js/directives/dynamicPlainAttribute.js\"></script>\n+    <script src=\"js/directives/dynamicDerivedAttribute.js\"></script>\n+    <script src=\"js/directives/dynamicVirtualAttribute.js\"></script>\n     <script src=\"js/directives/dynamicPlainAttributes.js\"></script>\n     <script src=\"js/directives/dynamicDerivedAttributes.js\"></script>\n     <script src=\"js/directives/dynamicVirtualAttributes.js\"></script>\n@@ -110,7 +112,7 @@\n     <link href=\"../webjars/ionicons/${ionicons.version}/css/ionicons.min.css\" rel=\"stylesheet\" type=\"text/css\" />\n     <link href=\"../webjars/angular-ui-select/${angular-ui-select.version}/select.css\" rel=\"stylesheet\" type=\"text/css\"/>\n     <link href=\"../webjars/angular-growl-2/${angular-growl-2.version}/angular-growl.css\" rel=\"stylesheet\" type=\"text/css\"/>\n-    <link href=\"../webjars/select2/${select2.version}/select2.css\" rel=\"stylesheet\" />\n+    <!--<link href=\"../webjars/select2/${select2.version}/select2.css\" rel=\"stylesheet\" />-->\n     <link href=\"css/app.css\" rel=\"stylesheet\" type=\"text/css\" />\n     <link href=\"css/login.css\" rel=\"stylesheet\" type=\"text/css\" />\n     <link href=\"css/editUser.css\" rel=\"stylesheet\" type=\"text/css\" />"},{"sha":"4253e113484b33cf8ba79b2907542c09811c7232","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/app.js","status":"modified","additions":13,"deletions":15,"changes":28,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fapp.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fapp.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fapp.js?ref=4d2cd5f9d6324ad81f44d93fd151d1c1853701f7","patch":"@@ -29,7 +29,7 @@ angular.module('info', []);\n var app = angular.module('SyncopeEnduserApp', [\n   'ui.router',\n   'ui.bootstrap',\n-  'ui.select',\n+//  'ui.select',\n   'ngSanitize',\n   'ngAnimate',\n   'ngResource',\n@@ -83,15 +83,14 @@ app.config(['$stateProvider', '$urlRouterProvider', '$httpProvider', 'growlProvi\n               url: '/plainSchemas',\n               templateUrl: 'views/user-plain-schemas.html'\n             })\n-            /*.state('create.derivedSchemas', {\n-              url: '/derivedSchemas',\n-              templateUrl: 'views/user-derived-schemas.html'\n-            })\n-            .state('create.virtualSchemas', {\n-              url: '/virtualSchemas',\n-              templateUrl: 'views/user-virtual-schemas.html'\n-            })*/\n-            // url will be /self/create/schema\n+            .state('create.derivedSchemas', {\n+             url: '/derivedSchemas',\n+             templateUrl: 'views/user-derived-schemas.html'\n+             })\n+             .state('create.virtualSchemas', {\n+             url: '/virtualSchemas',\n+             templateUrl: 'views/user-virtual-schemas.html'\n+             })\n             .state('create.resources', {\n               url: '/resources',\n               templateUrl: 'views/user-resources.html'\n@@ -111,7 +110,7 @@ app.config(['$stateProvider', '$urlRouterProvider', '$httpProvider', 'growlProvi\n             })\n             // nested states \n             // each of these sections will have their own view\n-            // url will be nested (/self/create)\n+            // url will be nested (/self/update)\n             .state('update.credentials', {\n               url: '/credentials',\n               templateUrl: 'views/user-credentials.html',\n@@ -130,7 +129,7 @@ app.config(['$stateProvider', '$urlRouterProvider', '$httpProvider', 'growlProvi\n                 }\n               }\n             })\n-            /*.state('update.derivedSchemas', {\n+            .state('update.derivedSchemas', {\n               url: '/derivedSchemas',\n               templateUrl: 'views/user-derived-schemas.html',\n               resolve: {\n@@ -147,8 +146,7 @@ app.config(['$stateProvider', '$urlRouterProvider', '$httpProvider', 'growlProvi\n                   return AuthenticationHelper.authenticated();\n                 }\n               }\n-            })*/\n-            // url will be /self/create/schema\n+            })\n             .state('update.groups', {\n               url: '/groups',\n               templateUrl: 'views/user-groups.html',\n@@ -228,7 +226,7 @@ app.config(['$stateProvider', '$urlRouterProvider', '$httpProvider', 'growlProvi\n         }\n       };\n     });\n-    \n+\n     growlProvider.globalTimeToLive(10000);\n     growlProvider.globalPosition('bottom-left');\n     growlProvider.globalInlineMessages(true);"},{"sha":"6bf7cb61f0f3f947577ffe6fbcfdee51684de6f4","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/controllers/UserController.js","status":"modified","additions":35,"deletions":11,"changes":46,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js?ref=4d2cd5f9d6324ad81f44d93fd151d1c1853701f7","patch":"@@ -45,8 +45,8 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n         plainSchemas: [],\n         derSchemas: [],\n         virSchemas: [],\n-        selectedDerSchemas: [],\n-        selectedVirSchemas: [],\n+//        selectedDerSchemas: [],\n+//        selectedVirSchemas: [],\n         errorMessage: '',\n         attributeTable: {}\n       };\n@@ -96,8 +96,14 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n \n             var derSchemaKey = schemas.derSchemas[i].key;\n \n-            if ($scope.user.derAttrs[derSchemaKey]) {\n-              $scope.dynamicForm.selectedDerSchemas.push(schemas.derSchemas[i]);\n+            if (!$scope.user.derAttrs[derSchemaKey]) {\n+\n+              $scope.user.derAttrs[derSchemaKey] = {\n+                schema: derSchemaKey,\n+                values: [],\n+                readonly: true\n+              };\n+\n             }\n           }\n \n@@ -106,8 +112,31 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n \n             var virSchemaKey = schemas.virSchemas[i].key;\n \n-            if ($scope.user.virAttrs[virSchemaKey]) {\n-              $scope.dynamicForm.selectedVirSchemas.push(schemas.virSchemas[i]);\n+            if (!$scope.user.virAttrs[virSchemaKey]) {\n+\n+              $scope.user.virAttrs[virSchemaKey] = {\n+                schema: virSchemaKey,\n+                values: [],\n+                readonly: schemas.virSchemas[i].readonly\n+              };\n+\n+              // initialize multivalue schema and support table: create mode, only first value\n+//              if (schemas.plainSchemas[i].multivalue) {\n+//                $scope.dynamicForm.attributeTable[schemas.plainSchemas[i].key] = {\n+//                  fields: [schemas.plainSchemas[i].key + \"_\" + 0]\n+//                };\n+//              }\n+            } else {\n+              // initialize multivalue schema and support table: update mode, all provided values\n+//              if (schemas.virSchemas[i].multivalue) {\n+//                $scope.dynamicForm.attributeTable[schemas.virSchemas[i].key] = {\n+//                  fields: [schemas.virSchemas[i].key + \"_\" + 0]\n+//                };\n+//                // add other values\n+//                for (var j = 1; j < $scope.user.plainAttrs[plainSchemaKey].values.length; j++) {\n+//                  $scope.dynamicForm.attributeTable[schemas.plainSchemas[i].key].fields.push(schemas.plainSchemas[i].key + \"_\" + j);\n+//                }\n+//              }\n             }\n           }\n \n@@ -174,15 +203,10 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n         initUserRealm();\n \n       } else {\n-\n         // read user from syncope core\n         readUser();\n-        // read user security question\n-\n       }\n \n-\n-\n       initRealms();\n       //retrieve security available questions\n       initSecurityQuestions();"},{"sha":"ff3f4e39586dcd0d8afa586c878e7e0aac32e49d","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/directives/dynamicDerivedAttribute.js","status":"added","additions":43,"deletions":0,"changes":43,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FdynamicDerivedAttribute.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FdynamicDerivedAttribute.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FdynamicDerivedAttribute.js?ref=4d2cd5f9d6324ad81f44d93fd151d1c1853701f7","patch":"@@ -0,0 +1,43 @@\n+/* \n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+'use strict';\n+\n+angular.module('self')\n+        .directive('dynamicDerivedAttribute', function ($filter) {\n+          return {\n+            restrict: 'E',\n+            templateUrl: 'views/dynamicDerivedAttribute.html',\n+            scope: {\n+              schema: \"=\",\n+              index: \"=\",\n+              user: \"=\"\n+            },\n+            controller: function ($scope, $element, $window) {\n+              $scope.$watch(function () {\n+                return $scope.user.derAttrs[$scope.schema.key].values[$scope.index];\n+              }, function (newValue, oldValue) {\n+                $scope.user.derAttrs[$scope.schema.key].values = $scope.user.derAttrs[$scope.schema.key].values\n+                        .filter(function (n) {\n+                          return (n !== undefined && n !== \"\");\n+                        });\n+              });\n+            },\n+            replace: true\n+          };\n+        });"},{"sha":"d2a018782a645658c30e8b17a61631e41ad678c5","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/directives/dynamicDerivedAttributes.js","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FdynamicDerivedAttributes.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FdynamicDerivedAttributes.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FdynamicDerivedAttributes.js?ref=4d2cd5f9d6324ad81f44d93fd151d1c1853701f7","patch":"@@ -44,7 +44,7 @@ angular.module('self')\n                 var derSchemaKey = item.key;\n                 console.log(\"REMOVING DERIVED item: \", derSchemaKey);\n                 delete $scope.user.derAttrs[derSchemaKey];\n-                \n+\n               };\n \n             }"},{"sha":"18dff974e59b80a76bdf480a99ee65f6fb8f7b8b","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/directives/dynamicPlainAttribute.js","status":"added","additions":198,"deletions":0,"changes":198,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FdynamicPlainAttribute.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FdynamicPlainAttribute.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FdynamicPlainAttribute.js?ref=4d2cd5f9d6324ad81f44d93fd151d1c1853701f7","patch":"@@ -0,0 +1,198 @@\n+/* \n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+'use strict';\n+\n+angular.module('self')\n+        .directive('dynamicPlainAttribute', function ($filter) {\n+          return {\n+            restrict: 'E',\n+            templateUrl: 'views/dynamicPlainAttribute.html',\n+            scope: {\n+              schema: \"=\",\n+              index: \"=\",\n+              user: \"=\"\n+            },\n+            controller: function ($scope, $element, $window) {\n+              $scope.initAttribute = function (schema, index) {\n+\n+                switch (schema.type) {\n+                  case \"Long\":\n+                  case \"Double\":\n+                    $scope.user.plainAttrs[schema.key].values[index] = Number($scope.user.plainAttrs[schema.key].values[index])\n+                            || undefined;\n+                    break;\n+                  case \"Enum\":\n+                    $scope.enumerationValues = [];\n+                    var enumerationValuesSplitted = schema.enumerationValues.toString().split(\";\");\n+                    for (var i = 0; i < enumerationValuesSplitted.length; i++) {\n+                      $scope.enumerationValues.push(enumerationValuesSplitted[i]);\n+                    }\n+                    $scope.user.plainAttrs[schema.key].values[index] = $scope.user.plainAttrs[schema.key].values[index]\n+                            || $scope.enumerationValues[0];\n+                    break;\n+                  case \"Binary\":\n+\n+                    $scope.userFile = $scope.userFile || '';\n+                    //for multivalue fields \n+//                    $scope.fileInputId = \"fileInputId_\" + index;\n+\n+                    $element.bind(\"change\", function (changeEvent) {\n+                      $scope.$apply(function () {\n+                        var reader = new FileReader();\n+                        var file = changeEvent.target.files[0];\n+                        $scope.userFile = file.name;\n+                        reader.onload = function (readerEvt) {\n+                          var binaryString = readerEvt.target.result;\n+                          $scope.user.plainAttrs[schema.key].values[index] = btoa(binaryString);\n+                        };\n+                        reader.readAsBinaryString(file);\n+                      });\n+                    });\n+\n+                    $scope.download = function () {\n+                      var byteString = atob($scope.user.plainAttrs[schema.key].values[index]);\n+\n+                      var ab = new ArrayBuffer(byteString.length);\n+                      var ia = new Uint8Array(ab);\n+                      for (var i = 0; i < byteString.length; i++) {\n+                        ia[i] = byteString.charCodeAt(i);\n+                      }\n+\n+                      var blob = new Blob([ia], {type: schema.mimeType});\n+\n+                      saveAs(blob, schema.key);\n+                    };\n+                    $scope.remove = function () {\n+                      $scope.user.plainAttrs[schema.key].values.splice(index, 1);\n+                      $scope.userFile = '';\n+                      $(\"#fileInput\").replaceWith($(\"#fileInput\").clone(true));\n+                    };\n+                    break;\n+                  case \"Date\":\n+\n+                    $scope.selectedDate = $scope.user.plainAttrs[schema.key].values[index];\n+                    $scope.format = $scope.schema.conversionPattern;\n+                    $scope.includeTimezone = false;\n+                    if ($scope.schema.conversionPattern.indexOf(\".SSS\") > -1) {\n+                      $scope.format = $scope.format.replace(\".SSS\", \".sss\");\n+                    }\n+                    if ($scope.schema.conversionPattern.indexOf(\"Z\") > -1) {\n+                      $scope.includeTimezone = true;\n+                      $scope.format = $scope.format.replace(\"Z\", \"\");\n+                    }\n+                    if ($scope.schema.conversionPattern.indexOf(\"\\'\") > -1) {\n+                      $scope.format = $scope.format.replace(new RegExp(\"\\'\", \"g\"), \"\");\n+                    }\n+\n+                    $scope.bindDateToModel = function (selectedDate, format) {\n+                      var newFormat = $scope.includeTimezone ? format.concat(\" Z\") : format;\n+                      if (selectedDate) {\n+                        selectedDate = $filter('date')(selectedDate, newFormat);\n+                        var dateGood = selectedDate.toString();\n+                        $scope.user.plainAttrs[schema.key].values[index] = dateGood;\n+                      } else {\n+                        $scope.user.plainAttrs[schema.key].values[index] = selectedDate;\n+                      }\n+                    };\n+\n+                    $scope.clear = function () {\n+                      $scope.user.plainAttrs[schema.key].values[index] = null;\n+                    };\n+\n+                    // Disable weekend selection\n+                    $scope.disabled = function (date, mode) {\n+                      // example if you want to disable weekends\n+                      // return (mode === 'day' && (date.getDay() === 0 || date.getDay() === 6));\n+                      return false;\n+                    };\n+\n+                    $scope.toggleMin = function () {\n+                      $scope.minDate = $scope.minDate ? null : new Date();\n+                    };\n+\n+                    $scope.maxDate = new Date(2050, 5, 22);\n+\n+                    $scope.open = function ($event) {\n+                      $scope.status.opened = true;\n+                    };\n+\n+                    $scope.setDate = function (year, month, day) {\n+                      $scope.user.plainAttrs[schema.key].values[index] = new Date(year, month, day);\n+                    };\n+\n+                    $scope.dateOptions = {\n+                      startingDay: 1\n+                    };\n+\n+                    $scope.status = {\n+                      opened: false\n+                    };\n+\n+                    var tomorrow = new Date();\n+                    tomorrow.setDate(tomorrow.getDate() + 1);\n+                    var afterTomorrow = new Date();\n+                    afterTomorrow.setDate(tomorrow.getDate() + 2);\n+                    $scope.events =\n+                            [\n+                              {\n+                                date: tomorrow,\n+                                status: 'full'\n+                              },\n+                              {\n+                                date: afterTomorrow,\n+                                status: 'partially'\n+                              }\n+                            ];\n+\n+                    $scope.getDayClass = function (date, mode) {\n+                      if (mode === 'day') {\n+                        var dayToCheck = new Date(date).setHours(0, 0, 0, 0);\n+\n+                        for (var i = 0; i < $scope.events.length; i++) {\n+                          var currentDay = new Date($scope.events[i].date).setHours(0, 0, 0, 0);\n+\n+                          if (dayToCheck === currentDay) {\n+                            return $scope.events[i].status;\n+                          }\n+                        }\n+                      }\n+\n+                    };\n+                    break;\n+\n+                  case \"Boolean\":\n+                    $scope.user.plainAttrs[schema.key].values[index] =\n+                            Boolean($scope.user.plainAttrs[schema.key].values[index]) || false;\n+                    break;\n+\n+                }\n+              };\n+\n+              $scope.$watch(function () {\n+                return $scope.user.plainAttrs[$scope.schema.key].values[$scope.index];\n+              }, function (newValue, oldValue) {\n+                $scope.user.plainAttrs[$scope.schema.key].values = $scope.user.plainAttrs[$scope.schema.key].values\n+                        .filter(function (n) {\n+                          return (n !== undefined && n !== \"\");\n+                        });\n+              });\n+            },\n+            replace: true\n+          };\n+        });"},{"sha":"5ee0d110c8d342e67c2648c88589982083501822","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/directives/dynamicVirtualAttribute.js","status":"renamed","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FdynamicVirtualAttribute.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FdynamicVirtualAttribute.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FdynamicVirtualAttribute.js?ref=4d2cd5f9d6324ad81f44d93fd151d1c1853701f7","patch":"@@ -22,7 +22,7 @@ angular.module('self')\n         .directive('dynamicAttribute', function ($filter) {\n           return {\n             restrict: 'E',\n-            templateUrl: 'views/dynamicAttribute.html',\n+            templateUrl: 'views/dynamicPlainAttribute.html',\n             scope: {\n               schema: \"=\",\n               index: \"=\",","previous_filename":"client/enduser/src/main/resources/META-INF/resources/app/js/directives/dynamicAttribute.js"},{"sha":"f0d325bfceef261576ed384a2d78b9f4f2d2f16c","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/dynamicDerivedAttribute.html","status":"added","additions":5,"deletions":0,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicDerivedAttribute.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicDerivedAttribute.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicDerivedAttribute.html?ref=4d2cd5f9d6324ad81f44d93fd151d1c1853701f7","patch":"@@ -0,0 +1,5 @@\n+<div>\n+  <input class=\"form-control\" type=\"text\"\n+         ng-model=\"user.derAttrs[schema.key].values[index]\"\n+         ng-disabled=\"true\"/>\n+</div>\n\\ No newline at end of file"},{"sha":"5807553e5a3f8de272346308407d3ca7b412ef11","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/dynamicDerivedAttributes.html","status":"modified","additions":4,"deletions":21,"changes":25,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicDerivedAttributes.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicDerivedAttributes.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicDerivedAttributes.html?ref=4d2cd5f9d6324ad81f44d93fd151d1c1853701f7","patch":"@@ -1,21 +1,4 @@\n-<ui-select on-select=\"addDerivedAttribute($item, $model)\" on-remove=\"removeDerivedAttribute($item, $model)\" multiple\n-           ng-model=\"dynamicForm.selectedDerSchemas\" theme=\"select2\" class=\"attribute-ui-select\">\n-  <ui-select-match placeholder=\"Select derived attribute...\">{{$item.key}}</ui-select-match>\n-  <ui-select-choices repeat=\"derSchema in dynamicForm.derSchemas | propsFilter: {key: $select.search}\">\n-    <div ng-bind-html=\"derSchema.key | highlight: $select.search\"></div>\n-    <small>\n-      name: {{derSchema.key}}\n-      expression: {{derSchema.expression}}\n-    </small>\n-  </ui-select-choices>\n-</ui-select>\n-\n-<ul class=\"attribute-virtual-value-container\">\n-  <li class=\"attribute-virtual-value-field\" ng-repeat=\"selectedDerSchema in dynamicForm.selectedDerSchemas| filter:q as results\">\n-    {{selectedDerSchema.key}}\n-    <input style=\"font-weight: normal\" class=\"form-control\" type=\"text\" ng-disabled=\"true\" ng-model=\"user.derAttrs[selectedDerSchema.key].values[0]\"/>\n-  </li>\n-  <li class=\"attribute-virtual-value-field\" ng-if=\"results.length == 0\">\n-    <strong>No derived attributes selected...</strong>\n-  </li>\n-</ul>\n+<div id=\"attribute\" class=\"form-group\" ng-repeat=\"derSchema in dynamicForm.derSchemas\">\n+  <label for=\"derivedSchema.key\">{{derSchema.key}} <span ng-if=\"Boolean(derSchema.mandatoryCondition) === 'true'\">*</span></label>\n+  <dynamic-derived-attribute schema=\"derSchema\" user=\"user\" index=\"0\"></dynamic-derived-attribute>\n+</div>"},{"sha":"9c6b1d9dd5daa054dbe302b1d9ea40c89735e172","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/dynamicPlainAttribute.html","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicPlainAttribute.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicPlainAttribute.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicPlainAttribute.html?ref=4d2cd5f9d6324ad81f44d93fd151d1c1853701f7","previous_filename":"client/enduser/src/main/resources/META-INF/resources/app/views/dynamicAttribute.html"},{"sha":"f7759b76ffaa0d58fff43f3b6a5db0b28876f15d","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/dynamicPlainAttributes.html","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicPlainAttributes.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicPlainAttributes.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicPlainAttributes.html?ref=4d2cd5f9d6324ad81f44d93fd151d1c1853701f7","patch":"@@ -1,12 +1,12 @@\n <div id=\"attribute\" class=\"form-group\" ng-repeat=\"plainSchema in dynamicForm.plainSchemas\">\n   <label for=\"plainSchema.key\">{{plainSchema.key}} <span ng-if=\"Boolean(plainSchema.mandatoryCondition)\">*</span></label>\n   <div ng-if=\"!plainSchema.multivalue\">\n-    <dynamic-attribute schema=\"plainSchema\" user=\"user\" index=\"0\"></dynamic-attribute>\n+    <dynamic-plain-attribute schema=\"plainSchema\" user=\"user\" index=\"0\"></dynamic-plain-attribute>\n   </div>\n \n   <div ng-if=\"plainSchema.multivalue\">\n     <div ng-repeat=\"field in dynamicForm.attributeTable[plainSchema.key].fields track by $index\" ng-model='dynamicForm.attributeTable[plainSchema.key].fields[$index]'>\n-      <dynamic-attribute schema=\"plainSchema\" user=\"user\" index=\"$index\"></dynamic-attribute>\n+      <dynamic-plain-attribute schema=\"plainSchema\" user=\"user\" index=\"$index\"></dynamic-plain-attribute>\n       <span>\n         <button class=\"btn btn-default btn-sm minus\" ng-if=\"$index > 0\" type=\"button\" ng-click=\"removeAttributeField(plainSchema.key, $index)\">\n           <i class=\"glyphicon glyphicon-minus\" title=\"Remove value\"></i>"},{"sha":"9c6b1d9dd5daa054dbe302b1d9ea40c89735e172","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/dynamicVirtualAttribute.html","status":"added","additions":58,"deletions":0,"changes":58,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicVirtualAttribute.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicVirtualAttribute.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FdynamicVirtualAttribute.html?ref=4d2cd5f9d6324ad81f44d93fd151d1c1853701f7","patch":"@@ -0,0 +1,58 @@\n+<div ng-switch=\"schema.type\" >\n+  <input ng-switch-when=\"String\" class=\"form-control\" type=\"text\"\n+         ng-model=\"user.plainAttrs[schema.key].values[index]\"\n+         ng-required=\"schema.mandatoryCondition\" \n+         ng-disabled=\"schema.readonly\" ng-init=\"initAttribute(schema, index)\"/>\n+  <input ng-switch-when=\"Encrypted\" class=\"form-control\" type=\"text\"\n+         ng-model=\"user.plainAttrs[schema.key].values[index]\"\n+         ng-required=\"schema.mandatoryCondition\" \n+         ng-disabled=\"schema.readonly\" ng-init=\"initAttribute(schema, index)\"/>\n+  <div ng-switch-when=\"Boolean\">\n+    <input type=\"checkbox\" ng-model=\"user.plainAttrs[schema.key].values[index]\" ng-required=\"schema.mandatoryCondition\" \n+           ng-init=\"initAttribute(schema, index)\" />\n+  </div>\n+  <input ng-switch-when=\"Long\" class=\"form-control\" type=\"number\" ng-model=\"user.plainAttrs[schema.key].values[index]\" ng-required=\"schema.mandatoryCondition\"\n+         ng-init=\"initAttribute(schema, index)\" />\n+  <input ng-switch-when=\"Double\" class=\"form-control\" type=\"number\" ng-model=\"user.plainAttrs[schema.key].values[index]\" ng-required=\"schema.mandatoryCondition\"\n+         ng-init=\"initAttribute(schema, index)\" />\n+  <p ng-switch-when=\"Date\" class=\"input-group\" >\n+    <input type=\"text\" class=\"form-control\" \n+           uib-datepicker-popup=\"{{format}}\"\n+           ng-model=\"selectedDate\"\n+           ng-change=\"bindDateToModel(selectedDate, format)\"\n+           min-date=\"minDate\" max-date=\"maxDate\"\n+           is-open=\"status.opened\" datepicker-options=\"dateOptions\"\n+           ng-required=\"schema.mandatoryCondition\" close-text=\"Close\" ng-init=\"initAttribute(schema, index)\"/>\n+    <span class=\"input-group-btn\">\n+      <button type=\"button\" class=\"btn btn-default\" ng-click=\"open($event)\"><i class=\"glyphicon glyphicon-calendar\"></i></button>\n+    </span>\n+  </p>\n+\n+  <div ng-switch-when=\"Enum\" ng-init=\"initAttribute(schema, index)\">\n+    <select class=\"form-control\"\n+            ng-model=\"user.plainAttrs[schema.key].values[index]\"\n+            ng-required=\"schema.mandatoryCondition\">\n+      <option ng-repeat=\"value in enumerationValues\" value=\"{{value}}\">{{schema.enumerationKeys[$index] || value}}</option>\n+    </select>\n+  </div>\n+\n+  <div ng-switch-when=\"Binary\" ng-init=\"initAttribute(schema, index)\">\n+    <div enctype=\"multipart/form-data\" accept-charset=\"UTF-8\">\n+      <input id=\"fileInput\" type=\"file\" ng-required=\"schema.mandatoryCondition\"/>\n+      <button type=\"button\" title=\"Download file\" class=\"fileButton btn btn-default btn-sm\" ng-click=\"download()\">\n+        <i class=\"glyphicon glyphicon-download\" ></i>\n+      </button>\n+      <button type=\"button\" class=\"fileButton btn btn-default btn-sm\" title=\"Remove file\" ng-click=\"remove()\">\n+        <i class=\"glyphicon glyphicon-remove-sign\" ></i>\n+      </button>\n+      <h4><span class=\"label label-primary\" ng-model=\"userFile\">{{userFile}}</span></h4>\n+    </div>\n+    \n+  </div>\n+\n+  <input ng-switch-default class=\"form-control\" type=\"text\"\n+         ng-model=\"user.plainAttrs[schema.key].values[index]\"\n+         ng-required=\"schema.mandatoryCondition\" \n+         ng-disabled=\"schema.readonly\" ng-init=\"initAttribute(schema, index)\"/>\n+\n+</div>"},{"sha":"13d50a42ab1f7d3fda930782f1fc45384860cbca","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/editUser.html","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FeditUser.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4d2cd5f9d6324ad81f44d93fd151d1c1853701f7/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FeditUser.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2FeditUser.html?ref=4d2cd5f9d6324ad81f44d93fd151d1c1853701f7","patch":"@@ -40,8 +40,8 @@\n               <a ui-sref-active=\"active\" ui-sref=\".credentials\" class=\"btn btn-default\">Credentials</a>\n               <a ui-sref-active=\"active\" ui-sref=\".groups\" class=\"btn btn-default\">Groups</a>\n               <a ui-sref-active=\"active\" ui-sref=\".plainSchemas\" class=\"btn btn-default\">Plain Schemas</a>\n-              <!--<a ui-sref-active=\"active\" ui-sref=\".derivedSchemas\" class=\"btn btn-default\">Derived Schemas</a>\n-              <a ui-sref-active=\"active\" ui-sref=\".virtualSchemas\" class=\"btn btn-default\">Virtual Schemas</a>-->              \n+              <a ui-sref-active=\"active\" ui-sref=\".derivedSchemas\" class=\"btn btn-default\">Derived Schemas</a>\n+              <a ui-sref-active=\"active\" ui-sref=\".virtualSchemas\" class=\"btn btn-default\">Virtual Schemas</a>              \n               <a ui-sref-active=\"active\" ui-sref=\".resources\" class=\"btn btn-default\">Resources</a>\n               <a ui-sref-active=\"active\" ui-sref=\".finish\" class=\"btn btn-default\">Finish</a>\n             </div>"}]}