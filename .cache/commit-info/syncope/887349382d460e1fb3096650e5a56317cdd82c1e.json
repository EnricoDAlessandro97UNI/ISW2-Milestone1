{"sha":"887349382d460e1fb3096650e5a56317cdd82c1e","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjg4NzM0OTM4MmQ0NjBlMWZiMzA5NjY1MGU1YTU2MzE3Y2RkODJjMWU=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2018-10-05T14:22:31Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2018-10-05T14:24:00Z"},"message":"[SYNCOPE-1376] Use absolute path but no protocol, host or port","tree":{"sha":"58d9d246ac0aa868c9040bac727a1215b2198ccd","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/58d9d246ac0aa868c9040bac727a1215b2198ccd"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/887349382d460e1fb3096650e5a56317cdd82c1e","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/887349382d460e1fb3096650e5a56317cdd82c1e","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/887349382d460e1fb3096650e5a56317cdd82c1e","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/887349382d460e1fb3096650e5a56317cdd82c1e/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"c448befbcf37f52bd1a1bd6849bc1503b99b3a7e","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/c448befbcf37f52bd1a1bd6849bc1503b99b3a7e","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/c448befbcf37f52bd1a1bd6849bc1503b99b3a7e"}],"stats":{"total":21,"additions":19,"deletions":2},"files":[{"sha":"69adcbb0683335eb04f3430236eb34879bd99901","filename":"core/rest-cxf/src/main/java/org/apache/syncope/core/rest/cxf/SyncopeOpenApiCustomizer.java","status":"modified","additions":17,"deletions":0,"changes":17,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/887349382d460e1fb3096650e5a56317cdd82c1e/core%2Frest-cxf%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2Fcxf%2FSyncopeOpenApiCustomizer.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/887349382d460e1fb3096650e5a56317cdd82c1e/core%2Frest-cxf%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2Fcxf%2FSyncopeOpenApiCustomizer.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Frest-cxf%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2Fcxf%2FSyncopeOpenApiCustomizer.java?ref=887349382d460e1fb3096650e5a56317cdd82c1e","patch":"@@ -19,6 +19,7 @@\n package org.apache.syncope.core.rest.cxf;\n \n import io.swagger.v3.jaxrs2.Reader;\n+import io.swagger.v3.oas.integration.api.OpenAPIConfiguration;\n import io.swagger.v3.oas.models.OpenAPI;\n import io.swagger.v3.oas.models.Operation;\n import io.swagger.v3.oas.models.PathItem;\n@@ -30,6 +31,7 @@\n import io.swagger.v3.oas.models.parameters.Parameter;\n import io.swagger.v3.oas.models.responses.ApiResponse;\n import io.swagger.v3.oas.models.responses.ApiResponses;\n+import io.swagger.v3.oas.models.servers.Server;\n import io.swagger.v3.oas.models.tags.Tag;\n import java.net.URL;\n import java.util.ArrayList;\n@@ -41,10 +43,12 @@\n import java.util.Optional;\n import org.apache.commons.lang3.StringUtils;\n import org.apache.commons.lang3.tuple.Pair;\n+import org.apache.cxf.jaxrs.ext.MessageContext;\n import org.apache.cxf.jaxrs.model.ClassResourceInfo;\n import org.apache.cxf.jaxrs.model.OperationResourceInfo;\n import org.apache.cxf.jaxrs.model.doc.JavaDocProvider;\n import org.apache.cxf.jaxrs.openapi.OpenApiCustomizer;\n+import org.apache.cxf.jaxrs.utils.JAXRSUtils;\n import org.apache.syncope.common.lib.SyncopeConstants;\n import org.apache.syncope.common.lib.to.ErrorTO;\n import org.apache.syncope.common.rest.api.RESTHeaders;\n@@ -89,6 +93,19 @@ public void setClassResourceInfos(final List<ClassResourceInfo> classResourceInf\n         super.setClassResourceInfos(classResourceInfos);\n     }\n \n+    @Override\n+    public OpenAPIConfiguration customize(final OpenAPIConfiguration configuration) {\n+        super.customize(configuration);\n+\n+        MessageContext ctx = JAXRSUtils.createContextValue(\n+                JAXRSUtils.getCurrentMessage(), null, MessageContext.class);\n+\n+        String url = StringUtils.substringBeforeLast(ctx.getUriInfo().getRequestUri().getRawPath(), \"/\");\n+        configuration.getOpenAPI().setServers(Collections.singletonList(new Server().url(url)));\n+\n+        return configuration;\n+    }\n+\n     @Override\n     public void customize(final OpenAPI oas) {\n         // remove this method with CXF 3.2.7"},{"sha":"b611a9bc4add154e0e25aac77bee00dddd692966","filename":"core/rest-cxf/src/main/resources/restCXFContext.xml","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/887349382d460e1fb3096650e5a56317cdd82c1e/core%2Frest-cxf%2Fsrc%2Fmain%2Fresources%2FrestCXFContext.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/887349382d460e1fb3096650e5a56317cdd82c1e/core%2Frest-cxf%2Fsrc%2Fmain%2Fresources%2FrestCXFContext.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Frest-cxf%2Fsrc%2Fmain%2Fresources%2FrestCXFContext.xml?ref=887349382d460e1fb3096650e5a56317cdd82c1e","patch":"@@ -115,7 +115,7 @@ under the License.\n     <property name=\"bearerFormat\" value=\"JWT\"/>\n   </bean>\n   <bean id=\"openApiCustomizer\" class=\"org.apache.syncope.core.rest.cxf.SyncopeOpenApiCustomizer\">\n-    <property name=\"dynamicBasePath\" value=\"true\"/>\n+    <property name=\"dynamicBasePath\" value=\"false\"/>\n     <property name=\"replaceTags\" value=\"false\"/>\n   </bean>\n   <bean id=\"openapiFeature\" class=\"org.apache.cxf.jaxrs.openapi.OpenApiFeature\">"},{"sha":"044f926072468ac72ed02232c4c60750335e6237","filename":"fit/core-reference/src/main/resources/jboss/restCXFContext.xml","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/887349382d460e1fb3096650e5a56317cdd82c1e/fit%2Fcore-reference%2Fsrc%2Fmain%2Fresources%2Fjboss%2FrestCXFContext.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/887349382d460e1fb3096650e5a56317cdd82c1e/fit%2Fcore-reference%2Fsrc%2Fmain%2Fresources%2Fjboss%2FrestCXFContext.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fcore-reference%2Fsrc%2Fmain%2Fresources%2Fjboss%2FrestCXFContext.xml?ref=887349382d460e1fb3096650e5a56317cdd82c1e","patch":"@@ -122,7 +122,7 @@ under the License.\n     <property name=\"bearerFormat\" value=\"JWT\"/>\n   </bean>\n   <bean id=\"openApiCustomizer\" class=\"org.apache.syncope.core.rest.cxf.SyncopeOpenApiCustomizer\">\n-    <property name=\"dynamicBasePath\" value=\"true\"/>\n+    <property name=\"dynamicBasePath\" value=\"false\"/>\n     <property name=\"replaceTags\" value=\"false\"/>\n     <property name=\"javaDocPaths\">\n       <list>"}]}