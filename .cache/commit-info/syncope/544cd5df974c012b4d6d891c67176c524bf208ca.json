{"sha":"544cd5df974c012b4d6d891c67176c524bf208ca","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjU0NGNkNWRmOTc0YzAxMmI0ZDZkODkxYzY3MTc2YzUyNGJmMjA4Y2E=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2019-03-12T14:11:07Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2019-03-12T14:29:12Z"},"message":"[SYNCOPE-1449] if single value, bind to value; if multi-value bind to list of values","tree":{"sha":"2b3fa7bacac1768339e5cfb305566925b31559a9","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/2b3fa7bacac1768339e5cfb305566925b31559a9"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/544cd5df974c012b4d6d891c67176c524bf208ca","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/544cd5df974c012b4d6d891c67176c524bf208ca","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/544cd5df974c012b4d6d891c67176c524bf208ca","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/544cd5df974c012b4d6d891c67176c524bf208ca/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"b723ee53ebeeabd4e510ff7593b87cf167e5aaf9","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/b723ee53ebeeabd4e510ff7593b87cf167e5aaf9","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/b723ee53ebeeabd4e510ff7593b87cf167e5aaf9"}],"stats":{"total":20,"additions":12,"deletions":8},"files":[{"sha":"413f30cc51ec141ecdaca9ebf1abcaa9d8f8806b","filename":"core/provisioning-java/src/main/java/org/apache/syncope/core/provisioning/java/jexl/JexlUtils.java","status":"modified","additions":12,"deletions":8,"changes":20,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/544cd5df974c012b4d6d891c67176c524bf208ca/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fjexl%2FJexlUtils.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/544cd5df974c012b4d6d891c67176c524bf208ca/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fjexl%2FJexlUtils.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fjexl%2FJexlUtils.java?ref=544cd5df974c012b4d6d891c67176c524bf208ca","patch":"@@ -198,13 +198,15 @@ public static void addFieldsToContext(final Object object, final JexlContext jex\n \n     public static void addAttrsToContext(final Collection<Attr> attrs, final JexlContext jexlContext) {\n         attrs.stream().filter(attr -> attr.getSchema() != null).forEach(attr -> {\n-            String expressionValue = attr.getValues().isEmpty()\n+            Object value = attr.getValues().isEmpty()\n                     ? StringUtils.EMPTY\n-                    : attr.getValues().get(0);\n+                    : attr.getValues().size() == 1\n+                    ? attr.getValues().get(0)\n+                    : attr.getValues();\n \n-            LOG.debug(\"Add attribute {} with value {}\", attr.getSchema(), expressionValue);\n+            LOG.debug(\"Add attribute {} with value {}\", attr.getSchema(), value);\n \n-            jexlContext.set(attr.getSchema(), expressionValue);\n+            jexlContext.set(attr.getSchema(), value);\n         });\n     }\n \n@@ -213,13 +215,15 @@ public static void addPlainAttrsToContext(\n \n         attrs.stream().filter(attr -> attr.getSchema() != null).forEach(attr -> {\n             List<String> attrValues = attr.getValuesAsStrings();\n-            String expressionValue = attrValues.isEmpty()\n+            Object value = attrValues.isEmpty()\n                     ? StringUtils.EMPTY\n-                    : attrValues.get(0);\n+                    : attrValues.size() == 1\n+                    ? attrValues.get(0)\n+                    : attrValues;\n \n-            LOG.debug(\"Add attribute {} with value {}\", attr.getSchema().getKey(), expressionValue);\n+            LOG.debug(\"Add attribute {} with value {}\", attr.getSchema().getKey(), value);\n \n-            jexlContext.set(attr.getSchema().getKey(), expressionValue);\n+            jexlContext.set(attr.getSchema().getKey(), value);\n         });\n     }\n "}]}