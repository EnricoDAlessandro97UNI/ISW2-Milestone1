{"sha":"b0a76473bf776f9b144dbff656eb46632356d322","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmIwYTc2NDczYmY3NzZmOWIxNDRkYmZmNjU2ZWI0NjYzMjM1NmQzMjI=","commit":{"author":{"name":"Unknown","email":"unknown@apache.org","date":"2010-07-19T14:58:52Z"},"committer":{"name":"Unknown","email":"unknown@apache.org","date":"2010-07-19T14:58:52Z"},"message":"(Fixes issue #14)\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/syncope/trunk@1246399 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"c3e885ee92aaefcda463f78774bbdbd36386531c","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/c3e885ee92aaefcda463f78774bbdbd36386531c"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/b0a76473bf776f9b144dbff656eb46632356d322","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/b0a76473bf776f9b144dbff656eb46632356d322","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/b0a76473bf776f9b144dbff656eb46632356d322","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/b0a76473bf776f9b144dbff656eb46632356d322/comments","author":null,"committer":null,"parents":[{"sha":"b45a7fecf82fd636b0f3ed81da33a64404fe52fc","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/b45a7fecf82fd636b0f3ed81da33a64404fe52fc","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/b45a7fecf82fd636b0f3ed81da33a64404fe52fc"}],"stats":{"total":213,"additions":202,"deletions":11},"files":[{"sha":"9e9448e343ec4ba578346cbc5ed086e85c081cd8","filename":"client/src/main/java/org/syncope/client/to/RoleTO.java","status":"modified","additions":18,"deletions":0,"changes":18,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b0a76473bf776f9b144dbff656eb46632356d322/client%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fclient%2Fto%2FRoleTO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b0a76473bf776f9b144dbff656eb46632356d322/client%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fclient%2Fto%2FRoleTO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fclient%2Fto%2FRoleTO.java?ref=b0a76473bf776f9b144dbff656eb46632356d322","patch":"@@ -22,6 +22,8 @@ public class RoleTO extends AbstractAttributableTO {\n     private String name;\n     private Long parent;\n     private Set<Long> users;\n+    private boolean inheritAttributes;\n+    private boolean inheritDerivedAttributes;\n \n     public RoleTO() {\n         super();\n@@ -61,4 +63,20 @@ public Set<Long> getUsers() {\n     public void setUsers(Set<Long> users) {\n         this.users = users;\n     }\n+\n+    public boolean isInheritAttributes() {\n+        return inheritAttributes;\n+    }\n+\n+    public void setInheritAttributes(boolean inheritAttributes) {\n+        this.inheritAttributes = inheritAttributes;\n+    }\n+\n+    public boolean isInheritDerivedAttributes() {\n+        return inheritDerivedAttributes;\n+    }\n+\n+    public void setInheritDerivedAttributes(boolean inheritDerivedAttributes) {\n+        this.inheritDerivedAttributes = inheritDerivedAttributes;\n+    }\n }"},{"sha":"9c6db46e05d9261d40f7d1ba86be493e1b8882b9","filename":"core/src/main/java/org/syncope/core/persistence/beans/AbstractDerivedAttribute.java","status":"modified","additions":3,"deletions":2,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b0a76473bf776f9b144dbff656eb46632356d322/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fbeans%2FAbstractDerivedAttribute.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b0a76473bf776f9b144dbff656eb46632356d322/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fbeans%2FAbstractDerivedAttribute.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fbeans%2FAbstractDerivedAttribute.java?ref=b0a76473bf776f9b144dbff656eb46632356d322","patch":"@@ -14,6 +14,7 @@\n  */\n package org.syncope.core.persistence.beans;\n \n+import java.util.Collection;\n import java.util.Iterator;\n import java.util.Set;\n import javax.persistence.GeneratedValue;\n@@ -35,7 +36,7 @@ public abstract class AbstractDerivedAttribute extends AbstractBaseBean {\n \n     static {\n         jexlEngine.setCache(512);\n-        jexlEngine.setLenient(false);\n+        jexlEngine.setLenient(true);\n         jexlEngine.setSilent(false);\n     }\n     @Id\n@@ -50,7 +51,7 @@ public Long getId() {\n      * @see http://commons.apache.org/jexl/reference/index.html\n      * @return\n      */\n-    public String getValue(Set<? extends AbstractAttribute> attributes) {\n+    public String getValue(Collection<? extends AbstractAttribute> attributes) {\n         Expression jexlExpression = jexlEngine.createExpression(\n                 getDerivedSchema().getExpression());\n         JexlContext jexlContext = new MapContext();"},{"sha":"57d989d2e6025ffdbfe508b326fdd7c5bf8926c2","filename":"core/src/main/java/org/syncope/core/persistence/beans/role/SyncopeRole.java","status":"modified","additions":18,"deletions":0,"changes":18,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b0a76473bf776f9b144dbff656eb46632356d322/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fbeans%2Frole%2FSyncopeRole.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b0a76473bf776f9b144dbff656eb46632356d322/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fbeans%2Frole%2FSyncopeRole.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fbeans%2Frole%2FSyncopeRole.java?ref=b0a76473bf776f9b144dbff656eb46632356d322","patch":"@@ -54,6 +54,8 @@ public class SyncopeRole extends AbstractAttributable {\n     @OneToMany(cascade = CascadeType.ALL,\n     fetch = FetchType.EAGER, mappedBy = \"owner\")\n     private Set<RoleDerivedAttribute> derivedAttributes;\n+    private boolean inheritAttributes;\n+    private boolean inheritDerivedAttributes;\n \n     public SyncopeRole() {\n         users = new HashSet<SyncopeUser>();\n@@ -159,4 +161,20 @@ public void setDerivedAttributes(\n \n         this.derivedAttributes = (Set<RoleDerivedAttribute>) derivedAttributes;\n     }\n+\n+    public boolean isInheritAttributes() {\n+        return inheritAttributes;\n+    }\n+\n+    public void setInheritAttributes(boolean inheritAttributes) {\n+        this.inheritAttributes = inheritAttributes;\n+    }\n+\n+    public boolean isInheritDerivedAttributes() {\n+        return inheritDerivedAttributes;\n+    }\n+\n+    public void setInheritDerivedAttributes(boolean inheritDerivedAttributes) {\n+        this.inheritDerivedAttributes = inheritDerivedAttributes;\n+    }\n }"},{"sha":"443d04bdd29dec2361a4b72cb6269c7d8c01cbb4","filename":"core/src/main/java/org/syncope/core/persistence/dao/SyncopeRoleDAO.java","status":"modified","additions":6,"deletions":0,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b0a76473bf776f9b144dbff656eb46632356d322/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fdao%2FSyncopeRoleDAO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b0a76473bf776f9b144dbff656eb46632356d322/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fdao%2FSyncopeRoleDAO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fdao%2FSyncopeRoleDAO.java?ref=b0a76473bf776f9b144dbff656eb46632356d322","patch":"@@ -15,6 +15,8 @@\n package org.syncope.core.persistence.dao;\n \n import java.util.List;\n+import org.syncope.core.persistence.beans.role.RoleAttribute;\n+import org.syncope.core.persistence.beans.role.RoleDerivedAttribute;\n import org.syncope.core.persistence.beans.role.SyncopeRole;\n \n public interface SyncopeRoleDAO extends DAO {\n@@ -25,6 +27,10 @@ public interface SyncopeRoleDAO extends DAO {\n \n     List<SyncopeRole> findChildren(Long roleId);\n \n+    List<RoleAttribute> findInheritedAttributes(SyncopeRole role);\n+\n+    List<RoleDerivedAttribute> findInheritedDerivedAttributes(SyncopeRole role);\n+\n     List<SyncopeRole> findAll();\n \n     SyncopeRole save(SyncopeRole syncopeRole);"},{"sha":"bf0505630951ecb46288493acf158a012a107274","filename":"core/src/main/java/org/syncope/core/persistence/dao/impl/SyncopeRoleDAOImpl.java","status":"modified","additions":77,"deletions":0,"changes":77,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b0a76473bf776f9b144dbff656eb46632356d322/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fdao%2Fimpl%2FSyncopeRoleDAOImpl.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b0a76473bf776f9b144dbff656eb46632356d322/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fdao%2Fimpl%2FSyncopeRoleDAOImpl.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fdao%2Fimpl%2FSyncopeRoleDAOImpl.java?ref=b0a76473bf776f9b144dbff656eb46632356d322","patch":"@@ -14,12 +14,15 @@\n  */\n package org.syncope.core.persistence.dao.impl;\n \n+import java.util.ArrayList;\n import java.util.Collections;\n import java.util.List;\n import javax.persistence.Query;\n import org.springframework.stereotype.Repository;\n import org.springframework.transaction.annotation.Transactional;\n import org.syncope.core.persistence.beans.Entitlement;\n+import org.syncope.core.persistence.beans.role.RoleAttribute;\n+import org.syncope.core.persistence.beans.role.RoleDerivedAttribute;\n import org.syncope.core.persistence.beans.role.SyncopeRole;\n import org.syncope.core.persistence.beans.user.SyncopeUser;\n import org.syncope.core.persistence.dao.SyncopeRoleDAO;\n@@ -62,6 +65,80 @@ public List<SyncopeRole> findChildren(Long roleId) {\n         return query.getResultList();\n     }\n \n+    private List<Long> getAncestors(SyncopeRole role,\n+            List<Long> ancestors) {\n+\n+        ancestors.add(role.getId());\n+\n+        if (role.getParent() != null && role.isInheritAttributes()) {\n+            return getAncestors(role.getParent(), ancestors);\n+        }\n+\n+        return ancestors;\n+    }\n+\n+    @Override\n+    public List<RoleAttribute> findInheritedAttributes(SyncopeRole role) {\n+        if (role.getParent() == null) {\n+            return Collections.EMPTY_LIST;\n+        }\n+\n+        List<Long> ancestors = getAncestors(role.getParent(),\n+                new ArrayList<Long>());\n+        if (ancestors == null || ancestors.isEmpty()) {\n+            return Collections.EMPTY_LIST;\n+        }\n+\n+        StringBuilder queryExp = new StringBuilder();\n+        queryExp.append(\"SELECT ra FROM RoleAttribute ra \"\n+                + \"WHERE ra.owner.id = \");\n+        queryExp.append(ancestors.get(0));\n+\n+        if (ancestors.size() > 1) {\n+            for (int i = 1; i < ancestors.size(); i++) {\n+                queryExp.append(\"OR ra.owner.id = \");\n+                queryExp.append(ancestors.get(i));\n+                queryExp.append(\" \");\n+            }\n+        }\n+        queryExp.append(\"ORDER BY ra.owner.id ASC\");\n+\n+        Query query = entityManager.createQuery(queryExp.toString());\n+        return query.getResultList();\n+    }\n+\n+    @Override\n+    public List<RoleDerivedAttribute> findInheritedDerivedAttributes(\n+            SyncopeRole role) {\n+\n+        if (role.getParent() == null) {\n+            return Collections.EMPTY_LIST;\n+        }\n+\n+        List<Long> ancestors = getAncestors(role.getParent(),\n+                new ArrayList<Long>());\n+        if (ancestors == null || ancestors.isEmpty()) {\n+            return Collections.EMPTY_LIST;\n+        }\n+\n+        StringBuilder queryExp = new StringBuilder();\n+        queryExp.append(\"SELECT rda FROM RoleDerivedAttribute rda \"\n+                + \"WHERE rda.owner.id = \");\n+        queryExp.append(ancestors.get(0));\n+\n+        if (ancestors.size() > 1) {\n+            for (int i = 1; i < ancestors.size(); i++) {\n+                queryExp.append(\"OR rda.owner.id = \");\n+                queryExp.append(ancestors.get(i));\n+                queryExp.append(\" \");\n+            }\n+        }\n+        queryExp.append(\"ORDER BY rda.owner.id ASC\");\n+\n+        Query query = entityManager.createQuery(queryExp.toString());\n+        return query.getResultList();\n+    }\n+\n     @Override\n     public List<SyncopeRole> findAll() {\n         Query query = entityManager.createQuery(\"SELECT e FROM SyncopeRole e\");"},{"sha":"64b25f8a694d8c04f33bacf9b7f211802f8a5ea2","filename":"core/src/main/java/org/syncope/core/rest/data/RoleDataBinder.java","status":"modified","additions":48,"deletions":0,"changes":48,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b0a76473bf776f9b144dbff656eb46632356d322/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fdata%2FRoleDataBinder.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b0a76473bf776f9b144dbff656eb46632356d322/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fdata%2FRoleDataBinder.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Frest%2Fdata%2FRoleDataBinder.java?ref=b0a76473bf776f9b144dbff656eb46632356d322","patch":"@@ -14,12 +14,19 @@\n  */\n package org.syncope.core.rest.data;\n \n+import java.util.Collections;\n+import java.util.List;\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.http.HttpStatus;\n import org.springframework.stereotype.Component;\n+import org.syncope.client.to.AttributeTO;\n import org.syncope.client.to.RoleTO;\n import org.syncope.client.validation.SyncopeClientCompositeErrorException;\n import org.syncope.client.validation.SyncopeClientException;\n+import org.syncope.core.persistence.beans.AbstractAttribute;\n+import org.syncope.core.persistence.beans.AbstractDerivedAttribute;\n+import org.syncope.core.persistence.beans.role.RoleAttribute;\n+import org.syncope.core.persistence.beans.role.RoleDerivedAttribute;\n import org.syncope.core.persistence.beans.role.SyncopeRole;\n import org.syncope.core.persistence.beans.user.SyncopeUser;\n import org.syncope.core.persistence.dao.AttributeValueDAO;\n@@ -53,6 +60,9 @@ public SyncopeRole createSyncopeRole(RoleTO roleTO)\n             throws SyncopeClientCompositeErrorException {\n \n         SyncopeRole syncopeRole = new SyncopeRole();\n+        syncopeRole.setInheritAttributes(roleTO.isInheritAttributes());\n+        syncopeRole.setInheritDerivedAttributes(\n+                roleTO.isInheritDerivedAttributes());\n \n         SyncopeClientCompositeErrorException scce =\n                 new SyncopeClientCompositeErrorException(\n@@ -120,16 +130,54 @@ public RoleTO getRoleTO(SyncopeRole role) {\n         RoleTO roleTO = new RoleTO();\n         roleTO.setId(role.getId());\n         roleTO.setName(role.getName());\n+        roleTO.setInheritAttributes(role.isInheritAttributes());\n+        roleTO.setInheritDerivedAttributes(role.isInheritDerivedAttributes());\n         if (role.getParent() != null) {\n             roleTO.setParent(role.getParent().getId());\n         }\n \n         roleTO = getAbstractAttributableTO(roleTO, role);\n \n+        // users\n         for (SyncopeUser user : role.getUsers()) {\n             roleTO.addUser(user.getId());\n         }\n \n+        AttributeTO attributeTO = null;\n+\n+        List<RoleAttribute> inheritedAttributes = null;\n+        if (role.isInheritAttributes()) {\n+            // inherited attributes\n+            inheritedAttributes = syncopeRoleDAO.findInheritedAttributes(role);\n+\n+            for (AbstractAttribute attribute : inheritedAttributes) {\n+                attributeTO = new AttributeTO();\n+                attributeTO.setSchema(attribute.getSchema().getName());\n+                attributeTO.setValues(attribute.getAttributeValuesAsStrings());\n+\n+                roleTO.addAttribute(attributeTO);\n+            }\n+\n+            // inherited derived attributes\n+            List<RoleDerivedAttribute> inheritedDerivedAttributes = null;\n+            if (role.isInheritDerivedAttributes()) {\n+                inheritedDerivedAttributes =\n+                        syncopeRoleDAO.findInheritedDerivedAttributes(role);\n+\n+                for (AbstractDerivedAttribute attribute :\n+                        inheritedDerivedAttributes) {\n+\n+                    attributeTO = new AttributeTO();\n+                    attributeTO.setSchema(\n+                            attribute.getDerivedSchema().getName());\n+                    attributeTO.setValues(Collections.singleton(\n+                            attribute.getValue(inheritedAttributes)));\n+\n+                    roleTO.addDerivedAttribute(attributeTO);\n+                }\n+            }\n+        }\n+\n         return roleTO;\n     }\n }"},{"sha":"cec6f18e008305f6a51a45e9fc2a340d9b64e03d","filename":"core/src/test/java/org/syncope/core/test/persistence/relationships/RoleTest.java","status":"modified","additions":18,"deletions":1,"changes":19,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b0a76473bf776f9b144dbff656eb46632356d322/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fsyncope%2Fcore%2Ftest%2Fpersistence%2Frelationships%2FRoleTest.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b0a76473bf776f9b144dbff656eb46632356d322/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fsyncope%2Fcore%2Ftest%2Fpersistence%2Frelationships%2FRoleTest.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fsyncope%2Fcore%2Ftest%2Fpersistence%2Frelationships%2FRoleTest.java?ref=b0a76473bf776f9b144dbff656eb46632356d322","patch":"@@ -22,6 +22,7 @@\n import org.syncope.core.persistence.beans.role.RoleAttribute;\n import org.syncope.core.persistence.beans.role.RoleAttributeValue;\n import org.syncope.core.persistence.beans.role.RoleSchema;\n+import org.syncope.core.persistence.beans.role.SyncopeRole;\n import org.syncope.core.persistence.dao.AttributeDAO;\n import org.syncope.core.persistence.dao.AttributeValueDAO;\n import org.syncope.core.persistence.dao.EntitlementDAO;\n@@ -47,7 +48,7 @@ public class RoleTest extends AbstractTest {\n     private EntitlementDAO entitlementDAO;\n \n     @Test\n-    public final void test() {\n+    public final void delete() {\n         syncopeRoleDAO.delete(2L);\n \n         syncopeRoleDAO.flush();\n@@ -59,4 +60,20 @@ public final void test() {\n         assertNull(attributeValueDAO.find(41L, RoleAttributeValue.class));\n         assertNotNull(schemaDAO.find(\"icon\", RoleSchema.class));\n     }\n+\n+    @Test\n+    public final void inheritedAttributes() {\n+        SyncopeRole director = syncopeRoleDAO.find(7L);\n+\n+        assertEquals(2,\n+                syncopeRoleDAO.findInheritedAttributes(director).size());\n+    }\n+\n+    @Test\n+    public final void inheritedDerivedAttributes() {\n+        SyncopeRole director = syncopeRoleDAO.find(7L);\n+\n+       assertEquals(1,\n+                syncopeRoleDAO.findInheritedDerivedAttributes(director).size());\n+    }\n }"},{"sha":"6b433c43151c7cc0f59c83e5652edab2b0c7aeb5","filename":"core/src/test/resources/org/syncope/core/persistence/content.xml","status":"modified","additions":14,"deletions":8,"changes":22,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b0a76473bf776f9b144dbff656eb46632356d322/core%2Fsrc%2Ftest%2Fresources%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fcontent.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b0a76473bf776f9b144dbff656eb46632356d322/core%2Fsrc%2Ftest%2Fresources%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fcontent.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Ftest%2Fresources%2Forg%2Fsyncope%2Fcore%2Fpersistence%2Fcontent.xml?ref=b0a76473bf776f9b144dbff656eb46632356d322","patch":"@@ -37,14 +37,14 @@\n     <SyncopeUser id=\"3\" password=\"ZZZ\"/>\n     <SyncopeUser id=\"4\" password=\"PPP\"/>\n \n-    <SyncopeRole id=\"1\" name=\"root\"/>\n-    <SyncopeRole id=\"2\" name=\"child\" parent_id=\"1\"/>\n-    <SyncopeRole id=\"3\" name=\"citizen\"/>\n-    <SyncopeRole id=\"4\" name=\"employee\" parent_id=\"3\"/>\n-    <SyncopeRole id=\"5\" name=\"secretary\" parent_id=\"4\"/>\n-    <SyncopeRole id=\"6\" name=\"director\" parent_id=\"4\"/>\n-    <SyncopeRole id=\"7\" name=\"managingDirector\" parent_id=\"6\"/>\n-    <SyncopeRole id=\"8\" name=\"otherchild\" parent_id=\"1\"/>\n+    <SyncopeRole id=\"1\" name=\"root\" inheritAttributes=\"FALSE\" inheritDerivedAttributes=\"FALSE\"/>\n+    <SyncopeRole id=\"2\" name=\"child\" parent_id=\"1\" inheritAttributes=\"FALSE\" inheritDerivedAttributes=\"FALSE\"/>\n+    <SyncopeRole id=\"3\" name=\"citizen\" inheritAttributes=\"FALSE\" inheritDerivedAttributes=\"FALSE\"/>\n+    <SyncopeRole id=\"4\" name=\"employee\" parent_id=\"3\" inheritAttributes=\"FALSE\" inheritDerivedAttributes=\"FALSE\"/>\n+    <SyncopeRole id=\"5\" name=\"secretary\" parent_id=\"4\" inheritAttributes=\"FALSE\" inheritDerivedAttributes=\"FALSE\"/>\n+    <SyncopeRole id=\"6\" name=\"director\" parent_id=\"4\" inheritAttributes=\"TRUE\" inheritDerivedAttributes=\"TRUE\"/>\n+    <SyncopeRole id=\"7\" name=\"managingDirector\" parent_id=\"6\" inheritAttributes=\"FALSE\" inheritDerivedAttributes=\"FALSE\"/>\n+    <SyncopeRole id=\"8\" name=\"otherchild\" parent_id=\"1\" inheritAttributes=\"FALSE\" inheritDerivedAttributes=\"FALSE\"/>\n \n     <SyncopeUser_SyncopeRole users_id=\"1\" roles_id=\"1\"/>\n     <SyncopeUser_SyncopeRole users_id=\"2\" roles_id=\"1\"/>\n@@ -85,6 +85,8 @@\n     <RoleAttribute id=\"600\" owner_id=\"1\" schema_name=\"icon\"/>\n     <RoleAttribute id=\"700\" owner_id=\"2\" schema_name=\"icon\"/>\n     <RoleAttribute id=\"800\" owner_id=\"1\" schema_name=\"show\"/>\n+    <RoleAttribute id=\"900\" owner_id=\"6\" schema_name=\"icon\"/>\n+    <RoleAttribute id=\"950\" owner_id=\"4\" schema_name=\"icon\"/>\n \n     <UserAttributeValue attribute_id=\"100\" id=\"10\" stringValue=\"chicchiricco\"/>\n     <UserAttributeValue attribute_id=\"300\" id=\"11\" stringValue=\"fabio.martelli\"/>\n@@ -97,6 +99,8 @@\n     <RoleAttributeValue attribute_id=\"600\" id=\"40\" stringValue=\"niceIcon\"/>\n     <RoleAttributeValue attribute_id=\"700\" id=\"41\" stringValue=\"badIcon\"/>\n     <RoleAttributeValue attribute_id=\"800\" id=\"42\" booleanValue=\"TRUE\"/>\n+    <RoleAttributeValue attribute_id=\"900\" id=\"43\" stringValue=\"icon6\"/>\n+    <RoleAttributeValue attribute_id=\"950\" id=\"44\" stringValue=\"icon4\"/>\n \n     <UserDerivedSchema name=\"cn\" expression=\"surname + ', ' + firstname\"/>\n     \n@@ -197,5 +201,7 @@\n \n     <RoleDerivedAttribute id=\"1001\" derivedSchema_name=\"displayProperty\"\n                           owner_id=\"1\"/>\n+    <RoleDerivedAttribute id=\"1002\" derivedSchema_name=\"displayProperty\"\n+                          owner_id=\"4\"/>\n \n </dataset>"}]}