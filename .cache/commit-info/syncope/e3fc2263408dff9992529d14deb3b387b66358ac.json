{"sha":"e3fc2263408dff9992529d14deb3b387b66358ac","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmUzZmMyMjYzNDA4ZGZmOTk5MjUyOWQxNGRlYjNiMzg3YjY2MzU4YWM=","commit":{"author":{"name":"fmartelli","email":"fabio.martelli@gmail.com","date":"2016-07-08T11:20:46Z"},"committer":{"name":"fmartelli","email":"fabio.martelli@gmail.com","date":"2016-07-08T11:20:46Z"},"message":"Merge branch 'master' of https://git-wip-us.apache.org/repos/asf/syncope","tree":{"sha":"d6877c6599f35d2a72469648b190f339e9de3de1","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/d6877c6599f35d2a72469648b190f339e9de3de1"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/e3fc2263408dff9992529d14deb3b387b66358ac","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/e3fc2263408dff9992529d14deb3b387b66358ac","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/e3fc2263408dff9992529d14deb3b387b66358ac","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/e3fc2263408dff9992529d14deb3b387b66358ac/comments","author":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"committer":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"parents":[{"sha":"46e642eaf3a3375f2d51f422e0f91ded5cf74e19","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/46e642eaf3a3375f2d51f422e0f91ded5cf74e19","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/46e642eaf3a3375f2d51f422e0f91ded5cf74e19"},{"sha":"f97d4fd39b7c0e8f18cd02f5bd2cf14b8b71e242","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/f97d4fd39b7c0e8f18cd02f5bd2cf14b8b71e242","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/f97d4fd39b7c0e8f18cd02f5bd2cf14b8b71e242"}],"stats":{"total":38,"additions":23,"deletions":15},"files":[{"sha":"c534a4414ec0fece212d76c8c91d2a9eb5b3b585","filename":"core/persistence-jpa/src/main/resources/domains/MasterContent.xml","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e3fc2263408dff9992529d14deb3b387b66358ac/core%2Fpersistence-jpa%2Fsrc%2Fmain%2Fresources%2Fdomains%2FMasterContent.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e3fc2263408dff9992529d14deb3b387b66358ac/core%2Fpersistence-jpa%2Fsrc%2Fmain%2Fresources%2Fdomains%2FMasterContent.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa%2Fsrc%2Fmain%2Fresources%2Fdomains%2FMasterContent.xml?ref=e3fc2263408dff9992529d14deb3b387b66358ac","patch":"@@ -166,13 +166,13 @@ a password reset was request for ${user.getUsername()}.&lt;/p&gt;\n &lt;/html&gt;\"/>\n   <MailTemplate id=\"confirmPasswordReset\"\n                 textTemplate=\"Hi,\n-we are happy to inform you that the password request was execute successfully for your account.\n+we are happy to inform you that the password request was successfully executed for your account.\n \n Best regards.\"\n                 htmlTemplate=\"&lt;html&gt;\n &lt;body&gt;\n &lt;p&gt;Hi,&lt;/br&gt;\n-we are happy to inform you that the password request was execute successfully for your account.&lt;/p&gt;\n+we are happy to inform you that the password request was successfully executed for your account.&lt;/p&gt;\n \n &lt;p&gt;Best regards.&lt;/p&gt;\n &lt;/body&gt;"},{"sha":"ff84934208e4f54a4816f3c527c988d848a243a1","filename":"core/persistence-jpa/src/test/resources/domains/MasterContent.xml","status":"modified","additions":3,"deletions":3,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e3fc2263408dff9992529d14deb3b387b66358ac/core%2Fpersistence-jpa%2Fsrc%2Ftest%2Fresources%2Fdomains%2FMasterContent.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e3fc2263408dff9992529d14deb3b387b66358ac/core%2Fpersistence-jpa%2Fsrc%2Ftest%2Fresources%2Fdomains%2FMasterContent.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa%2Fsrc%2Ftest%2Fresources%2Fdomains%2FMasterContent.xml?ref=e3fc2263408dff9992529d14deb3b387b66358ac","patch":"@@ -1070,7 +1070,7 @@ under the License.\n         destinationRealm_id=\"e4c28e7a-9dbf-4ee7-9441-93812a0d4a28\" pullMode=\"FULL_RECONCILIATION\" performCreate=\"1\" performDelete=\"1\" performUpdate=\"1\" syncStatus=\"0\"\n         unmatchingRule=\"PROVISION\" matchingRule=\"UPDATE\" active=\"1\"/>\n   <AnyTemplatePullTask id=\"df655a2a-40c0-43b1-a157-3f4988802f58\" pullTask_id=\"1e419ca4-ea81-4493-a14f-28b90113686d\" anyType_id=\"USER\"\n-                       template='{\"@class\":\"org.apache.syncope.common.lib.to.UserTO\",\"creator\":null,\"creationDate\":null,\"lastModifier\":null,\"lastChangeDate\":null,\"key\":null,\"type\":\"USER\",\"realm\":null,\"status\":null,\"password\":null,\"token\":null,\"tokenExpireTime\":null,\"username\":null,\"lastLoginDate\":null,\"changePwdDate\":null,\"failedLogins\":null,\"securityQuestion\":null,\"securityAnswer\":null,\"auxClasses\":[],\"derAttrs\":[],\"virAttrs\":[{\"schema\":\"virtualReadOnly\",\"readonly\":true,\"values\":[\"\"]}],\"resources\":[\"resource-ldap\"],\"roles\":[],\"dynRoles\":[],\"relationships\":[],\"memberships\":[],\"dynGroups\":[],\"plainAttrs\":[]}'/>\n+                       template='{\"@class\":\"org.apache.syncope.common.lib.to.UserTO\",\"creator\":null,\"creationDate\":null,\"lastModifier\":null,\"lastChangeDate\":null,\"key\":null,\"type\":\"USER\",\"realm\":\"&apos;/&apos; + title\",\"status\":null,\"password\":null,\"token\":null,\"tokenExpireTime\":null,\"username\":null,\"lastLoginDate\":null,\"changePwdDate\":null,\"failedLogins\":null,\"securityQuestion\":null,\"securityAnswer\":null,\"auxClasses\":[\"minimal group\"],\"derAttrs\":[],\"virAttrs\":[{\"schema\":\"virtualReadOnly\",\"readonly\":true,\"values\":[\"\"]}],\"resources\":[\"resource-ldap\"],\"roles\":[],\"dynRoles\":[],\"relationships\":[],\"memberships\":[],\"dynGroups\":[],\"plainAttrs\":[]}'/>\n   <AnyTemplatePullTask id=\"fda22ff3-98f3-42e4-a2ae-cd9a28282d57\" pullTask_id=\"1e419ca4-ea81-4493-a14f-28b90113686d\" anyType_id=\"GROUP\"\n                        template='{\"@class\":\"org.apache.syncope.common.lib.to.GroupTO\",\"creator\":null,\"creationDate\":null,\"lastModifier\":null,\"lastChangeDate\":null,\"key\":null,\"type\":\"GROUP\",\"realm\":null,\"status\":null,\"name\":null,\"userOwner\":null,\"groupOwner\":null,\"udynMembershipCond\":null,\"auxClasses\":[],\"derAttrs\":[],\"virAttrs\":[],\"resources\":[],\"plainAttrs\":[{\"schema\":\"show\",\"readonly\":false,\"values\":[\"true\"]}]}'/>\n   <PullTask_actionsClassNames pullTask_id=\"1e419ca4-ea81-4493-a14f-28b90113686d\" actionClassName=\"org.apache.syncope.core.provisioning.java.pushpull.LDAPMembershipPullActions\"/>\n@@ -1178,13 +1178,13 @@ a password reset was request for ${user.getUsername()}.&lt;/p&gt;\n &lt;/html&gt;\"/>\n   <MailTemplate id=\"confirmPasswordReset\"\n                 textTemplate=\"Hi,\n-we are happy to inform you that the password request was execute successfully for your account.\n+we are happy to inform you that the password request was successfully executed for your account.\n \n Best regards.\"\n                 htmlTemplate=\"&lt;html&gt;\n &lt;body&gt;\n &lt;p&gt;Hi,&lt;br/&gt;\n-we are happy to inform you that the password request was execute successfully for your account.&lt;/p&gt;\n+we are happy to inform you that the password request was successfully executed for your account.&lt;/p&gt;\n \n &lt;p&gt;Best regards.&lt;/p&gt;\n &lt;/body&gt;"},{"sha":"437debcd8e307767e856f96ab28ed8e67ae448f3","filename":"core/persistence-jpa/src/test/resources/domains/TwoContent.xml","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e3fc2263408dff9992529d14deb3b387b66358ac/core%2Fpersistence-jpa%2Fsrc%2Ftest%2Fresources%2Fdomains%2FTwoContent.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e3fc2263408dff9992529d14deb3b387b66358ac/core%2Fpersistence-jpa%2Fsrc%2Ftest%2Fresources%2Fdomains%2FTwoContent.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa%2Fsrc%2Ftest%2Fresources%2Fdomains%2FTwoContent.xml?ref=e3fc2263408dff9992529d14deb3b387b66358ac","patch":"@@ -143,13 +143,13 @@ a password reset was request for ${user.getUsername()}.&lt;/p&gt;\n &lt;/html&gt;\"/>\n   <MailTemplate id=\"confirmPasswordReset\"\n                 textTemplate=\"Hi,\n-we are happy to inform you that the password request was execute successfully for your account.\n+we are happy to inform you that the password request was successfully executed for your account.\n \n Best regards.\"\n                 htmlTemplate=\"&lt;html&gt;\n &lt;body&gt;\n &lt;p&gt;Hi,&lt;/br&gt;\n-we are happy to inform you that the password request was execute successfully for your account.&lt;/p&gt;\n+we are happy to inform you that the password request was successfully executed for your account.&lt;/p&gt;\n \n &lt;p&gt;Best regards.&lt;/p&gt;\n &lt;/body&gt;"},{"sha":"94822ed28b543f939a040883accfdee4c4a573ed","filename":"core/provisioning-java/src/main/java/org/apache/syncope/core/provisioning/java/utils/ConnObjectUtils.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e3fc2263408dff9992529d14deb3b387b66358ac/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Futils%2FConnObjectUtils.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e3fc2263408dff9992529d14deb3b387b66358ac/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Futils%2FConnObjectUtils.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Futils%2FConnObjectUtils.java?ref=e3fc2263408dff9992529d14deb3b387b66358ac","patch":"@@ -133,7 +133,7 @@ public <T extends AnyTO> T getAnyTO(\n \n         // (for users) if password was not set above, generate\n         if (anyTO instanceof UserTO && StringUtils.isBlank(((UserTO) anyTO).getPassword())) {\n-            final UserTO userTO = (UserTO) anyTO;\n+            UserTO userTO = (UserTO) anyTO;\n \n             List<PasswordRuleConf> ruleConfs = new ArrayList<>();\n "},{"sha":"de0480f2506f2f3e10dfa5242ebbf0db5e39943e","filename":"core/provisioning-java/src/main/java/org/apache/syncope/core/provisioning/java/utils/TemplateUtils.java","status":"modified","additions":5,"deletions":4,"changes":9,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e3fc2263408dff9992529d14deb3b387b66358ac/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Futils%2FTemplateUtils.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e3fc2263408dff9992529d14deb3b387b66358ac/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Futils%2FTemplateUtils.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Futils%2FTemplateUtils.java?ref=e3fc2263408dff9992529d14deb3b387b66358ac","patch":"@@ -69,7 +69,10 @@ private AttrTO evaluateAttr(final AnyTO anyTO, final AttrTO template) {\n \n     private void fill(final AnyTO anyTO, final AnyTO template) {\n         if (template.getRealm() != null) {\n-            anyTO.setRealm(template.getRealm());\n+            String evaluated = JexlUtils.evaluate(template.getRealm(), anyTO, new MapContext());\n+            if (StringUtils.isNotBlank(evaluated)) {\n+                anyTO.setRealm(evaluated);\n+            }\n         }\n \n         Map<String, AttrTO> currentAttrMap = anyTO.getPlainAttrMap();\n@@ -99,9 +102,7 @@ private void fill(final AnyTO anyTO, final AnyTO template) {\n             }\n         }\n \n-        for (String resource : template.getResources()) {\n-            anyTO.getResources().add(resource);\n-        }\n+        anyTO.getResources().addAll(template.getResources());\n \n         anyTO.getAuxClasses().addAll(template.getAuxClasses());\n     }"},{"sha":"d0d7c77c3f6290f1696a89819ad6cafc24c9fe17","filename":"ext/camel/provisioning-camel/src/main/resources/userRoutes.xml","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e3fc2263408dff9992529d14deb3b387b66358ac/ext%2Fcamel%2Fprovisioning-camel%2Fsrc%2Fmain%2Fresources%2FuserRoutes.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e3fc2263408dff9992529d14deb3b387b66358ac/ext%2Fcamel%2Fprovisioning-camel%2Fsrc%2Fmain%2Fresources%2FuserRoutes.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fcamel%2Fprovisioning-camel%2Fsrc%2Fmain%2Fresources%2FuserRoutes.xml?ref=e3fc2263408dff9992529d14deb3b387b66358ac","patch":"@@ -25,8 +25,8 @@ under the License.\n       <simple>${body}</simple>\n     </setProperty>\n     <doTry>\n-      <bean ref=\"uwfAdapter\" method=\"create(${body},${property.disablePwdPolicyCheck},\n-                                     ${property.enabled},${property.storePassword})\"/>\n+      <bean method=\"create(${body},${property.disablePwdPolicyCheck},${property.enabled},${property.storePassword})\"\n+            ref=\"uwfAdapter\" />\n       <process ref=\"userCreateProcessor\"/>\n       <to uri=\"direct:createPort\"/>\n       <doCatch>        "},{"sha":"18f184fdbb3730d8a330334586cd60b809ac0e29","filename":"fit/build-tools/src/main/resources/content.ldif","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e3fc2263408dff9992529d14deb3b387b66358ac/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fresources%2Fcontent.ldif","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e3fc2263408dff9992529d14deb3b387b66358ac/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fresources%2Fcontent.ldif","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fresources%2Fcontent.ldif?ref=e3fc2263408dff9992529d14deb3b387b66358ac","patch":"@@ -44,6 +44,7 @@ sn: Surname\n uid: pullFromLDAP\n userpassword:: cGFzc3dvcmQxMjM=\n givenname: pullFromLDAP\n+title: odd\n registeredAddress:  5BAA61E4C9B93F3F0682250B6CF8331B7EE68FD8\n jpegPhoto:: /9j/4AAQSkZJRgABAQEBKwErAAD/2wBDAAMCAgMCAgMDAwMEAwMEBQgFBQQEBQoH\n  BwYIDAoMDAsKCwsNDhIQDQ4RDgsLEBYQERMUFRUVDA8XGBYUGBIUFRT/2wBDAQMEBAUEBQkFBQk"},{"sha":"74f8b17ccbf90ed1687291560e7ecb345ba62707","filename":"fit/core-reference/src/test/java/org/apache/syncope/fit/core/PullTaskITCase.java","status":"modified","additions":7,"deletions":1,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e3fc2263408dff9992529d14deb3b387b66358ac/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FPullTaskITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e3fc2263408dff9992529d14deb3b387b66358ac/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FPullTaskITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FPullTaskITCase.java?ref=e3fc2263408dff9992529d14deb3b387b66358ac","patch":"@@ -208,7 +208,7 @@ public void fromCSV() throws Exception {\n \n             ExecTO exec = execProvisioningTask(taskService, PULL_TASK_KEY, 50, false);\n             assertEquals(PropagationTaskExecStatus.SUCCESS, PropagationTaskExecStatus.valueOf(exec.getStatus()));\n-            \n+\n             LOG.debug(\"Execution of task {}:\\n{}\", PULL_TASK_KEY, exec);\n \n             // check for pull results\n@@ -382,6 +382,10 @@ public void reconcileFromLDAP() {\n                 build());\n         assertNotNull(matchingGroups);\n         assertEquals(1, matchingGroups.getResult().size());\n+        // SYNCOPE-898\n+        PullTaskTO task = taskService.read(\"1e419ca4-ea81-4493-a14f-28b90113686d\", false);\n+        assertEquals(\"/\", task.getDestinationRealm());\n+        assertEquals(\"/\", matchingGroups.getResult().get(0).getRealm());\n \n         // 3. verify that pulled user is found\n         PagedResult<UserTO> matchingUsers = userService.search(\n@@ -390,6 +394,8 @@ public void reconcileFromLDAP() {\n                 build());\n         assertNotNull(matchingUsers);\n         assertEquals(1, matchingUsers.getResult().size());\n+        // SYNCOPE-898\n+        assertEquals(\"/odd\", matchingUsers.getResult().get(0).getRealm());\n \n         // Check for SYNCOPE-436\n         assertEquals(\"pullFromLDAP\","}]}