{"sha":"0b24e5c1a9de1db22183a8af447deb875a14ecb2","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjBiMjRlNWMxYTlkZTFkYjIyMTgzYThhZjQ0N2RlYjg3NWExNGVjYjI=","commit":{"author":{"name":"Unknown","email":"unknown@apache.org","date":"2011-12-06T13:59:36Z"},"committer":{"name":"Unknown","email":"unknown@apache.org","date":"2011-12-06T13:59:36Z"},"message":"Fixes issue 221\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/syncope/trunk@1247238 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"1d9ec476146d7bb98ca8f45579fe967cd64992bd","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/1d9ec476146d7bb98ca8f45579fe967cd64992bd"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/0b24e5c1a9de1db22183a8af447deb875a14ecb2","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/0b24e5c1a9de1db22183a8af447deb875a14ecb2","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/0b24e5c1a9de1db22183a8af447deb875a14ecb2","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/0b24e5c1a9de1db22183a8af447deb875a14ecb2/comments","author":null,"committer":null,"parents":[{"sha":"5e58b6940e18c4cc84ba0177ef5c96ae3cfd9985","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/5e58b6940e18c4cc84ba0177ef5c96ae3cfd9985","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/5e58b6940e18c4cc84ba0177ef5c96ae3cfd9985"}],"stats":{"total":650,"additions":446,"deletions":204},"files":[{"sha":"f5aedcc2b0627f8ac1b18772566ebf87fbac9242","filename":"console/src/main/java/org/syncope/console/pages/UserModalPage.java","status":"modified","additions":181,"deletions":137,"changes":318,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/0b24e5c1a9de1db22183a8af447deb875a14ecb2/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/0b24e5c1a9de1db22183a8af447deb875a14ecb2/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage.java?ref=0b24e5c1a9de1db22183a8af447deb875a14ecb2","patch":"@@ -24,6 +24,7 @@\n import org.apache.wicket.extensions.ajax.markup.html.modal.ModalWindow;\n import org.apache.wicket.markup.html.basic.Label;\n import org.apache.wicket.markup.html.form.Form;\n+import org.apache.wicket.markup.html.panel.Fragment;\n import org.apache.wicket.model.CompoundPropertyModel;\n import org.apache.wicket.model.ResourceModel;\n import org.apache.wicket.spring.injection.annot.SpringBean;\n@@ -38,6 +39,7 @@\n import org.syncope.console.pages.panels.ResourcesPanel;\n import org.syncope.console.pages.panels.RolesPanel;\n import org.syncope.console.pages.panels.UserDetailsPanel;\n+import org.syncope.console.pages.panels.UserSummaryPanel;\n import org.syncope.console.pages.panels.VirtualAttributesPanel;\n import org.syncope.console.rest.TaskRestClient;\n import org.syncope.console.rest.UserRequestRestClient;\n@@ -81,6 +83,12 @@ public enum Mode {\n \n     private UserTO initialUserTO;\n \n+    private UserTO summaryUserTO;\n+\n+    private Fragment fragment;\n+\n+    private boolean submitted = false;\n+\n     public UserModalPage(final PageReference callerPageRef,\n             final ModalWindow window,\n             final UserRequestTO userRequestTO) {\n@@ -123,6 +131,20 @@ public UserModalPage(final PageReference callerPageRef,\n         setupModalPage();\n     }\n \n+    public UserModalPage(final PageReference callerPageRef,\n+            final ModalWindow window,\n+            final UserTO summaryUserTO, final boolean submitted) {\n+\n+        super();\n+\n+        this.callerPageRef = callerPageRef;\n+        this.window = window;\n+        this.summaryUserTO = summaryUserTO;\n+        this.submitted = submitted;\n+\n+        setupModalPage();\n+    }\n+\n     public UserTO getUserTO() {\n         return userTO;\n     }\n@@ -132,159 +154,181 @@ public void setUserTO(final UserTO userTO) {\n     }\n \n     private void setupModalPage() {\n-        if (userRequestTO != null) {\n-            switch (userRequestTO.getType()) {\n-                case CREATE:\n-                    userTO = userRequestTO.getUserTO();\n-                    break;\n-\n-                case UPDATE:\n-                    initialUserTO = userRestClient.read(\n-                            userRequestTO.getUserMod().getId());\n-                    userTO = AttributableOperations.apply(\n-                            initialUserTO, userRequestTO.getUserMod());\n-                    break;\n-\n-                case DELETE:\n-                default:\n-            }\n-        }\n-        if (syncTaskTO != null) {\n-            userTO = syncTaskTO.getUserTemplate();\n-        }\n \n-        if (initialUserTO == null && userTO.getId() > 0) {\n-            initialUserTO = AttributableOperations.clone(userTO);\n-        }\n+        fragment = new Fragment(\"userPanel\",\n+                !submitted ? \"editPanel\" : \"summaryPanel\", this);\n+        fragment.setOutputMarkupId(true);\n \n-        add(new Label(\"id\", userTO.getId() == 0\n-                ? \"\" : userTO.getUsername()));\n-        add(new Label(\"new\", userTO.getId() == 0\n-                ? getString(\"new\") : \"\"));\n-\n-        final Form form = new Form(\"UserForm\");\n-        form.setModel(new CompoundPropertyModel(userTO));\n-\n-        //--------------------------------\n-        // User details\n-        //--------------------------------\n-        form.add(new UserDetailsPanel(\"details\", userTO, form,\n-                userRequestTO == null, mode == Mode.TEMPLATE));\n-        //--------------------------------\n-\n-        //--------------------------------\n-        // Attributes panel\n-        //--------------------------------\n-        form.add(new AttributesPanel(\"attributes\", userTO, form,\n-                mode == Mode.TEMPLATE));\n-        //--------------------------------\n-\n-        //--------------------------------\n-        // Derived attributes panel\n-        //--------------------------------\n-        form.add(new DerivedAttributesPanel(\"derivedAttributes\", userTO));\n-        //--------------------------------\n-\n-        //--------------------------------\n-        // Virtual attributes panel\n-        //--------------------------------\n-        form.add(new VirtualAttributesPanel(\"virtualAttributes\", userTO,\n-                mode == Mode.TEMPLATE));\n-        //--------------------------------\n-\n-        //--------------------------------\n-        // Resources panel\n-        //--------------------------------\n-        form.add(new ResourcesPanel(\"resources\", userTO));\n-        //--------------------------------\n-\n-        //--------------------------------\n-        // Roles panel\n-        //--------------------------------\n-        form.add(new RolesPanel(\"roles\", userTO, mode == Mode.TEMPLATE));\n-        //--------------------------------\n-\n-        final AjaxButton submit = new IndicatingAjaxButton(\n-                \"apply\", new ResourceModel(\"submit\")) {\n-\n-            private static final long serialVersionUID = -958724007591692537L;\n-\n-            @Override\n-            protected void onSubmit(final AjaxRequestTarget target,\n-                    final Form form) {\n-\n-                final UserTO updatedUserTO = (UserTO) form.getModelObject();\n-                try {\n-                    if (updatedUserTO.getId() == 0) {\n-                        switch (mode) {\n-                            case SELF:\n-                                requestRestClient.requestCreate(updatedUserTO);\n-                                break;\n-\n-                            case ADMIN:\n-                            default:\n-                                userRestClient.create(updatedUserTO);\n-                                if (userRequestTO != null) {\n-                                    requestRestClient.delete(\n-                                            userRequestTO.getId());\n-                                }\n-                                break;\n+        if (!submitted) {\n \n-                            case TEMPLATE:\n-                                syncTaskTO.setUserTemplate(updatedUserTO);\n-                                taskRestClient.updateSyncTask(syncTaskTO);\n-                                break;\n+            if (userRequestTO != null) {\n+                switch (userRequestTO.getType()) {\n+                    case CREATE:\n+                        userTO = userRequestTO.getUserTO();\n+                        break;\n \n-                        }\n-                    } else {\n-                        UserMod userMod = AttributableOperations.diff(\n-                                updatedUserTO, initialUserTO);\n-\n-                        // update user just if it is changed\n-                        if (!userMod.isEmpty()) {\n-                            if (mode == Mode.SELF) {\n-                                requestRestClient.requestUpdate(userMod);\n-                            } else {\n-                                userRestClient.update(userMod);\n-                                if (userRequestTO != null) {\n-                                    requestRestClient.delete(\n-                                            userRequestTO.getId());\n+                    case UPDATE:\n+                        initialUserTO = userRestClient.read(\n+                                userRequestTO.getUserMod().getId());\n+                        userTO = AttributableOperations.apply(\n+                                initialUserTO, userRequestTO.getUserMod());\n+                        break;\n+\n+                    case DELETE:\n+                    default:\n+                }\n+            }\n+            if (syncTaskTO != null) {\n+                userTO = syncTaskTO.getUserTemplate();\n+            }\n+\n+            if (initialUserTO == null && userTO.getId() > 0) {\n+                initialUserTO = AttributableOperations.clone(userTO);\n+            }\n+\n+            fragment.add(new Label(\"id\", userTO.getId() == 0\n+                    ? \"\" : userTO.getUsername()));\n+            fragment.add(new Label(\"new\", userTO.getId() == 0\n+                    ? getString(\"new\") : \"\"));\n+\n+            final Form form = new Form(\"UserForm\");\n+            form.setModel(new CompoundPropertyModel(userTO));\n+\n+            //--------------------------------\n+            // User details\n+            //--------------------------------\n+            form.add(new UserDetailsPanel(\"details\", userTO, form,\n+                    userRequestTO == null, mode == Mode.TEMPLATE));\n+            //--------------------------------\n+\n+            //--------------------------------\n+            // Attributes panel\n+            //--------------------------------\n+            form.add(new AttributesPanel(\"attributes\", userTO, form,\n+                    mode == Mode.TEMPLATE));\n+            //--------------------------------\n+\n+            //--------------------------------\n+            // Derived attributes panel\n+            //--------------------------------\n+            form.add(new DerivedAttributesPanel(\"derivedAttributes\", userTO));\n+            //--------------------------------\n+\n+            //--------------------------------\n+            // Virtual attributes panel\n+            //--------------------------------\n+            form.add(new VirtualAttributesPanel(\"virtualAttributes\", userTO,\n+                    mode == Mode.TEMPLATE));\n+            //--------------------------------\n+\n+            //--------------------------------\n+            // Resources panel\n+            //--------------------------------\n+            form.add(new ResourcesPanel(\"resources\", userTO));\n+            //--------------------------------\n+\n+            //--------------------------------\n+            // Roles panel\n+            //--------------------------------\n+            form.add(new RolesPanel(\"roles\", userTO, mode == Mode.TEMPLATE));\n+            //--------------------------------\n+\n+            final AjaxButton submit = new IndicatingAjaxButton(\n+                    \"apply\", new ResourceModel(\"submit\")) {\n+\n+                private static final long serialVersionUID =\n+                        -958724007591692537L;\n+\n+                @Override\n+                protected void onSubmit(final AjaxRequestTarget target,\n+                        final Form form) {\n+\n+                    final UserTO updatedUserTO = (UserTO) form.getModelObject();\n+                    try {\n+                        if (updatedUserTO.getId() == 0) {\n+                            switch (mode) {\n+                                case SELF:\n+                                    requestRestClient.requestCreate(\n+                                            updatedUserTO);\n+                                    break;\n+\n+                                case ADMIN:\n+                                default:\n+                                    summaryUserTO = userRestClient.create(\n+                                            updatedUserTO);\n+                                    if (userRequestTO != null) {\n+                                        requestRestClient.delete(\n+                                                userRequestTO.getId());\n+                                    }\n+                                    break;\n+\n+                                case TEMPLATE:\n+                                    syncTaskTO.setUserTemplate(updatedUserTO);\n+                                    taskRestClient.updateSyncTask(syncTaskTO);\n+                                    break;\n+\n+                            }\n+                        } else {\n+                            UserMod userMod = AttributableOperations.diff(\n+                                    updatedUserTO, initialUserTO);\n+\n+                            // update user just if it is changed\n+                            if (!userMod.isEmpty()) {\n+                                if (mode == Mode.SELF) {\n+                                    requestRestClient.requestUpdate(userMod);\n+                                } else {\n+                                    summaryUserTO =\n+                                            userRestClient.update(userMod);\n+                                    if (userRequestTO != null) {\n+                                        requestRestClient.delete(\n+                                                userRequestTO.getId());\n+                                    }\n                                 }\n                             }\n                         }\n-                    }\n \n-                    if (callerPageRef.getPage() instanceof BasePage) {\n-                        ((BasePage) callerPageRef.getPage()).setModalResult(\n-                                true);\n+                        if (callerPageRef.getPage() instanceof BasePage) {\n+                            ((BasePage) callerPageRef.getPage()).setModalResult(\n+                                    true);\n+                        }\n+\n+                        setResponsePage(new UserModalPage(callerPageRef,\n+                                window, summaryUserTO, form.isSubmitted()));\n+                    } catch (SyncopeClientCompositeErrorException e) {\n+                        LOG.error(\"While creating or updating user\", e);\n+                        error(getString(\"error\") + \":\" + e.getMessage());\n+                        target.add(feedbackPanel);\n                     }\n+                }\n+\n+                @Override\n+                protected void onError(final AjaxRequestTarget target,\n+                        final Form form) {\n \n-                    window.close(target);\n-                } catch (SyncopeClientCompositeErrorException e) {\n-                    LOG.error(\"While creating or updating user\", e);\n-                    error(getString(\"error\") + \":\" + e.getMessage());\n                     target.add(feedbackPanel);\n                 }\n+            };\n+\n+            if (mode == Mode.ADMIN) {\n+                String allowedRoles = userTO.getId() == 0\n+                        ? xmlRolesReader.getAllAllowedRoles(\"Users\", \"create\")\n+                        : xmlRolesReader.getAllAllowedRoles(\"Users\", \"update\");\n+                MetaDataRoleAuthorizationStrategy.authorize(\n+                        submit, RENDER, allowedRoles);\n             }\n \n-            @Override\n-            protected void onError(final AjaxRequestTarget target,\n-                    final Form form) {\n+            fragment.add(form);\n+            form.add(submit);\n \n-                target.add(feedbackPanel);\n-            }\n-        };\n-\n-        if (mode == Mode.ADMIN) {\n-            String allowedRoles = userTO.getId() == 0\n-                    ? xmlRolesReader.getAllAllowedRoles(\"Users\", \"create\")\n-                    : xmlRolesReader.getAllAllowedRoles(\"Users\", \"update\");\n-            MetaDataRoleAuthorizationStrategy.authorize(\n-                    submit, RENDER, allowedRoles);\n-        }\n+        } else {\n+            final UserSummaryPanel userSummaryPanel =\n+                    new UserSummaryPanel(\"userSummaryPanel\",\n+                    window, summaryUserTO);\n \n-        form.add(submit);\n+            userSummaryPanel.setOutputMarkupId(true);\n+            fragment.add(userSummaryPanel);\n+        }\n \n-        add(form);\n+        add(fragment);\n     }\n }"},{"sha":"b2b807bc8b904fa006e7ca61c683f1dcf0bf10cb","filename":"console/src/main/java/org/syncope/console/pages/panels/UserSummaryPanel.java","status":"added","additions":115,"deletions":0,"changes":115,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/0b24e5c1a9de1db22183a8af447deb875a14ecb2/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FUserSummaryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/0b24e5c1a9de1db22183a8af447deb875a14ecb2/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FUserSummaryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FUserSummaryPanel.java?ref=0b24e5c1a9de1db22183a8af447deb875a14ecb2","patch":"@@ -0,0 +1,115 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one or more\n+ * contributor license agreements.  See the NOTICE file distributed with\n+ * this work for additional information regarding copyright ownership.\n+ * The ASF licenses this file to You under the Apache License, Version 2.0\n+ * (the \"License\"); you may not use this file except in compliance with\n+ * the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+package org.syncope.console.pages.panels;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import java.util.Map;\n+import org.apache.wicket.ajax.AjaxRequestTarget;\n+import org.apache.wicket.ajax.markup.html.AjaxLink;\n+import org.apache.wicket.ajax.markup.html.navigation.paging.AjaxPagingNavigator;\n+import org.apache.wicket.extensions.ajax.markup.html.IndicatingAjaxLink;\n+import org.apache.wicket.extensions.ajax.markup.html.modal.ModalWindow;\n+import org.apache.wicket.markup.html.WebMarkupContainer;\n+import org.apache.wicket.markup.html.basic.Label;\n+import org.apache.wicket.markup.html.image.Image;\n+import org.apache.wicket.markup.html.list.ListItem;\n+import org.apache.wicket.markup.html.list.PageableListView;\n+import org.apache.wicket.markup.html.panel.Panel;\n+import org.apache.wicket.request.resource.ContextRelativeResource;\n+import org.apache.wicket.spring.injection.annot.SpringBean;\n+import org.syncope.client.to.UserTO;\n+import org.syncope.console.commons.PreferenceManager;\n+import org.syncope.types.PropagationTaskExecStatus;\n+\n+public class UserSummaryPanel extends Panel {\n+\n+    private static final long serialVersionUID = 2646115294319713723L;\n+\n+    private static final int PROPAGATION_RESULT_PAGINATOR_ROWS = 7;\n+\n+    @SpringBean\n+    private PreferenceManager prefMan;\n+\n+    private UserTO userTO;\n+\n+    public UserSummaryPanel(final String id,\n+            final ModalWindow window, final UserTO userTO) {\n+        super(id);\n+\n+        this.userTO = userTO;\n+\n+        final WebMarkupContainer container =\n+                new WebMarkupContainer(\"container\");\n+\n+        container.setOutputMarkupId(true);\n+        add(container);\n+\n+        final Map<String, PropagationTaskExecStatus> propagationMap =\n+                userTO.getPropagationStatusMap();\n+\n+        final List<String> resourceListKey =\n+                new ArrayList<String>(propagationMap.keySet());\n+\n+        //Insert Syncope DB propagation status\n+        resourceListKey.add(0, \"Syncope\");\n+        propagationMap.put(\"Syncope\", PropagationTaskExecStatus.SUCCESS);\n+\n+        container.add(new Label(\"userInfo\", userTO.getUsername()));\n+\n+        final PageableListView<String> propagationStatus =\n+                new PageableListView<String>(\n+                \"propagationResults\", resourceListKey,\n+                PROPAGATION_RESULT_PAGINATOR_ROWS) {\n+\n+                    private static final long serialVersionUID =\n+                            -1020475259727720708L;\n+\n+                    @Override\n+                    protected void populateItem(final ListItem item) {\n+                        final String resourceItem =\n+                                (String) item.getDefaultModelObject();\n+\n+                        item.add(new Label(\"resourceName\", resourceItem));\n+                        item.add(new Label(\"propagation\",\n+                                propagationMap.get(resourceItem).name()));\n+\n+                        item.add(new Image(\"status\",\n+                                propagationMap.get(resourceItem).isSuccessful()\n+                                ? new ContextRelativeResource(\n+                                \"img/success.png\")\n+                                : new ContextRelativeResource(\n+                                \"img/warning.png\")));\n+                    }\n+                };\n+\n+        container.add(new AjaxPagingNavigator(\"navigator\", propagationStatus));\n+\n+        final AjaxLink close = new IndicatingAjaxLink(\"close\") {\n+\n+            private static final long serialVersionUID = -7978723352517770644L;\n+\n+            @Override\n+            public void onClick(final AjaxRequestTarget target) {\n+                window.close(target);\n+            }\n+        };\n+\n+        container.add(close);\n+        container.add(propagationStatus);\n+    }\n+}"},{"sha":"967e5fab1d7b2c9c897d1bdc7b07321980802189","filename":"console/src/main/java/org/syncope/console/rest/UserRestClient.java","status":"modified","additions":5,"deletions":5,"changes":10,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/0b24e5c1a9de1db22183a8af447deb875a14ecb2/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Frest%2FUserRestClient.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/0b24e5c1a9de1db22183a8af447deb875a14ecb2/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Frest%2FUserRestClient.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Frest%2FUserRestClient.java?ref=0b24e5c1a9de1db22183a8af447deb875a14ecb2","patch":"@@ -50,10 +50,10 @@ public List<UserTO> list(final int page, final int size) {\n      * @param userTO instance\n      * @throws SyncopeClientCompositeErrorException\n      */\n-    public void create(final UserTO userTO)\n+    public UserTO create(final UserTO userTO)\n             throws SyncopeClientCompositeErrorException {\n \n-        restTemplate.postForObject(baseURL\n+        return restTemplate.postForObject(baseURL\n                 + \"user/create\", userTO, UserTO.class);\n     }\n \n@@ -62,15 +62,15 @@ public void create(final UserTO userTO)\n      * @param userTO\n      * @return true is the opertion ends succesfully, false otherwise\n      */\n-    public void update(UserMod userModTO)\n+    public UserTO update(UserMod userModTO)\n             throws SyncopeClientCompositeErrorException {\n \n-        restTemplate.postForObject(baseURL + \"user/update\",\n+        return restTemplate.postForObject(baseURL + \"user/update\",\n                 userModTO, UserTO.class);\n     }\n \n     public void delete(Long id) {\n-        restTemplate.delete(baseURL + \"user/delete/{userId}\", id);\n+         restTemplate.delete(baseURL + \"user/delete/{userId}\", id);\n     }\n \n     public UserTO read(Long id) {"},{"sha":"c17bffb91c83f7d601777769f1a959b61ebbc0a1","filename":"console/src/main/resources/org/syncope/console/pages/UserModalPage.html","status":"modified","additions":58,"deletions":47,"changes":105,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/0b24e5c1a9de1db22183a8af447deb875a14ecb2/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/0b24e5c1a9de1db22183a8af447deb875a14ecb2/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage.html?ref=0b24e5c1a9de1db22183a8af447deb875a14ecb2","patch":"@@ -54,58 +54,69 @@\n </wicket:head>\n \n <wicket:extend>\n-    <div style=\"margin:10px\">\n-        <p class=\"ui-widget ui-corner-all ui-widget-header\">\n-            <span wicket:id=\"new\"/>&nbsp;<wicket:message key=\"title\"/>&nbsp;<span wicket:id=\"id\"/>\n-        </p>\n-\n-        <form wicket:id=\"UserForm\">\n-            <div id=\"tabs\">\n-                <ul>\n-                    <li  class=\"tabs-selected\"><a href=\"#tabs-1\"><span><wicket:message key=\"tab1\"/></span></a></li>\n-                    <li><a href=\"#tabs-2\"><span><wicket:message key=\"tab2\"/></span></a></li>\n-                    <li><a href=\"#tabs-3\"><span><wicket:message key=\"tab3\"/></span></a></li>\n-                    <li><a href=\"#tabs-4\"><span><wicket:message key=\"tab4\"/></span></a></li>\n-                    <li><a href=\"#tabs-5\"><span><wicket:message key=\"tab5\"/></span></a></li>\n-                    <li><a href=\"#tabs-6\"><span><wicket:message key=\"tab6\"/></span></a></li>\n-                </ul>\n-                <div id=\"tabs-1\">\n-                    <span wicket:id=\"details\">[user details]</span>\n-                </div>\n-                <div id=\"tabs-2\">\n-                    <div id=\"formtable\">\n-                        <span wicket:id=\"attributes\">[user attributes]</span>\n+\n+    <span wicket:id=\"userPanel\"/>\n+\n+    <wicket:fragment wicket:id=\"editPanel\">\n+\n+        <div style=\"margin:10px\">\n+            <p class=\"ui-widget ui-corner-all ui-widget-header\">\n+                <span wicket:id=\"new\"/>&nbsp;<wicket:message key=\"title\"/>&nbsp;<span wicket:id=\"id\"/>\n+            </p>\n+\n+            <form wicket:id=\"UserForm\">\n+                <div id=\"tabs\">\n+                    <ul>\n+                        <li  class=\"tabs-selected\"><a href=\"#tabs-1\"><span><wicket:message key=\"tab1\"/></span></a></li>\n+                        <li><a href=\"#tabs-2\"><span><wicket:message key=\"tab2\"/></span></a></li>\n+                        <li><a href=\"#tabs-3\"><span><wicket:message key=\"tab3\"/></span></a></li>\n+                        <li><a href=\"#tabs-4\"><span><wicket:message key=\"tab4\"/></span></a></li>\n+                        <li><a href=\"#tabs-5\"><span><wicket:message key=\"tab5\"/></span></a></li>\n+                        <li><a href=\"#tabs-6\"><span><wicket:message key=\"tab6\"/></span></a></li>\n+                    </ul>\n+                    <div id=\"tabs-1\">\n+                        <span wicket:id=\"details\">[user details]</span>\n+                    </div>\n+                    <div id=\"tabs-2\">\n+                        <div id=\"formtable\">\n+                            <span wicket:id=\"attributes\">[user attributes]</span>\n+                        </div>\n                     </div>\n-                </div>\n \n-                <div id=\"tabs-3\">\n-                    <span wicket:id=\"derivedAttributes\">[user derived attributes]</span>\n-                </div>\n+                    <div id=\"tabs-3\">\n+                        <span wicket:id=\"derivedAttributes\">[user derived attributes]</span>\n+                    </div>\n \n-                <div id=\"tabs-4\">\n-                    <span wicket:id=\"virtualAttributes\">[user virtual attributes]</span>\n-                </div>\n+                    <div id=\"tabs-4\">\n+                        <span wicket:id=\"virtualAttributes\">[user virtual attributes]</span>\n+                    </div>\n+\n+                    <div id=\"tabs-5\">\n+                        <span wicket:id=\"resources\">[resources]</span>\n+                    </div>\n \n-                <div id=\"tabs-5\">\n-                    <span wicket:id=\"resources\">[resources]</span>\n+                    <div id=\"tabs-6\">\n+                        <span wicket:id=\"roles\">[roles]</span>\n+                    </div>\n                 </div>\n \n-                <div id=\"tabs-6\">\n-                    <span wicket:id=\"roles\">[roles]</span>\n+                <script type=\"text/javascript\">\n+                    $(function() {\n+                        $('#formtable div.tablerow:even').addClass(\"alt\");\n+                    });\n+                </script>\n+\n+                <div style=\"margin: 20px 10px 0\">\n+                    <input type=\"submit\"\n+                           class=\"ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only\"\n+                           wicket:id=\"apply\"/>\n                 </div>\n-            </div>\n-\n-            <script type=\"text/javascript\">\n-                $(function() {\n-                    $('#formtable div.tablerow:even').addClass(\"alt\");\n-                });\n-            </script>\n-\n-            <div style=\"margin: 20px 10px 0\">\n-                <input type=\"submit\"\n-                       class=\"ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only\"\n-                       wicket:id=\"apply\"/>\n-            </div>\n-        </form>\n-    </div>\n+            </form>\n+        </div>\n+    </wicket:fragment>\n+\n+    <wicket:fragment wicket:id=\"summaryPanel\">\n+        <span wicket:id=\"userSummaryPanel\"/>\n+    </wicket:fragment>\n+\n </wicket:extend>\n\\ No newline at end of file"},{"sha":"9da221d70fa9fad2e0a9d4337b13e2142d06bba3","filename":"console/src/main/resources/org/syncope/console/pages/panels/UserSummaryPanel.html","status":"added","additions":57,"deletions":0,"changes":57,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/0b24e5c1a9de1db22183a8af447deb875a14ecb2/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FUserSummaryPanel.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/0b24e5c1a9de1db22183a8af447deb875a14ecb2/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FUserSummaryPanel.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FUserSummaryPanel.html?ref=0b24e5c1a9de1db22183a8af447deb875a14ecb2","patch":"@@ -0,0 +1,57 @@\n+<!--\n+ Licensed under the Apache License, Version 2.0 (the \"License\");\n+ you may not use this file except in compliance with the License.\n+ You may obtain a copy of the License at\n+\n+      http://www.apache.org/licenses/LICENSE-2.0\n+\n+ Unless required by applicable law or agreed to in writing, software\n+ distributed under the License is distributed on an \"AS IS\" BASIS,\n+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ See the License for the specific language governing permissions and\n+ limitations under the License.\n+ under the License.\n+-->\n+<wicket:panel>\n+\n+    <div wicket:id=\"container\" id=\"users-contain\" class=\"ui-widget\" style=\"margin:30px; width:inherit\">\n+\n+        <p class=\"ui-widget ui-corner-all ui-widget-header\">\n+        <wicket:message key=\"operationResult\"/>&nbsp;<span wicket:id=\"userInfo\"/>\n+        </p>\n+\n+        <div>\n+            <span class=\"text ui-corner-all\"\n+                  style=\"float:right\" wicket:id=\"navigator\">\n+            </span>\n+        </div>\n+        <table class=\"ui-widget ui-widget-content table-hover\"\n+               style=\"font-size:1.1em\" cellpadding=\"5px\" cellspacing=\"2px\">\n+            <thead>\n+                <tr class=\"ui-widget-header\">\n+                    <th><wicket:message key=\"resource\"/></th>\n+            <th><wicket:message key=\"propagation\"/></th>\n+            <th><wicket:message key=\"status\"/></th>\n+            </tr>\n+            </thead>\n+            <tbody>\n+                <tr wicket:id=\"propagationResults\">\n+                    <td>\n+                        <span wicket:id=\"resourceName\"/>\n+                    </td>\n+                    <td>\n+                        <span wicket:id=\"propagation\"/>\n+                    </td>\n+                    <td>\n+                        <img wicket:id=\"status\"/>\n+                    </td>\n+                </tr>\n+            </tbody>\n+\n+        </table>\n+        <a class=\"ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only\"\n+           wicket:id=\"close\">\n+            <wicket:message key=\"close\"/>\n+        </a>\n+    </div>\n+</wicket:panel>\n\\ No newline at end of file"},{"sha":"1f87dd2b01d6860636234e7a81b0c36c632e1b8a","filename":"console/src/main/resources/org/syncope/console/pages/panels/UserSummaryPanel.properties","status":"added","additions":5,"deletions":0,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/0b24e5c1a9de1db22183a8af447deb875a14ecb2/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FUserSummaryPanel.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/0b24e5c1a9de1db22183a8af447deb875a14ecb2/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FUserSummaryPanel.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FUserSummaryPanel.properties?ref=0b24e5c1a9de1db22183a8af447deb875a14ecb2","patch":"@@ -0,0 +1,5 @@\n+resource=Resource\n+status=Status\n+propagation=Propagation\n+operationResult=Operation result for\n+close=Close\n\\ No newline at end of file"},{"sha":"7f908cfd6f9fd79d94e5c9ccb832f1e89cef1746","filename":"console/src/main/resources/org/syncope/console/pages/panels/UserSummaryPanel_it.properties","status":"added","additions":5,"deletions":0,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/0b24e5c1a9de1db22183a8af447deb875a14ecb2/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FUserSummaryPanel_it.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/0b24e5c1a9de1db22183a8af447deb875a14ecb2/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FUserSummaryPanel_it.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FUserSummaryPanel_it.properties?ref=0b24e5c1a9de1db22183a8af447deb875a14ecb2","patch":"@@ -0,0 +1,5 @@\n+resource=Risorsa\n+status=Stato\n+propagation=Propagazione\n+operationResult=Risultato dell'operazione per\n+close=Chiudi"},{"sha":"e4b1df77e09eed1eb5c2a39364d7c0b03cb36640","filename":"console/src/main/webapp/img/success.png","status":"added","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/0b24e5c1a9de1db22183a8af447deb875a14ecb2/console%2Fsrc%2Fmain%2Fwebapp%2Fimg%2Fsuccess.png","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/0b24e5c1a9de1db22183a8af447deb875a14ecb2/console%2Fsrc%2Fmain%2Fwebapp%2Fimg%2Fsuccess.png","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fwebapp%2Fimg%2Fsuccess.png?ref=0b24e5c1a9de1db22183a8af447deb875a14ecb2"},{"sha":"14c51d6c149407a88cdb324913c47b81610be548","filename":"console/src/main/webapp/img/warning.png","status":"added","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/0b24e5c1a9de1db22183a8af447deb875a14ecb2/console%2Fsrc%2Fmain%2Fwebapp%2Fimg%2Fwarning.png","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/0b24e5c1a9de1db22183a8af447deb875a14ecb2/console%2Fsrc%2Fmain%2Fwebapp%2Fimg%2Fwarning.png","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fwebapp%2Fimg%2Fwarning.png?ref=0b24e5c1a9de1db22183a8af447deb875a14ecb2"},{"sha":"6060eb6661b4de3accefa428dad317d4b2da28cd","filename":"console/src/test/java/org/syncope/console/RoleTestITCase.java","status":"modified","additions":20,"deletions":15,"changes":35,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/0b24e5c1a9de1db22183a8af447deb875a14ecb2/console%2Fsrc%2Ftest%2Fjava%2Forg%2Fsyncope%2Fconsole%2FRoleTestITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/0b24e5c1a9de1db22183a8af447deb875a14ecb2/console%2Fsrc%2Ftest%2Fjava%2Forg%2Fsyncope%2Fconsole%2FRoleTestITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Ftest%2Fjava%2Forg%2Fsyncope%2Fconsole%2FRoleTestITCase.java?ref=0b24e5c1a9de1db22183a8af447deb875a14ecb2","patch":"@@ -26,7 +26,7 @@ public void createRootNodeModal() {\n \n         selenium.click(\"//div[3]/span/div/div/table\"\n                 + \"/tbody/tr/td[2]/table/tbody/tr/td/img\");\n-        \n+\n         selenium.click(\"//div[3]/span[2]/span/div/p/span/span/a\");\n         for (int second = 0;; second++) {\n             if (second >= 60) {\n@@ -57,7 +57,7 @@ public void browseCreateModal() {\n         selenium.waitForPageToLoad(\"30000\");\n         selenium.click(\"//div[3]/span/div/div/table[3]/tbody/tr/td[4]/\"\n                 + \"table/tbody/tr/td/a[1]\");\n-        \n+\n         selenium.click(\"//div[3]/span[2]/span/span/div/p/span/span/a[1]/\");\n         for (int second = 0;; second++) {\n             if (second >= 60) {\n@@ -94,7 +94,7 @@ public void browseEditModal() {\n         selenium.waitForPageToLoad(\"30000\");\n         selenium.click(\"//div[3]/span/div/div/table[3]/tbody/tr/td[4]/\"\n                 + \"table/tbody/tr/td/a[1]\");\n-        \n+\n         selenium.click(\"//div[3]/span[2]/span/span/div/p/span[2]/span/a[2]\");\n         for (int second = 0;; second++) {\n             if (second >= 60) {\n@@ -131,7 +131,7 @@ public void checkSecurityTab() {\n         selenium.waitForPageToLoad(\"30000\");\n         selenium.click(\"//div[3]/span/div/div/table[3]/tbody/tr/\"\n                 + \"td[4]/table/tbody/tr/td[2]/a\");\n-        \n+\n         selenium.click(\"//div[3]/span[2]/span/span/div/p/span[2]/span/a[2]\");\n \n         for (int second = 0;; second++) {\n@@ -173,7 +173,7 @@ public void displayRoleAttributes() {\n         selenium.waitForPageToLoad(\"30000\");\n         selenium.click(\"//div[3]/span/div/div/table[3]/tbody/tr/td[4]/\"\n                 + \"table/tbody/tr/td/a[1]\");\n-        \n+\n         selenium.click(\"//div[3]/span[2]/span/span/div/p/span/span/a[1]/\");\n         for (int second = 0;; second++) {\n             if (second >= 60) {\n@@ -251,11 +251,17 @@ public void browseUserEditModal() {\n         selenium.setSpeed(\"1000\");\n \n         selenium.click(\"css=img[alt=\\\"Roles\\\"]\");\n-        selenium.waitForPageToLoad(\"30000\");\n+        try {\n+            Thread.sleep(3000);\n+        } catch (InterruptedException e) {\n+        }\n         //Prende Root\n         selenium.click(\"//div[3]/span/div/div/table[2]/tbody/\"\n                 + \"tr/td[3]/table/tbody/tr/td[2]/a/span\");\n-        \n+        try {\n+            Thread.sleep(5000);\n+        } catch (InterruptedException e) {\n+        }\n         selenium.click(\"//div[3]/span[2]/span/\"\n                 + \"span/div/form/div[2]/ul/li[7]/a/span\");\n \n@@ -269,16 +275,15 @@ public void browseUserEditModal() {\n             }\n             try {\n                 if (selenium.isElementPresent(\n-                        \"//div[2]/form/div[2]/div/\"\n-                        + \"span/div/div/div[contains(text(),'Username')]\")) {\n+                        \"//span/div/form/div[2]/div/span/div/div/\"\n+                        + \"div[contains(text(),'Username')]\")) {\n                     break;\n                 }\n             } catch (Exception e) {\n             }\n-            \n-            selenium.selectFrame(\"relative=up\");\n-            selenium.click(\"css=a.w_close\");\n         }\n+        selenium.selectFrame(\"relative=up\");\n+        selenium.click(\"css=a.w_close\");\n     }\n \n     @Test\n@@ -290,7 +295,7 @@ public void deleteUser() {\n         //Remove user4\n         selenium.click(\"//div[3]/span/div/div/table[10]/tbody/\"\n                 + \"tr/td[6]/table/tbody/tr/td[2]/a/span\");\n-        \n+\n         selenium.click(\"//div[3]/span[2]/span/\"\n                 + \"span/div/form/div[2]/ul/li[7]/a/span\");\n \n@@ -308,11 +313,11 @@ public void deleteRole() {\n         selenium.setSpeed(\"1000\");\n         selenium.click(\"css=img[alt=\\\"Roles\\\"]\");\n         selenium.waitForPageToLoad(\"30000\");\n-        \n+\n         //Remove managing director\n         selenium.click(\"//div[3]/span/div/div/table[10]/tbody\"\n                 + \"/tr/td[6]/table/tbody/tr/td[2]/a\");\n-        \n+\n         selenium.click(\"//div[3]/span[2]/span/span/div/p/span[2]/span/a[3]\");\n         assertTrue(selenium.getConfirmation().matches(\n                 \"^Do you really want to delete the selected item[\\\\s\\\\S]$\"));"}]}