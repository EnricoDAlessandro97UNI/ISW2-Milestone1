{"sha":"1012e616598d3ff8e42460d4a2eb8f0eeca6504e","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjEwMTJlNjE2NTk4ZDNmZjhlNDI0NjBkNGEyZWI4ZjBlZWNhNjUwNGU=","commit":{"author":{"name":"fmartelli","email":"fabio.martelli@gmail.com","date":"2015-02-20T09:51:59Z"},"committer":{"name":"fmartelli","email":"fabio.martelli@gmail.com","date":"2015-02-20T09:51:59Z"},"message":"[SYNCOPE-646] fix on branch 1_2_X","tree":{"sha":"e045e73b63af4459b1517edaf7d7e6fce2efdda8","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/e045e73b63af4459b1517edaf7d7e6fce2efdda8"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/1012e616598d3ff8e42460d4a2eb8f0eeca6504e","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/1012e616598d3ff8e42460d4a2eb8f0eeca6504e","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/1012e616598d3ff8e42460d4a2eb8f0eeca6504e","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/1012e616598d3ff8e42460d4a2eb8f0eeca6504e/comments","author":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"committer":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"parents":[{"sha":"583e83905f533293ee621e9fce0d82fecfdb1938","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/583e83905f533293ee621e9fce0d82fecfdb1938","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/583e83905f533293ee621e9fce0d82fecfdb1938"}],"stats":{"total":43,"additions":41,"deletions":2},"files":[{"sha":"4ec1964a761dbd6fcca8262761b2740b1c00c48c","filename":"core/src/main/java/org/apache/syncope/core/propagation/impl/PropagationManager.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/1012e616598d3ff8e42460d4a2eb8f0eeca6504e/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpropagation%2Fimpl%2FPropagationManager.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/1012e616598d3ff8e42460d4a2eb8f0eeca6504e/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpropagation%2Fimpl%2FPropagationManager.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpropagation%2Fimpl%2FPropagationManager.java?ref=1012e616598d3ff8e42460d4a2eb8f0eeca6504e","patch":"@@ -305,7 +305,7 @@ public List<PropagationTask> getUserUpdateTaskIds(final WorkflowResult<Map.Entry\n         List<PropagationTask> tasks = new ArrayList<PropagationTask>();\n         if (userMod.getPwdPropRequest() == null) {\n             // a. no specific password propagation request: generate propagation tasks for any resource associated\n-            tasks = getUserUpdateTaskIds(wfResult, true, null);\n+            tasks = getUserUpdateTaskIds(wfResult, false, null);\n         } else {\n             // b. generate the propagation task list in two phases: first the ones containing password,\n             // the the rest (with no password)"},{"sha":"00fa956449f81463b8218243cd22a11e66f0a7ac","filename":"core/src/main/java/org/apache/syncope/core/workflow/user/activiti/ActivitiUserWorkflowAdapter.java","status":"modified","additions":11,"deletions":0,"changes":11,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/1012e616598d3ff8e42460d4a2eb8f0eeca6504e/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fworkflow%2Fuser%2Factiviti%2FActivitiUserWorkflowAdapter.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/1012e616598d3ff8e42460d4a2eb8f0eeca6504e/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fworkflow%2Fuser%2Factiviti%2FActivitiUserWorkflowAdapter.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fworkflow%2Fuser%2Factiviti%2FActivitiUserWorkflowAdapter.java?ref=1012e616598d3ff8e42460d4a2eb8f0eeca6504e","patch":"@@ -65,6 +65,7 @@\n import org.apache.syncope.common.types.WorkflowFormPropertyType;\n import org.apache.syncope.common.util.BeanUtils;\n import org.apache.syncope.common.SyncopeClientException;\n+import org.apache.syncope.common.mod.StatusMod;\n import org.apache.syncope.core.persistence.beans.user.SyncopeUser;\n import org.apache.syncope.core.persistence.dao.NotFoundException;\n import org.apache.syncope.core.persistence.validation.attrvalue.ParsingValidationException;\n@@ -879,6 +880,16 @@ public WorkflowResult<UserMod> submitForm(final WorkflowFormTO form)\n             userMod = new UserMod();\n             userMod.setId(updated.getId());\n             userMod.setPassword(clearPassword);\n+\n+            if (propByRes != null) {\n+                final StatusMod st = new StatusMod();\n+                userMod.setPwdPropRequest(st);\n+\n+                st.setOnSyncope(true);\n+                for (String res : propByRes.get(ResourceOperation.CREATE)) {\n+                    st.getResourceNames().add(res);\n+                }\n+            }\n         }\n \n         return new WorkflowResult<UserMod>(userMod, propByRes, postTasks);"},{"sha":"aaf53472ab13e050536a811c42e0c54b0666ea0d","filename":"core/src/test/java/org/apache/syncope/core/rest/UserSelfTestITCase.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/1012e616598d3ff8e42460d4a2eb8f0eeca6504e/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2FUserSelfTestITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/1012e616598d3ff8e42460d4a2eb8f0eeca6504e/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2FUserSelfTestITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2FUserSelfTestITCase.java?ref=1012e616598d3ff8e42460d4a2eb8f0eeca6504e","patch":"@@ -93,7 +93,7 @@ public void createAndApprove() {\n         membership.setRoleId(3L);\n         userTO.getMemberships().add(membership);\n         userTO.getResources().add(RESOURCE_NAME_TESTDB);\n-\n+        \n         SyncopeClient anonClient = clientFactory.createAnonymous();\n         userTO = anonClient.getService(UserSelfService.class).\n                 create(userTO, true)."},{"sha":"a17e75be01cb121e33a1b0e7bd45fc6f019138c3","filename":"core/src/test/java/org/apache/syncope/core/rest/UserTestITCase.java","status":"modified","additions":28,"deletions":0,"changes":28,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/1012e616598d3ff8e42460d4a2eb8f0eeca6504e/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2FUserTestITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/1012e616598d3ff8e42460d4a2eb8f0eeca6504e/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2FUserTestITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2FUserTestITCase.java?ref=1012e616598d3ff8e42460d4a2eb8f0eeca6504e","patch":"@@ -1069,6 +1069,11 @@ public final void issue280() {\n         userMod.setId(userTO.getId());\n         userMod.setPassword(\"123password\");\n         userMod.getResourcesToAdd().add(RESOURCE_NAME_TESTDB);\n+        \n+        final StatusMod st = new StatusMod();\n+        st.setOnSyncope(false);\n+        st.getResourceNames().add(RESOURCE_NAME_TESTDB);\n+        userMod.setPwdPropRequest(st);\n \n         userTO = updateUser(userMod);\n         assertNotNull(userTO);\n@@ -1558,6 +1563,11 @@ public void isseSYNCOPE136AES() {\n         UserMod userMod = new UserMod();\n         userMod.setId(userTO.getId());\n         userMod.getResourcesToAdd().add(RESOURCE_NAME_WS1);\n+        \n+        final StatusMod st = new StatusMod();\n+        st.setOnSyncope(false);\n+        st.getResourceNames().add(RESOURCE_NAME_WS1);\n+        userMod.setPwdPropRequest(st);        \n \n         userTO = updateUser(userMod);\n         assertNotNull(userTO);\n@@ -1588,6 +1598,12 @@ public void isseSYNCOPE136Random() {\n         UserMod userMod = new UserMod();\n         userMod.setId(userTO.getId());\n         userMod.getResourcesToAdd().add(RESOURCE_NAME_LDAP);\n+\n+        final StatusMod st = new StatusMod();\n+        st.setOnSyncope(false);\n+        st.getResourceNames().add(RESOURCE_NAME_LDAP);\n+        userMod.setPwdPropRequest(st);\n+        \n         userTO = updateUser(userMod);\n         assertNotNull(userTO);\n \n@@ -2302,6 +2318,12 @@ public void issueSYNCOPE505DB() throws Exception {\n         UserMod userMod = new UserMod();\n         userMod.setId(user.getId());\n         userMod.getResourcesToAdd().add(RESOURCE_NAME_TESTDB);\n+\n+        final StatusMod st = new StatusMod();\n+        st.setOnSyncope(false);\n+        st.getResourceNames().add(RESOURCE_NAME_TESTDB);\n+        userMod.setPwdPropRequest(st);\n+        \n         user = updateUser(userMod);\n         assertNotNull(user);\n         assertEquals(1, user.getResources().size());\n@@ -2339,6 +2361,12 @@ public void issueSYNCOPE505LDAP() throws Exception {\n         UserMod userMod = new UserMod();\n         userMod.setId(user.getId());\n         userMod.getResourcesToAdd().add(RESOURCE_NAME_LDAP);\n+        \n+        final StatusMod st = new StatusMod();\n+        st.setOnSyncope(false);\n+        st.getResourceNames().add(RESOURCE_NAME_LDAP);\n+        userMod.setPwdPropRequest(st);\n+\n         user = updateUser(userMod);\n         assertNotNull(user);\n         assertEquals(1, user.getResources().size());"}]}