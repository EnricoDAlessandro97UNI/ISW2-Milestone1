{"sha":"7d5954dc188b8f39ab67834dc11f9d1f8277e5ff","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjdkNTk1NGRjMTg4YjhmMzlhYjY3ODM0ZGMxMWY5ZDFmODI3N2U1ZmY=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2019-12-18T08:37:59Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2019-12-18T08:39:44Z"},"message":"Improving PlainSchemaDAO#hasAttrs implementations","tree":{"sha":"4beb7b60f26ac1081ff277afb8c255307119a6fa","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/4beb7b60f26ac1081ff277afb8c255307119a6fa"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"028a232543a5ae5c9ee60de532f3a7e6a841e78f","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/028a232543a5ae5c9ee60de532f3a7e6a841e78f","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/028a232543a5ae5c9ee60de532f3a7e6a841e78f"}],"stats":{"total":164,"additions":132,"deletions":32},"files":[{"sha":"9034af0c279b675a902f4800091014f949aac70b","filename":"core/persistence-jpa-json/src/main/java/org/apache/syncope/core/persistence/jpa/dao/AbstractJPAJSONPlainSchemaDAO.java","status":"added","additions":51,"deletions":0,"changes":51,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FAbstractJPAJSONPlainSchemaDAO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FAbstractJPAJSONPlainSchemaDAO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FAbstractJPAJSONPlainSchemaDAO.java?ref=7d5954dc188b8f39ab67834dc11f9d1f8277e5ff","patch":"@@ -0,0 +1,51 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.core.persistence.jpa.dao;\n+\n+import java.util.List;\n+import org.apache.syncope.common.lib.types.AnyTypeKind;\n+import org.apache.syncope.core.persistence.api.entity.PlainAttr;\n+import org.apache.syncope.core.persistence.api.entity.PlainSchema;\n+import org.apache.syncope.core.persistence.api.entity.anyobject.APlainAttr;\n+import org.apache.syncope.core.persistence.api.entity.group.GPlainAttr;\n+\n+abstract class AbstractJPAJSONPlainSchemaDAO extends JPAPlainSchemaDAO {\n+\n+    @Override\n+    public <T extends PlainAttr<?>> List<T> findAttrs(final PlainSchema schema, final Class<T> reference) {\n+        // not possible\n+        return List.of();\n+    }\n+\n+    protected <T extends PlainAttr<?>> AnyTypeKind getAnyTypeKind(final Class<T> plainAttrClass) {\n+        if (GPlainAttr.class.isAssignableFrom(plainAttrClass)) {\n+            return AnyTypeKind.GROUP;\n+        }\n+        if (APlainAttr.class.isAssignableFrom(plainAttrClass)) {\n+            return AnyTypeKind.ANY_OBJECT;\n+        }\n+\n+        return AnyTypeKind.USER;\n+    }\n+\n+    @Override\n+    protected void deleteAttrs(final PlainSchema schema) {\n+        // nothing to do\n+    }\n+}"},{"sha":"07c99697a6aeb217e127c5de816634de8b2804e8","filename":"core/persistence-jpa-json/src/main/java/org/apache/syncope/core/persistence/jpa/dao/MyJPAJSONPlainSchemaDAO.java","status":"renamed","additions":7,"deletions":15,"changes":22,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FMyJPAJSONPlainSchemaDAO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FMyJPAJSONPlainSchemaDAO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FMyJPAJSONPlainSchemaDAO.java?ref=7d5954dc188b8f39ab67834dc11f9d1f8277e5ff","patch":"@@ -18,26 +18,18 @@\n  */\n package org.apache.syncope.core.persistence.jpa.dao;\n \n-import java.util.List;\n+import javax.persistence.Query;\n import org.apache.syncope.core.persistence.api.entity.PlainAttr;\n import org.apache.syncope.core.persistence.api.entity.PlainSchema;\n \n-public class JPAJSONPlainSchemaDAO extends JPAPlainSchemaDAO {\n+public class MyJPAJSONPlainSchemaDAO extends AbstractJPAJSONPlainSchemaDAO {\n \n     @Override\n-    public <T extends PlainAttr<?>> List<T> findAttrs(final PlainSchema schema, final Class<T> reference) {\n-        // not possible\n-        return List.of();\n-    }\n+    public <T extends PlainAttr<?>> boolean hasAttrs(final PlainSchema schema, final Class<T> reference) {\n+        Query query = entityManager().createNativeQuery(\n+                \"SELECT COUNT(id) FROM \" + new SearchSupport(getAnyTypeKind(reference)).field().name\n+                + \" WHERE JSON_CONTAINS(plainAttrs, '[{\\\"schema\\\":\\\"\" + schema.getKey() + \"\\\"}]')\");\n \n-    @Override\n-    public <T extends PlainAttr<?>> boolean hasAttrs(final PlainSchema schema, final Class<T> plainAttrTable) {\n-        // not possible\n-        return true;\n-    }\n-\n-    @Override\n-    protected void deleteAttrs(final PlainSchema schema) {\n-        // nothing to do\n+        return (long) query.getSingleResult() > 0;\n     }\n }","previous_filename":"core/persistence-jpa-json/src/main/java/org/apache/syncope/core/persistence/jpa/dao/JPAJSONPlainSchemaDAO.java"},{"sha":"77019a7f69ca50feaf3ec42fccf1483cce0f06c4","filename":"core/persistence-jpa-json/src/main/java/org/apache/syncope/core/persistence/jpa/dao/PGJPAJSONPlainSchemaDAO.java","status":"added","additions":35,"deletions":0,"changes":35,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FPGJPAJSONPlainSchemaDAO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FPGJPAJSONPlainSchemaDAO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FPGJPAJSONPlainSchemaDAO.java?ref=7d5954dc188b8f39ab67834dc11f9d1f8277e5ff","patch":"@@ -0,0 +1,35 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.core.persistence.jpa.dao;\n+\n+import javax.persistence.Query;\n+import org.apache.syncope.core.persistence.api.entity.PlainAttr;\n+import org.apache.syncope.core.persistence.api.entity.PlainSchema;\n+\n+public class PGJPAJSONPlainSchemaDAO extends AbstractJPAJSONPlainSchemaDAO {\n+\n+    @Override\n+    public <T extends PlainAttr<?>> boolean hasAttrs(final PlainSchema schema, final Class<T> reference) {\n+        Query query = entityManager().createNativeQuery(\n+                \"SELECT COUNT(id) FROM \" + new SearchSupport(getAnyTypeKind(reference)).field().name\n+                + \" WHERE plainAttrs @> '[{\\\"schema\\\":\\\"\" + schema.getKey() + \"\\\"}]'::jsonb\");\n+\n+        return (long) query.getSingleResult() > 0;\n+    }\n+}"},{"sha":"1a7d556588b5c5b54d2f5b5fd7ef764b6ce7b302","filename":"core/persistence-jpa-json/src/main/resources/myjson/persistence.properties","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fresources%2Fmyjson%2Fpersistence.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fresources%2Fmyjson%2Fpersistence.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fresources%2Fmyjson%2Fpersistence.properties?ref=7d5954dc188b8f39ab67834dc11f9d1f8277e5ff","patch":"@@ -16,7 +16,7 @@\n # under the License.\n content.directory=${conf.directory}\n entity.factory=org.apache.syncope.core.persistence.jpa.entity.MyJPAJSONEntityFactory\n-plainSchema.dao=org.apache.syncope.core.persistence.jpa.dao.JPAJSONPlainSchemaDAO\n+plainSchema.dao=org.apache.syncope.core.persistence.jpa.dao.MyJPAJSONPlainSchemaDAO\n plainAttr.dao=org.apache.syncope.core.persistence.jpa.dao.JPAJSONPlainAttrDAO\n plainAttrValue.dao=org.apache.syncope.core.persistence.jpa.dao.JPAJSONPlainAttrValueDAO\n any.search.dao=org.apache.syncope.core.persistence.jpa.dao.MyJPAJSONAnySearchDAO"},{"sha":"d4a22e9bdc6a747e6972f4e7641843c21daf24bb","filename":"core/persistence-jpa-json/src/main/resources/pgjsonb/persistence.properties","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fresources%2Fpgjsonb%2Fpersistence.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fresources%2Fpgjsonb%2Fpersistence.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fresources%2Fpgjsonb%2Fpersistence.properties?ref=7d5954dc188b8f39ab67834dc11f9d1f8277e5ff","patch":"@@ -16,7 +16,7 @@\n # under the License.\n content.directory=${conf.directory}\n entity.factory=org.apache.syncope.core.persistence.jpa.entity.PGJPAJSONEntityFactory\n-plainSchema.dao=org.apache.syncope.core.persistence.jpa.dao.JPAJSONPlainSchemaDAO\n+plainSchema.dao=org.apache.syncope.core.persistence.jpa.dao.PGJPAJSONPlainSchemaDAO\n plainAttr.dao=org.apache.syncope.core.persistence.jpa.dao.JPAJSONPlainAttrDAO\n plainAttrValue.dao=org.apache.syncope.core.persistence.jpa.dao.JPAJSONPlainAttrValueDAO\n any.search.dao=org.apache.syncope.core.persistence.jpa.dao.PGJPAJSONAnySearchDAO"},{"sha":"8bb728bfcffaab250f5fb9e0eac99fb56fd79a2a","filename":"core/persistence-jpa/src/main/java/org/apache/syncope/core/persistence/jpa/dao/JPAPlainSchemaDAO.java","status":"modified","additions":11,"deletions":8,"changes":19,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff/core%2Fpersistence-jpa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FJPAPlainSchemaDAO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff/core%2Fpersistence-jpa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FJPAPlainSchemaDAO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FJPAPlainSchemaDAO.java?ref=7d5954dc188b8f39ab67834dc11f9d1f8277e5ff","patch":"@@ -32,6 +32,9 @@\n import org.apache.syncope.core.persistence.api.entity.Implementation;\n import org.apache.syncope.core.persistence.api.entity.PlainAttr;\n import org.apache.syncope.core.persistence.api.entity.PlainSchema;\n+import org.apache.syncope.core.persistence.api.entity.anyobject.APlainAttr;\n+import org.apache.syncope.core.persistence.api.entity.conf.CPlainAttr;\n+import org.apache.syncope.core.persistence.api.entity.group.GPlainAttr;\n import org.apache.syncope.core.persistence.jpa.entity.JPAPlainSchema;\n import org.apache.syncope.core.persistence.jpa.entity.anyobject.JPAAPlainAttr;\n import org.apache.syncope.core.persistence.jpa.entity.group.JPAGPlainAttr;\n@@ -110,10 +113,10 @@ public <T extends PlainAttr<?>> List<T> findAttrs(final PlainSchema schema, fina\n     @Override\n     public <T extends PlainAttr<?>> boolean hasAttrs(final PlainSchema schema, final Class<T> reference) {\n         String plainAttrTable = getPlainAttrTable(reference);\n-        Query query = entityManager()\n-                .createNativeQuery(\"SELECT COUNT(\" + plainAttrTable + \".id) FROM \" + JPAPlainSchema.TABLE\n-                        + \" JOIN \" + plainAttrTable + \" ON \" + JPAPlainSchema.TABLE + \".id = \" + plainAttrTable\n-                        + \".schema_id WHERE \" + JPAPlainSchema.TABLE + \".id = ?1\");\n+        Query query = entityManager().createNativeQuery(\n+                \"SELECT COUNT(\" + plainAttrTable + \".id) FROM \" + JPAPlainSchema.TABLE\n+                + \" JOIN \" + plainAttrTable + \" ON \" + JPAPlainSchema.TABLE + \".id = \" + plainAttrTable\n+                + \".schema_id WHERE \" + JPAPlainSchema.TABLE + \".id = ?1\");\n         query.setParameter(1, schema.getKey());\n \n         return (long) query.getSingleResult() > 0;\n@@ -153,14 +156,14 @@ public void delete(final String key) {\n     }\n \n     private <T extends PlainAttr<?>> String getPlainAttrTable(final Class<T> plainAttrClass) {\n-        if (plainAttrClass.equals(JPAGPlainAttr.class)) {\n+        if (GPlainAttr.class.isAssignableFrom(plainAttrClass)) {\n             return JPAGPlainAttr.TABLE;\n         }\n-        if (plainAttrClass.equals(JPAAPlainAttr.class)) {\n+        if (APlainAttr.class.isAssignableFrom(plainAttrClass)) {\n             return JPAAPlainAttr.TABLE;\n         }\n-        if (plainAttrClass.equals(JPAUPlainAttr.class)) {\n-            return JPAUPlainAttr.TABLE;\n+        if (CPlainAttr.class.isAssignableFrom(plainAttrClass)) {\n+            return JPAAPlainAttr.TABLE;\n         }\n         return JPAUPlainAttr.TABLE;\n     }"},{"sha":"293e5e94d286778402d730e1e5ce14c697781cc8","filename":"core/persistence-jpa/src/test/java/org/apache/syncope/core/persistence/jpa/inner/PlainSchemaTest.java","status":"modified","additions":22,"deletions":3,"changes":25,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff/core%2Fpersistence-jpa%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Finner%2FPlainSchemaTest.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff/core%2Fpersistence-jpa%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Finner%2FPlainSchemaTest.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Finner%2FPlainSchemaTest.java?ref=7d5954dc188b8f39ab67834dc11f9d1f8277e5ff","patch":"@@ -36,6 +36,7 @@\n import org.apache.syncope.core.persistence.api.dao.PlainSchemaDAO;\n import org.apache.syncope.core.persistence.api.entity.PlainSchema;\n import org.apache.syncope.core.persistence.api.entity.group.GPlainAttr;\n+import org.apache.syncope.core.persistence.api.entity.user.UPlainAttr;\n import org.apache.syncope.core.persistence.jpa.AbstractTest;\n import org.junit.jupiter.api.Tag;\n import org.junit.jupiter.api.Test;\n@@ -80,9 +81,27 @@ public void findAttrs() {\n         PlainSchema schema = plainSchemaDAO.find(\"icon\");\n         assertNotNull(schema);\n \n-        List<GPlainAttr> attrs = plainSchemaDAO.findAttrs(schema, GPlainAttr.class);\n-        assertNotNull(attrs);\n-        assertFalse(attrs.isEmpty());\n+        List<GPlainAttr> gattrs = plainSchemaDAO.findAttrs(schema, GPlainAttr.class);\n+        assertNotNull(gattrs);\n+        assertFalse(gattrs.isEmpty());\n+\n+        schema = plainSchemaDAO.find(\"aLong\");\n+        assertNotNull(schema);\n+\n+        List<UPlainAttr> uattrs = plainSchemaDAO.findAttrs(schema, UPlainAttr.class);\n+        assertNotNull(uattrs);\n+        assertTrue(uattrs.isEmpty());\n+    }\n+\n+    @Test\n+    public void hasAttrs() {\n+        PlainSchema schema = plainSchemaDAO.find(\"icon\");\n+        assertNotNull(schema);\n+        assertTrue(plainSchemaDAO.hasAttrs(schema, GPlainAttr.class));\n+\n+        schema = plainSchemaDAO.find(\"aLong\");\n+        assertNotNull(schema);\n+        assertFalse(plainSchemaDAO.hasAttrs(schema, UPlainAttr.class));\n     }\n \n     @Test"},{"sha":"dc034b6ca13372ee23f7dc3f9562a65ab624f135","filename":"docker/core/src/main/resources/persistence.properties.myjson","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff/docker%2Fcore%2Fsrc%2Fmain%2Fresources%2Fpersistence.properties.myjson","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff/docker%2Fcore%2Fsrc%2Fmain%2Fresources%2Fpersistence.properties.myjson","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fcore%2Fsrc%2Fmain%2Fresources%2Fpersistence.properties.myjson?ref=7d5954dc188b8f39ab67834dc11f9d1f8277e5ff","patch":"@@ -16,7 +16,7 @@\n # under the License.\n content.directory=${conf.directory}\n entity.factory=org.apache.syncope.core.persistence.jpa.entity.MyJPAJSONEntityFactory\n-plainSchema.dao=org.apache.syncope.core.persistence.jpa.dao.JPAJSONPlainSchemaDAO\n+plainSchema.dao=org.apache.syncope.core.persistence.jpa.dao.MyJPAJSONPlainSchemaDAO\n plainAttr.dao=org.apache.syncope.core.persistence.jpa.dao.JPAJSONPlainAttrDAO\n plainAttrValue.dao=org.apache.syncope.core.persistence.jpa.dao.JPAJSONPlainAttrValueDAO\n any.search.dao=org.apache.syncope.core.persistence.jpa.dao.MyJPAJSONAnySearchDAO"},{"sha":"fe9250c092557667d52ce37b7f37f139233a85c8","filename":"docker/core/src/main/resources/persistence.properties.pgjsonb","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff/docker%2Fcore%2Fsrc%2Fmain%2Fresources%2Fpersistence.properties.pgjsonb","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff/docker%2Fcore%2Fsrc%2Fmain%2Fresources%2Fpersistence.properties.pgjsonb","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fcore%2Fsrc%2Fmain%2Fresources%2Fpersistence.properties.pgjsonb?ref=7d5954dc188b8f39ab67834dc11f9d1f8277e5ff","patch":"@@ -16,7 +16,7 @@\n # under the License.\n content.directory=${conf.directory}\n entity.factory=org.apache.syncope.core.persistence.jpa.entity.PGJPAJSONEntityFactory\n-plainSchema.dao=org.apache.syncope.core.persistence.jpa.dao.JPAJSONPlainSchemaDAO\n+plainSchema.dao=org.apache.syncope.core.persistence.jpa.dao.PGJPAJSONPlainSchemaDAO\n plainAttr.dao=org.apache.syncope.core.persistence.jpa.dao.JPAJSONPlainAttrDAO\n plainAttrValue.dao=org.apache.syncope.core.persistence.jpa.dao.JPAJSONPlainAttrValueDAO\n any.search.dao=org.apache.syncope.core.persistence.jpa.dao.PGJPAJSONAnySearchDAO"},{"sha":"c1128ff8aced9f215e77be446ae96f87e648d3e5","filename":"src/main/asciidoc/reference-guide/workingwithapachesyncope/systemadministration/dbms.adoc","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff/src%2Fmain%2Fasciidoc%2Freference-guide%2Fworkingwithapachesyncope%2Fsystemadministration%2Fdbms.adoc","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7d5954dc188b8f39ab67834dc11f9d1f8277e5ff/src%2Fmain%2Fasciidoc%2Freference-guide%2Fworkingwithapachesyncope%2Fsystemadministration%2Fdbms.adoc","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/src%2Fmain%2Fasciidoc%2Freference-guide%2Fworkingwithapachesyncope%2Fsystemadministration%2Fdbms.adoc?ref=7d5954dc188b8f39ab67834dc11f9d1f8277e5ff","patch":"@@ -83,7 +83,7 @@ In `persistence.properties`, replace as follows:\n \n ....\n entity.factory=org.apache.syncope.core.persistence.jpa.entity.PGJPAJSONEntityFactory\n-plainSchema.dao=org.apache.syncope.core.persistence.jpa.dao.JPAJSONPlainSchemaDAO\n+plainSchema.dao=org.apache.syncope.core.persistence.jpa.dao.PGJPAJSONPlainSchemaDAO\n plainAttr.dao=org.apache.syncope.core.persistence.jpa.dao.JPAJSONPlainAttrDAO\n plainAttrValue.dao=org.apache.syncope.core.persistence.jpa.dao.JPAJSONPlainAttrValueDAO\n any.search.dao=org.apache.syncope.core.persistence.jpa.dao.PGJPAJSONAnySearchDAO\n@@ -216,7 +216,7 @@ In `persistence.properties`, replace as follows:\n \n ....\n entity.factory=org.apache.syncope.core.persistence.jpa.entity.MyJPAJSONEntityFactory\n-plainSchema.dao=org.apache.syncope.core.persistence.jpa.dao.JPAJSONPlainSchemaDAO\n+plainSchema.dao=org.apache.syncope.core.persistence.jpa.dao.MyJPAJSONPlainSchemaDAO\n plainAttr.dao=org.apache.syncope.core.persistence.jpa.dao.JPAJSONPlainAttrDAO\n plainAttrValue.dao=org.apache.syncope.core.persistence.jpa.dao.JPAJSONPlainAttrValueDAO\n any.search.dao=org.apache.syncope.core.persistence.jpa.dao.MyJPAJSONAnySearchDAO"}]}