{"sha":"5820eb52a37abf3a8d6f288c5fb8a3e311d66179","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjU4MjBlYjUyYTM3YWJmM2E4ZDZmMjg4YzVmYjhhM2UzMTFkNjYxNzk=","commit":{"author":{"name":"fmartelli","email":"fabio.martelli@gmail.com","date":"2017-05-08T14:46:34Z"},"committer":{"name":"fmartelli","email":"fabio.martelli@gmail.com","date":"2017-05-08T14:47:02Z"},"message":"[SYNCOPE-1073] provides authorization check for realm details","tree":{"sha":"d4c7b5b42148d4839f422d55f3dfc716c54e36da","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/d4c7b5b42148d4839f422d55f3dfc716c54e36da"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/5820eb52a37abf3a8d6f288c5fb8a3e311d66179","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/5820eb52a37abf3a8d6f288c5fb8a3e311d66179","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/5820eb52a37abf3a8d6f288c5fb8a3e311d66179","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/5820eb52a37abf3a8d6f288c5fb8a3e311d66179/comments","author":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"committer":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"parents":[{"sha":"2f65c14fcd681d1e2e798e4563c6eaa07b5def9f","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/2f65c14fcd681d1e2e798e4563c6eaa07b5def9f","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/2f65c14fcd681d1e2e798e4563c6eaa07b5def9f"}],"stats":{"total":17,"additions":11,"deletions":6},"files":[{"sha":"8d9ec0f1f48d2df51255b1e42211ce25740dccd4","filename":"client/console/src/main/java/org/apache/syncope/client/console/commons/ITabComponent.java","status":"modified","additions":2,"deletions":3,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/5820eb52a37abf3a8d6f288c5fb8a3e311d66179/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fcommons%2FITabComponent.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/5820eb52a37abf3a8d6f288c5fb8a3e311d66179/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fcommons%2FITabComponent.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fcommons%2FITabComponent.java?ref=5820eb52a37abf3a8d6f288c5fb8a3e311d66179","patch":"@@ -19,7 +19,6 @@\n package org.apache.syncope.client.console.commons;\n \n import java.util.UUID;\n-import org.apache.commons.lang3.StringUtils;\n import org.apache.wicket.Component;\n import org.apache.wicket.authroles.authorization.strategies.role.Roles;\n import org.apache.wicket.authroles.authorization.strategies.role.metadata.ActionPermissions;\n@@ -43,13 +42,13 @@ public abstract class ITabComponent extends Component implements ITab {\n      * @param title IModel used to represent the title of the tab. Must contain a string\n      * @param roles authorized roles\n      */\n-    public ITabComponent(final IModel<String> title, final String roles) {\n+    public ITabComponent(final IModel<String> title, final String[] roles) {\n         super(UUID.randomUUID().toString());\n         this.title = title;\n \n         final ActionPermissions permissions = new ActionPermissions();\n         setMetaData(MetaDataRoleAuthorizationStrategy.ACTION_PERMISSIONS, permissions);\n-        if (StringUtils.isBlank(roles)) {\n+        if (roles == null || roles.length == 0) {\n             permissions.authorizeAll(RENDER);\n         } else {\n             permissions.authorize(RENDER, new Roles(roles));"},{"sha":"722eed9685b65d96956b4d9c89b97989467be205","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/Realm.java","status":"modified","additions":9,"deletions":3,"changes":12,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/5820eb52a37abf3a8d6f288c5fb8a3e311d66179/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FRealm.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/5820eb52a37abf3a8d6f288c5fb8a3e311d66179/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FRealm.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FRealm.java?ref=5820eb52a37abf3a8d6f288c5fb8a3e311d66179","patch":"@@ -56,7 +56,6 @@\n import org.apache.wicket.Component;\n import org.apache.wicket.PageReference;\n import org.apache.wicket.ajax.AjaxRequestTarget;\n-import org.apache.wicket.extensions.markup.html.tabs.AbstractTab;\n import org.apache.wicket.extensions.markup.html.tabs.ITab;\n import org.apache.wicket.markup.html.WebMarkupContainer;\n import org.apache.wicket.markup.html.basic.Label;\n@@ -106,7 +105,8 @@ public RealmTO getRealmTO() {\n     private List<ITab> buildTabList(final PageReference pageRef) {\n         List<ITab> tabs = new ArrayList<>();\n \n-        tabs.add(new AbstractTab(new Model<>(\"DETAILS\")) {\n+        tabs.add(new ITabComponent(new Model<>(\"DETAILS\"), new String[] {\n+            StandardEntitlement.REALM_CREATE, StandardEntitlement.REALM_UPDATE, StandardEntitlement.REALM_DELETE }) {\n \n             private static final long serialVersionUID = -5861786415855103549L;\n \n@@ -159,6 +159,12 @@ public void onClick(final AjaxRequestTarget target, final RealmTO ignore) {\n                 actionPanel.setEnabled(true);\n                 return panel;\n             }\n+\n+            @Override\n+            public boolean isVisible() {\n+                return SyncopeConsoleApplication.get().getSecuritySettings().getAuthorizationStrategy().\n+                        isActionAuthorized(this, RENDER);\n+            }\n         });\n \n         final Triple<UserFormLayoutInfo, GroupFormLayoutInfo, Map<String, AnyObjectFormLayoutInfo>> formLayoutInfo\n@@ -169,7 +175,7 @@ public void onClick(final AjaxRequestTarget target, final RealmTO ignore) {\n             tabs.add(new ITabComponent(\n                     new Model<>(anyTypeTO.getKey()),\n                     AnyTypeKind.GROUP.name().equals(anyTypeTO.getKey())\n-                    ? null : String.format(\"%s_SEARCH\", anyTypeTO.getKey())) {\n+                    ? null : new String[]{String.format(\"%s_SEARCH\", anyTypeTO.getKey())}) {\n \n                 private static final long serialVersionUID = 1169585538404171118L;\n "}]}