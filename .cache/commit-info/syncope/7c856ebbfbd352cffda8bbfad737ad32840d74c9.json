{"sha":"7c856ebbfbd352cffda8bbfad737ad32840d74c9","node_id":"C_kwDOJfYA1toAKDdjODU2ZWJiZmJkMzUyY2ZmZGE4YmJmYWQ3MzdhZDMyODQwZDc0Yzk","commit":{"author":{"name":"Andrea Patricelli","email":"andreapatricelli@apache.org","date":"2022-03-31T14:14:13Z"},"committer":{"name":"GitHub","email":"noreply@github.com","date":"2022-03-31T14:14:13Z"},"message":"[SYNCOPE-1666] linked account must have AES as encryption algorithm (#334)","tree":{"sha":"3bf44ad85159950cb4987f76f293e7896f2cb63a","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/3bf44ad85159950cb4987f76f293e7896f2cb63a"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/7c856ebbfbd352cffda8bbfad737ad32840d74c9","comment_count":0,"verification":{"verified":true,"reason":"valid","signature":"-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJiRbc1CRBK7hj4Ov3rIwAAucEIAFFpekHUw4zhQ3ixogGkqAEk\neulnrH1Q3N6COf0wD/xm3UsCs/t5efq9drzRyMmbKBuzuOzDvpXJ84hLI25angL3\nYRuKgXGUSwNIztX6G9bxX5ZW9q6dPDpc2vkQ4hfMNBiP+8PajysuxlvZS1NE0wSf\nkqBXkIizvgZAKuS/M0MeZtsbiGxAr96dlMOXGBmmGI0q3DmbwmVvaiBlVW+1/9Uz\n4s8tcykFmhQgU4JbqGMbx5AT4gdanU86cjv1HbcYD8/CaJb+V1KWFp2mxnOov3M6\nA0xP6oXC8cpPbFqHp6MlZwTbRUAXtajkBpPZPzAklMIBOUuIKSldSogpMVyDQFI=\n=bsaO\n-----END PGP SIGNATURE-----\n","payload":"tree 3bf44ad85159950cb4987f76f293e7896f2cb63a\nparent 553d9c6618bf844eba80135c202abd188f207431\nauthor Andrea Patricelli <andreapatricelli@apache.org> 1648736053 +0200\ncommitter GitHub <noreply@github.com> 1648736053 +0200\n\n[SYNCOPE-1666] linked account must have AES as encryption algorithm (#334)\n\n"}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/7c856ebbfbd352cffda8bbfad737ad32840d74c9","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/7c856ebbfbd352cffda8bbfad737ad32840d74c9","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/7c856ebbfbd352cffda8bbfad737ad32840d74c9/comments","author":{"login":"andrea-patricelli","id":3763111,"node_id":"MDQ6VXNlcjM3NjMxMTE=","avatar_url":"https://avatars.githubusercontent.com/u/3763111?v=4","gravatar_id":"","url":"https://api.github.com/users/andrea-patricelli","html_url":"https://github.com/andrea-patricelli","followers_url":"https://api.github.com/users/andrea-patricelli/followers","following_url":"https://api.github.com/users/andrea-patricelli/following{/other_user}","gists_url":"https://api.github.com/users/andrea-patricelli/gists{/gist_id}","starred_url":"https://api.github.com/users/andrea-patricelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrea-patricelli/subscriptions","organizations_url":"https://api.github.com/users/andrea-patricelli/orgs","repos_url":"https://api.github.com/users/andrea-patricelli/repos","events_url":"https://api.github.com/users/andrea-patricelli/events{/privacy}","received_events_url":"https://api.github.com/users/andrea-patricelli/received_events","type":"User","site_admin":false},"committer":{"login":"web-flow","id":19864447,"node_id":"MDQ6VXNlcjE5ODY0NDQ3","avatar_url":"https://avatars.githubusercontent.com/u/19864447?v=4","gravatar_id":"","url":"https://api.github.com/users/web-flow","html_url":"https://github.com/web-flow","followers_url":"https://api.github.com/users/web-flow/followers","following_url":"https://api.github.com/users/web-flow/following{/other_user}","gists_url":"https://api.github.com/users/web-flow/gists{/gist_id}","starred_url":"https://api.github.com/users/web-flow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/web-flow/subscriptions","organizations_url":"https://api.github.com/users/web-flow/orgs","repos_url":"https://api.github.com/users/web-flow/repos","events_url":"https://api.github.com/users/web-flow/events{/privacy}","received_events_url":"https://api.github.com/users/web-flow/received_events","type":"User","site_admin":false},"parents":[{"sha":"553d9c6618bf844eba80135c202abd188f207431","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/553d9c6618bf844eba80135c202abd188f207431","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/553d9c6618bf844eba80135c202abd188f207431"}],"stats":{"total":11,"additions":6,"deletions":5},"files":[{"sha":"393d5d3c13c300eeb3e402288997770918b18cf2","filename":"core/provisioning-java/src/main/java/org/apache/syncope/core/provisioning/java/data/UserDataBinderImpl.java","status":"modified","additions":6,"deletions":5,"changes":11,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7c856ebbfbd352cffda8bbfad737ad32840d74c9/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fdata%2FUserDataBinderImpl.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7c856ebbfbd352cffda8bbfad737ad32840d74c9/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fdata%2FUserDataBinderImpl.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Fdata%2FUserDataBinderImpl.java?ref=7c856ebbfbd352cffda8bbfad737ad32840d74c9","patch":"@@ -52,7 +52,6 @@\n import org.apache.syncope.core.persistence.api.dao.SecurityQuestionDAO;\n import org.apache.syncope.core.persistence.api.entity.group.Group;\n import org.apache.syncope.core.persistence.api.entity.resource.Item;\n-import org.apache.syncope.core.persistence.api.entity.user.Account;\n import org.apache.syncope.core.persistence.api.entity.user.SecurityQuestion;\n import org.apache.syncope.core.persistence.api.entity.user.User;\n import org.apache.syncope.core.provisioning.api.PropagationByResource;\n@@ -210,9 +209,9 @@ private void setSecurityAnswer(\n         }\n     }\n \n-    private void setCipherAlgorithm(final Account account) {\n-        if (account.getCipherAlgorithm() == null) {\n-            account.setCipherAlgorithm(CipherAlgorithm.valueOf(confParamOps.get(AuthContextUtils.getDomain(),\n+    private void setCipherAlgorithm(final User user) {\n+        if (user.getCipherAlgorithm() == null) {\n+            user.setCipherAlgorithm(CipherAlgorithm.valueOf(confParamOps.get(AuthContextUtils.getDomain(),\n                     \"password.cipher.algorithm\", CipherAlgorithm.AES.name(), String.class)));\n         }\n     }\n@@ -260,7 +259,9 @@ public LinkedAccount get() {\n             if (StringUtils.isBlank(accountTO.getPassword())) {\n                 account.setEncodedPassword(null, null);\n             } else if (!accountTO.getPassword().equals(account.getPassword())) {\n-                setCipherAlgorithm(account);\n+                if (account.getCipherAlgorithm() == null) {\n+                    account.setCipherAlgorithm(CipherAlgorithm.AES);\n+                }\n                 account.setPassword(accountTO.getPassword());\n             }\n             account.setSuspended(accountTO.isSuspended());"}]}