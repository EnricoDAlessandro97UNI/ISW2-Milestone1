{"sha":"b0c423af80d5df8d26163a7ac290e551e8fbd3ed","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmIwYzQyM2FmODBkNWRmOGQyNjE2M2E3YWMyOTBlNTUxZThmYmQzZWQ=","commit":{"author":{"name":"Andrea Patricelli","email":"andreapatricelli@apache.org","date":"2019-06-07T10:14:47Z"},"committer":{"name":"Andrea Patricelli","email":"andreapatricelli@apache.org","date":"2019-06-07T10:15:47Z"},"message":"fixes default value initialization in enduser, wizard builder instantiated from class specified in configuration param","tree":{"sha":"3938afae3a821533cc5d5f9fe28c234066776f94","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/3938afae3a821533cc5d5f9fe28c234066776f94"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/b0c423af80d5df8d26163a7ac290e551e8fbd3ed","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/b0c423af80d5df8d26163a7ac290e551e8fbd3ed","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/b0c423af80d5df8d26163a7ac290e551e8fbd3ed","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/b0c423af80d5df8d26163a7ac290e551e8fbd3ed/comments","author":{"login":"andrea-patricelli","id":3763111,"node_id":"MDQ6VXNlcjM3NjMxMTE=","avatar_url":"https://avatars.githubusercontent.com/u/3763111?v=4","gravatar_id":"","url":"https://api.github.com/users/andrea-patricelli","html_url":"https://github.com/andrea-patricelli","followers_url":"https://api.github.com/users/andrea-patricelli/followers","following_url":"https://api.github.com/users/andrea-patricelli/following{/other_user}","gists_url":"https://api.github.com/users/andrea-patricelli/gists{/gist_id}","starred_url":"https://api.github.com/users/andrea-patricelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrea-patricelli/subscriptions","organizations_url":"https://api.github.com/users/andrea-patricelli/orgs","repos_url":"https://api.github.com/users/andrea-patricelli/repos","events_url":"https://api.github.com/users/andrea-patricelli/events{/privacy}","received_events_url":"https://api.github.com/users/andrea-patricelli/received_events","type":"User","site_admin":false},"committer":{"login":"andrea-patricelli","id":3763111,"node_id":"MDQ6VXNlcjM3NjMxMTE=","avatar_url":"https://avatars.githubusercontent.com/u/3763111?v=4","gravatar_id":"","url":"https://api.github.com/users/andrea-patricelli","html_url":"https://github.com/andrea-patricelli","followers_url":"https://api.github.com/users/andrea-patricelli/followers","following_url":"https://api.github.com/users/andrea-patricelli/following{/other_user}","gists_url":"https://api.github.com/users/andrea-patricelli/gists{/gist_id}","starred_url":"https://api.github.com/users/andrea-patricelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrea-patricelli/subscriptions","organizations_url":"https://api.github.com/users/andrea-patricelli/orgs","repos_url":"https://api.github.com/users/andrea-patricelli/repos","events_url":"https://api.github.com/users/andrea-patricelli/events{/privacy}","received_events_url":"https://api.github.com/users/andrea-patricelli/received_events","type":"User","site_admin":false},"parents":[{"sha":"8cf6fc1746df33f54ba440df6c3a6304e7d2f6a9","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/8cf6fc1746df33f54ba440df6c3a6304e7d2f6a9","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/8cf6fc1746df33f54ba440df6c3a6304e7d2f6a9"}],"stats":{"total":33,"additions":23,"deletions":10},"files":[{"sha":"67bd151adbb2df9c3394c0a6ecc209b4bb89c12a","filename":"client/idrepo/enduser/src/main/java/org/apache/syncope/client/enduser/pages/Self.java","status":"modified","additions":12,"deletions":9,"changes":21,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b0c423af80d5df8d26163a7ac290e551e8fbd3ed/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FSelf.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b0c423af80d5df8d26163a7ac290e551e8fbd3ed/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FSelf.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fpages%2FSelf.java?ref=b0c423af80d5df8d26163a7ac290e551e8fbd3ed","patch":"@@ -23,9 +23,9 @@\n import org.apache.syncope.client.enduser.SyncopeWebApplication;\n import org.apache.syncope.client.enduser.layout.FormLayoutInfoUtils;\n import org.apache.syncope.client.enduser.layout.UserFormLayoutInfo;\n-import org.apache.syncope.client.enduser.wizards.any.UserWizardBuilder;\n import org.apache.syncope.client.ui.commons.Constants;\n import org.apache.syncope.client.ui.commons.wizards.AjaxWizard;\n+import org.apache.syncope.client.ui.commons.wizards.AjaxWizardBuilder;\n import org.apache.syncope.client.ui.commons.wizards.any.AnyWrapper;\n import org.apache.syncope.client.ui.commons.wizards.any.UserWrapper;\n import org.apache.syncope.common.keymaster.client.api.ConfParamOps;\n@@ -45,7 +45,7 @@ public class Self extends BaseEnduserWebPage implements IEventSource {\n     @SpringBean\n     private ConfParamOps confParamOps;\n \n-    private UserWizardBuilder userWizardBuilder;\n+    private AjaxWizardBuilder<AnyWrapper<UserTO>> wizardBuilder;\n \n     protected static final String WIZARD_ID = \"wizard\";\n \n@@ -97,16 +97,19 @@ protected final AjaxWizard<AnyWrapper<UserTO>> buildWizard(final UserTO userTO,\n                 \"enduser.form.layout.info\",\n                 FormLayoutInfoUtils.getDefaultValue(),\n                 String.class);\n-        userWizardBuilder = new UserWizardBuilder(\n-                null,\n-                userTO,\n-                SyncopeEnduserSession.get().getService(SyncopeService.class).platform().getUserClasses(),\n+\n+        final UserFormLayoutInfo formLayoutInfo =\n                 StringUtils.isBlank(formLayoutConfParam)\n                 ? new UserFormLayoutInfo()\n-                : FormLayoutInfoUtils.fromJsonString(formLayoutConfParam),\n+                : FormLayoutInfoUtils.fromJsonString(formLayoutConfParam);\n+\n+        wizardBuilder = (AjaxWizardBuilder<AnyWrapper<UserTO>>) FormLayoutInfoUtils.instantiate(\n+                userTO,\n+                SyncopeEnduserSession.get().getService(SyncopeService.class).platform().getUserClasses(),\n+                formLayoutInfo,\n                 this.getPageReference());\n-        userWizardBuilder.setItem(new UserWrapper(userTO));\n-        return userWizardBuilder.build(WIZARD_ID, mode);\n+        wizardBuilder.setItem(new UserWrapper(userTO));\n+        return wizardBuilder.build(WIZARD_ID, mode);\n     }\n \n     private UserTO buildNewUserTO(final PageParameters parameters) {"},{"sha":"061756b558bdfa519e65de6435a3e6bcc41f4b37","filename":"client/idrepo/enduser/src/main/java/org/apache/syncope/client/enduser/wizards/any/AbstractAttrs.java","status":"modified","additions":4,"deletions":0,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b0c423af80d5df8d26163a7ac290e551e8fbd3ed/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FAbstractAttrs.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b0c423af80d5df8d26163a7ac290e551e8fbd3ed/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FAbstractAttrs.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FAbstractAttrs.java?ref=b0c423af80d5df8d26163a7ac290e551e8fbd3ed","patch":"@@ -136,6 +136,10 @@ protected boolean renderAsReadonly(final String schema, final String groupName)\n         return whichAttrs.get(schemaName) == null ? false : whichAttrs.get(schemaName).isReadonly();\n     }\n \n+    protected List<String> getDefaultValues(final String schema) {\n+        return getDefaultValues(schema, null);\n+    }\n+    \n     protected List<String> getDefaultValues(final String schema, final String groupName) {\n         String schemaName = (org.apache.commons.lang3.StringUtils.isBlank(groupName)\n                 ? org.apache.commons.lang3.StringUtils.EMPTY"},{"sha":"d0189fc43b5769df9444d5fe692ce2676f4c1ac0","filename":"client/idrepo/enduser/src/main/java/org/apache/syncope/client/enduser/wizards/any/PlainAttrs.java","status":"modified","additions":7,"deletions":1,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b0c423af80d5df8d26163a7ac290e551e8fbd3ed/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FPlainAttrs.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b0c423af80d5df8d26163a7ac290e551e8fbd3ed/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FPlainAttrs.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fidrepo%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fwizards%2Fany%2FPlainAttrs.java?ref=b0c423af80d5df8d26163a7ac290e551e8fbd3ed","patch":"@@ -406,7 +406,7 @@ protected void populateItem(final ListItem<Attr> item) {\n                     Attr attrTO = item.getModelObject();\n \n                     // set default values, if any\n-                    if (attrTO.getValues().stream().anyMatch(value -> StringUtils.isNotBlank(value))) {\n+                    if (attrTO.getValues().stream().noneMatch(value -> StringUtils.isNotBlank(value))) {\n                         attrTO.getValues().clear();\n                         attrTO.getValues().addAll(getDefaultValues(attrTO.getSchema(), groupName));\n                     }\n@@ -453,6 +453,12 @@ public PlainSchemasOwn(\n                 protected void populateItem(final ListItem<Attr> item) {\n                     Attr attrTO = item.getModelObject();\n \n+                    // set default values, if any\n+                    if (attrTO.getValues().stream().noneMatch(value -> StringUtils.isNotBlank(value))) {\n+                        attrTO.getValues().clear();\n+                        attrTO.getValues().addAll(getDefaultValues(attrTO.getSchema()));\n+                    }\n+\n                     AbstractFieldPanel<?> panel = getFieldPanel(schemas.get(attrTO.getSchema()));\n                     if (schemas.get(attrTO.getSchema()).isMultivalue()) {\n                         panel = new MultiFieldPanel.Builder<>("}]}