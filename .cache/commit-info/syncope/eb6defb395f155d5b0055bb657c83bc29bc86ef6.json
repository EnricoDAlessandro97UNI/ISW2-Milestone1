{"sha":"eb6defb395f155d5b0055bb657c83bc29bc86ef6","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmViNmRlZmIzOTVmMTU1ZDViMDA1NWJiNjU3YzgzYmMyOWJjODZlZjY=","commit":{"author":{"name":"Marco Di Sabatino Di Diodoro","email":"mdisabatino@apache.org","date":"2014-05-23T13:27:52Z"},"committer":{"name":"Marco Di Sabatino Di Diodoro","email":"mdisabatino@apache.org","date":"2014-05-23T13:27:52Z"},"message":"[SYNCOPE-446] Notification: added possibility to specify About for roles\n\ngit-svn-id: https://svn.apache.org/repos/asf/syncope/trunk@1597090 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"9b602095347fab2bdfeceaf82fa6a13c5e1c7f41","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/9b602095347fab2bdfeceaf82fa6a13c5e1c7f41"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/eb6defb395f155d5b0055bb657c83bc29bc86ef6","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/eb6defb395f155d5b0055bb657c83bc29bc86ef6","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/eb6defb395f155d5b0055bb657c83bc29bc86ef6","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/eb6defb395f155d5b0055bb657c83bc29bc86ef6/comments","author":{"login":"mdisabatino","id":1792527,"node_id":"MDQ6VXNlcjE3OTI1Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/1792527?v=4","gravatar_id":"","url":"https://api.github.com/users/mdisabatino","html_url":"https://github.com/mdisabatino","followers_url":"https://api.github.com/users/mdisabatino/followers","following_url":"https://api.github.com/users/mdisabatino/following{/other_user}","gists_url":"https://api.github.com/users/mdisabatino/gists{/gist_id}","starred_url":"https://api.github.com/users/mdisabatino/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mdisabatino/subscriptions","organizations_url":"https://api.github.com/users/mdisabatino/orgs","repos_url":"https://api.github.com/users/mdisabatino/repos","events_url":"https://api.github.com/users/mdisabatino/events{/privacy}","received_events_url":"https://api.github.com/users/mdisabatino/received_events","type":"User","site_admin":false},"committer":{"login":"mdisabatino","id":1792527,"node_id":"MDQ6VXNlcjE3OTI1Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/1792527?v=4","gravatar_id":"","url":"https://api.github.com/users/mdisabatino","html_url":"https://github.com/mdisabatino","followers_url":"https://api.github.com/users/mdisabatino/followers","following_url":"https://api.github.com/users/mdisabatino/following{/other_user}","gists_url":"https://api.github.com/users/mdisabatino/gists{/gist_id}","starred_url":"https://api.github.com/users/mdisabatino/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mdisabatino/subscriptions","organizations_url":"https://api.github.com/users/mdisabatino/orgs","repos_url":"https://api.github.com/users/mdisabatino/repos","events_url":"https://api.github.com/users/mdisabatino/events{/privacy}","received_events_url":"https://api.github.com/users/mdisabatino/received_events","type":"User","site_admin":false},"parents":[{"sha":"6c4bc7692e65f436c21679c241aa2ef1bbdb9600","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/6c4bc7692e65f436c21679c241aa2ef1bbdb9600","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/6c4bc7692e65f436c21679c241aa2ef1bbdb9600"}],"stats":{"total":488,"additions":413,"deletions":75},"files":[{"sha":"e1215d323e187aa16bc1c25918b87678c6ca0fea","filename":"common/src/main/java/org/apache/syncope/common/to/NotificationTO.java","status":"modified","additions":15,"deletions":5,"changes":20,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/eb6defb395f155d5b0055bb657c83bc29bc86ef6/common%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Fto%2FNotificationTO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/eb6defb395f155d5b0055bb657c83bc29bc86ef6/common%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Fto%2FNotificationTO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/common%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Fto%2FNotificationTO.java?ref=eb6defb395f155d5b0055bb657c83bc29bc86ef6","patch":"@@ -41,7 +41,9 @@ public class NotificationTO extends AbstractBaseBean {\n \r\n     private List<String> events = new ArrayList<String>();\r\n \r\n-    private String about;\r\n+    private String userAbout;\r\n+\r\n+    private String roleAbout;\r\n \r\n     private String recipients;\r\n \r\n@@ -63,12 +65,20 @@ public class NotificationTO extends AbstractBaseBean {\n     \r\n     private boolean active;\r\n \r\n-    public String getAbout() {\r\n-        return about;\r\n+    public String getUserAbout() {\r\n+        return userAbout;\r\n+    }\r\n+\r\n+    public void setUserAbout(final String userAbout) {\r\n+        this.userAbout = userAbout;\r\n+    }\r\n+\r\n+    public String getRoleAbout() {\r\n+        return roleAbout;\r\n     }\r\n \r\n-    public void setAbout(final String about) {\r\n-        this.about = about;\r\n+    public void setRoleAbout(final String roleAbout) {\r\n+        this.roleAbout = roleAbout;\r\n     }\r\n \r\n     @XmlElementWrapper(name = \"events\")\r"},{"sha":"b28a83e9304b5c2c9ed2f63f7e343d32dc98779f","filename":"console/src/main/java/org/apache/syncope/console/pages/NotificationModalPage.java","status":"modified","additions":76,"deletions":13,"changes":89,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/eb6defb395f155d5b0055bb657c83bc29bc86ef6/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FNotificationModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/eb6defb395f155d5b0055bb657c83bc29bc86ef6/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FNotificationModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FNotificationModalPage.java?ref=eb6defb395f155d5b0055bb657c83bc29bc86ef6","patch":"@@ -30,6 +30,7 @@\n import org.apache.syncope.common.SyncopeClientException;\n import org.apache.syncope.console.commons.Constants;\n import org.apache.syncope.console.pages.panels.LoggerCategoryPanel;\n+import org.apache.syncope.console.pages.panels.RoleSearchPanel;\n import org.apache.syncope.console.pages.panels.UserSearchPanel;\n import org.apache.syncope.console.rest.LoggerRestClient;\n import org.apache.syncope.console.rest.NotificationRestClient;\n@@ -66,8 +67,8 @@ class NotificationModalPage extends BaseModalPage {\n     public NotificationModalPage(final PageReference pageRef, final ModalWindow window,\n             final NotificationTO notificationTO, final boolean createFlag) {\n \n-        final Form<NotificationTO> form =\n-                new Form<NotificationTO>(FORM, new CompoundPropertyModel<NotificationTO>(notificationTO));\n+        final Form<NotificationTO> form\n+                = new Form<NotificationTO>(FORM, new CompoundPropertyModel<NotificationTO>(notificationTO));\n \n         final AjaxTextFieldPanel sender = new AjaxTextFieldPanel(\"sender\", getString(\"sender\"),\n                 new PropertyModel<String>(notificationTO, \"sender\"));\n@@ -106,23 +107,81 @@ public NotificationModalPage(final PageReference pageRef, final ModalWindow wind\n \n         form.add(aboutContainer);\n \n-        final AjaxCheckBoxPanel checkAbout =\n-                new AjaxCheckBoxPanel(\"checkAbout\", \"checkAbout\",\n-                        new Model<Boolean>(notificationTO.getAbout() == null));\n+        final AjaxCheckBoxPanel checkAbout\n+                = new AjaxCheckBoxPanel(\"checkAbout\", \"checkAbout\",\n+                        new Model<Boolean>(notificationTO.getUserAbout() == null && notificationTO.getRoleAbout() == null));\n         aboutContainer.add(checkAbout);\n \n-        final UserSearchPanel about = new UserSearchPanel.Builder(\"about\").fiql(notificationTO.getAbout()).build();\n-        aboutContainer.add(about);\n-        about.setEnabled(!checkAbout.getModelObject());\n+        final AjaxCheckBoxPanel checkUserAbout\n+                = new AjaxCheckBoxPanel(\"checkUserAbout\", \"checkUserAbout\",\n+                        new Model<Boolean>(notificationTO.getUserAbout() != null));\n+        aboutContainer.add(checkUserAbout);\n+\n+        final AjaxCheckBoxPanel checkRoleAbout\n+                = new AjaxCheckBoxPanel(\"checkRoleAbout\", \"checkRoleAbout\",\n+                        new Model<Boolean>(notificationTO.getRoleAbout() != null));\n+        aboutContainer.add(checkRoleAbout);\n+\n+        final UserSearchPanel userAbout\n+                = new UserSearchPanel.Builder(\"userAbout\").fiql(notificationTO.getUserAbout()).build();\n+        aboutContainer.add(userAbout);\n+        userAbout.setEnabled(checkUserAbout.getModelObject());\n+\n+        final RoleSearchPanel roleAbout\n+                = new RoleSearchPanel.Builder(\"roleAbout\").fiql(notificationTO.getRoleAbout()).build();\n+        aboutContainer.add(roleAbout);\n+        roleAbout.setEnabled(checkRoleAbout.getModelObject());\n \n         checkAbout.getField().add(new AjaxFormComponentUpdatingBehavior(Constants.ON_CHANGE) {\n \n             private static final long serialVersionUID = -1107858522700306810L;\n \n             @Override\n             protected void onUpdate(final AjaxRequestTarget target) {\n-                about.setEnabled(!checkAbout.getModelObject());\n-                target.add(about);\n+                if (checkAbout.getModelObject()) {\n+                    checkUserAbout.setModelObject(Boolean.FALSE);\n+                    checkRoleAbout.setModelObject(Boolean.FALSE);\n+                    userAbout.setEnabled(Boolean.FALSE);\n+                    roleAbout.setEnabled(Boolean.FALSE);\n+                } else {\n+                    checkAbout.setModelObject(Boolean.TRUE);\n+                }\n+                target.add(aboutContainer);\n+            }\n+        });\n+\n+        checkUserAbout.getField().add(new AjaxFormComponentUpdatingBehavior(Constants.ON_CHANGE) {\n+\n+            private static final long serialVersionUID = -1107858522700306810L;\n+\n+            @Override\n+            protected void onUpdate(final AjaxRequestTarget target) {\n+                if (checkUserAbout.getModelObject()) {\n+                    checkAbout.setModelObject(!checkUserAbout.getModelObject());\n+                    checkRoleAbout.setModelObject(!checkUserAbout.getModelObject());\n+                    roleAbout.setEnabled(Boolean.FALSE);\n+                } else {\n+                    checkUserAbout.setModelObject(Boolean.TRUE);\n+                }\n+                userAbout.setEnabled(Boolean.TRUE);\n+                target.add(aboutContainer);\n+            }\n+        });\n+\n+        checkRoleAbout.getField().add(new AjaxFormComponentUpdatingBehavior(Constants.ON_CHANGE) {\n+\n+            private static final long serialVersionUID = -1107858522700306810L;\n+\n+            @Override\n+            protected void onUpdate(final AjaxRequestTarget target) {\n+                if (checkRoleAbout.getModelObject()) {\n+                    checkAbout.setModelObject(Boolean.FALSE);\n+                    checkUserAbout.setModelObject(Boolean.FALSE);\n+                    userAbout.setEnabled(Boolean.FALSE);\n+                } else {\n+                    checkRoleAbout.setModelObject(Boolean.TRUE);\n+                }\n+                roleAbout.setEnabled(Boolean.TRUE);\n                 target.add(aboutContainer);\n             }\n         });\n@@ -165,12 +224,12 @@ protected void onUpdate(final AjaxRequestTarget target) {\n \n                     @Override\n                     protected String[] getListRoles() {\n-                        return new String[] {};\n+                        return new String[]{};\n                     }\n \n                     @Override\n                     protected String[] getChangeRoles() {\n-                        return new String[] {};\n+                        return new String[]{};\n                     }\n                 });\n \n@@ -293,7 +352,11 @@ protected void onUpdate(final AjaxRequestTarget target) {\n \n             @Override\n             protected void onSubmit(final AjaxRequestTarget target, final Form<?> form) {\n-                notificationTO.setAbout(checkAbout.getModelObject() ? null : about.buildFIQL());\n+                notificationTO.setUserAbout(\n+                        !checkAbout.getModelObject() && checkUserAbout.getModelObject() ? userAbout.buildFIQL() : null);\n+                notificationTO.setRoleAbout(\n+                        !checkAbout.getModelObject()\n+                        && checkRoleAbout.getModelObject() ? roleAbout.buildFIQL() : null);\n                 notificationTO.setRecipients(checkRecipients.getModelObject() ? recipients.buildFIQL() : null);\n                 notificationTO.getStaticRecipients().removeAll(Collections.singleton(null));\n "},{"sha":"2ee68029abd1a5ef56276e673c312e0c7b1accd3","filename":"console/src/main/resources/org/apache/syncope/console/pages/NotificationModalPage.html","status":"modified","additions":30,"deletions":3,"changes":33,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/eb6defb395f155d5b0055bb657c83bc29bc86ef6/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FNotificationModalPage.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/eb6defb395f155d5b0055bb657c83bc29bc86ef6/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FNotificationModalPage.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FNotificationModalPage.html?ref=eb6defb395f155d5b0055bb657c83bc29bc86ef6","patch":"@@ -134,10 +134,18 @@\n                 <div class=\"tablecolumn_field\" style=\"width: auto; padding-right: 5px;\">\n                   <span wicket:id=\"checkAbout\">[checkAbout]</span>\n                 </div>\n-                <div class=\"tablecolumn_label\" style=\"width: auto;\">\n+                <div class=\"tablecolumn_label\" style=\"width: 100%\">\n                   <label for=\"checkAbout\"><wicket:message key=\"checkAbout\"/></label>\n                 </div>\n               </div>\n+              <div class=\"tablerow\" style=\"width: auto;\">\n+                <div class=\"tablecolumn_field\" style=\"width: auto; padding-right: 5px;\">\n+                  <span wicket:id=\"checkUserAbout\">[checkUserAbout]</span>\n+                </div>\n+                <div class=\"tablecolumn_label\" style=\"width: auto;\">\n+                  <label for=\"checkUserAbout\"><wicket:message key=\"checkUserAbout\"/></label>\n+                </div>\n+              </div>\n               <div id=\"userFilter\">\n                 <div id=\"title\">\n                   <label for=\"userFilter\"><wicket:message key=\"userFilter\"/></label>\n@@ -146,7 +154,26 @@\n                   <label for=\"userFilter\"><wicket:message key=\"userFilterWarning\"/></label>\n                 </div>\n                 <div id=\"condition\">\n-                  <span wicket:id=\"about\"/>\n+                  <span wicket:id=\"userAbout\"/>\n+                </div>\n+              </div>\n+              <div class=\"tablerow\" style=\"width: auto;\">\n+                <div class=\"tablecolumn_field\" style=\"width: auto; padding-right: 5px;\">\n+                  <span wicket:id=\"checkRoleAbout\">[checkRoleAbout]</span>\n+                </div>\n+                <div class=\"tablecolumn_label\" style=\"width: auto;\">\n+                  <label for=\"checkRoleAbout\"><wicket:message key=\"checkRoleAbout\"/></label>\n+                </div>\n+              </div>\n+              <div id=\"userFilter\">\n+                <div id=\"title\">\n+                  <label for=\"roleFilter\"><wicket:message key=\"roleFilter\"/></label>\n+                </div>\n+                <div id=\"warning\">\n+                  <label for=\"roleFilter\"><wicket:message key=\"roleFilterWarning\"/></label>\n+                </div>\n+                <div id=\"condition\">\n+                  <span wicket:id=\"roleAbout\"/>\n                 </div>\n               </div>\n             </span>\n@@ -192,7 +219,7 @@\n             </div>\n           </div>\n         </div>\n-\n+        \n         <div style=\"margin: 20px 10px 0\">\n           <input type=\"submit\"\n                  class=\"ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only\""},{"sha":"f36d754f9608919fc35ad8437e3553f8f259c579","filename":"console/src/main/resources/org/apache/syncope/console/pages/NotificationModalPage.properties","status":"modified","additions":4,"deletions":0,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/eb6defb395f155d5b0055bb657c83bc29bc86ef6/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FNotificationModalPage.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/eb6defb395f155d5b0055bb657c83bc29bc86ef6/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FNotificationModalPage.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FNotificationModalPage.properties?ref=eb6defb395f155d5b0055bb657c83bc29bc86ef6","patch":"@@ -33,4 +33,8 @@ userFilter=User filter\n userFilterWarning=Do not use this filter unless events are not targeted at users\n userNotifications=User notifications\n userNotificationsWarning=Do not select this checkbox unless events are not targeted at users\n+roleFilter=Role filter\n+roleFilterWarning=Do not use this filter unless events are not targeted at roles\n isActive=Enabled\n+checkUserAbout=Users\n+checkRoleAbout=Roles"},{"sha":"6d3b2b6fe68087b656538c37d0b0cdfbe58cc832","filename":"console/src/main/resources/org/apache/syncope/console/pages/NotificationModalPage_it.properties","status":"modified","additions":4,"deletions":0,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/eb6defb395f155d5b0055bb657c83bc29bc86ef6/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FNotificationModalPage_it.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/eb6defb395f155d5b0055bb657c83bc29bc86ef6/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FNotificationModalPage_it.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FNotificationModalPage_it.properties?ref=eb6defb395f155d5b0055bb657c83bc29bc86ef6","patch":"@@ -33,4 +33,8 @@ userFilter=Filtro utenti\n userFilterWarning=Non usare questo filtro se gli eventi catturati non riguardano espressamente utenti\n userNotifications=Notifiche utente\n userNotificationsWarning=Non selezionare questa checkbox se gli eventi catturati non riguardano espressamente utenti\n+roleFilter=Filtro ruoli\n+roleFilterWarning=Non usare questo filtro se gli eventi catturati non riguardano espressamente i ruoli\n isActive=Abilitata\n+checkUserAbout=Utenti\n+checkRoleAbout=Ruoli"},{"sha":"08879cb0e30e11eb01b6c91d63408943104807f6","filename":"console/src/main/resources/org/apache/syncope/console/pages/NotificationModalPage_pt_BR.properties","status":"modified","additions":5,"deletions":1,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/eb6defb395f155d5b0055bb657c83bc29bc86ef6/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FNotificationModalPage_pt_BR.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/eb6defb395f155d5b0055bb657c83bc29bc86ef6/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FNotificationModalPage_pt_BR.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2FNotificationModalPage_pt_BR.properties?ref=eb6defb395f155d5b0055bb657c83bc29bc86ef6","patch":"@@ -33,4 +33,8 @@ userFilter=User filter\n userFilterWarning=N\\u00e3o use este filtro n\\u00e3o ser que os eventos n\\u00e3o s\\u00e3o direcionados a usu\\u00e1rios\n userNotifications=Notifica\\u00e7\\u00f5es do usu\\u00e1rio\n userNotificationsWarning=N\\u00e3o selecione esta op\\u00e7\\u00e3o a menos que os eventos n\\u00e3o s\\u00e3o direcionados a usu\\u00e1rios\n-isActive=Ativada\n\\ No newline at end of file\n+roleNotifications=Notifica\\u00e7\\u00f5es do fun\\u00e7\\u00f5es\n+roleNotificationsWarning=N\\u00e3o selecione esta op\\u00e7\\u00e3o a menos que os eventos n\\u00e3o s\\u00e3o direcionados a fun\\u00e7\\u00f5es\n+isActive=Ativada\n+checkUserAbout=Usu\\u00e1rio\n+checkRoleAbout=Fun\\u00e7\\u00e3o"},{"sha":"5367cfed881cc08923feaa2db498b2b31f441979","filename":"console/src/test/java/org/apache/syncope/console/ConfigurationTestITCase.java","status":"modified","additions":101,"deletions":7,"changes":108,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/eb6defb395f155d5b0055bb657c83bc29bc86ef6/console%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2FConfigurationTestITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/eb6defb395f155d5b0055bb657c83bc29bc86ef6/console%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2FConfigurationTestITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2FConfigurationTestITCase.java?ref=eb6defb395f155d5b0055bb657c83bc29bc86ef6","patch":"@@ -138,7 +138,7 @@ public void createNotification() {\n \n         selenium.type(\"name=sender:textField\", \"test@syncope.it\");\n \n-        selenium.type(\"name=sender:textField\", \"test@syncope.it\");\n+        selenium.type(\"name=subject:textField\", \"test@syncope.it\");\n \n         selenium.select(\"//div[2]/form/div[3]/div/div/div[3]/div[2]/span/select\", \"label=UserSchema\");\n \n@@ -168,7 +168,7 @@ public void createNotification() {\n                 + \"//select[@name='eventSelection:categoryContainer:category:dropDownChoiceField']\"\n                 + \"/option[text()='role']\\\");\",\n                 \"30000\");\n-        \n+\n         selenium.select(\n                 \"//select[@name='eventSelection:categoryContainer:category:dropDownChoiceField']\",\n                 \"label=role\");\n@@ -189,7 +189,7 @@ public void createNotification() {\n         selenium.click(\"//div[@class='eventSelectionWidzard']/div[2]/div[3]/span/div/input\");\n \n         selenium.click(\"//div[2]/form/div[3]/ul/li[4]/a/span\");\n-        \n+\n         selenium.click(\"//div[2]/form/div[3]/div[4]/div/div/span/input\");\n \n         selenium.type(\n@@ -238,7 +238,7 @@ public void createDisabledNotification() {\n \n         // disable notification\n         selenium.click(\"//div[2]/form/div[3]/div/div/div[7]/div[2]/span/input\");\n-        \n+\n         selenium.click(\"//div[2]/form/div[3]/ul/li[3]/a/span\");\n \n         selenium.click(\"//div[2]/form/div[3]/ul/li[2]/a/span\");\n@@ -256,7 +256,7 @@ public void createDisabledNotification() {\n                 + \"//select[@name='eventSelection:categoryContainer:category:dropDownChoiceField']\"\n                 + \"/option[text()='role']\\\");\",\n                 \"30000\");\n-        \n+\n         selenium.select(\n                 \"//select[@name='eventSelection:categoryContainer:category:dropDownChoiceField']\",\n                 \"label=role\");\n@@ -277,7 +277,7 @@ public void createDisabledNotification() {\n         selenium.click(\"//div[@class='eventSelectionWidzard']/div[2]/div[3]/span/div/input\");\n \n         selenium.click(\"//div[2]/form/div[3]/ul/li[4]/a/span\");\n-        \n+\n         selenium.click(\"//div[2]/form/div[3]/div[4]/div/div/span/input\");\n \n         selenium.type(\n@@ -290,7 +290,7 @@ public void createDisabledNotification() {\n \n         seleniumDriver.switchTo().defaultContent();\n     }\n-    \n+\n     @Test\n     public void issueSYNCOPE189() {\n         selenium.click(\"css=img[alt=\\\"Configuration\\\"]\");\n@@ -308,4 +308,98 @@ public void issueSYNCOPE189() {\n \n         seleniumDriver.switchTo().defaultContent();\n     }\n+\n+    @Test\n+    public void issueSYNCOPE446() {\n+        selenium.click(\"css=img[alt=\\\"Configuration\\\"]\");\n+\n+        selenium.waitForCondition(\"selenium.isElementPresent(\\\"//div[@id='tabs']\\\");\", \"30000\");\n+\n+        selenium.click(\"//div[@id='tabs']/ul/li[3]/a\");\n+\n+        selenium.click(\"//a[contains(text(),'Create new notification')]\");\n+\n+        selenium.waitForCondition(\"selenium.isElementPresent(\"\n+                + \"\\\"//div[2]/form/div[3]/div/div/div/div/label\\\");\", \"30000\");\n+\n+        selenium.waitForCondition(\"selenium.isElementPresent(\\\"//input[@name='sender:textField']\\\");\", \"30000\");\n+\n+        selenium.waitForCondition(\"selenium.isElementPresent(\\\"//iframe\\\");\", \"30000\");\n+        selenium.selectFrame(\"index=0\");\n+\n+        selenium.type(\"name=sender:textField\", \"syncope446@syncope.it\");\n+\n+        selenium.type(\"name=subject:textField\", \"Test issue Syncope 446\");\n+\n+        selenium.select(\"//div[2]/form/div[3]/div/div/div[3]/div[2]/span/select\", \"label=UserSchema\");\n+\n+        selenium.waitForCondition(\"selenium.isElementPresent(\"\n+                + \"\\\"//div[2]/form/div[3]/div/div/div[4]/div[2]/span/select/option[2]\\\");\", \"30000\");\n+\n+        selenium.select(\"//div[2]/form/div[3]/div/div/div[4]/div[2]/span/select\", \"label=email\");\n+\n+        selenium.select(\"//div[2]/form/div[3]/div/div/div[5]/div[2]/span/select\", \"label=optin\");\n+\n+        selenium.select(\"//div[2]/form/div[3]/div/div/div[6]/div[2]/span/select\", \"label=ALL\");\n+\n+        selenium.click(\"//div[2]/form/div[3]/ul/li[3]/a/span\");\n+\n+        selenium.click(\"//div[2]/form/div[3]/ul/li[2]/a/span\");\n+\n+        selenium.waitForCondition(\"selenium.isElementPresent(\\\"\"\n+                + \"//select[@name='eventSelection:categoryContainer:type:dropDownChoiceField']\"\n+                + \"/option[text()='REST']\\\");\",\n+                \"30000\");\n+\n+        selenium.select(\n+                \"//select[@name='eventSelection:categoryContainer:type:dropDownChoiceField']\",\n+                \"label=REST\");\n+\n+        selenium.waitForCondition(\"selenium.isElementPresent(\\\"\"\n+                + \"//select[@name='eventSelection:categoryContainer:category:dropDownChoiceField']\"\n+                + \"/option[text()='RoleController']\\\");\",\n+                \"30000\");\n+\n+        selenium.select(\n+                \"//select[@name='eventSelection:categoryContainer:category:dropDownChoiceField']\",\n+                \"label=RoleController\");\n+\n+        selenium.waitForCondition(\"selenium.isElementPresent(\"\n+                + \"\\\"//input[@name='eventSelection:eventsContainer:eventsPanel:successGroup']\\\");\",\n+                \"30000\");\n+\n+        selenium.click(\"//div[@class='eventSelectionWidzard']/div[2]/div[3]/span/div/input\");\n+\n+        selenium.click(\"//div[2]/form/div[3]/ul/li[3]/a/span\");\n+        selenium.click(\"//div[2]/form/div[3]/div[3]/span/div[4]/div/span/input\");\n+\n+        selenium.waitForCondition(\"selenium.isElementPresent(\\\"\"\n+                + \"//select[@name='aboutContainer:roleAbout:searchFormContainer:searchView:0:type']\"\n+                + \"/option[text()='ENTITLEMENT']\\\");\",\n+                \"30000\");\n+\n+        selenium.select(\n+                \"//select[@name='aboutContainer:roleAbout:searchFormContainer:searchView:0:type']\",\n+                \"label=ENTITLEMENT\");\n+\n+        selenium.waitForCondition(\"selenium.isElementPresent(\\\"\"\n+                + \"//select[@name='aboutContainer:roleAbout:searchFormContainer:searchView:0:property']\"\n+                + \"/option[text()='ROLE_CREATE']\\\");\",\n+                \"30000\");\n+\n+        selenium.select(\n+                \"//select[@name='aboutContainer:roleAbout:searchFormContainer:searchView:0:property']\",\n+                \"label=ROLE_CREATE\");\n+        \n+        selenium.click(\"//div[2]/form/div[3]/ul/li[4]/a/span\");\n+        \n+        selenium.click(\"//input[@name='recipientsContainer:checkRecipients:checkboxField']\");\n+\n+        selenium.type(\n+                \"name=staticRecipients:multiValueContainer:view:0:panel:textField\", \"syncope446@syncope.apache.org\");\n+\n+        selenium.click(\"//div[2]/form/div[4]/input\");\n+\n+        seleniumDriver.switchTo().defaultContent();\n+    }\n }"},{"sha":"4fd8fce07eaa3cba5d950133041d41baedd91513","filename":"console/src/test/java/org/apache/syncope/console/TaskTestITCase.java","status":"modified","additions":12,"deletions":12,"changes":24,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/eb6defb395f155d5b0055bb657c83bc29bc86ef6/console%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2FTaskTestITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/eb6defb395f155d5b0055bb657c83bc29bc86ef6/console%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2FTaskTestITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2FTaskTestITCase.java?ref=eb6defb395f155d5b0055bb657c83bc29bc86ef6","patch":"@@ -28,30 +28,30 @@ public void execute() {\n \n         selenium.waitForCondition(\"selenium.isElementPresent(\\\"//div[@id='tabs']\\\");\", \"30000\");\n \n-        selenium.click(\"//div[@id='tabs']/ul/li[4]/a\");\n+        selenium.click(\"//div[@id='tabs']/ul/li[1]/a\");\n \n         selenium.waitForCondition(\"selenium.isElementPresent(\"\n-                + \"\\\"//div[4]/span/div/span/span/span/form/span/table/tbody/tr/td[9]/div/span[6]/a/img\\\");\", \"30000\");\n+                + \"\\\"//tr[4]/td[10]/div/span[6]/a/img\\\");\", \"30000\");\n \n-        selenium.click(\"//div[4]/span/div/span/span/span/form/span/table/tbody/tr/td[9]/div/span[6]/a/img\");\n-\n-        selenium.waitForCondition(\"selenium.isTextPresent(\" + \"\\\"Operation executed successfully\\\");\", \"30000\");\n+        selenium.click(\"//tr[4]/td[10]/div/span[6]/a/img\");      \n+        \n+        selenium.waitForCondition(\"selenium.isTextPresent(\\\"Operation executed successfully\\\");\", \"30000\");\n \n         selenium.waitForCondition(\"selenium.isElementPresent(\"\n-                + \"\\\"//div[4]/span/div/span/span/span/form/span/table/tbody/tr/td[9]/div/span[12]/a/img\\\");\", \"30000\");\n-\n-        selenium.click(\"//div[4]/span/div/span/span/span/form/span/table/tbody/tr/td[9]/div/span[12]/a/img\");\n+                + \"\\\"//tr[4]/td[10]/div/span[12]/a/img\\\");\", \"30000\");\n+        \n+        selenium.click(\"//tr[4]/td[10]/div/span[12]/a/img\");\n \n         selenium.waitForCondition(\"selenium.isElementPresent(\\\"//iframe\\\");\", \"30000\");\n         selenium.selectFrame(\"index=0\");\n \n         selenium.waitForCondition(\"selenium.isElementPresent(\"\n-                + \"\\\"//div[2]/form/div[2]/ul/li[3]/a\\\");\", \"30000\");\n-\n-        selenium.click(\"//div[2]/form/div[2]/ul/li[3]/a\");\n+                + \"\\\"//div[2]/form/div[2]/ul/li[2]/a\\\");\", \"30000\");\n \n-        assertTrue(selenium.isElementPresent(\"//div[2]/form/div[2]/div[3]/span/table/tbody/tr/td[2]\"));\n+        selenium.click(\"//div[2]/form/div[2]/ul/li[2]/a\");\n \n+        assertTrue(selenium.isElementPresent(\"//div[2]/form/div[2]/div[2]/span/table/tbody/tr/td[4]\"));\n+        \n         seleniumDriver.switchTo().defaultContent();\n \n         selenium.click(\"css=a.w_close\");"},{"sha":"679313faef2243af5427f3d2c104e706806374a4","filename":"core/src/main/java/org/apache/syncope/core/notification/NotificationManager.java","status":"modified","additions":26,"deletions":8,"changes":34,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/eb6defb395f155d5b0055bb657c83bc29bc86ef6/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fnotification%2FNotificationManager.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/eb6defb395f155d5b0055bb657c83bc29bc86ef6/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fnotification%2FNotificationManager.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fnotification%2FNotificationManager.java?ref=eb6defb395f155d5b0055bb657c83bc29bc86ef6","patch":"@@ -41,6 +41,7 @@\n import org.apache.syncope.core.persistence.beans.NotificationTask;\n import org.apache.syncope.core.persistence.beans.SyncopeConf;\n import org.apache.syncope.core.persistence.beans.TaskExec;\n+import org.apache.syncope.core.persistence.beans.role.SyncopeRole;\n import org.apache.syncope.core.persistence.beans.user.SyncopeUser;\n import org.apache.syncope.core.persistence.beans.user.UAttr;\n import org.apache.syncope.core.persistence.beans.user.UDerAttr;\n@@ -53,6 +54,7 @@\n import org.apache.syncope.core.persistence.dao.TaskDAO;\n import org.apache.syncope.core.persistence.dao.UserDAO;\n import org.apache.syncope.core.persistence.dao.search.OrderByClause;\n+import org.apache.syncope.core.rest.data.RoleDataBinder;\n import org.apache.syncope.core.rest.data.SearchCondConverter;\n import org.apache.syncope.core.rest.data.UserDataBinder;\n import org.apache.syncope.core.util.AttributableUtil;\n@@ -72,7 +74,7 @@\n  *\n  * @see NotificationTask\n  */\n-@Transactional(rollbackFor = { Throwable.class })\n+@Transactional(rollbackFor = {Throwable.class})\n public class NotificationManager {\n \n     /**\n@@ -110,6 +112,12 @@ public class NotificationManager {\n     @Autowired\n     private UserDataBinder userDataBinder;\n \n+    /**\n+     * Role data binder.\n+     */\n+    @Autowired\n+    private RoleDataBinder roleDataBinder;\n+\n     /**\n      * User Search DAO.\n      */\n@@ -154,7 +162,9 @@ private NotificationTask getNotificationTask(\n             final Map<String, Object> model) {\n \n         if (attributable != null) {\n-            connObjectUtil.retrieveVirAttrValues(attributable, AttributableUtil.getInstance(AttributableType.USER));\n+            connObjectUtil.retrieveVirAttrValues(attributable,\n+                    AttributableUtil.getInstance(\n+                            attributable instanceof SyncopeUser ? AttributableType.USER : AttributableType.ROLE));\n         }\n \n         final List<SyncopeUser> recipients = new ArrayList<SyncopeUser>();\n@@ -268,7 +278,8 @@ public void createTasks(\n         LOG.debug(\"Search notification for [{}]{}\", attributableType, attributable);\n \n         for (Notification notification : notificationDAO.findAll()) {\n-            LOG.debug(\"Notification available about {}\", notification.getAbout());\n+            LOG.debug(\"Notification available user about {}\", notification.getUserAbout());\n+            LOG.debug(\"Notification available role about {}\", notification.getRoleAbout());\n             if (notification.isActive()) {\n \n                 final Set<String> events = new HashSet<String>(notification.getEvents());\n@@ -277,9 +288,13 @@ public void createTasks(\n \n                 if (events.isEmpty()) {\n                     LOG.debug(\"No events found about {}\", attributable);\n-                } else if (attributableType == null || attributable == null || notification.\n-                        getAbout() == null || searchDAO.matches(attributable,\n-                                SearchCondConverter.convert(notification.getAbout()),\n+                } else if (attributableType == null || attributable == null\n+                        || notification.getUserAbout() == null || notification.getRoleAbout() == null\n+                        || searchDAO.matches(attributable,\n+                                SearchCondConverter.convert(notification.getUserAbout()),\n+                                AttributableUtil.getInstance(attributableType))\n+                        || searchDAO.matches(attributable,\n+                                SearchCondConverter.convert(notification.getRoleAbout()),\n                                 AttributableUtil.getInstance(attributableType))) {\n \n                     LOG.debug(\"Creating notification task for events {} about {}\", events, attributable);\n@@ -296,13 +311,16 @@ public void createTasks(\n \n                     if (attributable instanceof SyncopeUser) {\n                         model.put(\"user\", userDataBinder.getUserTO((SyncopeUser) attributable));\n+                    } else if (attributable instanceof SyncopeRole) {\n+                        model.put(\"role\", roleDataBinder.getRoleTO((SyncopeRole) attributable));\n                     }\n \n                     taskDAO.save(getNotificationTask(notification, attributable, model));\n                 }\n             } else {\n-                LOG.debug(\"Notification {}, about {} is deactivated, notification task will not be created\",\n-                        notification.getId(), notification.getAbout());\n+                LOG.debug(\"Notification {}, userAbout {}, roleAbout {} is deactivated, \"\n+                        + \"notification task will not be created\", notification.getId(),\n+                        notification.getUserAbout(), notification.getRoleAbout());\n             }\n         }\n     }"},{"sha":"6c1c466f2ba2b8db7a4b25b11e6b4b39d58a01a3","filename":"core/src/main/java/org/apache/syncope/core/persistence/beans/Notification.java","status":"modified","additions":15,"deletions":5,"changes":20,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/eb6defb395f155d5b0055bb657c83bc29bc86ef6/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fbeans%2FNotification.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/eb6defb395f155d5b0055bb657c83bc29bc86ef6/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fbeans%2FNotification.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fbeans%2FNotification.java?ref=eb6defb395f155d5b0055bb657c83bc29bc86ef6","patch":"@@ -50,7 +50,9 @@ public class Notification extends AbstractBaseBean {\n     @Column(name = \"events\")\n     private List<String> events;\n \n-    private String about;\n+    private String userAbout;\n+\n+    private String roleAbout;\n \n     private String recipients;\n \n@@ -102,12 +104,20 @@ public Long getId() {\n         return id;\n     }\n \n-    public String getAbout() {\n-        return about;\n+    public String getUserAbout() {\n+        return userAbout;\n+    }\n+\n+    public void setUserAbout(final String userAbout) {\n+        this.userAbout = userAbout;\n+    }\n+\n+    public String getRoleAbout() {\n+        return roleAbout;\n     }\n \n-    public void setAbout(final String about) {\n-        this.about = about;\n+    public void setRoleAbout(final String roleAbout) {\n+        this.roleAbout = roleAbout;\n     }\n \n     public String getRecipients() {"},{"sha":"d9e3d4ec531be387ba2160550a3519f8e543f0a5","filename":"core/src/main/java/org/apache/syncope/core/rest/data/NotificationDataBinder.java","status":"modified","additions":4,"deletions":2,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/eb6defb395f155d5b0055bb657c83bc29bc86ef6/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2Fdata%2FNotificationDataBinder.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/eb6defb395f155d5b0055bb657c83bc29bc86ef6/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2Fdata%2FNotificationDataBinder.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2Fdata%2FNotificationDataBinder.java?ref=eb6defb395f155d5b0055bb657c83bc29bc86ef6","patch":"@@ -34,7 +34,8 @@ public NotificationTO getNotificationTO(final Notification notification) {\n         BeanUtils.copyProperties(notification, result, IGNORE_PROPERTIES);\n \n         result.setId(notification.getId());\n-        result.setAbout(notification.getAbout());\n+        result.setUserAbout(notification.getUserAbout());\n+        result.setRoleAbout(notification.getRoleAbout());\n         result.setRecipients(notification.getRecipients());\n \n         return result;\n@@ -49,7 +50,8 @@ public Notification createNotification(final NotificationTO notificationTO) {\n     public void updateNotification(final Notification notification, final NotificationTO notificationTO) {\n         BeanUtils.copyProperties(notificationTO, notification, IGNORE_PROPERTIES);\n \n-        notification.setAbout(notificationTO.getAbout());\n+        notification.setUserAbout(notificationTO.getUserAbout());\n+        notification.setRoleAbout(notificationTO.getRoleAbout());\n         notification.setRecipients(notificationTO.getRecipients());\n     }\n }"},{"sha":"dbc9d0d01fc69b61b2ed1ac25c75e555ba2060fa","filename":"core/src/test/java/org/apache/syncope/core/notification/NotificationTest.java","status":"modified","additions":70,"deletions":6,"changes":76,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/eb6defb395f155d5b0055bb657c83bc29bc86ef6/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fnotification%2FNotificationTest.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/eb6defb395f155d5b0055bb657c83bc29bc86ef6/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fnotification%2FNotificationTest.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fnotification%2FNotificationTest.java?ref=eb6defb395f155d5b0055bb657c83bc29bc86ef6","patch":"@@ -41,6 +41,7 @@\n import org.apache.syncope.common.SyncopeConstants;\n import org.apache.syncope.common.to.MembershipTO;\n import org.apache.syncope.common.to.NotificationTaskTO;\n+import org.apache.syncope.common.to.RoleTO;\n import org.apache.syncope.common.to.UserTO;\n import org.apache.syncope.common.types.IntMappingType;\n import org.apache.syncope.common.types.TraceLevel;\n@@ -53,6 +54,7 @@\n import org.apache.syncope.core.persistence.dao.NotificationDAO;\n import org.apache.syncope.core.persistence.dao.TaskDAO;\n import org.apache.syncope.core.rest.UserTestITCase;\n+import org.apache.syncope.core.rest.controller.RoleController;\n import org.apache.syncope.core.rest.controller.TaskController;\n import org.apache.syncope.core.rest.controller.UserController;\n import org.junit.AfterClass;\n@@ -124,6 +126,9 @@ public class NotificationTest {\n     @Autowired\n     private UserController userController;\n \n+    @Autowired\n+    private RoleController roleController;\n+\n     @Autowired\n     private TaskController taskController;\n \n@@ -209,7 +214,7 @@ public void notifyByMail() throws Exception {\n         // 1. create suitable notification for subsequent tests\n         Notification notification = new Notification();\n         notification.addEvent(\"[REST]:[UserController]:[]:[create]:[SUCCESS]\");\n-        notification.setAbout(SyncopeClient.getUserSearchConditionBuilder().hasRoles(7L).query());\n+        notification.setUserAbout(SyncopeClient.getUserSearchConditionBuilder().hasRoles(7L).query());\n         notification.setRecipients(SyncopeClient.getUserSearchConditionBuilder().hasRoles(8L).query());\n         notification.setSelfAsRecipient(true);\n \n@@ -267,7 +272,7 @@ public void issueSYNCOPE192() throws Exception {\n         // 1. create suitable notification for subsequent tests\n         Notification notification = new Notification();\n         notification.addEvent(\"[REST]:[UserController]:[]:[create]:[SUCCESS]\");\n-        notification.setAbout(SyncopeClient.getUserSearchConditionBuilder().hasRoles(7L).query());\n+        notification.setUserAbout(SyncopeClient.getUserSearchConditionBuilder().hasRoles(7L).query());\n         notification.setRecipients(SyncopeClient.getUserSearchConditionBuilder().hasRoles(8L).query());\n         notification.setSelfAsRecipient(true);\n \n@@ -319,7 +324,7 @@ public void notifyByMailEmptyAbout() throws Exception {\n         // 1. create suitable notification for subsequent tests\n         Notification notification = new Notification();\n         notification.addEvent(\"[REST]:[UserController]:[]:[create]:[SUCCESS]\");\n-        notification.setAbout(null);\n+        notification.setUserAbout(null);\n         notification.setRecipients(SyncopeClient.getUserSearchConditionBuilder().hasRoles(8L).query());\n         notification.setSelfAsRecipient(true);\n \n@@ -369,7 +374,7 @@ public void notifyByMailWithRetry() throws Exception {\n         // 1. create suitable notification for subsequent tests\n         Notification notification = new Notification();\n         notification.addEvent(\"[REST]:[UserController]:[]:[create]:[SUCCESS]\");\n-        notification.setAbout(null);\n+        notification.setUserAbout(null);\n         notification.setRecipients(SyncopeClient.getUserSearchConditionBuilder().hasRoles(8L).query());\n         notification.setSelfAsRecipient(true);\n \n@@ -435,7 +440,7 @@ public void issueSYNCOPE445() throws Exception {\n         // 1. create suitable notification for subsequent tests\n         Notification notification = new Notification();\n         notification.addEvent(\"[REST]:[UserController]:[]:[create]:[SUCCESS]\");\n-        notification.setAbout(SyncopeClient.getUserSearchConditionBuilder().hasRoles(7L).query());\n+        notification.setUserAbout(SyncopeClient.getUserSearchConditionBuilder().hasRoles(7L).query());\n         notification.setRecipients(SyncopeClient.getUserSearchConditionBuilder().hasRoles(8L).query());\n         notification.setSelfAsRecipient(true);\n \n@@ -494,7 +499,7 @@ public void issueSYNCOPE492() throws Exception {\n         // 1. create suitable disabled notification for subsequent tests\n         Notification notification = new Notification();\n         notification.addEvent(\"[REST]:[UserController]:[]:[create]:[SUCCESS]\");\n-        notification.setAbout(SyncopeClient.getUserSearchConditionBuilder().hasRoles(7L).query());\n+        notification.setUserAbout(SyncopeClient.getUserSearchConditionBuilder().hasRoles(7L).query());\n         notification.setSelfAsRecipient(true);\n \n         notification.setRecipientAttrName(\"email\");\n@@ -531,4 +536,63 @@ public void issueSYNCOPE492() throws Exception {\n         // 4. check if number of tasks is not incremented\n         assertEquals(tasksNumberBefore, taskDAO.findAll(NotificationTask.class).size());\n     }\n+\n+    @Test\n+    public void issueSYNCOPE446() throws Exception {\n+\n+        // 1. create suitable notification for subsequent tests\n+        Notification notification = new Notification();\n+        notification.addEvent(\"[REST]:[RoleController]:[]:[create]:[SUCCESS]\");\n+        notification.setRoleAbout(SyncopeClient.getRoleSearchConditionBuilder().is(\"name\").equalTo(\"role446\").query());\n+        notification.setSelfAsRecipient(false);\n+\n+        notification.setRecipientAttrName(\"email\");\n+        notification.setRecipientAttrType(IntMappingType.UserSchema);\n+\n+        notification.getStaticRecipients().add(mailAddress);\n+\n+        Random random = new Random(System.currentTimeMillis());\n+        String sender = \"syncopetest-\" + random.nextLong() + \"@syncope.apache.org\";\n+        notification.setSender(sender);\n+        String subject = \"Test notification \" + random.nextLong();\n+        notification.setSubject(subject);\n+        notification.setTemplate(\"optin\");\n+\n+        Notification actual = notificationDAO.save(notification);\n+        assertNotNull(actual);\n+\n+        notificationDAO.flush();\n+\n+        // 2. create role\n+        RoleTO roleTO = new RoleTO();\n+        roleTO.setName(\"role446\");\n+        roleTO.setParent(1L);\n+\n+        RoleTO createdRole = roleController.create(roleTO);\n+        assertNotNull(createdRole);\n+\n+        // 3. force Quartz job execution and verify e-mail\n+        notificationJob.execute(null);\n+        assertTrue(verifyMail(sender, subject));\n+\n+        // 4. get NotificationTask id and text body\n+        Long taskId = null;\n+        String textBody = null;\n+        Set<String> recipients = null;\n+        for (NotificationTask task : taskDAO.findAll(NotificationTask.class)) {\n+            if (sender.equals(task.getSender())) {\n+                taskId = task.getId();\n+                textBody = task.getTextBody();\n+                recipients = task.getRecipients();\n+            }\n+        }\n+\n+        assertNotNull(taskId);\n+        assertNotNull(textBody);\n+        assertTrue(recipients.contains(mailAddress));\n+\n+        // 5. execute Notification task and verify e-mail\n+        taskController.execute(taskId, false);\n+        assertTrue(verifyMail(sender, subject));\n+    }\n }"},{"sha":"c9d18ec49f2332fe6531aa12a788f1816f120461","filename":"core/src/test/java/org/apache/syncope/core/persistence/dao/NotificationTest.java","status":"modified","additions":28,"deletions":8,"changes":36,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/eb6defb395f155d5b0055bb657c83bc29bc86ef6/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fdao%2FNotificationTest.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/eb6defb395f155d5b0055bb657c83bc29bc86ef6/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fdao%2FNotificationTest.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fdao%2FNotificationTest.java?ref=eb6defb395f155d5b0055bb657c83bc29bc86ef6","patch":"@@ -18,13 +18,10 @@\n  */\n package org.apache.syncope.core.persistence.dao;\n \n-import java.util.ArrayList;\n import static org.junit.Assert.assertFalse;\n import static org.junit.Assert.assertNotNull;\n import static org.junit.Assert.assertNull;\n-\n import java.util.List;\n-\n import org.apache.syncope.client.SyncopeClient;\n import org.apache.syncope.common.types.IntMappingType;\n import org.apache.syncope.core.persistence.beans.Notification;\n@@ -44,7 +41,7 @@ public void find() {\n         assertNotNull(notification);\n         assertNotNull(notification.getEvents());\n         assertFalse(notification.getEvents().isEmpty());\n-        assertNotNull(notification.getAbout());\n+        assertNotNull(notification.getUserAbout());\n         assertNotNull(notification.getRecipients());\n \n     }\n@@ -61,7 +58,7 @@ public void save() {\n         Notification notification = new Notification();\n         notification.addEvent(\"save\");\n \n-        notification.setAbout(SyncopeClient.getUserSearchConditionBuilder().\n+        notification.setUserAbout(SyncopeClient.getUserSearchConditionBuilder().\n                 is(\"fullname\").equalTo(\"*o*\").and(\"fullname\").equalTo(\"*i*\").query());\n \n         notification.setRecipients(SyncopeClient.getUserSearchConditionBuilder().hasRoles(7L).query());\n@@ -89,16 +86,16 @@ public void issueSYNCOPE445() {\n         Notification notification = new Notification();\n         notification.addEvent(\"save\");\n \n-        notification.setAbout(SyncopeClient.getUserSearchConditionBuilder().\n+        notification.setUserAbout(SyncopeClient.getUserSearchConditionBuilder().\n                 is(\"fullname\").equalTo(\"*o*\").and(\"fullname\").equalTo(\"*i*\").query());\n \n         notification.setRecipients(SyncopeClient.getUserSearchConditionBuilder().hasRoles(7L).query());\n \n         notification.setRecipientAttrName(\"email\");\n         notification.setRecipientAttrType(IntMappingType.UserSchema);\n-       \n+\n         notification.addStaticRecipient(\"syncope445@syncope.apache.org\");\n-        \n+\n         notification.setSender(\"syncope@syncope.apache.org\");\n         notification.setSubject(\"Test notification\");\n         notification.setTemplate(\"test\");\n@@ -110,4 +107,27 @@ public void issueSYNCOPE445() {\n         assertFalse(actual.getStaticRecipients().isEmpty());\n     }\n \n+    @Test\n+    public void issueSYNCOPE446() {\n+        Notification notification = new Notification();\n+        notification.addEvent(\"[REST]:[RoleController]:[]:[create]:[SUCCESS]\");\n+\n+        notification.setRoleAbout(\n+                SyncopeClient.getRoleSearchConditionBuilder().hasEntitlements(\"ROLE_READ\").query());\n+\n+        notification.setRecipientAttrName(\"email\");\n+        notification.setRecipientAttrType(IntMappingType.UserSchema);\n+\n+        notification.addStaticRecipient(\"syncope446@syncope.apache.org\");\n+\n+        notification.setSender(\"syncope@syncope.apache.org\");\n+        notification.setSubject(\"Test notification\");\n+        notification.setTemplate(\"test\");\n+\n+        Notification actual = notificationDAO.save(notification);\n+        assertNotNull(actual);\n+        assertNotNull(actual.getId());\n+        assertNotNull(actual.getStaticRecipients());\n+        assertFalse(actual.getStaticRecipients().isEmpty());\n+    }\n }"},{"sha":"3cd20395d9bd7c5a21a2213de79b5e27e717917e","filename":"core/src/test/java/org/apache/syncope/core/rest/NotificationTestITCase.java","status":"modified","additions":21,"deletions":3,"changes":24,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/eb6defb395f155d5b0055bb657c83bc29bc86ef6/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2FNotificationTestITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/eb6defb395f155d5b0055bb657c83bc29bc86ef6/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2FNotificationTestITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2FNotificationTestITCase.java?ref=eb6defb395f155d5b0055bb657c83bc29bc86ef6","patch":"@@ -44,13 +44,13 @@ private NotificationTO buildNotificationTO() {\n         NotificationTO notificationTO = new NotificationTO();\n         notificationTO.setTraceLevel(TraceLevel.SUMMARY);\n         notificationTO.getEvents().add(\"create\");\n-\n-        notificationTO.setAbout(SyncopeClient.getUserSearchConditionBuilder().\n+        \n+        notificationTO.setUserAbout(SyncopeClient.getUserSearchConditionBuilder().\n                 is(\"fullname\").equalTo(\"*o*\").and(\"fullname\").equalTo(\"*i*\").query());\n \n         notificationTO.setRecipientAttrName(\"email\");\n         notificationTO.setRecipientAttrType(IntMappingType.UserSchema);\n-        \n+\n         notificationTO.setSender(\"syncope@syncope.apache.org\");\n         notificationTO.setSubject(\"Test notification\");\n         notificationTO.setTemplate(\"test\");\n@@ -152,4 +152,22 @@ public void issueSYNCOPE445() {\n         assertEquals(actual, notificationTO);\n     }\n \n+    @Test\n+    public void issueSYNCOPE446() {\n+        NotificationTO notificationTO = buildNotificationTO();\n+        notificationTO.getStaticRecipients().add(\"syncope446@syncope.apache.org\");\n+        notificationTO.setRoleAbout(SyncopeClient.getRoleSearchConditionBuilder().hasEntitlements(\"ROLE_READ\").query());\n+\n+        NotificationTO actual = null;\n+        try {\n+            Response response = notificationService.create(notificationTO);\n+            actual = getObject(response.getLocation(), NotificationService.class, NotificationTO.class);\n+        } catch (SyncopeClientException e) {\n+            assertNotNull(e);\n+        }\n+        assertNotNull(actual);\n+        assertNotNull(actual.getId());\n+        notificationTO.setId(actual.getId());\n+        assertEquals(actual, notificationTO);\n+    }\n }"},{"sha":"4c330ec7f45ff08a6746c1a308a44b52596335f5","filename":"core/src/test/java/org/apache/syncope/core/rest/TaskTestITCase.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/eb6defb395f155d5b0055bb657c83bc29bc86ef6/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2FTaskTestITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/eb6defb395f155d5b0055bb657c83bc29bc86ef6/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2FTaskTestITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Frest%2FTaskTestITCase.java?ref=eb6defb395f155d5b0055bb657c83bc29bc86ef6","patch":"@@ -538,7 +538,7 @@ private void createNotificationTask(final String sender) {\n         notification.setTraceLevel(TraceLevel.FAILURES);\n         notification.getEvents().add(\"[REST]:[UserController]:[]:[create]:[SUCCESS]\");\n \n-        notification.setAbout(SyncopeClient.getUserSearchConditionBuilder().hasRoles(7L).query());\n+        notification.setUserAbout(SyncopeClient.getUserSearchConditionBuilder().hasRoles(7L).query());\n \n         notification.setRecipients(SyncopeClient.getUserSearchConditionBuilder().hasRoles(8L).query());\n         notification.setSelfAsRecipient(true);"},{"sha":"9aaddad12e76eb0a0011310183fcf490a7097815","filename":"core/src/test/resources/content.xml","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/eb6defb395f155d5b0055bb657c83bc29bc86ef6/core%2Fsrc%2Ftest%2Fresources%2Fcontent.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/eb6defb395f155d5b0055bb657c83bc29bc86ef6/core%2Fsrc%2Ftest%2Fresources%2Fcontent.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Ftest%2Fresources%2Fcontent.xml?ref=eb6defb395f155d5b0055bb657c83bc29bc86ef6","patch":"@@ -845,7 +845,7 @@ under the License.\n         jobClassName=\"org.apache.syncope.core.sync.impl.PushJob\"/>\n       \n   <Notification id=\"1\" sender=\"test@syncope.apache.org\" subject=\"Test subject\" template=\"test\" selfAsRecipient=\"0\" traceLevel=\"ALL\"\n-                about=\"fullname==*o*;fullname==*i*\"\n+                userAbout=\"fullname==*o*;fullname==*i*\"\n                 recipients=\"$roles==7\"\n                 recipientAttrType=\"UserSchema\" recipientAttrName=\"email\" active=\"1\"/>\n   <Notification_events Notification_id=\"1\" events=\"[CUSTOM]:[]:[]:[unexisting1]:[FAILURE]\"/>"}]}