{"sha":"606e32ec4f8c3e184dc58702862516705a71a0ad","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjYwNmUzMmVjNGY4YzNlMTg0ZGM1ODcwMjg2MjUxNjcwNWE3MWEwYWQ=","commit":{"author":{"name":"Massimiliano Perrone","email":"massi@apache.org","date":"2012-03-16T14:17:10Z"},"committer":{"name":"Massimiliano Perrone","email":"massi@apache.org","date":"2012-03-16T14:17:10Z"},"message":"Applying attached patch [SYNCOPE-21]\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/syncope/trunk@1301538 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"49a80f1d01aa31b441cc02e59c5b0f821abd7bcb","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/49a80f1d01aa31b441cc02e59c5b0f821abd7bcb"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/606e32ec4f8c3e184dc58702862516705a71a0ad","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/606e32ec4f8c3e184dc58702862516705a71a0ad","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/606e32ec4f8c3e184dc58702862516705a71a0ad","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/606e32ec4f8c3e184dc58702862516705a71a0ad/comments","author":null,"committer":null,"parents":[{"sha":"fa22d73ea631e110fd7780d89112b9d83fdff51a","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/fa22d73ea631e110fd7780d89112b9d83fdff51a","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/fa22d73ea631e110fd7780d89112b9d83fdff51a"}],"stats":{"total":25,"additions":21,"deletions":4},"files":[{"sha":"7c2abc23fdfe091f0b4caaf8a7ec048c42502f64","filename":"core/src/main/java/org/syncope/core/init/ContentLoader.java","status":"modified","additions":10,"deletions":2,"changes":12,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/606e32ec4f8c3e184dc58702862516705a71a0ad/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Finit%2FContentLoader.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/606e32ec4f8c3e184dc58702862516705a71a0ad/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Finit%2FContentLoader.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Finit%2FContentLoader.java?ref=606e32ec4f8c3e184dc58702862516705a71a0ad","patch":"@@ -145,14 +145,22 @@ public void load() {\n             LOG.debug(\"Indexes created, go for default content\");\n         } catch (Throwable t) {\n             LOG.error(\"While creating indexes\", t);\n-        } finally {\n-            DataSourceUtils.releaseConnection(conn, dataSource);\n+        }\n+\n+        try {\n+            statement = conn.createStatement();\n+            statement.executeUpdate(\"DELETE FROM ACT_GE_PROPERTY\");\n+            statement.close();\n+        } catch (SQLException e) {\n+            LOG.error(\"Error during ACT_GE_PROPERTY delete rows\", e);\n         }\n \n         try {\n             conn.close();\n         } catch (SQLException e) {\n             LOG.error(\"While closing SQL connection\", e);\n+        } finally {\n+            DataSourceUtils.releaseConnection(conn, dataSource);\n         }\n \n         // 4. Load default content"},{"sha":"5ba8c52cdbf0aea8a4b141b2dbbe45f953aa32e4","filename":"core/src/main/java/org/syncope/core/util/ImportExport.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/606e32ec4f8c3e184dc58702862516705a71a0ad/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Futil%2FImportExport.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/606e32ec4f8c3e184dc58702862516705a71a0ad/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Futil%2FImportExport.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fcore%2Futil%2FImportExport.java?ref=606e32ec4f8c3e184dc58702862516705a71a0ad","patch":"@@ -353,7 +353,7 @@ public void export(final OutputStream os)\n             while (rs.next()) {\n                 String tableName = rs.getString(\"TABLE_NAME\");\n                 // these tables must be ignored\n-                if (!tableName.toUpperCase().startsWith(\"QRTZ_\") && !tableName.toUpperCase().equals(\"ACT_GE_PROPERTY\")) {\n+                if (!tableName.toUpperCase().startsWith(\"QRTZ_\")) {\n \n                     tableNames.add(tableName);\n                 }"},{"sha":"ba8c0a786e997634b54a28f7ecb3ac4df7528ea0","filename":"core/src/main/resources/content.xml","status":"modified","additions":5,"deletions":1,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/606e32ec4f8c3e184dc58702862516705a71a0ad/core%2Fsrc%2Fmain%2Fresources%2Fcontent.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/606e32ec4f8c3e184dc58702862516705a71a0ad/core%2Fsrc%2Fmain%2Fresources%2Fcontent.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fresources%2Fcontent.xml?ref=606e32ec4f8c3e184dc58702862516705a71a0ad","patch":"@@ -117,5 +117,9 @@ under the License.\n   <Entitlement name=\"AUDIT_LIST\"/>\n   <Entitlement name=\"AUDIT_SET_LEVEL\"/>\n   <Entitlement name=\"AUDIT_DELETE\"/>\n-    \n+\n+  <ACT_GE_PROPERTY NAME_=\"schema.version\" VALUE_=\"5.9\" REV_=\"1\"/>\n+  <ACT_GE_PROPERTY NAME_=\"schema.history\" VALUE_=\"create(5.9)\" REV_=\"1\"/>\n+  <ACT_GE_PROPERTY NAME_=\"next.dbid\" VALUE_=\"1\" REV_=\"1\"/>\n+  <ACT_GE_PROPERTY NAME_=\"historyLevel\" VALUE_=\"1\" REV_=\"1\"/>    \n </dataset>"},{"sha":"152e19a67553cd84e4c7982a14c7fae6de46ba50","filename":"core/src/test/resources/content.xml","status":"modified","additions":5,"deletions":0,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/606e32ec4f8c3e184dc58702862516705a71a0ad/core%2Fsrc%2Ftest%2Fresources%2Fcontent.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/606e32ec4f8c3e184dc58702862516705a71a0ad/core%2Fsrc%2Ftest%2Fresources%2Fcontent.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Ftest%2Fresources%2Fcontent.xml?ref=606e32ec4f8c3e184dc58702862516705a71a0ad","patch":"@@ -607,4 +607,9 @@ under the License.\n   <ReportExec Report_id=\"1\" id=\"1\" status=\"SUCCESS\" startDate=\"2012-02-26 15:40:04\" endDate=\"2012-02-26 15:41:04\"/>\n   \n   <SyncopeLogger logName=\"syncope.audit.authentication.getEntitlements.success\" logLevel=\"DEBUG\" logType=\"AUDIT\"/>\n+  \n+  <ACT_GE_PROPERTY NAME_=\"schema.version\" VALUE_=\"5.9\" REV_=\"1\"/>\n+  <ACT_GE_PROPERTY NAME_=\"schema.history\" VALUE_=\"create(5.9)\" REV_=\"1\"/>\n+  <ACT_GE_PROPERTY NAME_=\"next.dbid\" VALUE_=\"1\" REV_=\"1\"/>\n+  <ACT_GE_PROPERTY NAME_=\"historyLevel\" VALUE_=\"1\" REV_=\"1\"/>\n </dataset>"}]}