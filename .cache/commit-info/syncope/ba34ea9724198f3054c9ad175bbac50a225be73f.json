{"sha":"ba34ea9724198f3054c9ad175bbac50a225be73f","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmJhMzRlYTk3MjQxOThmMzA1NGM5YWQxNzViYmFjNTBhMjI1YmU3M2Y=","commit":{"author":{"name":"Unknown","email":"unknown@apache.org","date":"2010-08-25T14:06:05Z"},"committer":{"name":"Unknown","email":"unknown@apache.org","date":"2010-08-25T14:06:05Z"},"message":"Role and User's update + small fixes\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/syncope/trunk@1246445 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"0235acf510d9db85481f3af89ba5a3b9e7e15736","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/0235acf510d9db85481f3af89ba5a3b9e7e15736"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/ba34ea9724198f3054c9ad175bbac50a225be73f","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/ba34ea9724198f3054c9ad175bbac50a225be73f","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/ba34ea9724198f3054c9ad175bbac50a225be73f","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/ba34ea9724198f3054c9ad175bbac50a225be73f/comments","author":null,"committer":null,"parents":[{"sha":"9e2378cee5d5ad1d1c200ed6d5de9f6d3557cc37","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/9e2378cee5d5ad1d1c200ed6d5de9f6d3557cc37","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/9e2378cee5d5ad1d1c200ed6d5de9f6d3557cc37"}],"stats":{"total":742,"additions":550,"deletions":192},"files":[{"sha":"9fee95f2656009f7e0fb699301815b4a3e4a26db","filename":"console/src/main/java/org/syncope/console/pages/RoleModalPage.java","status":"modified","additions":85,"deletions":16,"changes":101,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FRoleModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FRoleModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FRoleModalPage.java?ref=ba34ea9724198f3054c9ad175bbac50a225be73f","patch":"@@ -74,6 +74,8 @@ public class RoleModalPage extends SyncopeModalPage {\n     WebMarkupContainer container;\n     List<SchemaWrapper> schemaWrappers = new ArrayList<SchemaWrapper>();\n \n+    RoleTO oldRole;\n+    RoleMod roleMod;\n     /**\n      *\n      * @param basePage base\n@@ -90,6 +92,9 @@ public RoleModalPage(final BasePage basePage, final ModalWindow window,\n \n         setupSchemaWrappers(createFlag, roleTO);\n \n+        if(!createFlag)\n+            cloneOldRoleTO(roleTO);\n+\n         final ListView roleAttributesView = new ListView(\"roleSchemas\", schemaWrappers) {\n \n             @Override\n@@ -287,7 +292,8 @@ protected void onSubmit(AjaxRequestTarget target, Form form) {\n                         restClient.createRole(roleTO);\n                         window.close(target);\n                     } else {\n-                        res = restClient.updateRole(convertRoleTOtoRoleMod(roleTO));\n+                        setupRoleMod(roleTO);\n+                        res = restClient.updateRole(roleMod);\n                         if (!res) {\n                             error(getString(\"error\"));\n                         } else {\n@@ -323,6 +329,8 @@ public void setupSchemaWrappers(boolean create, RoleTO roleTO) {\n \n         SchemaTOs schemas = schemaRestClient.getAllRoleSchemas();\n \n+        boolean found = false;\n+\n         if (create) {\n             for (SchemaTO schema : schemas) {\n                 schemaWrapper = new SchemaWrapper(schema);\n@@ -335,8 +343,15 @@ public void setupSchemaWrappers(boolean create, RoleTO roleTO) {\n                         schemaWrapper = new SchemaWrapper(schema);\n                         schemaWrapper.setValues(attribute.getValues());\n                         schemaWrappers.add(schemaWrapper);\n+                        found = true;\n                     }\n                 }\n+                if (!found) {\n+                    schemaWrapper = new SchemaWrapper(schema);\n+                    schemaWrappers.add(schemaWrapper);\n+                } else {\n+                    found = false;\n+                }\n             }\n         }\n     }\n@@ -377,32 +392,86 @@ public Set<String> getResourcesSet(List<String> resourcesList) {\n         return resourcesSet;\n     }\n \n+    /**\n+     * Create a copy of old RoleTO\n+     * @param roleTO\n+     */\n+    public void cloneOldRoleTO(RoleTO roleTO){\n+        oldRole = new RoleTO();\n \n-    public RoleMod convertRoleTOtoRoleMod(RoleTO roleTO){\n-        RoleMod roleMod = new RoleMod();\n+        oldRole.setName(new String(roleTO.getName()));\n+        oldRole.setParent(new Long(roleTO.getParent()));\n \n-        AttributeMod attributeMod;\n-        Set<AttributeMod> attributesToUpdate = new HashSet<AttributeMod>();\n+        Set<AttributeTO> attributes = new HashSet<AttributeTO>();\n \n-        for (SchemaWrapper schemaWrapper : schemaWrappers) {\n+        oldRole.setAttributes(attributes);\n \n-            attributeMod = new AttributeMod();\n-            attributeMod.setSchema(schemaWrapper.getSchemaTO().getName());\n-            attributeMod.setValuesToBeAdded(new HashSet<String>());\n+        AttributeTO attributeTO;\n+        Set<String> values;\n+        for (AttributeTO attribute : roleTO.getAttributes()) {\n+            attributeTO = new AttributeTO();\n+            attributeTO.setSchema(new String(attribute.getSchema()));\n \n-            for (String value : schemaWrapper.getValues()) {\n-                attributeMod.getValuesToBeAdded().add(value);\n+            values = new HashSet<String>();\n+            for(String val : attribute.getValues()) {\n+                values.add(val);\n             }\n-\n-            attributesToUpdate.add(attributeMod);\n+            attributeTO.setValues(values);\n         }\n+    }\n+\n+    public void setupRoleMod(RoleTO roleTO){\n+        roleMod = new RoleMod();\n+\n+//        AttributeMod attributeMod;\n+//        Set<AttributeMod> attributesToUpdate = new HashSet<AttributeMod>();\n+\n+//        for (SchemaWrapper schemaWrapper : schemaWrappers) {\n+\n+//            attributeMod = new AttributeMod();\n+//            attributeMod.setSchema(schemaWrapper.getSchemaTO().getName());\n+//            attributeMod.setValuesToBeAdded(new HashSet<String>());\n+//\n+//            for (String value : schemaWrapper.getValues()) {\n+//                attributeMod.getValuesToBeAdded().add(value);\n+//            }\n+//\n+//            attributesToUpdate.add(attributeMod);\n+//        }\n \n         roleMod.setId(roleTO.getId());\n-        roleMod.setName(roleTO.getName());\n \n-        roleMod.setAttributesToBeUpdated(attributesToUpdate);\n+        if(!oldRole.getName().equals(roleTO.getName()))\n+            roleMod.setName(roleTO.getName());\n+\n+        for(AttributeTO attributeTO : roleTO.getAttributes())\n+            searchAndUpdateAttribute(attributeTO);\n+    }\n+\n+    public void searchAndUpdateAttribute(AttributeTO attributeTO){\n+        boolean found = false;\n+\n+        AttributeMod attributeMod = new AttributeMod();\n+        attributeMod.setSchema(attributeTO.getSchema());\n+\n+        for(AttributeTO oldAttribute : oldRole.getAttributes()){\n+            if (attributeTO.getSchema().equals(oldAttribute.getSchema())) {\n+\n+                if (!attributeTO.equals(oldAttribute)) {\n+                    attributeMod.setValuesToBeAdded(attributeTO.getValues());\n+\n+                    roleMod.addAttributeToBeRemoved(oldAttribute.getSchema());\n+                    roleMod.addAttributeToBeUpdated(attributeMod);\n+                }\n+\n+                found = true;\n+            }\n+        }\n \n-        return roleMod;\n+        if(!found){\n+            attributeMod.setValuesToBeAdded(attributeTO.getValues());\n+            roleMod.addAttributeToBeUpdated(attributeMod);\n+       }\n     }\n \n     /**"},{"sha":"d0aa0a77ac11f94d0c416b0c6470242c08132522","filename":"console/src/main/java/org/syncope/console/pages/UserModalPage.java","status":"modified","additions":402,"deletions":128,"changes":530,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage.java?ref=ba34ea9724198f3054c9ad175bbac50a225be73f","patch":"@@ -23,8 +23,10 @@\n import java.text.SimpleDateFormat;\n import java.util.ArrayList;\n import java.util.Date;\n+import java.util.HashMap;\n import java.util.HashSet;\n import java.util.List;\n+import java.util.Map;\n import java.util.Set;\n import java.util.logging.Level;\n import java.util.logging.Logger;\n@@ -51,10 +53,15 @@\n import org.apache.wicket.model.Model;\n import org.apache.wicket.model.PropertyModel;\n import org.apache.wicket.spring.injection.annot.SpringBean;\n+import org.syncope.client.mod.AttributeMod;\n+import org.syncope.client.mod.MembershipMod;\n+import org.syncope.client.mod.UserMod;\n import org.syncope.client.to.AttributeTO;\n import org.syncope.client.to.MembershipTO;\n import org.syncope.client.to.ResourceTO;\n import org.syncope.client.to.ResourceTOs;\n+import org.syncope.client.to.RoleTO;\n+import org.syncope.client.to.RoleTOs;\n import org.syncope.client.to.SchemaTO;\n import org.syncope.client.to.SchemaTOs;\n import org.syncope.client.to.UserTO;\n@@ -84,12 +91,19 @@ public class UserModalPage extends SyncopeModalPage {\n \n     WebMarkupContainer container;\n     WebMarkupContainer membershipsContainer;\n+\n     AjaxButton submit;\n \n     List<SchemaWrapper> schemaWrappers;\n     List<MembershipTO> membershipTOs;\n+\n     final ModalWindow createUserWin;\n \n+    UserTO oldUser;\n+    UserMod userMod;\n+\n+    Map rolesMap;\n+\n     /**\n      *\n      * @param basePage base\n@@ -100,6 +114,11 @@ public class UserModalPage extends SyncopeModalPage {\n     public UserModalPage(final BasePage basePage, final ModalWindow window,\n             final UserTO userTO, final boolean createFlag) {\n \n+        if (!createFlag) \n+            cloneOldUserTO(userTO);\n+\n+        setupRolesMap();\n+        \n         schemaWrappers = new ArrayList<SchemaWrapper>();\n \n         add(createUserWin = new ModalWindow(\"membershipWin\"));\n@@ -115,8 +134,8 @@ public UserModalPage(final BasePage basePage, final ModalWindow window,\n         userForm.setModel(new CompoundPropertyModel(userTO));\n \n         setupSchemaWrappers(createFlag, userTO);\n-        setupMemberships(createFlag,userTO);\n-        \n+        setupMemberships(createFlag, userTO);\n+\n         final ListView userAttributesView = new ListView(\"userSchemas\", schemaWrappers) {\n \n             @Override\n@@ -129,118 +148,119 @@ protected void populateItem(ListItem item) {\n \n                 item.add(new ListView(\"fields\", schemaWrapper.getValues()) {\n \n-                    Panel panel;\n+                Panel panel;\n \n-                    @Override\n-                    protected void populateItem(final ListItem item) {\n+                @Override\n+                protected void populateItem(final ListItem item) {\n \n-                        if (schemaTO.getType().getClassName().equals(\"java.lang.String\")) {\n-                            panel = new AjaxTextFieldPanel(\"panel\", schemaTO.getName(), new Model() {\n+                    if (schemaTO.getType().getClassName().equals(\"java.lang.String\")) {\n+                        panel = new AjaxTextFieldPanel(\"panel\", schemaTO.getName(), new Model() {\n \n-                                @Override\n-                                public Serializable getObject() {\n-                                    return (String) item.getModelObject();\n-                                }\n+                            @Override\n+                            public Serializable getObject() {\n+                                return (String) item.getModelObject();\n+                            }\n \n-                                @Override\n-                                public void setObject(Serializable object) {\n-                                    item.setModelObject((String) object);\n-                                }\n-                            }, schemaTO.isMandatory());\n-                        } else if (schemaTO.getType().getClassName().equals(\"java.lang.Boolean\")) {\n-                            panel = new AjaxCheckBoxPanel(\"panel\", schemaTO.getName(), new Model() {\n-\n-                                @Override\n-                                public Serializable getObject() {\n-                                    return (String) item.getModelObject();\n-                                    //return \"false\";\n-                                }\n+                            @Override\n+                            public void setObject(Serializable object) {\n+                                item.setModelObject((String) object);\n+                            }\n+                        }, schemaTO.isMandatory());\n+                    } else if (schemaTO.getType().getClassName().equals(\"java.lang.Boolean\")) {\n+                        panel = new AjaxCheckBoxPanel(\"panel\", schemaTO.getName(), new Model() {\n+\n+                            @Override\n+                            public Serializable getObject() {\n+                                return (String) item.getModelObject();\n+                                //return \"false\";\n+                            }\n \n-                                @Override\n-                                public void setObject(Serializable object) {\n-                                    Boolean val = (Boolean) object;\n-                                    item.setModelObject(val.toString());\n-                                }\n-                            }, schemaTO.isMandatory());\n-\n-                        } else if (schemaTO.getType().getClassName().equals(\"java.util.Date\")) {\n-                            panel = new DateFieldPanel(\"panel\", schemaTO.getName(),\n-                                    new Model() {\n-\n-                                        @Override\n-                                        public Serializable getObject() {\n-                                            DateFormat formatter = new SimpleDateFormat(schemaTO.getConversionPattern());\n-                                            Date date = new Date();\n-\n-                                            try {\n-                                                String dateValue = (String) item.getModelObject();\n-                                                formatter = new SimpleDateFormat(\"yyyy-MM-dd\");\n-\n-                                                if(!dateValue.equals(\"\"))\n-                                                    date = formatter.parse((String) item.getModelObject());\n-                                                \n-                                            } catch (ParseException ex) {\n-                                                Logger.getLogger(UserModalPage.class.getName()).log(Level.SEVERE, null, ex);\n+                            @Override\n+                            public void setObject(Serializable object) {\n+                                Boolean val = (Boolean) object;\n+                                item.setModelObject(val.toString());\n+                            }\n+                        }, schemaTO.isMandatory());\n+\n+                    } else if (schemaTO.getType().getClassName().equals(\"java.util.Date\")) {\n+                        panel = new DateFieldPanel(\"panel\", schemaTO.getName(),\n+                                new Model() {\n+\n+                                    @Override\n+                                    public Serializable getObject() {\n+                                        DateFormat formatter = new SimpleDateFormat(schemaTO.getConversionPattern());\n+                                        Date date = new Date();\n+\n+                                        try {\n+                                            String dateValue = (String) item.getModelObject();\n+                                            formatter = new SimpleDateFormat(\"yyyy-MM-dd\");\n+\n+                                            if (!dateValue.equals(\"\")) {\n+                                                date = formatter.parse((String) item.getModelObject());\n                                             }\n-                                            return date;\n-                                        }\n \n-                                        @Override\n-                                        public void setObject(Serializable object) {\n-                                            Date date = (Date) object;\n-                                            Format formatter = new SimpleDateFormat(schemaTO.getConversionPattern());\n-                                            String val = formatter.format(date);\n-                                            item.setModelObject(val);\n+                                        } catch (ParseException ex) {\n+                                            Logger.getLogger(UserModalPage.class.getName()).log(Level.SEVERE, null, ex);\n                                         }\n-                                    }, schemaTO.isMandatory());\n-                        }\n+                                        return date;\n+                                    }\n \n-                        item.add(panel);\n+                                    @Override\n+                                    public void setObject(Serializable object) {\n+                                        Date date = (Date) object;\n+                                        Format formatter = new SimpleDateFormat(schemaTO.getConversionPattern());\n+                                        String val = formatter.format(date);\n+                                        item.setModelObject(val);\n+                                    }\n+                                }, schemaTO.isMandatory());\n                     }\n-                });\n \n-                AjaxButton addButton = new AjaxButton(\"add\", new Model(getString(\"add\"))) {\n+                    item.add(panel);\n+                }\n+            });\n \n-                    @Override\n-                    protected void onSubmit(AjaxRequestTarget target, Form form) {\n-                        schemaWrapper.getValues().add(\"\");\n+            AjaxButton addButton = new AjaxButton(\"add\", new Model(getString(\"add\"))) {\n \n-                        target.addComponent(container);\n-                    }\n-                };\n+                @Override\n+                protected void onSubmit(AjaxRequestTarget target, Form form) {\n+                    schemaWrapper.getValues().add(\"\");\n \n-                AjaxButton dropButton = new AjaxButton(\"drop\", new Model(getString(\"drop\"))) {\n+                    target.addComponent(container);\n+                }\n+            };\n \n-                    @Override\n-                    protected void onSubmit(AjaxRequestTarget target, Form form) {\n-                        //Drop the last component added\n-                        schemaWrapper.getValues().remove(schemaWrapper.getValues().size() - 1);\n+            AjaxButton dropButton = new AjaxButton(\"drop\", new Model(getString(\"drop\"))) {\n \n-                        target.addComponent(container);\n-                    }\n-                };\n+                @Override\n+                protected void onSubmit(AjaxRequestTarget target, Form form) {\n+                    //Drop the last component added\n+                    schemaWrapper.getValues().remove(schemaWrapper.getValues().size() - 1);\n \n-                if (schemaTO.getType().getClassName().equals(\"java.lang.Boolean\")) {\n-                    addButton.setVisible(false);\n-                    dropButton.setVisible(false);\n+                    target.addComponent(container);\n                 }\n+            };\n \n-                addButton.setDefaultFormProcessing(false);\n-                addButton.setVisible(schemaTO.isMultivalue());\n+            if (schemaTO.getType().getClassName().equals(\"java.lang.Boolean\")) {\n+                addButton.setVisible(false);\n+                dropButton.setVisible(false);\n+            }\n \n-                dropButton.setDefaultFormProcessing(false);\n-                dropButton.setVisible(schemaTO.isMultivalue());\n+            addButton.setDefaultFormProcessing(false);\n+            addButton.setVisible(schemaTO.isMultivalue());\n \n-                if (schemaWrapper.getValues().size() == 1) {\n-                    dropButton.setVisible(false);\n-                }\n+            dropButton.setDefaultFormProcessing(false);\n+            dropButton.setVisible(schemaTO.isMultivalue());\n \n-                item.add(addButton);\n-                item.add(dropButton);\n+            if (schemaWrapper.getValues().size() == 1) {\n+                dropButton.setVisible(false);\n             }\n-        };\n \n-        userForm.add(userAttributesView);\n+            item.add(addButton);\n+            item.add(dropButton);\n+        }\n+    };\n+\n+    userForm.add(userAttributesView);\n \n         final ListMultipleChoiceTransfer resourcesTransfer =\n                 new ListMultipleChoiceTransfer(\"resourcesChoiceTransfer\",\n@@ -315,10 +335,11 @@ protected void onSubmit(AjaxRequestTarget target, Form form) {\n                     userTO.setAttributes(getUserAttributesSet());\n                     userTO.setMemberships(getMembershipsSet());\n \n-                        if (createFlag) {\n-                            usersRestClient.createUser(userTO);\n-                        } else {\n-                            res = usersRestClient.updateUser(userTO);\n+                    if (createFlag) {\n+                        usersRestClient.createUser(userTO);\n+                    } else {\n+                        setupUserMod(userTO);\n+                        res = usersRestClient.updateUser(userMod);\n \n                         if (!res) {\n                             error(getString(\"error_updating\"));\n@@ -362,14 +383,14 @@ protected void onNodeLinkClicked(final Object node, final BaseTree tree,\n                 DefaultMutableTreeNode syncopeTreeNode = (DefaultMutableTreeNode) node;\n                 final TreeModelBean treeModel = (TreeModelBean) syncopeTreeNode.getUserObject();\n \n-                if (treeModel.getTreeNode() != null){\n+                if (treeModel.getTreeNode() != null) {\n \n-                createUserWin.setPageCreator(new ModalWindow.PageCreator() {\n+                    createUserWin.setPageCreator(new ModalWindow.PageCreator() {\n \n-                 MembershipTO membershipTO;\n-                 \n-                    @Override\n-                    public Page createPage() {\n+                        MembershipTO membershipTO;\n+\n+                        @Override\n+                        public Page createPage() {\n \n                             membershipTO = new MembershipTO();\n                             membershipTO.setRole(treeModel.getTreeNode().getId());\n@@ -380,9 +401,9 @@ public Page createPage() {\n                                     membershipTO, true);\n \n                             return form;\n-                    }\n-                });\n-                createUserWin.show(target);\n+                        }\n+                    });\n+                    createUserWin.show(target);\n                 }\n             }\n         };\n@@ -401,6 +422,7 @@ protected void populateItem(final ListItem item) {\n                         (MembershipTO) item.getDefaultModelObject();\n \n                 item.add(new Label(\"roleId\", new Model(membershipTO.getRole())));\n+                item.add(new Label(\"roleName\", new Model((String)rolesMap.get(membershipTO.getRole()))));\n \n                 AjaxLink editLink = new AjaxLink(\"editLink\") {\n \n@@ -410,10 +432,10 @@ public void onClick(AjaxRequestTarget target) {\n \n                             public Page createPage() {\n \n-                            MembershipModalPage form = new MembershipModalPage(\n-                                getPage(), createUserWin,membershipTO, false);\n+                                MembershipModalPage form = new MembershipModalPage(\n+                                        getPage(), createUserWin, membershipTO, false);\n \n-                            return form;  \n+                                return form;\n \n                             }\n                         });\n@@ -424,14 +446,14 @@ public Page createPage() {\n \n                 AjaxLink deleteLink = new AjaxLink(\"deleteLink\") {\n \n-                        @Override\n-                        public void onClick(AjaxRequestTarget target) {\n-                            int componentId = new Integer(getParent().getId());\n-                            membershipTOs.remove(componentId);\n-                            \n-                            target.addComponent(membershipsContainer);\n-                        }\n-                    };\n+                    @Override\n+                    public void onClick(AjaxRequestTarget target) {\n+                        int componentId = new Integer(getParent().getId());\n+                        membershipTOs.remove(componentId);\n+\n+                        target.addComponent(membershipsContainer);\n+                    }\n+                };\n                 item.add(deleteLink);\n             }\n         };\n@@ -446,6 +468,43 @@ public void onClick(AjaxRequestTarget target) {\n         add(userForm);\n     }\n \n+    /**\n+     * Create a copy of old userTO object.\n+     * @param userTO\n+     */\n+    public void cloneOldUserTO(UserTO userTO) {\n+\n+        oldUser = new UserTO();\n+        oldUser.setId(userTO.getId());\n+        oldUser.setPassword(userTO.getPassword());\n+        oldUser.setAttributes(userTO.getAttributes());\n+\n+        oldUser.setMemberships(new HashSet<MembershipTO>());\n+        MembershipTO membership;\n+\n+        for (MembershipTO membershipTO : userTO.getMemberships()) {\n+            membership = new MembershipTO();\n+            membership.setRole(membershipTO.getRole());\n+            membership.setAttributes(membershipTO.getAttributes());\n+            oldUser.getMemberships().add(membership);\n+        }\n+\n+    }\n+\n+    /**\n+     * Populate a roles hashmap of type (roleId,roleName)\n+     */\n+    public void setupRolesMap() {\n+\n+        rolesMap = new HashMap();\n+\n+        RoleTOs roleTOs = rolesRestClient.getAllRoles();\n+\n+        for (RoleTO roleTO : roleTOs) {\n+            rolesMap.put(roleTO.getId(), roleTO.getName());\n+        }\n+    }\n+\n     /**\n      * Set a WindowClosedCallback for a ModalWindow instance.\n      * @param window\n@@ -468,18 +527,17 @@ public void onClose(AjaxRequestTarget target) {\n      * @param create\n      * @param userTO\n      */\n-\n-    public void setupSchemaWrappers(boolean create,UserTO userTO) {\n+    public void setupSchemaWrappers(boolean create, UserTO userTO) {\n \n         schemaWrappers = new ArrayList<SchemaWrapper>();\n         SchemaWrapper schemaWrapper;\n \n-        SchemaRestClient schemaRestClient = (SchemaRestClient)\n-                ((SyncopeApplication) Application.get())\n-                .getApplicationContext().getBean(\"schemaRestClient\");\n+        SchemaRestClient schemaRestClient = (SchemaRestClient) ((SyncopeApplication) Application.get()).getApplicationContext().getBean(\"schemaRestClient\");\n \n         SchemaTOs schemas = schemaRestClient.getAllUserSchemas();\n \n+        boolean found = false;\n+\n         if (create) {\n             for (SchemaTO schema : schemas) {\n                 schemaWrapper = new SchemaWrapper(schema);\n@@ -492,8 +550,15 @@ public void setupSchemaWrappers(boolean create,UserTO userTO) {\n                         schemaWrapper = new SchemaWrapper(schema);\n                         schemaWrapper.setValues(attribute.getValues());\n                         schemaWrappers.add(schemaWrapper);\n+                        found = true;\n                     }\n                 }\n+                if (!found) {\n+                    schemaWrapper = new SchemaWrapper(schema);\n+                    schemaWrappers.add(schemaWrapper);\n+                }\n+                else\n+                    found = false;\n             }\n         }\n     }\n@@ -503,16 +568,17 @@ public void setupSchemaWrappers(boolean create,UserTO userTO) {\n      * @param creation flag: true if a new User is being created, false otherwise\n      * @param userTO object\n      */\n-    public void setupMemberships(boolean create,UserTO userTO){\n-    \n+    public void setupMemberships(boolean create, UserTO userTO) {\n+\n         membershipTOs = new ArrayList<MembershipTO>();\n-        \n-        if(!create) {\n+\n+        if (!create) {\n             Set<MembershipTO> memberships = userTO.getMemberships();\n \n-            for(MembershipTO membership : memberships)\n-            membershipTOs.add(membership);\n-          }\n+            for (MembershipTO membership : memberships) {\n+                membershipTOs.add(membership);\n+            }\n+        }\n     }\n \n     /**\n@@ -546,12 +612,13 @@ public Set<AttributeTO> getUserAttributesSet() {\n      * Convert a memberships ArrayList in a memberships HashSet list.\n      * @return Set<MembershipTO> selected for a new user.\n      */\n-    public Set<MembershipTO> getMembershipsSet(){\n+    public Set<MembershipTO> getMembershipsSet() {\n \n         HashSet<MembershipTO> memberships = new HashSet<MembershipTO>();\n \n-        for (MembershipTO membership : membershipTOs) \n+        for (MembershipTO membership : membershipTOs) {\n             memberships.add(membership);\n+        }\n \n         return memberships;\n     }\n@@ -578,6 +645,213 @@ public void setMembershipTOs(List<MembershipTO> membershipTOs) {\n         this.membershipTOs = membershipTOs;\n     }\n \n+    /**\n+     * Updates the modified user object.\n+     * @param updated userTO\n+     * @return UserMod object\n+     */\n+    public void setupUserMod(UserTO userTO) {\n+\n+        userMod = new UserMod();\n+        userMod.setId(oldUser.getId());\n+\n+        //1.Check if the password has been changed and update it\n+        if (!oldUser.getPassword().equals(userTO.getPassword())) {\n+            userMod.setPassword(userTO.getPassword());\n+        }\n+\n+        //2.Update user's schema attributes\n+        for (AttributeTO attributeTO : userTO.getAttributes()) {\n+            searchAndUpdateAttribute(attributeTO);\n+        }\n+\n+        //3.Update user's resources\n+        for (String resource : userTO.getResources()) {\n+            searchAndAddResource(resource);\n+        }\n+\n+\n+        for (String resource : oldUser.getResources()) {\n+            searchAndDropResource(resource, userTO);\n+        }\n+\n+        //4.Update user's memberships\n+        for (MembershipTO membership : userTO.getMemberships()) {\n+            searchAndUpdateMembership(membership);\n+        }\n+\n+        //5.Drop user's memberships marked\n+        for (MembershipTO membership : oldUser.getMemberships()) {\n+            searchAndDropMembership(membership, userTO);\n+        }\n+\n+    }\n+\n+    /**\n+     * Search for the current attribute in the old user object and, if exists,\n+     * replace it. Otherwise will be created from scratch.\n+     * Old - To remove\n+     * @param attributeTO\n+     * @param userMod\n+     * @return\n+     */\n+//    public void searchAndUpdateAttribute(AttributeTO attributeTO){\n+//        boolean found = false;\n+//\n+//        AttributeMod attributeMod = new AttributeMod();\n+//        attributeMod.setSchema(attributeTO.getSchema());\n+//\n+//        for(AttributeTO oldAttribute : oldUser.getAttributes()){\n+//            if(attributeTO.getSchema().equals(oldAttribute.getSchema())){\n+//            attributeMod.setValuesToBeAdded(attributeTO.getValues());\n+//\n+//            userMod.addAttributeToBeRemoved(oldAttribute.getSchema());\n+//            userMod.addAttributeToBeUpdated(attributeMod);\n+//            found = true;\n+//            }\n+//        }\n+//\n+//        if(!found){\n+//        attributeMod.setValuesToBeAdded(attributeTO.getValues());\n+//        userMod.addAttributeToBeUpdated(attributeMod);\n+//       }\n+//    }\n+    public void searchAndUpdateAttribute(AttributeTO attributeTO) {\n+        boolean found = false;\n+\n+        AttributeMod attributeMod = new AttributeMod();\n+        attributeMod.setSchema(attributeTO.getSchema());\n+\n+        for (AttributeTO oldAttribute : oldUser.getAttributes()) {\n+            if (attributeTO.getSchema().equals(oldAttribute.getSchema())) {\n+\n+                if (!attributeTO.equals(oldAttribute)) {\n+                    attributeMod.setValuesToBeAdded(attributeTO.getValues());\n+\n+                    userMod.addAttributeToBeRemoved(oldAttribute.getSchema());\n+                    userMod.addAttributeToBeUpdated(attributeMod);\n+                }\n+\n+                found = true;\n+            }\n+        }\n+\n+        if (!found) {\n+            attributeMod.setValuesToBeAdded(attributeTO.getValues());\n+            userMod.addAttributeToBeUpdated(attributeMod);\n+        }\n+    }\n+\n+    /**\n+     * Search for a resource and add that one to the UserMod object if\n+     * it doesn't exist.\n+     * @param resource, new resource added\n+     */\n+    public void searchAndAddResource(String resource) {\n+        boolean found = false;\n+\n+        //Check if the current resource was existent before the update\n+        for (String oldResource : oldUser.getResources()) {\n+            if (resource.equals(oldResource)) {\n+                found = true;\n+            }\n+        }\n+\n+        if (!found) {\n+            userMod.addResourceToBeAdded(resource);\n+        }\n+    }\n+\n+    /**\n+     * Search for a resource and drop that one from the UserMod object if\n+     * it doesn't exist anymore.\n+     * @param resource\n+     * @param userTO\n+     */\n+    public void searchAndDropResource(String resource, UserTO userTO) {\n+        boolean found = false;\n+\n+        //Check if the current resource was existent before the update\n+        for (String newResource : userTO.getResources()) {\n+            if (resource.equals(newResource)) {\n+                found = true;\n+            }\n+        }\n+\n+        if (!found) {\n+            userMod.addResourceToBeRemoved(resource);\n+        }\n+    }\n+\n+    /**\n+     * Update the Membership.\n+     * @param new membershipTO\n+     */\n+    public void searchAndUpdateMembership(MembershipTO membershipTO) {\n+        boolean found = false;\n+        MembershipMod membershipMod = new MembershipMod();\n+        membershipMod.setRole(membershipTO.getRole());\n+\n+        AttributeMod attributeMod;\n+\n+        //1. If the membership exists and it's changed, update it\n+        for (MembershipTO oldMembership : oldUser.getMemberships()) {\n+            if (membershipTO.getRole() == oldMembership.getRole()) {\n+\n+                for (AttributeTO oldAttribute : oldMembership.getAttributes()) {\n+                    for (AttributeTO newAttribute : membershipTO.getAttributes()) {\n+                        if (!oldAttribute.equals(newAttribute)) {\n+                            attributeMod = new AttributeMod();\n+                            attributeMod.setSchema(newAttribute.getSchema());\n+                            attributeMod.setValuesToBeAdded(newAttribute.getValues());\n+\n+                            membershipMod.addAttributeToBeUpdated(attributeMod);\n+                            userMod.addMembershipToBeRemoved(oldMembership.getId());\n+                            //userMod.addMembershipToBeAdded(membershipMod);\n+                        }\n+                    }\n+                }\n+                found = true;\n+            }\n+        }\n+\n+        //2.Otherwise, if it doesn't exist, create it from scratch\n+        if (!found) {\n+            Set<AttributeMod> attributes = new HashSet<AttributeMod>();\n+            AttributeMod attrMod;\n+            for (AttributeTO attr : membershipTO.getAttributes()) {\n+                attrMod = new AttributeMod();\n+                attrMod.setSchema(attr.getSchema());\n+                attrMod.setValuesToBeAdded(attr.getValues());\n+\n+                attributes.add(attrMod);\n+            }\n+\n+            membershipMod.setAttributesToBeUpdated(attributes);\n+            userMod.addMembershipToBeAdded(membershipMod);\n+        }\n+    }\n+\n+    /**\n+     * Drop membership not present anymore.\n+     * @param membershipTO\n+     * @param userTO\n+     */\n+    public void searchAndDropMembership(MembershipTO membershipTO, UserTO userTO) {\n+        boolean found = false;\n+\n+        //Check if the current resource was existent before the update\n+        for (MembershipTO newMembership : userTO.getMemberships()) {\n+            if (newMembership.getId() == membershipTO.getId()) {\n+                found = true;\n+            }\n+        }\n+\n+        if (!found) {\n+            userMod.addMembershipToBeRemoved(membershipTO.getId());\n+        }\n+    }\n+\n     /**\n      * Wrapper for User's Schema - Attribute.\n      */"},{"sha":"0bc4fc76b1bbcab5fee7e41f37aa4a5888f75ae8","filename":"console/src/main/java/org/syncope/console/rest/RolesRestClient.java","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Frest%2FRolesRestClient.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Frest%2FRolesRestClient.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Frest%2FRolesRestClient.java?ref=ba34ea9724198f3054c9ad175bbac50a225be73f","patch":"@@ -93,9 +93,10 @@ public boolean updateRole(RoleMod roleMod) {\n         }\n         catch (SyncopeClientCompositeErrorException e) {\n             e.printStackTrace();\n+            return false;\n         }\n \n-        return (newRoleTO.getName().equals(roleMod.getName()))?true:false;\n+        return true;\n     }\n     \n     /**"},{"sha":"d8d99e0d916db0327c0997a90eadf14897b96dd8","filename":"console/src/main/java/org/syncope/console/rest/UsersRestClient.java","status":"modified","additions":5,"deletions":4,"changes":9,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Frest%2FUsersRestClient.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Frest%2FUsersRestClient.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Frest%2FUsersRestClient.java?ref=ba34ea9724198f3054c9ad175bbac50a225be73f","patch":"@@ -16,6 +16,7 @@\n \n package org.syncope.console.rest;\n \n+import org.syncope.client.mod.UserMod;\n import org.syncope.client.to.ConfigurationTO;\n import org.syncope.client.to.UserTO;\n import org.syncope.client.to.UserTOs;\n@@ -71,25 +72,25 @@ public void createUser(UserTO userTO) {\n      * @param userTO\n      * @return true is the opertion ends succesfully, false otherwise\n      */\n-    public boolean updateUser(UserTO userTO) {\n+    public boolean updateUser(UserMod userModTO) {\n         UserTO newUserTO = null;\n         \n         try {\n         newUserTO = restClient.getRestTemplate().postForObject(restClient.getBaseURL()\n-                + \"user/update\", userTO, UserTO.class);\n+                + \"user/update\", userModTO, UserTO.class);\n         }\n         catch (SyncopeClientCompositeErrorException e) {\n             e.printStackTrace();\n         }\n \n-        return (userTO.equals(newUserTO))?true:false;\n+        return (userModTO.getId() == newUserTO.getId())?true:false;\n     }\n \n \n     public void deleteUser(String id) {\n         try {\n         restClient.getRestTemplate().delete(restClient.getBaseURL()\n-                + \"user/delete/{userId}\", id);\n+                + \"user/delete/{userId}\", new Integer(id));\n         }\n         catch (SyncopeClientCompositeErrorException e) {\n             e.printStackTrace();"},{"sha":"6bb5819aba51548032db47dc5a0726486fa4d9fb","filename":"console/src/main/java/org/syncope/console/wicket/markup/html/tree/NodeEditablePanel.java","status":"modified","additions":14,"deletions":3,"changes":17,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FNodeEditablePanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FNodeEditablePanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FNodeEditablePanel.java?ref=ba34ea9724198f3054c9ad175bbac50a225be73f","patch":"@@ -20,6 +20,7 @@\n import org.apache.wicket.ajax.AjaxRequestTarget;\n import org.apache.wicket.ajax.markup.html.AjaxLink;\n import org.apache.wicket.extensions.ajax.markup.html.modal.ModalWindow;\n+import org.apache.wicket.markup.html.panel.Fragment;\n import org.apache.wicket.markup.html.panel.Panel;\n import org.apache.wicket.model.IModel;\n import org.apache.wicket.spring.injection.annot.SpringBean;\n@@ -34,6 +35,8 @@\n public class NodeEditablePanel extends Panel {\n     @SpringBean(name = \"rolesRestClient\")\n     RolesRestClient restClient;\n+\n+    Fragment fragment;\n     /**\n      * Panel constructor.\n      *\n@@ -50,7 +53,12 @@ public NodeEditablePanel(String id, final Long idRole,IModel inputModel,\n                                final ModalWindow window) {\n         super(id);\n \n-        add(new AjaxLink(\"createRoleLink\") {\n+        if (idRole == -1)\n+            fragment = new Fragment(\"menuPanel\", \"frag2\",this);\n+        else {\n+            fragment = new Fragment(\"menuPanel\", \"frag1\",this);\n+\n+        fragment.add(new AjaxLink(\"createRoleLink\") {\n \n             @Override\n             public void onClick(AjaxRequestTarget target) {\n@@ -69,7 +77,7 @@ public Page createPage() {\n             }\n         });\n \n-        add(new AjaxLink(\"updateRoleLink\") {\n+        fragment.add(new AjaxLink(\"updateRoleLink\") {\n \n             @Override\n             public void onClick(AjaxRequestTarget target) {\n@@ -87,7 +95,7 @@ public Page createPage() {\n             }\n         });\n \n-        add(new AjaxLink(\"dropRoleLink\") {\n+        fragment.add(new AjaxLink(\"dropRoleLink\") {\n \n             @Override\n             public void onClick(AjaxRequestTarget target) {\n@@ -96,4 +104,7 @@ public void onClick(AjaxRequestTarget target) {\n             }\n         });\n     }\n+\n+    add(fragment);\n+    }\n }"},{"sha":"7da3c52e2b71cfa6b091a0bdd096e91469174673","filename":"console/src/main/java/org/syncope/console/wicket/markup/html/tree/PropertyEditableColumn.java","status":"modified","additions":9,"deletions":3,"changes":12,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FPropertyEditableColumn.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FPropertyEditableColumn.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FPropertyEditableColumn.java?ref=ba34ea9724198f3054c9ad175bbac50a225be73f","patch":"@@ -52,9 +52,15 @@ public Component newCell(MarkupContainer parent, String id,\n         DefaultMutableTreeNode syncopeTreeNode = (DefaultMutableTreeNode) node;\n         TreeModelBean treeModel = (TreeModelBean) syncopeTreeNode.getUserObject();\n \n-        NodeEditablePanel editablePanel;\n-        \n-        editablePanel = new NodeEditablePanel(id, treeModel.getTreeNode().getId(),\n+        NodeEditablePanel editablePanel = null;\n+        long nodeId;\n+\n+        if(treeModel.getTreeNode() != null)\n+            nodeId = treeModel.getTreeNode().getId();\n+        else\n+            nodeId = -1;\n+\n+        editablePanel = new NodeEditablePanel(id, nodeId ,\n                     new PropertyModel(node, getPropertyExpression()),window);\n \n "},{"sha":"25f81b38d4fb3fbf9bf2461db3a9547d0ed37a3c","filename":"console/src/main/resources/org/syncope/console/pages/ResourceModalPage.html","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FResourceModalPage.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FResourceModalPage.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FResourceModalPage.html?ref=ba34ea9724198f3054c9ad175bbac50a225be73f","patch":"@@ -25,7 +25,7 @@\n                 <select id=\"connector\" class=\"text ui-widget-content ui-corner-all\" wicket:id=\"connectors\" />\n \n                 <label for=\"mappingUserSchema\"><wicket:message key=\"mappingUserSchema\"/></label>\n-                <table id=\"mappingUserSchema\" class=\"ui-widget ui-widget-content\" width=\"80%\" cellpadding=\"2px\" cellspacing=\"1px\">\n+                <table id=\"mappingUserSchema\" class=\"ui-widget ui-widget-content ui-corner-all\" width=\"80%\" cellpadding=\"2px\" cellspacing=\"1px\">\n                     <thead>\n                         <tr class=\"ui-widget-header\">\n                             <th><wicket:message key=\"delete\"/></th>\n@@ -73,7 +73,7 @@\n                 </div>\n \n                  <label for=\"mappingRoleSchema\"><wicket:message key=\"mappingRoleSchema\"/></label>\n-                <table id=\"mappingRoleSchema\" class=\"ui-widget ui-widget-content\" width=\"80%\" cellpadding=\"2px\" cellspacing=\"1px\">\n+                <table id=\"mappingRoleSchema\" class=\"ui-widget ui-widget-content ui-corner-all\" width=\"80%\" cellpadding=\"2px\" cellspacing=\"1px\">\n                     <thead>\n                         <tr class=\"ui-widget-header\">\n                             <th><wicket:message key=\"delete\"/></th>"},{"sha":"d8af56777313ecfdd615af922e2178d952df9c6b","filename":"console/src/main/resources/org/syncope/console/pages/RoleModalPage.html","status":"modified","additions":0,"deletions":9,"changes":9,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FRoleModalPage.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FRoleModalPage.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FRoleModalPage.html?ref=ba34ea9724198f3054c9ad175bbac50a225be73f","patch":"@@ -22,7 +22,6 @@\n             <div id=\"tabs\">\n                 <ul>\n                     <li><a href=\"#tabs-1\"><span><wicket:message key=\"tab1\"/></span></a></li>\n-                    <li><a href=\"#tabs-2\"><span><wicket:message key=\"tab2\"/></span></a></li>\n                     <li><a href=\"#tabs-3\"><span><wicket:message key=\"tab3\"/></span></a></li>\n                 </ul>\n                     <div id=\"tabs-1\">\n@@ -48,14 +47,6 @@\n                             </tr>\n                          </table>\n                     </div>\n-                    <div id=\"tabs-2\">\n-                        <!--table>\n-                            <tr wicket:id=\"userDerivedAttributes\">\n-                                <td><span wicket:id=\"key\"/></td>\n-                                <td><input type=\"text\" class=\"text ui-widget-content ui-corner-all\" wicket:id=\"value\" /></td>\n-                            </tr>\n-                         </table-->\n-                    </div>\n                     <div id=\"tabs-3\">\n                         <span wicket:id=\"resourcesChoiceTransfer\"/>\n                     </div>"},{"sha":"a1e501e14bcf1f4067b41e0260c2c7857c623af2","filename":"console/src/main/resources/org/syncope/console/pages/RoleModalPage.properties","status":"modified","additions":1,"deletions":2,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FRoleModalPage.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FRoleModalPage.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FRoleModalPage.properties?ref=ba34ea9724198f3054c9ad175bbac50a225be73f","patch":"@@ -1,7 +1,6 @@\n required_alert=All form fields are required.\n title=Role\n-tab1=Role attributes\n-tab2=Role derived attributes\n+tab1=Attributes\n tab3=Resources\n add=+\n drop=-"},{"sha":"4f5d6718b1402be4680d5076410eed7a69799cd3","filename":"console/src/main/resources/org/syncope/console/pages/RoleModalPage_it.properties","status":"modified","additions":2,"deletions":3,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FRoleModalPage_it.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FRoleModalPage_it.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FRoleModalPage_it.properties?ref=ba34ea9724198f3054c9ad175bbac50a225be73f","patch":"@@ -1,8 +1,7 @@\n required_alert=All form fields are required.\n title=Ruolo\n-tab1=User attributes\n-tab2=User derived attributes\n-tab3=Resources\n+tab1=Attributi\n+tab3=Risorse\n add=+\n drop=-\n name=Nome"},{"sha":"1faa217853e41b35ec0078a6a332382bc6f67bff","filename":"console/src/main/resources/org/syncope/console/pages/UserModalPage.html","status":"modified","additions":5,"deletions":9,"changes":14,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage.html?ref=ba34ea9724198f3054c9ad175bbac50a225be73f","patch":"@@ -36,7 +36,6 @@\n         <div id=\"tabs\">\n             <ul>\n                 <li  class=\"tabs-selected\"><a href=\"#tabs-1\"><span><wicket:message key=\"tab1\"/></span></a></li>\n-                <li><a href=\"#tabs-2\"><span><wicket:message key=\"tab2\"/></span></a></li>\n                 <li><a href=\"#tabs-3\"><span><wicket:message key=\"tab3\"/></span></a></li>\n                 <li><a href=\"#tabs-4\"><span><wicket:message key=\"tab4\"/></span></a></li>\n             </ul>\n@@ -66,14 +65,7 @@\n                     </tr>\n                 </table>\n             </div>\n-            <div id=\"tabs-2\">\n-                <!--table>\n-                    <tr wicket:id=\"userDerivedAttributes\">\n-                        <td><span wicket:id=\"key\"/></td>\n-                        <td><input type=\"text\" class=\"text ui-widget-content ui-corner-all\" wicket:id=\"value\" /></td>\n-                    </tr>\n-                 </table-->\n-            </div>\n+\n             <div id=\"tabs-3\">\n \n                 <span wicket:id=\"resourcesChoiceTransfer\"/>\n@@ -98,6 +90,7 @@\n                    <thead>\n                         <tr class=\"ui-widget-header\">\n                             <th><wicket:message key=\"id\"/></th>\n+                            <th><wicket:message key=\"name\"/></th>\n                             <th><wicket:message key=\"edit\"/></th>\n                             <th><wicket:message key=\"delete\"/></th>\n                         </tr>\n@@ -106,6 +99,9 @@\n                         <tr wicket:id=\"memberships\">\n                             <td>\n                                 <span wicket:id=\"roleId\"/>\n+                            </td>\n+                            <td>\n+                                <span wicket:id=\"roleName\"/>\n                             </td>\n                              <td>\n                                 <a href=\"#\" wicket:id=\"editLink\">"},{"sha":"b6e2f9f0b0bca03762e2d36eb447ff78ee6da73d","filename":"console/src/main/resources/org/syncope/console/pages/UserModalPage.properties","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage.properties?ref=ba34ea9724198f3054c9ad175bbac50a225be73f","patch":"@@ -4,7 +4,7 @@ username=Username\n password=password\n firstname=Firstname\n surname=Surname\n-tab1=User attributes\n+tab1=Attributes\n tab2=User derived attributes\n tab3=Resources\n tab4=Roles\n@@ -17,6 +17,7 @@ updating_error=Generic error occurred during updating\n column1=Roles\n column2=Action\n id=Role Id\n+name=Role Name\n edit=Edit\n delete=Delete\n membership_text=Selected roles"},{"sha":"8d4f400fc2bd321bce23f85f4035cfca4cce0543","filename":"console/src/main/resources/org/syncope/console/pages/UserModalPage_it.properties","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage_it.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage_it.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUserModalPage_it.properties?ref=ba34ea9724198f3054c9ad175bbac50a225be73f","patch":"@@ -5,7 +5,7 @@ username=Username\n password=password\n firstname=Nome\n surname=Cognome\n-tab1=Attributi utente\n+tab1=Attributi\n tab2=Attributi utente derivati\n tab3=Risorse\n tab4=Ruoli\n@@ -22,3 +22,4 @@ edit=Modifica\n delete=Elimina\n membership_text=Ruoli selezionati\n membership_availability=Ruoli disponibili\n+name=Nome Ruolo"},{"sha":"99b2b466b6e1aad9efe4b8b599e6eed4104c9272","filename":"console/src/main/resources/org/syncope/console/wicket/markup/html/form/DateFieldPanel.html","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FDateFieldPanel.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FDateFieldPanel.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FDateFieldPanel.html?ref=ba34ea9724198f3054c9ad175bbac50a225be73f","patch":"@@ -15,7 +15,7 @@\n <!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\n     \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n <wicket:panel>\n-<input type=\"text\" size=\"10\" wicket:id=\"dateField\"/>\n+<input type=\"text\" class=\"text ui-widget-content ui-corner-all\" size=\"10\" wicket:id=\"dateField\"/>\n <span wicket:id=\"required\"/>\n <br/>\n </wicket:panel>\n\\ No newline at end of file"},{"sha":"9bb2e78ad3af4ca63df8c9eeab6f1434c9bfdb7b","filename":"console/src/main/resources/org/syncope/console/wicket/markup/html/tree/NodeEditablePanel.html","status":"modified","additions":18,"deletions":9,"changes":27,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FNodeEditablePanel.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/ba34ea9724198f3054c9ad175bbac50a225be73f/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FNodeEditablePanel.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FNodeEditablePanel.html?ref=ba34ea9724198f3054c9ad175bbac50a225be73f","patch":"@@ -13,13 +13,22 @@\n  under the License.\n -->\n <wicket:panel>\n-    <a  wicket:id=\"createRoleLink\">\n-        <wicket:message key=\"create_role\"/>&nbsp;\n-    </a>\n-    <a  wicket:id=\"updateRoleLink\">\n-        <wicket:message key=\"update_role\"/>&nbsp;\n-    </a>\n-    <a  wicket:id=\"dropRoleLink\">\n-        <wicket:message key=\"drop_role\"/>&nbsp;\n-    </a>\n+    <span wicket:id=\"menuPanel\"/>\n+    \n+    <wicket:fragment wicket:id=\"frag1\">\n+        <a  wicket:id=\"createRoleLink\">\n+            <wicket:message key=\"create_role\"/>&nbsp;\n+        </a>\n+        <a  wicket:id=\"updateRoleLink\">\n+            <wicket:message key=\"update_role\"/>&nbsp;\n+        </a>\n+        <a  wicket:id=\"dropRoleLink\">\n+            <wicket:message key=\"drop_role\"/>&nbsp;\n+        </a>\n+    </wicket:fragment>\n+\n+    <wicket:fragment wicket:id=\"frag2\">\n+\n+    </wicket:fragment>\n+    \n </wicket:panel>\n\\ No newline at end of file"}]}