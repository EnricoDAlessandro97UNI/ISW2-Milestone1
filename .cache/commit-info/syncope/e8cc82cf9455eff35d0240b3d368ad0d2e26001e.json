{"sha":"e8cc82cf9455eff35d0240b3d368ad0d2e26001e","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmU4Y2M4MmNmOTQ1NWVmZjM1ZDAyNDBiM2QzNjhhZDBkMmUyNjAwMWU=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2013-07-11T11:49:30Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2013-07-11T11:49:30Z"},"message":"[SYNCOPE-395] Applying provided patch, thanks\n\ngit-svn-id: https://svn.apache.org/repos/asf/syncope/branches/1_1_X@1502194 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"d2cc4bd14788edbe04449ec0afc23a92980e9286","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/d2cc4bd14788edbe04449ec0afc23a92980e9286"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/e8cc82cf9455eff35d0240b3d368ad0d2e26001e","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/e8cc82cf9455eff35d0240b3d368ad0d2e26001e","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/e8cc82cf9455eff35d0240b3d368ad0d2e26001e","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/e8cc82cf9455eff35d0240b3d368ad0d2e26001e/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"ac1ef5831d010bd782eca6a3936169d3776f4b5f","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/ac1ef5831d010bd782eca6a3936169d3776f4b5f","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/ac1ef5831d010bd782eca6a3936169d3776f4b5f"}],"stats":{"total":1024,"additions":942,"deletions":82},"files":[{"sha":"e28fd770132f919e60cc65b91d3800ae36167ac2","filename":"common/src/main/java/org/apache/syncope/common/report/RoleReportletConf.java","status":"added","additions":126,"deletions":0,"changes":126,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e8cc82cf9455eff35d0240b3d368ad0d2e26001e/common%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Freport%2FRoleReportletConf.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e8cc82cf9455eff35d0240b3d368ad0d2e26001e/common%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Freport%2FRoleReportletConf.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/common%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Freport%2FRoleReportletConf.java?ref=e8cc82cf9455eff35d0240b3d368ad0d2e26001e","patch":"@@ -0,0 +1,126 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.common.report;\n+\n+import java.util.ArrayList;\n+import java.util.List;\n+import javax.xml.bind.annotation.XmlElement;\n+import javax.xml.bind.annotation.XmlElementWrapper;\n+import javax.xml.bind.annotation.XmlEnum;\n+import javax.xml.bind.annotation.XmlRootElement;\n+import javax.xml.bind.annotation.XmlType;\n+\n+import org.apache.syncope.common.annotation.FormAttributeField;\n+import org.apache.syncope.common.search.NodeCond;\n+import org.apache.syncope.common.types.IntMappingType;\n+\n+@XmlRootElement(name = \"RoleReportletConfiguration\")\n+@XmlType\n+public class RoleReportletConf extends AbstractReportletConf {\n+\n+    private static final long serialVersionUID = -8488503068032439699L;\n+\n+    @XmlEnum\n+    @XmlType(name = \"RoleReportletConfigurationFeature\")\n+    public enum Feature {\n+\n+        id,\n+        name,\n+        roleOwner,\n+        userOwner,\n+        entitelments,\n+        users,\n+        resources\n+\n+    }\n+\n+    private NodeCond matchingCond;\n+\n+    @FormAttributeField(schema = IntMappingType.RoleSchema)\n+    private List<String> attrs;\n+\n+    @FormAttributeField(schema = IntMappingType.RoleDerivedSchema)\n+    private List<String> derAttrs;\n+\n+    @FormAttributeField(schema = IntMappingType.RoleVirtualSchema)\n+    private List<String> virAttrs;\n+\n+    private List<Feature> features;\n+\n+    public RoleReportletConf() {\n+        super();\n+    }\n+\n+    public RoleReportletConf(final String name) {\n+        super(name);\n+\n+        attrs = new ArrayList<String>();\n+        derAttrs = new ArrayList<String>();\n+        virAttrs = new ArrayList<String>();\n+        features = new ArrayList<Feature>();\n+    }\n+\n+    @XmlElementWrapper(name = \"normalAttributes\")\n+    @XmlElement(name = \"attribute\")\n+    public List<String> getAttrs() {\n+        return attrs;\n+    }\n+\n+    public void setAttrs(final List<String> attrs) {\n+        this.attrs = attrs;\n+    }\n+\n+    @XmlElementWrapper(name = \"derivedAttributes\")\n+    @XmlElement(name = \"attribute\")\n+    public List<String> getDerAttrs() {\n+        return derAttrs;\n+    }\n+\n+    public void setDerAttrs(final List<String> derAttrs) {\n+        this.derAttrs = derAttrs;\n+    }\n+\n+    @XmlElementWrapper(name = \"features\")\n+    @XmlElement(name = \"feature\")\n+    public List<Feature> getFeatures() {\n+        return features;\n+    }\n+\n+    public void setFeatures(final List<Feature> features) {\n+        this.features = features;\n+    }\n+\n+    public NodeCond getMatchingCond() {\n+        return matchingCond;\n+    }\n+\n+    public void setMatchingCond(final NodeCond matchingCond) {\n+        this.matchingCond = matchingCond;\n+    }\n+\n+    @XmlElementWrapper(name = \"virtualAttributes\")\n+    @XmlElement(name = \"attribute\")\n+    public List<String> getVirAttrs() {\n+        return virAttrs;\n+    }\n+\n+    public void setVirAttrs(final List<String> virAttrs) {\n+        this.virAttrs = virAttrs;\n+    }\n+}"},{"sha":"1d1a5fc7fa3fcab82354db838e602db679a573fa","filename":"common/src/main/java/org/apache/syncope/common/report/UserReportletConf.java","status":"modified","additions":5,"deletions":5,"changes":10,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e8cc82cf9455eff35d0240b3d368ad0d2e26001e/common%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Freport%2FUserReportletConf.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e8cc82cf9455eff35d0240b3d368ad0d2e26001e/common%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Freport%2FUserReportletConf.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/common%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcommon%2Freport%2FUserReportletConf.java?ref=e8cc82cf9455eff35d0240b3d368ad0d2e26001e","patch":"@@ -87,7 +87,7 @@ public List<String> getAttrs() {\n         return attrs;\r\n     }\r\n \r\n-    public void setAttrs(List<String> attrs) {\r\n+    public void setAttrs(final List<String> attrs) {\r\n         this.attrs = attrs;\r\n     }\r\n \r\n@@ -97,7 +97,7 @@ public List<String> getDerAttrs() {\n         return derAttrs;\r\n     }\r\n \r\n-    public void setDerAttrs(List<String> derAttrs) {\r\n+    public void setDerAttrs(final List<String> derAttrs) {\r\n         this.derAttrs = derAttrs;\r\n     }\r\n \r\n@@ -107,15 +107,15 @@ public List<Feature> getFeatures() {\n         return features;\r\n     }\r\n \r\n-    public void setFeatures(List<Feature> features) {\r\n+    public void setFeatures(final List<Feature> features) {\r\n         this.features = features;\r\n     }\r\n \r\n     public NodeCond getMatchingCond() {\r\n         return matchingCond;\r\n     }\r\n \r\n-    public void setMatchingCond(NodeCond matchingCond) {\r\n+    public void setMatchingCond(final NodeCond matchingCond) {\r\n         this.matchingCond = matchingCond;\r\n     }\r\n \r\n@@ -125,7 +125,7 @@ public List<String> getVirAttrs() {\n         return virAttrs;\r\n     }\r\n \r\n-    public void setVirAttrs(List<String> virAttrs) {\r\n+    public void setVirAttrs(final List<String> virAttrs) {\r\n         this.virAttrs = virAttrs;\r\n     }\r\n }\r"},{"sha":"36ead184bf21183fd7c3aba1d4ae7ab177da6669","filename":"core/src/main/java/org/apache/syncope/core/report/RoleReportlet.java","status":"added","additions":287,"deletions":0,"changes":287,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e8cc82cf9455eff35d0240b3d368ad0d2e26001e/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Freport%2FRoleReportlet.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e8cc82cf9455eff35d0240b3d368ad0d2e26001e/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Freport%2FRoleReportlet.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Freport%2FRoleReportlet.java?ref=e8cc82cf9455eff35d0240b3d368ad0d2e26001e","patch":"@@ -0,0 +1,287 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.core.report;\n+\n+import static org.apache.syncope.core.report.ReportXMLConst.ATTR_NAME;\n+import static org.apache.syncope.core.report.ReportXMLConst.XSD_LONG;\n+import static org.apache.syncope.core.report.ReportXMLConst.XSD_STRING;\n+\n+import java.util.Collection;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.Set;\n+import org.apache.syncope.common.report.RoleReportletConf;\n+import org.apache.syncope.common.report.RoleReportletConf.Feature;\n+import org.apache.syncope.common.to.AbstractAttributableTO;\n+import org.apache.syncope.common.to.AttributeTO;\n+import org.apache.syncope.common.to.RoleTO;\n+import org.apache.syncope.common.types.AttributableType;\n+import org.apache.syncope.core.persistence.beans.membership.Membership;\n+import org.apache.syncope.core.persistence.beans.role.SyncopeRole;\n+import org.apache.syncope.core.persistence.dao.AttributableSearchDAO;\n+import org.apache.syncope.core.persistence.dao.EntitlementDAO;\n+import org.apache.syncope.core.persistence.dao.RoleDAO;\n+import org.apache.syncope.core.rest.data.RoleDataBinder;\n+import org.apache.syncope.core.util.AttributableUtil;\n+import org.apache.syncope.core.util.EntitlementUtil;\n+import org.springframework.beans.factory.annotation.Autowired;\n+import org.xml.sax.ContentHandler;\n+import org.xml.sax.SAXException;\n+import org.xml.sax.helpers.AttributesImpl;\n+\n+@ReportletConfClass(RoleReportletConf.class)\n+public class RoleReportlet extends AbstractReportlet<RoleReportletConf> {\n+\n+    private static final int PAGE_SIZE = 10;\n+\n+    @Autowired\n+    private EntitlementDAO entitlementDAO;\n+\n+    @Autowired\n+    private RoleDAO roleDAO;\n+\n+    @Autowired\n+    private AttributableSearchDAO searchDAO;\n+\n+    @Autowired\n+    private RoleDataBinder roleDataBinder;\n+\n+    private List<SyncopeRole> getPagedRoles(final int page) {\n+        final Set<Long> adminRoleIds = EntitlementUtil.getRoleIds(entitlementDAO.findAll());\n+        final List<SyncopeRole> result;\n+        if (conf.getMatchingCond() == null) {\n+            result = roleDAO.findAll();\n+        } else {\n+            result = searchDAO.search(adminRoleIds, conf.getMatchingCond(), page, PAGE_SIZE,\n+                    AttributableUtil.getInstance(AttributableType.ROLE));\n+        }\n+\n+        return result;\n+    }\n+\n+    private int count() {\n+        Set<Long> adminRoleIds = EntitlementUtil.getRoleIds(entitlementDAO.findAll());\n+\n+        return conf.getMatchingCond() == null\n+                ? roleDAO.findAll().size()\n+                : searchDAO.count(adminRoleIds, conf.getMatchingCond(),\n+                AttributableUtil.getInstance(AttributableType.ROLE));\n+    }\n+\n+    private void doExtractResources(final ContentHandler handler, final AbstractAttributableTO attributableTO)\n+            throws SAXException {\n+\n+        if (attributableTO.getResources().isEmpty()) {\n+            LOG.debug(\"No resources found for {}[{}]\", attributableTO.getClass().getSimpleName(), attributableTO\n+                    .getId());\n+        } else {\n+            AttributesImpl atts = new AttributesImpl();\n+            handler.startElement(\"\", \"\", \"resources\", null);\n+\n+            for (String resourceName : attributableTO.getResources()) {\n+                atts.clear();\n+\n+                atts.addAttribute(\"\", \"\", ATTR_NAME, XSD_STRING, resourceName);\n+                handler.startElement(\"\", \"\", \"resource\", atts);\n+                handler.endElement(\"\", \"\", \"resource\");\n+            }\n+\n+            handler.endElement(\"\", \"\", \"resources\");\n+        }\n+    }\n+\n+    private void doExtractAttributes(final ContentHandler handler, final AbstractAttributableTO attributableTO,\n+            final Collection<String> attrs, final Collection<String> derAttrs, final Collection<String> virAttrs)\n+            throws SAXException {\n+\n+        AttributesImpl atts = new AttributesImpl();\n+        if (!attrs.isEmpty()) {\n+            Map<String, AttributeTO> attrMap = attributableTO.getAttributeMap();\n+\n+            handler.startElement(\"\", \"\", \"attributes\", null);\n+            for (String attrName : attrs) {\n+                atts.clear();\n+\n+                atts.addAttribute(\"\", \"\", ATTR_NAME, XSD_STRING, attrName);\n+                handler.startElement(\"\", \"\", \"attribute\", atts);\n+\n+                if (attrMap.containsKey(attrName)) {\n+                    for (String value : attrMap.get(attrName).getValues()) {\n+                        handler.startElement(\"\", \"\", \"value\", null);\n+                        handler.characters(value.toCharArray(), 0, value.length());\n+                        handler.endElement(\"\", \"\", \"value\");\n+                    }\n+                } else {\n+                    LOG.debug(\"{} not found for {}[{}]\", attrName,\n+                            attributableTO.getClass().getSimpleName(), attributableTO.getId());\n+                }\n+\n+                handler.endElement(\"\", \"\", \"attribute\");\n+            }\n+            handler.endElement(\"\", \"\", \"attributes\");\n+        }\n+\n+        if (!derAttrs.isEmpty()) {\n+            Map<String, AttributeTO> derAttrMap = attributableTO.getDerivedAttributeMap();\n+\n+            handler.startElement(\"\", \"\", \"derivedAttributes\", null);\n+            for (String attrName : derAttrs) {\n+                atts.clear();\n+\n+                atts.addAttribute(\"\", \"\", ATTR_NAME, XSD_STRING, attrName);\n+                handler.startElement(\"\", \"\", \"derivedAttribute\", atts);\n+\n+                if (derAttrMap.containsKey(attrName)) {\n+                    for (String value : derAttrMap.get(attrName).getValues()) {\n+                        handler.startElement(\"\", \"\", \"value\", null);\n+                        handler.characters(value.toCharArray(), 0, value.length());\n+                        handler.endElement(\"\", \"\", \"value\");\n+                    }\n+                } else {\n+                    LOG.debug(\"{} not found for {}[{}]\", attrName,\n+                            attributableTO.getClass().getSimpleName(), attributableTO.getId());\n+                }\n+\n+                handler.endElement(\"\", \"\", \"derivedAttribute\");\n+            }\n+            handler.endElement(\"\", \"\", \"derivedAttributes\");\n+        }\n+\n+        if (!virAttrs.isEmpty()) {\n+            Map<String, AttributeTO> virAttrMap = attributableTO.getVirtualAttributeMap();\n+\n+            handler.startElement(\"\", \"\", \"virtualAttributes\", null);\n+            for (String attrName : virAttrs) {\n+                atts.clear();\n+\n+                atts.addAttribute(\"\", \"\", ATTR_NAME, XSD_STRING, attrName);\n+                handler.startElement(\"\", \"\", \"virtualAttribute\", atts);\n+\n+                if (virAttrMap.containsKey(attrName)) {\n+                    for (String value : virAttrMap.get(attrName).getValues()) {\n+                        handler.startElement(\"\", \"\", \"value\", null);\n+                        handler.characters(value.toCharArray(), 0, value.length());\n+                        handler.endElement(\"\", \"\", \"value\");\n+                    }\n+                } else {\n+                    LOG.debug(\"{} not found for {}[{}]\", attrName,\n+                            attributableTO.getClass().getSimpleName(), attributableTO.getId());\n+                }\n+\n+                handler.endElement(\"\", \"\", \"virtualAttribute\");\n+            }\n+            handler.endElement(\"\", \"\", \"virtualAttributes\");\n+        }\n+    }\n+\n+    private void doExtract(final ContentHandler handler, final List<SyncopeRole> roles)\n+            throws SAXException, ReportException {\n+\n+        AttributesImpl atts = new AttributesImpl();\n+        for (SyncopeRole role : roles) {\n+            atts.clear();\n+\n+            for (Feature feature : conf.getFeatures()) {\n+                String type = null;\n+                String value = null;\n+                switch (feature) {\n+                    case id:\n+                        type = XSD_LONG;\n+                        value = String.valueOf(role.getId());\n+                        break;\n+\n+                    case name:\n+                        type = XSD_STRING;\n+                        value = String.valueOf(role.getName());\n+                        break;\n+\n+                    case roleOwner:\n+                        type = XSD_LONG;\n+                        value = String.valueOf(role.getRoleOwner());\n+                        break;\n+\n+                    case userOwner:\n+                        type = XSD_LONG;\n+                        value = String.valueOf(role.getUserOwner());\n+                        break;\n+\n+                    default:\n+                }\n+\n+                if (type != null && value != null) {\n+                    atts.addAttribute(\"\", \"\", feature.name(), type, value);\n+                }\n+            }\n+\n+            handler.startElement(\"\", \"\", \"role\", atts);\n+\n+            // Using RoleTO for attribute values, since the conversion logic of\n+            // values to String is already encapsulated there\n+\n+            RoleTO roleTO = roleDataBinder.getRoleTO(role);\n+\n+            doExtractAttributes(handler, roleTO, conf.getAttrs(), conf.getDerAttrs(), conf.getVirAttrs());\n+\n+            if (conf.getFeatures().contains(Feature.entitelments)) {\n+                handler.startElement(\"\", \"\", \"entitlements\", null);\n+\n+                for (String ent : roleTO.getEntitlements()) {\n+                    atts.clear();\n+\n+                    atts.addAttribute(\"\", \"\", \"id\", XSD_STRING, String.valueOf(ent));\n+\n+                    handler.startElement(\"\", \"\", \"entitlement\", atts);\n+                    handler.endElement(\"\", \"\", \"entitlement\");\n+                }\n+\n+                handler.endElement(\"\", \"\", \"entitlements\");\n+            }\n+            // to get resources associated to a role\n+            if (conf.getFeatures().contains(Feature.resources)) {\n+                doExtractResources(handler, roleTO);\n+            }\n+            //to get users asscoiated to a role is preferred RoleDAO to RoleTO\n+            if (conf.getFeatures().contains(Feature.users)) {\n+                handler.startElement(\"\", \"\", \"users\", null);\n+\n+                for (Membership memb : roleDAO.findMemberships(role)) {\n+                    atts.clear();\n+\n+                    atts.addAttribute(\"\", \"\", \"userId\", XSD_LONG, String.valueOf(memb.getSyncopeUser().getId()));\n+                    atts.addAttribute(\"\", \"\", \"userUsername\", XSD_STRING, String.valueOf(memb.getSyncopeUser().\n+                            getUsername()));\n+\n+                    handler.startElement(\"\", \"\", \"user\", atts);\n+                    handler.endElement(\"\", \"\", \"user\");\n+                }\n+\n+                handler.endElement(\"\", \"\", \"users\");\n+            }\n+\n+            handler.endElement(\"\", \"\", \"role\");\n+        }\n+    }\n+\n+    @Override\n+    protected void doExtract(final ContentHandler handler) throws SAXException, ReportException {\n+        for (int i = 1; i <= (count() / PAGE_SIZE) + 1; i++) {\n+            doExtract(handler, getPagedRoles(i));\n+        }\n+    }\n+}"},{"sha":"7da9cabcf45ddc6ef7ca56b048fe594c71c40f8d","filename":"core/src/main/resources/report/report2fo.xsl","status":"modified","additions":49,"deletions":44,"changes":93,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e8cc82cf9455eff35d0240b3d368ad0d2e26001e/core%2Fsrc%2Fmain%2Fresources%2Freport%2Freport2fo.xsl","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e8cc82cf9455eff35d0240b3d368ad0d2e26001e/core%2Fsrc%2Fmain%2Fresources%2Freport%2Freport2fo.xsl","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fresources%2Freport%2Freport2fo.xsl?ref=e8cc82cf9455eff35d0240b3d368ad0d2e26001e","patch":"@@ -16,14 +16,13 @@ software distributed under the License is distributed on an\n KIND, either express or implied.  See the License for the\n specific language governing permissions and limitations\n under the License.\n-\n -->\n-\n <xsl:stylesheet xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"\n                 xmlns:fo=\"http://www.w3.org/1999/XSL/Format\"\n                 version=\"1.0\">\n \n   <xsl:import href=\"userReportlet2fo.xsl\"/>\n+  <xsl:import href=\"roleReportlet2fo.xsl\"/>\n   <xsl:import href=\"staticReportlet2fo.xsl\"/>\n  \n   <xsl:param name=\"status\"/>\n@@ -36,55 +35,61 @@ under the License.\n       \n       <!-- defines the layout master -->\n       <fo:layout-master-set>\n-\t<fo:simple-page-master master-name=\"first\" page-height=\"29.7cm\" page-width=\"21cm\" \n-\t\t\t       margin-top=\"1cm\" margin-bottom=\"2cm\" margin-left=\"2.5cm\" margin-right=\"2.5cm\">\n-\t  <fo:region-body margin-top=\"1cm\"/>\n-\t  <fo:region-before extent=\"1cm\"/>\n-\t  <fo:region-after extent=\"1.5cm\"/>\n-\t</fo:simple-page-master>\n+        <fo:simple-page-master master-name=\"first\" page-height=\"29.7cm\" page-width=\"21cm\" \n+                               margin-top=\"1cm\" margin-bottom=\"2cm\" margin-left=\"2.5cm\" margin-right=\"2.5cm\">\n+          <fo:region-body margin-top=\"1cm\"/>\n+          <fo:region-before extent=\"1cm\"/>\n+          <fo:region-after extent=\"1.5cm\"/>\n+        </fo:simple-page-master>\n       </fo:layout-master-set>\n \n       <!-- starts actual layout -->\n       <fo:page-sequence master-reference=\"first\">\n \t\n-\t<fo:flow flow-name=\"xsl-region-body\">\n-\t  <fo:block font-size=\"24pt\" font-weight=\"bold\" text-align=\"center\" space-after=\"1cm\">\n-\t    Apache Syncope Report - <xsl:value-of select=\"report/@name\"/>\n-\t  </fo:block>\n+        <fo:flow flow-name=\"xsl-region-body\">\n+          <fo:block font-size=\"24pt\" font-weight=\"bold\" text-align=\"center\" space-after=\"1cm\">\n+            Apache Syncope Report - <xsl:value-of select=\"report/@name\"/>\n+          </fo:block>\n \n-\t  <fo:table table-layout=\"fixed\" border-width=\"0.5mm\" border-style=\"solid\" width=\"100%\" space-after=\"1cm\">\n-\t    <fo:table-column column-width=\"proportional-column-width(1)\"/>\n-\t    <fo:table-column column-width=\"proportional-column-width(1)\"/>\n-\t    <fo:table-body>\n-\t      <fo:table-row>\n-\t\t<fo:table-cell>\n-\t\t  <fo:block font-size=\"18pt\" font-weight=\"bold\">Report Name:</fo:block>\n-\t\t</fo:table-cell>\n-\t\t<fo:table-cell>\n-\t\t  <fo:block font-size=\"18pt\" font-weight=\"bold\"><xsl:value-of select=\"report/@name\"/></fo:block>\n-\t\t</fo:table-cell>\n-\t      </fo:table-row>\n-\t      <fo:table-row>\n-\t\t<fo:table-cell>\n-\t\t  <fo:block font-size=\"18pt\" font-weight=\"bold\">Start Date:</fo:block>\n-\t\t</fo:table-cell>\n-\t\t<fo:table-cell>\n-\t\t  <fo:block font-size=\"18pt\" font-weight=\"bold\"><xsl:value-of select=\"$startDate\"/></fo:block>\n-\t\t</fo:table-cell>\n-\t      </fo:table-row>\n-\t      <fo:table-row>\n-\t\t<fo:table-cell>\n-\t\t  <fo:block font-size=\"18pt\" font-weight=\"bold\">End Date:</fo:block>\n-\t\t</fo:table-cell>\n-\t\t<fo:table-cell>\n-\t\t  <fo:block font-size=\"18pt\" font-weight=\"bold\"><xsl:value-of select=\"$endDate\"/></fo:block>\n-\t\t</fo:table-cell>\n-\t      </fo:table-row>\n-\t    </fo:table-body>\n-\t  </fo:table>\n+          <fo:table table-layout=\"fixed\" border-width=\"0.5mm\" border-style=\"solid\" width=\"100%\" space-after=\"1cm\">\n+            <fo:table-column column-width=\"proportional-column-width(1)\"/>\n+            <fo:table-column column-width=\"proportional-column-width(1)\"/>\n+            <fo:table-body>\n+              <fo:table-row>\n+                <fo:table-cell>\n+                  <fo:block font-size=\"18pt\" font-weight=\"bold\">Report Name:</fo:block>\n+                </fo:table-cell>\n+                <fo:table-cell>\n+                  <fo:block font-size=\"18pt\" font-weight=\"bold\">\n+                    <xsl:value-of select=\"report/@name\"/>\n+                  </fo:block>\n+                </fo:table-cell>\n+              </fo:table-row>\n+              <fo:table-row>\n+                <fo:table-cell>\n+                  <fo:block font-size=\"18pt\" font-weight=\"bold\">Start Date:</fo:block>\n+                </fo:table-cell>\n+                <fo:table-cell>\n+                  <fo:block font-size=\"18pt\" font-weight=\"bold\">\n+                    <xsl:value-of select=\"$startDate\"/>\n+                  </fo:block>\n+                </fo:table-cell>\n+              </fo:table-row>\n+              <fo:table-row>\n+                <fo:table-cell>\n+                  <fo:block font-size=\"18pt\" font-weight=\"bold\">End Date:</fo:block>\n+                </fo:table-cell>\n+                <fo:table-cell>\n+                  <fo:block font-size=\"18pt\" font-weight=\"bold\">\n+                    <xsl:value-of select=\"$endDate\"/>\n+                  </fo:block>\n+                </fo:table-cell>\n+              </fo:table-row>\n+            </fo:table-body>\n+          </fo:table>\n \n-\t  <xsl:apply-templates/>\n-\t</fo:flow>\n+          <xsl:apply-templates/>\n+        </fo:flow>\n       </fo:page-sequence>\n     </fo:root>\n   </xsl:template>"},{"sha":"c1d6b6732847146049c23a3ca148590936aaa348","filename":"core/src/main/resources/report/report2html.xsl","status":"modified","additions":36,"deletions":19,"changes":55,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e8cc82cf9455eff35d0240b3d368ad0d2e26001e/core%2Fsrc%2Fmain%2Fresources%2Freport%2Freport2html.xsl","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e8cc82cf9455eff35d0240b3d368ad0d2e26001e/core%2Fsrc%2Fmain%2Fresources%2Freport%2Freport2html.xsl","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fresources%2Freport%2Freport2html.xsl?ref=e8cc82cf9455eff35d0240b3d368ad0d2e26001e","patch":"@@ -16,13 +16,12 @@ software distributed under the License is distributed on an\n KIND, either express or implied.  See the License for the\n specific language governing permissions and limitations\n under the License.\n-\n -->\n-\n <xsl:stylesheet xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"\n                 version=\"1.0\">\n \n   <xsl:import href=\"userReportlet2html.xsl\"/>\n+  <xsl:import href=\"roleReportlet2html.xsl\"/>\n   <xsl:import href=\"staticReportlet2html.xsl\"/>\n  \n   <xsl:param name=\"status\"/>\n@@ -33,26 +32,44 @@ under the License.\n   <xsl:template match=\"/\">\n     <html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\">\n       <head>\n-\t<meta http-equiv=\"content-type\" content=\"text/html; charset=utf-8\" />\n-\t<title>Apache Syncope Report - <xsl:value-of select=\"report/@name\"/></title>\n+        <meta http-equiv=\"content-type\" content=\"text/html; charset=utf-8\" />\n+        <title>Apache Syncope Report - <xsl:value-of select=\"report/@name\"/></title>\n       </head>\n       <body>\n-\t<table style=\"border: 1px solid black;\">\n-\t  <tr>\n-\t    <td><h1>Report Name:</h1></td>\n-\t    <td><h1><xsl:value-of select=\"report/@name\"/></h1></td>\n-\t  </tr>\n-\t  <tr>\n-\t    <td><h2>Start Date:</h2></td>\n-\t    <td><h2><xsl:value-of select=\"$startDate\"/></h2></td>\n-\t  </tr>\n-\t  <tr>\n-\t    <td><h2>End Date:</h2></td>\n-\t    <td><h2><xsl:value-of select=\"$endDate\"/></h2></td>\n-\t  </tr>\n-\t</table>\n+        <table style=\"border: 1px solid black;\">\n+          <tr>\n+            <td>\n+              <h1>Report Name:</h1>\n+            </td>\n+            <td>\n+              <h1>\n+                <xsl:value-of select=\"report/@name\"/>\n+              </h1>\n+            </td>\n+          </tr>\n+          <tr>\n+            <td>\n+              <h2>Start Date:</h2>\n+            </td>\n+            <td>\n+              <h2>\n+                <xsl:value-of select=\"$startDate\"/>\n+              </h2>\n+            </td>\n+          </tr>\n+          <tr>\n+            <td>\n+              <h2>End Date:</h2>\n+            </td>\n+            <td>\n+              <h2>\n+                <xsl:value-of select=\"$endDate\"/>\n+              </h2>\n+            </td>\n+          </tr>\n+        </table>\n \n-\t<xsl:apply-templates/>\n+        <xsl:apply-templates/>\n       </body>\n     </html>\n   </xsl:template>"},{"sha":"bb319a45442d3d18eb5e67ff1d2377902de90b20","filename":"core/src/main/resources/report/roleReportlet2fo.xsl","status":"added","additions":228,"deletions":0,"changes":228,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e8cc82cf9455eff35d0240b3d368ad0d2e26001e/core%2Fsrc%2Fmain%2Fresources%2Freport%2FroleReportlet2fo.xsl","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e8cc82cf9455eff35d0240b3d368ad0d2e26001e/core%2Fsrc%2Fmain%2Fresources%2Freport%2FroleReportlet2fo.xsl","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fresources%2Freport%2FroleReportlet2fo.xsl?ref=e8cc82cf9455eff35d0240b3d368ad0d2e26001e","patch":"@@ -0,0 +1,228 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+<xsl:stylesheet xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"\n+                xmlns:fo=\"http://www.w3.org/1999/XSL/Format\"\n+                version=\"1.0\">\n+\n+  <xsl:template match=\"reportlet[@class='org.apache.syncope.core.report.RoleReportlet']\">\n+   \n+    <fo:block font-size=\"16pt\" font-weight=\"bold\" space-after=\"0.5cm\" space-before=\"5mm\">Reportlet: <xsl:value-of select=\"@name\"/></fo:block>\n+        \n+    <xsl:for-each select=\"role\">\n+      <fo:block font-size=\"14pt\" font-weight=\"bold\" space-before=\"15mm\" space-after=\"5mm\" background-color=\"(#8888ff)\">Role <xsl:value-of select=\"@name\"/></fo:block>\n+      <fo:table table-layout=\"fixed\" space-after=\"7mm\">\n+        <fo:table-column/>\n+        <fo:table-column/>\n+        <fo:table-body>\n+          <fo:table-row background-color=\"(#ccccff)\">\n+            <fo:table-cell>\n+              <fo:block>Id:</fo:block>\n+            </fo:table-cell>\n+            <fo:table-cell>\n+              <fo:block font-style=\"italic\">\n+                <xsl:value-of select=\"@id\"/>\n+              </fo:block>\n+            </fo:table-cell>\n+          </fo:table-row>\n+          <xsl:if test=\"@roleOwner != 'null'\">\n+            <fo:table-row background-color=\"(#ccccff)\">\n+              <fo:table-cell>\n+                <fo:block>Role Owner:</fo:block>\n+              </fo:table-cell>\n+              <fo:table-cell>\n+                <fo:block font-style=\"italic\">\n+                  <xsl:value-of select=\"@roleOwner\"/>\n+                </fo:block>\n+              </fo:table-cell>\n+            </fo:table-row>\n+          </xsl:if>\n+          <xsl:if test=\"@userOwner != 'null'\">\n+            <fo:table-row background-color=\"(#ccccff)\">\n+              <fo:table-cell>\n+                <fo:block>Last Login Date:</fo:block>\n+              </fo:table-cell>\n+              <fo:table-cell>\n+                <fo:block font-style=\"italic\">\n+                  <xsl:value-of select=\"@userOwner\"/>\n+                </fo:block>\n+              </fo:table-cell>\n+            </fo:table-row>\n+          </xsl:if>\n+        </fo:table-body>\n+      </fo:table>\n+      <xsl:choose>\n+        <xsl:when test=\"string-length(attributes/attribute) &gt; 0\">\n+          <xsl:call-template name=\"attributes\">\n+            <xsl:with-param name=\"label\">Attributes</xsl:with-param>\n+            <xsl:with-param name=\"node\" select=\"attributes/attribute\"/>\n+          </xsl:call-template>\n+        </xsl:when>\n+        <xsl:otherwise>\n+          <fo:block color=\"red\" font-size=\"9pt\" space-after=\"3mm\">THIS ROLE HASN'T ANY ATTRIBUTE</fo:block>\n+        </xsl:otherwise>\n+      </xsl:choose>\n+      \n+      <xsl:choose>\n+        <xsl:when test=\"string-length(derivedAttributes/derivedAttribute) &gt; 0\">\n+          <xsl:call-template name=\"attributes\">\n+            <xsl:with-param name=\"label\">Derived Attributes</xsl:with-param>\n+            <xsl:with-param name=\"node\" select=\"derivedAttributes/derivedAttribute\"/>\n+          </xsl:call-template>\n+        </xsl:when>\n+        <xsl:otherwise>\n+          <fo:block color=\"red\" font-size=\"9pt\" space-after=\"3mm\">THIS ROLE HASN'T ANY DERIVED ATTRIBUTE</fo:block>\n+        </xsl:otherwise>\n+      </xsl:choose>\n+      <xsl:choose>\n+        <xsl:when test=\"string-length(virtualAttributes/virtualAttribute) &gt; 0\">\n+          <xsl:call-template name=\"attributes\">\n+            <xsl:with-param name=\"label\">Virtual Attributes</xsl:with-param>\n+            <xsl:with-param name=\"node\" select=\"virtualAttributes/virtualAttribute\"/>\n+          </xsl:call-template>\n+        </xsl:when>\n+        <xsl:otherwise>\n+          <fo:block color=\"red\" font-size=\"9pt\" space-after=\"3mm\">THIS ROLE HASN'T ANY VIRTUAL ATTRIBUTE</fo:block>\n+        </xsl:otherwise>\n+      </xsl:choose>\n+      \n+      <!--entitlements-->\n+      <xsl:choose>\n+        <xsl:when test=\"entitlements/entitlement\">\n+          <xsl:call-template name=\"entitlements\">\n+            <xsl:with-param name=\"label\">Entitlements</xsl:with-param>\n+            <xsl:with-param name=\"node\" select=\"entitlements/entitlement\"/>\n+          </xsl:call-template>\n+        </xsl:when>\n+        <xsl:otherwise>\n+          <fo:block color=\"red\" font-size=\"9pt\" space-after=\"3mm\">THIS ROLE HASN'T ANY ENTITLEMENT</fo:block>\n+        </xsl:otherwise>\n+      </xsl:choose>\n+      \n+      <xsl:choose>\n+        <xsl:when test=\"users/user\">\n+          <fo:block font-size=\"11pt\" font-weight=\"bold\">Users</fo:block>\n+          <xsl:for-each select=\"users/user\">\n+            <fo:block background-color=\"(#ccccff)\" font-size=\"9pt\" font-weight=\"bold\" space-before=\"4mm\">User: <xsl:value-of select=\"@userUsername\"/> (Id: <xsl:value-of select=\"@userId\"/>)</fo:block>\n+                 \n+          </xsl:for-each> \n+        </xsl:when>\n+        <xsl:otherwise>\n+          <fo:block color=\"red\" font-size=\"9pt\" space-after=\"3mm\">THIS ROLE HASN'T ANY USER ASSIGNED TO</fo:block>\n+        </xsl:otherwise>\n+      </xsl:choose>\n+      <xsl:call-template name=\"roleResources\">\n+        <xsl:with-param name=\"node\" select=\"resources/resource\"/>\n+      </xsl:call-template>\n+    </xsl:for-each>\n+\n+  </xsl:template>\n+  \n+  <xsl:template name=\"attributes\">\n+    <xsl:param name=\"label\"/>\n+    <xsl:param name=\"node\"/>\n+    <fo:block font-size=\"11pt\" font-weight=\"bold\" space-after=\"2mm\">\n+      <xsl:value-of select=\"$label\"/>\n+    </fo:block>\n+    <fo:table table-layout=\"fixed\" space-after=\"7mm\">\n+      <fo:table-column/>\n+      <fo:table-column/>\n+      <fo:table-header>\n+        <fo:table-row height=\"7mm\" background-color=\"(#ccccba)\">\n+          <fo:table-cell>\n+            <fo:block font-weight=\"bold\">Schema name</fo:block>\n+          </fo:table-cell>\n+          <fo:table-cell>\n+            <fo:block font-weight=\"bold\">Value(s)</fo:block>\n+          </fo:table-cell>\n+        </fo:table-row>\n+      </fo:table-header>\n+      <fo:table-body>\n+        <xsl:for-each select=\"$node\">\n+          <xsl:if test=\"string-length(value/text()) &gt; 0\">\n+            <fo:table-row height=\"4mm\" background-color=\"(#ccccff)\">\n+              <fo:table-cell>\n+                <fo:block>\n+                  <xsl:value-of select=\"@name\"/>\n+                </fo:block>\n+              </fo:table-cell>\n+              <fo:table-cell>\n+                <xsl:for-each select=\"value\">\n+                  <fo:block></fo:block><!--                        <fo:block>&#x2022;</fo:block>-->\n+                  <fo:block font-style=\"italic\">\n+                    <xsl:value-of select=\"text()\"/>\n+                  </fo:block>\n+                </xsl:for-each>\n+              </fo:table-cell>\n+            </fo:table-row>\n+          </xsl:if>\n+          <fo:table-row>\n+            <fo:table-cell>\n+              <fo:block></fo:block>\n+            </fo:table-cell>\n+            <fo:table-cell>\n+              <fo:block></fo:block>\n+            </fo:table-cell>\n+          </fo:table-row>\n+        </xsl:for-each>\n+      </fo:table-body>\n+    </fo:table>\n+  </xsl:template>\n+  <!--entitlements template-->\n+  <xsl:template name=\"entitlements\">\n+    <xsl:param name=\"label\"/>\n+    <xsl:param name=\"node\"/>\n+    <fo:block font-size=\"11pt\" font-weight=\"bold\" space-after=\"2mm\" space-before=\"5mm\">\n+      <xsl:value-of select=\"$label\"/>\n+    </fo:block>\n+    <fo:table table-layout=\"fixed\" space-after=\"7mm\">\n+      <fo:table-column/>\n+      <!--<fo:table-column/>-->\n+      <fo:table-header>\n+        <fo:table-row height=\"7mm\" background-color=\"(#ccccba)\">\n+          <fo:table-cell>\n+            <fo:block font-weight=\"bold\">Name</fo:block>\n+          </fo:table-cell>\n+        </fo:table-row>\n+      </fo:table-header>\n+      <fo:table-body>\n+        <xsl:for-each select=\"$node\">\n+          <fo:table-row height=\"4mm\" background-color=\"(#ccccff)\">\n+            <fo:table-cell>\n+              <fo:block>\n+                <xsl:value-of select=\"@id\"/>\n+              </fo:block>\n+            </fo:table-cell>\n+          </fo:table-row>\n+        </xsl:for-each>\n+      </fo:table-body>\n+    </fo:table>\n+  </xsl:template>\n+  \n+  <xsl:template name=\"roleResources\">\n+    <xsl:param name=\"node\"/>\n+    <fo:block font-size=\"11pt\" font-weight=\"bold\" space-after=\"3mm\" space-before=\"5mm\">Role Resources</fo:block>\n+    <xsl:for-each select=\"$node\">\n+      <fo:block></fo:block> <!--            <fo:block>&#x2022;</fo:block>-->\n+      <fo:block background-color=\"(#ccccff)\">\n+        <xsl:value-of select=\"@name\"/>\n+      </fo:block>\n+    </xsl:for-each>\n+  </xsl:template>\n+</xsl:stylesheet>\n\\ No newline at end of file"},{"sha":"9f5825f131a9c04fe5b3c0b39897bc9905757feb","filename":"core/src/main/resources/report/roleReportlet2html.xsl","status":"added","additions":196,"deletions":0,"changes":196,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e8cc82cf9455eff35d0240b3d368ad0d2e26001e/core%2Fsrc%2Fmain%2Fresources%2Freport%2FroleReportlet2html.xsl","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e8cc82cf9455eff35d0240b3d368ad0d2e26001e/core%2Fsrc%2Fmain%2Fresources%2Freport%2FroleReportlet2html.xsl","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fresources%2Freport%2FroleReportlet2html.xsl?ref=e8cc82cf9455eff35d0240b3d368ad0d2e26001e","patch":"@@ -0,0 +1,196 @@\n+<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+<xsl:stylesheet xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"\n+                version=\"1.0\">\n+\n+  <xsl:template match=\"reportlet[@class='org.apache.syncope.core.report.RoleReportlet']\">\n+    <h2>Reportlet: <xsl:value-of select=\"@name\"/></h2>\n+    <xsl:for-each select=\"role\">\n+      <h3>Role <xsl:value-of select=\"@name\"/></h3>\n+      \n+      <table style=\"border: 1px solid black;\">\n+        <tr>\n+          <td>Id:</td>\n+          <td>\n+            <xsl:value-of select=\"@id\"/>\n+          </td>\n+        </tr>\n+        <xsl:if test=\"@roleOwner != 'null'\"> <!--!= null test=\"not(USER/FIRSTNAME)\" -->\n+          <tr>\n+            <td>Role Owner:</td>\n+            <td>\n+              <xsl:value-of select=\"@roleOwner\"/>\n+            </td>\n+          </tr>\n+        </xsl:if>\n+        <xsl:if test=\"@userOwner != 'null'\">\n+          <tr>\n+            <td>User Owner:</td>\n+            <td>\n+              <xsl:value-of select=\"@userOwner\"/>\n+            </td>\n+          </tr>\n+        </xsl:if>\n+        \n+      </table>\n+\n+      <xsl:choose>\n+        <xsl:when test=\"string-length(attributes/attribute) &gt; 0\">\n+          <xsl:call-template name=\"attributes\">\n+            <xsl:with-param name=\"label\">Attributes</xsl:with-param>\n+            <xsl:with-param name=\"node\" select=\"attributes/attribute\"/>\n+          </xsl:call-template>\n+        </xsl:when>\n+        <xsl:otherwise>\n+          <h5>THIS ROLE HASN'T ANY ATTRIBUTE</h5>\n+        </xsl:otherwise>\n+      </xsl:choose>\n+\n+      <xsl:choose>\n+        <xsl:when test=\"string-length(derivedAttributes/derivedAttribute) &gt; 0\">\n+          <xsl:call-template name=\"attributes\">\n+            <xsl:with-param name=\"label\">Derived Attributes</xsl:with-param>\n+            <xsl:with-param name=\"node\" select=\"derivedAttributes/derivedAttribute\"/>\n+          </xsl:call-template>\n+        </xsl:when>\n+        <xsl:otherwise>\n+          <h5>THIS ROLE HASN'T ANY DERIVED ATTRIBUTE</h5>\n+        </xsl:otherwise>\n+      </xsl:choose>\n+      <!--</xsl:if>-->\n+      <xsl:choose>\n+        <xsl:when test=\"string-length(virtualAttributes/virtualAttribute) &gt; 0\">\n+          <xsl:call-template name=\"attributes\">\n+            <xsl:with-param name=\"label\">Virtual Attributes</xsl:with-param>\n+            <xsl:with-param name=\"node\" select=\"virtualAttributes/virtualAttribute\"/>\n+          </xsl:call-template>\n+        </xsl:when>\n+        <xsl:otherwise>\n+          <h5>THIS ROLE HASN'T ANY VIRTUAL ATTRIBUTE</h5>\n+        </xsl:otherwise>\n+      </xsl:choose>\n+      \n+      <xsl:choose>\n+        <xsl:when test=\"entitlements/entitlement\">\n+          <xsl:call-template name=\"entitlements\">\n+            <xsl:with-param name=\"label\">Entitlements: </xsl:with-param>\n+            <xsl:with-param name=\"node\" select=\"entitlements/entitlement\"/>\n+          </xsl:call-template>\n+        </xsl:when>\n+        <xsl:otherwise>\n+          <h5>THIS ROLE HASN'T ANY ENTITLEMENT</h5>\n+        </xsl:otherwise>\n+      </xsl:choose>\n+      \n+      <xsl:choose>\n+        <xsl:when test=\"users/user\">\n+          <h4>Users</h4>\n+          <xsl:for-each select=\"users/user\">\n+            <h5>User: <xsl:value-of select=\"@userUsername\"/> (Id: <xsl:value-of select=\"@userId\"/>)</h5>\n+          </xsl:for-each>\n+        </xsl:when>\n+        <xsl:otherwise>\n+          <h5>THIS ROLE HASN'T ANY USER ASSIGNED TO</h5>\n+        </xsl:otherwise>\n+      </xsl:choose>\n+      \n+      <xsl:call-template name=\"roleResources\">\n+        <xsl:with-param name=\"node\" select=\"resources/resource\"/>\n+      </xsl:call-template>\n+      <hr/>\n+      \n+    </xsl:for-each>\n+  </xsl:template>\n+ \n+  <!--entitlement template-->\n+  <xsl:template name=\"entitlements\">\n+    <xsl:param name=\"label\"/>\n+    <xsl:param name=\"node\"/>\n+\n+    <h4>\n+      <xsl:value-of select=\"$label\"/>\n+    </h4>\n+    \n+    <table>\n+      \n+      <tbody>\n+        <xsl:for-each select=\"$node\">\n+          <tr>\n+            <td>\n+              <xsl:value-of select=\"@id\"/>\n+            </td>\n+          </tr>\n+        </xsl:for-each>\n+      </tbody>\n+    </table>\n+  </xsl:template>\n+\n+\n+  <xsl:template name=\"attributes\">\n+    <xsl:param name=\"label\"/>\n+    <xsl:param name=\"node\"/>\n+\n+    <h4>\n+      <xsl:value-of select=\"$label\"/>\n+    </h4>\n+    \n+    <table>\n+      <thead>\n+        <tr>\n+          <th>Schema name</th>\n+          <th>Value(s)</th>\n+        </tr>\n+      </thead>\n+      <tbody>\n+        <xsl:for-each select=\"$node\">\n+          <xsl:if test=\"string-length(value/text()) &gt; 0\">\n+            <tr>\n+              <td>\n+                <xsl:value-of select=\"@name\"/>\n+              </td>\n+              <td>\n+                <ul>\n+                  <xsl:for-each select=\"value\">\n+                    <li>\n+                      <xsl:value-of select=\"text()\"/>\n+                    </li>\n+                  </xsl:for-each>\n+                </ul>\n+              </td>\n+            </tr>\n+          </xsl:if>\n+        </xsl:for-each>\n+      </tbody>\n+    </table>\n+  </xsl:template>\n+\n+  <xsl:template name=\"roleResources\">\n+    <xsl:param name=\"node\"/>\n+    \n+    <h4>Role Resources</h4>\n+    <ul>\n+      <xsl:for-each select=\"$node\">\n+        <li>\n+          <xsl:value-of select=\"@name\"/>\n+        </li>\n+      </xsl:for-each>\n+    </ul>\n+  </xsl:template>\n+</xsl:stylesheet>\n\\ No newline at end of file"},{"sha":"977ef4c4e17ec8fd6f666b633e3928e9fbdd5f06","filename":"core/src/main/resources/report/userReportlet2fo.xsl","status":"modified","additions":2,"deletions":3,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e8cc82cf9455eff35d0240b3d368ad0d2e26001e/core%2Fsrc%2Fmain%2Fresources%2Freport%2FuserReportlet2fo.xsl","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e8cc82cf9455eff35d0240b3d368ad0d2e26001e/core%2Fsrc%2Fmain%2Fresources%2Freport%2FuserReportlet2fo.xsl","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fresources%2Freport%2FuserReportlet2fo.xsl?ref=e8cc82cf9455eff35d0240b3d368ad0d2e26001e","patch":"@@ -16,9 +16,7 @@ software distributed under the License is distributed on an\n KIND, either express or implied.  See the License for the\n specific language governing permissions and limitations\n under the License.\n-\n -->\n-\n <xsl:stylesheet xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"\n                 xmlns:fo=\"http://www.w3.org/1999/XSL/Format\"\n                 version=\"1.0\">\n@@ -170,7 +168,8 @@ under the License.\n                   <fo:block color=\"red\" font-size=\"8pt\" space-after=\"2mm\">THIS ROLE HASN'T ANY VIRTUAL ATTRIBUTE</fo:block>\n                 </xsl:otherwise>\n               </xsl:choose>\n-              <xsl:call-template name=\"resources\">\n+              <!-- 'roleResources\" is defined in roleReportlet2fo.xsl -->\n+              <xsl:call-template name=\"roleResources\">\n                 <xsl:with-param name=\"node\" select=\"resources/resource\"/>\n               </xsl:call-template>\n             </fo:block>"},{"sha":"6215d9d67690065635322bfee9bde5d500f21c6c","filename":"core/src/main/resources/report/userReportlet2html.xsl","status":"modified","additions":13,"deletions":11,"changes":24,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e8cc82cf9455eff35d0240b3d368ad0d2e26001e/core%2Fsrc%2Fmain%2Fresources%2Freport%2FuserReportlet2html.xsl","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e8cc82cf9455eff35d0240b3d368ad0d2e26001e/core%2Fsrc%2Fmain%2Fresources%2Freport%2FuserReportlet2html.xsl","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fsrc%2Fmain%2Fresources%2Freport%2FuserReportlet2html.xsl?ref=e8cc82cf9455eff35d0240b3d368ad0d2e26001e","patch":"@@ -16,16 +16,16 @@ software distributed under the License is distributed on an\n KIND, either express or implied.  See the License for the\n specific language governing permissions and limitations\n under the License.\n-\n -->\n-\n <xsl:stylesheet xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"\n                 version=\"1.0\">\n \n   <xsl:template match=\"reportlet[@class='org.apache.syncope.core.report.UserReportlet']\">\n-    <h2>Reportlet: <xsl:value-of select=\"@name\"/></h2>\n+    \n+    <h3>Reportlet: <xsl:value-of select=\"@name\"/></h3>\n+    \n     <xsl:for-each select=\"user\">\n-      <h3>User <xsl:value-of select=\"@username\"/></h3>\n+      <h4>User <xsl:value-of select=\"@username\"/></h4>\n       \n       <table style=\"border: 1px solid black;\">\n         <tr>\n@@ -90,7 +90,7 @@ under the License.\n           </xsl:call-template>\n         </xsl:when>\n         <xsl:otherwise>\n-          <h5>THIS USER HASN'T ANY DERIVED ATTRIBUTE</h5>\n+          <h5>THIS USER HASN'T DERIVED ATTRIBUTES</h5>\n         </xsl:otherwise>\n       </xsl:choose>\n       <!--</xsl:if>-->\n@@ -102,7 +102,7 @@ under the License.\n           </xsl:call-template>\n         </xsl:when>\n         <xsl:otherwise>\n-          <h5>THIS USER HASN'T ANY VIRTUAL ATTRIBUTE</h5>\n+          <h5>THIS USER HASN'T VIRTUAL ATTRIBUTES</h5>\n         </xsl:otherwise>\n       </xsl:choose>\n       \n@@ -120,7 +120,7 @@ under the License.\n                   </xsl:call-template>\n                 </xsl:when>\n                 <xsl:otherwise>\n-                  <h5>THIS ROLE HASN'T ANY ATTRIBUTE</h5>\n+                  <h5>THIS ROLE HASN'T ATTRIBUTES</h5>\n                 </xsl:otherwise>\n               </xsl:choose>\n               <xsl:choose>\n@@ -131,7 +131,7 @@ under the License.\n                   </xsl:call-template>\n                 </xsl:when>\n                 <xsl:otherwise>\n-                  <h5>THIS ROLE HASN'T ANY DERIVED ATTRIBUTE</h5>\n+                  <h5>THIS ROLE HASN'T DERIVED ATTRIBUTES</h5>\n                 </xsl:otherwise>\n               </xsl:choose>\n               <xsl:choose>\n@@ -142,24 +142,26 @@ under the License.\n                   </xsl:call-template>\n                 </xsl:when>\n                 <xsl:otherwise>\n-                  <h5>THIS ROLE HASN'T ANY VIRTUAL ATTRIBUTE</h5>\n+                  <h5>THIS ROLE HASN'T VIRTUAL ATTRIBUTES</h5>\n                 </xsl:otherwise>\n               </xsl:choose>\n-              <xsl:call-template name=\"resources\">\n+              <!-- 'roleResources\" is defined in roleReportlet2html.xsl -->\n+              <xsl:call-template name=\"roleResources\">\n                 <xsl:with-param name=\"node\" select=\"resources/resource\"/>\n               </xsl:call-template>\n             </blockquote>\n           </xsl:for-each>\n         </xsl:when>\n         <xsl:otherwise>\n-          <h5>THIS USER ISN'T ASSIGNED TO ANY ROLE</h5>\n+          <h5>THIS USER ISN'T ASSIGNED TO A ROLE</h5>\n         </xsl:otherwise>\n       </xsl:choose>\n       <xsl:call-template name=\"resources\">\n         <xsl:with-param name=\"node\" select=\"resources/resource\"/>\n       </xsl:call-template>\n       <hr/>\n     </xsl:for-each>\n+       \n   </xsl:template>\n \n   <xsl:template name=\"attributes\">"}]}