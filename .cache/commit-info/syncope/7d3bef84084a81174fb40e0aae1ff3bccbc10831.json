{"sha":"7d3bef84084a81174fb40e0aae1ff3bccbc10831","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjdkM2JlZjg0MDg0YTgxMTc0ZmI0MGUwYWFlMWZmM2JjY2JjMTA4MzE=","commit":{"author":{"name":"Unknown","email":"unknown@apache.org","date":"2010-11-11T17:11:37Z"},"committer":{"name":"Unknown","email":"unknown@apache.org","date":"2010-11-11T17:11:37Z"},"message":"Fix on DateTimeField validation\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/syncope/trunk@1246630 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"35f00a9b2bed7636cbd90429ca3255da9d2300e3","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/35f00a9b2bed7636cbd90429ca3255da9d2300e3"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/7d3bef84084a81174fb40e0aae1ff3bccbc10831","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/7d3bef84084a81174fb40e0aae1ff3bccbc10831","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/7d3bef84084a81174fb40e0aae1ff3bccbc10831","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/7d3bef84084a81174fb40e0aae1ff3bccbc10831/comments","author":null,"committer":null,"parents":[{"sha":"0752281b4d1539b0ee0b925631f4592d479c2c6d","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/0752281b4d1539b0ee0b925631f4592d479c2c6d","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/0752281b4d1539b0ee0b925631f4592d479c2c6d"}],"stats":{"total":39,"additions":30,"deletions":9},"files":[{"sha":"c5bea2cfcd4c72372455d03b420b2268aa89c833","filename":"console/src/main/java/org/syncope/console/wicket/markup/html/form/DateFieldPanel.java","status":"modified","additions":30,"deletions":9,"changes":39,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7d3bef84084a81174fb40e0aae1ff3bccbc10831/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FDateFieldPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7d3bef84084a81174fb40e0aae1ff3bccbc10831/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FDateFieldPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Fform%2FDateFieldPanel.java?ref=7d3bef84084a81174fb40e0aae1ff3bccbc10831","patch":"@@ -15,6 +15,7 @@\n package org.syncope.console.wicket.markup.html.form;\n \n import java.util.Date;\n+import java.util.StringTokenizer;\n import org.apache.wicket.extensions.markup.html.form.DateTextField;\n import org.apache.wicket.markup.html.basic.Label;\n import org.apache.wicket.markup.html.form.Form;\n@@ -43,7 +44,7 @@ public class DateFieldPanel extends Panel {\n      * @param readonly TRUE if it can't be valued, FALSE otherwise\n      * @param form form where it will be included\n      */\n-    public DateFieldPanel(String id, String name ,IModel<Date> model,\n+    public DateFieldPanel(String id, String name ,final IModel<Date> model,\n             final String datePattern, boolean required,boolean readonly,\n             Form form) {\n         super(id, model);\n@@ -130,16 +131,36 @@ public FormComponent[] getDependentFormComponents() {\n          */\n         @Override\n         public void validate(Form form) {\n-        DateTimeField dateTimeField = (DateTimeField) dateTimeComponents[0];\n+            DateTimeField dateTimeField = (DateTimeField) dateTimeComponents[0];\n \n-        if(dateTimeField.getDate() == null || dateTimeField.getHours() == null\n-                || dateTimeField.getMinutes() == null) {\n+            StringTokenizer inputDateTokenizer = new StringTokenizer(\n+                    dateTimeField.getInput(), \",\");\n \n-            ValidationError ve = new ValidationError();\n-            ve.setVariables(DateTimeFormValidator.this.variablesMap());\n-            ve.addMessageKey(resourceKey());\n-            dateTimeComponents[0].error((IValidationError) ve);\n+            int tokens = inputDateTokenizer.countTokens();\n+\n+            boolean isValid = true;\n+\n+            if (tokens < 2) {\n+                isValid = false;\n+            } else {\n+                //First token = date\n+                String date = inputDateTokenizer.nextToken();\n+                //Second token = time\n+                StringTokenizer timeTokenizer = new StringTokenizer(\n+                        inputDateTokenizer.nextToken(), \":\");\n+\n+                if (timeTokenizer.countTokens() < 2) {\n+                    isValid = false;\n+                }\n+\n+            }\n+\n+            if (!isValid) {\n+                ValidationError ve = new ValidationError();\n+                ve.setVariables(DateTimeFormValidator.this.variablesMap());\n+                ve.addMessageKey(resourceKey());\n+                dateTimeComponents[0].error((IValidationError) ve);\n+            }\n         }\n-      }\n     }\n }\n\\ No newline at end of file"}]}