{"sha":"5ca5439383de631df351c035f4fcdfda5a2d43a7","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjVjYTU0MzkzODNkZTYzMWRmMzUxYzAzNWY0ZmNkZmRhNWEyZDQzYTc=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2018-10-12T12:01:18Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2018-10-12T12:10:31Z"},"message":"Review and reflow the Kubernets sample","tree":{"sha":"26b8acf224d25d540ce0d579c84bf6cfb4aad2d5","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/26b8acf224d25d540ce0d579c84bf6cfb4aad2d5"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/5ca5439383de631df351c035f4fcdfda5a2d43a7","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/5ca5439383de631df351c035f4fcdfda5a2d43a7","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/5ca5439383de631df351c035f4fcdfda5a2d43a7","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/5ca5439383de631df351c035f4fcdfda5a2d43a7/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"dfccf431fcd34b410838c3e230c362f58e4a8877","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/dfccf431fcd34b410838c3e230c362f58e4a8877","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/dfccf431fcd34b410838c3e230c362f58e4a8877"}],"stats":{"total":97,"additions":47,"deletions":50},"files":[{"sha":"cac74c82398342ecb5edc9cab9bab7f89dcdc2ee","filename":"docker/src/main/resources/k8s/helm/README.adoc","status":"removed","additions":0,"deletions":25,"changes":25,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2FREADME.adoc","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/dfccf431fcd34b410838c3e230c362f58e4a8877/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2FREADME.adoc","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fk8s%2Fhelm%2FREADME.adoc?ref=dfccf431fcd34b410838c3e230c362f58e4a8877","patch":"@@ -1,25 +0,0 @@\n-= Install Commands\n-\n-Open a terminal and navigate to the \"helm\" folder.  \n-\n-[WARNING]\n-Do not forget to set your `values.yaml`!\n-\n-.Install postgres\n-[source,bash]\n-----\n-helm install postgres --name postgres --namespace <YOUR_NAMESPACE> -f postgres/values.yaml\n-----\n-\n-Let Postgres initialize (about 20-30 seconds).  You can watch logs to confirm\n-\n-.Install syncope\n-[source,bash]\n-----\n-helm install syncope --name syncope --namespace <YOUR_NAMESPACE> -f syncope/values.yaml\n-----\n-=== Todo\n-Still more to do:\n-\n-* Have some value parameters that are not plumbed in (e.g. resources)\n-* Need to put in liveness and readyness checks\n\\ No newline at end of file"},{"sha":"a7c8b8fcd79e9ec5e8c47789bf55d43800cba492","filename":"docker/src/main/resources/kubernetes/postgres/Chart.yaml","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/5ca5439383de631df351c035f4fcdfda5a2d43a7/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fpostgres%2FChart.yaml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/5ca5439383de631df351c035f4fcdfda5a2d43a7/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fpostgres%2FChart.yaml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fpostgres%2FChart.yaml?ref=5ca5439383de631df351c035f4fcdfda5a2d43a7","previous_filename":"docker/src/main/resources/k8s/helm/postgres/Chart.yaml"},{"sha":"55f8755b4d7725de75576b59fdc7c91bc3dc2785","filename":"docker/src/main/resources/kubernetes/postgres/templates/db-deployment.yaml","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/5ca5439383de631df351c035f4fcdfda5a2d43a7/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fpostgres%2Ftemplates%2Fdb-deployment.yaml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/5ca5439383de631df351c035f4fcdfda5a2d43a7/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fpostgres%2Ftemplates%2Fdb-deployment.yaml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fpostgres%2Ftemplates%2Fdb-deployment.yaml?ref=5ca5439383de631df351c035f4fcdfda5a2d43a7","previous_filename":"docker/src/main/resources/k8s/helm/postgres/templates/db-deployment.yaml"},{"sha":"51a60b3416a2fa8ed17eb68d0cd84cf8db903aa4","filename":"docker/src/main/resources/kubernetes/postgres/values.yaml","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/5ca5439383de631df351c035f4fcdfda5a2d43a7/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fpostgres%2Fvalues.yaml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/5ca5439383de631df351c035f4fcdfda5a2d43a7/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fpostgres%2Fvalues.yaml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fpostgres%2Fvalues.yaml?ref=5ca5439383de631df351c035f4fcdfda5a2d43a7","previous_filename":"docker/src/main/resources/k8s/helm/postgres/values.yaml"},{"sha":"7f697a2b4584d8ef9918a2f047cb7637410cd5e0","filename":"docker/src/main/resources/kubernetes/syncope/Chart.yaml","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/5ca5439383de631df351c035f4fcdfda5a2d43a7/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fsyncope%2FChart.yaml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/5ca5439383de631df351c035f4fcdfda5a2d43a7/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fsyncope%2FChart.yaml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fsyncope%2FChart.yaml?ref=5ca5439383de631df351c035f4fcdfda5a2d43a7","previous_filename":"docker/src/main/resources/k8s/helm/syncope/Chart.yaml"},{"sha":"2daf9f25ba4aedd5818df6d64c43c26a6fa3c337","filename":"docker/src/main/resources/kubernetes/syncope/templates/syncope-console-deployment.yaml","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/5ca5439383de631df351c035f4fcdfda5a2d43a7/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fsyncope%2Ftemplates%2Fsyncope-console-deployment.yaml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/5ca5439383de631df351c035f4fcdfda5a2d43a7/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fsyncope%2Ftemplates%2Fsyncope-console-deployment.yaml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fsyncope%2Ftemplates%2Fsyncope-console-deployment.yaml?ref=5ca5439383de631df351c035f4fcdfda5a2d43a7","previous_filename":"docker/src/main/resources/k8s/helm/syncope/templates/syncope-console-deployment.yaml"},{"sha":"ecbf13f5bb9e51d2a33535fe16b7dd687b0f1573","filename":"docker/src/main/resources/kubernetes/syncope/templates/syncope-deployment.yaml","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/5ca5439383de631df351c035f4fcdfda5a2d43a7/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fsyncope%2Ftemplates%2Fsyncope-deployment.yaml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/5ca5439383de631df351c035f4fcdfda5a2d43a7/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fsyncope%2Ftemplates%2Fsyncope-deployment.yaml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fsyncope%2Ftemplates%2Fsyncope-deployment.yaml?ref=5ca5439383de631df351c035f4fcdfda5a2d43a7","previous_filename":"docker/src/main/resources/k8s/helm/syncope/templates/syncope-deployment.yaml"},{"sha":"2a28cfca6d2c0136318f19a46f9a70fc6942ce5b","filename":"docker/src/main/resources/kubernetes/syncope/templates/syncope-enduser-deployment.yaml","status":"renamed","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/5ca5439383de631df351c035f4fcdfda5a2d43a7/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fsyncope%2Ftemplates%2Fsyncope-enduser-deployment.yaml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/5ca5439383de631df351c035f4fcdfda5a2d43a7/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fsyncope%2Ftemplates%2Fsyncope-enduser-deployment.yaml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fsyncope%2Ftemplates%2Fsyncope-enduser-deployment.yaml?ref=5ca5439383de631df351c035f4fcdfda5a2d43a7","previous_filename":"docker/src/main/resources/k8s/helm/syncope/templates/syncope-enduser-deployment.yaml"},{"sha":"a6a85136609550320483c4a6908b117a791cb610","filename":"docker/src/main/resources/kubernetes/syncope/values.yaml","status":"renamed","additions":4,"deletions":4,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/5ca5439383de631df351c035f4fcdfda5a2d43a7/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fsyncope%2Fvalues.yaml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/5ca5439383de631df351c035f4fcdfda5a2d43a7/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fsyncope%2Fvalues.yaml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/docker%2Fsrc%2Fmain%2Fresources%2Fkubernetes%2Fsyncope%2Fvalues.yaml?ref=5ca5439383de631df351c035f4fcdfda5a2d43a7","patch":"@@ -30,7 +30,7 @@ syncopeConfig:\n   replicas: 1\n   repository: apache\n   container: syncope\n-  tag: 2.1.0\n+  tag: ${syncope.version}\n   containerPort: 8080\n   memoryLimit: 512Mi\n   serviceType: ClusterIP\n@@ -40,7 +40,7 @@ syncopeConsoleConfig:\n   replicas: 1\n   repository: apache\n   container: syncope-console\n-  tag: 2.1.0\n+  tag: ${syncope.version}\n   containerPort: 8080\n   memoryLimit: 512Mi\n   serviceType: ClusterIP\n@@ -50,7 +50,7 @@ syncopeEndUserConfig:\n   replicas: 1\n   repository: apache\n   container: syncope-enduser\n-  tag: 2.1.0\n+  tag: ${syncope.version}\n   containerPort: 8080\n   memoryLimit: 512Mi\n-  serviceType: ClusterIP\n\\ No newline at end of file\n+  serviceType: ClusterIP","previous_filename":"docker/src/main/resources/k8s/helm/syncope/values.yaml"},{"sha":"ce0da9f7ea1ef2e9d74f0a2fdaa4cec0e5ae5f6c","filename":"src/main/asciidoc/getting-started/obtain.adoc","status":"modified","additions":43,"deletions":21,"changes":64,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/5ca5439383de631df351c035f4fcdfda5a2d43a7/src%2Fmain%2Fasciidoc%2Fgetting-started%2Fobtain.adoc","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/5ca5439383de631df351c035f4fcdfda5a2d43a7/src%2Fmain%2Fasciidoc%2Fgetting-started%2Fobtain.adoc","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/src%2Fmain%2Fasciidoc%2Fgetting-started%2Fobtain.adoc?ref=5ca5439383de631df351c035f4fcdfda5a2d43a7","patch":"@@ -346,10 +346,10 @@ Environment variables:\n \n Besides the one reported below, more samples are\n ifeval::[\"{snapshotOrRelease}\" == \"release\"]\n-https://github.com/apache/syncope/tree/syncope-{docVersion}/docker/src/main/resources[available^].\n+https://github.com/apache/syncope/tree/syncope-{docVersion}/docker/src/main/resources/docker-compose[available^].\n endif::[]\n ifeval::[\"{snapshotOrRelease}\" == \"snapshot\"]\n-https://github.com/apache/syncope/tree/master/docker/src/main/resources[available^].\n+https://github.com/apache/syncope/tree/master/docker/src/main/resources/docker-compose[available^].\n endif::[]\n \n .Syncope Core, Admin UI and Enduser UI with PostgreSQL\n@@ -453,43 +453,65 @@ Credentials: `admin` / `password`\n \n |===\n \n-==== Kubernetes Install\n+==== Kubernetes sample\n \n-Using the same images above it is possible to install in Kubernetes.  Provided is a set of example helm charts that can be used to install Syncope directly in Kubernetes.  Your specific setup might be different but ideally these can be a baseline install for your specific needs.  This will walk you through the installation of syncope via helm.\n+A set of example https://www.helm.sh/[Helm^] charts is\n+ifeval::[\"{snapshotOrRelease}\" == \"release\"]\n+https://github.com/apache/syncope/tree/syncope-{docVersion}/docker/src/main/resources/kubernetes[available^],\n+endif::[]\n+ifeval::[\"{snapshotOrRelease}\" == \"snapshot\"]\n+https://github.com/apache/syncope/tree/master/docker/src/main/resources/kubernetes[available^],\n+endif::[]\n+that can be used to install Apache Syncope directly in Kubernetes.\n \n-It makes a couple assumptions:\n+Some assumptions are made:\n \n-* Have a working Kubernetes Cluster to install into.\n-** If you don't have one then GCP has a decent https://kubernetes.io/docs/setup/[tutorial] .  **NOTE:** You could also use any other Cloud Provider or Local install (e.g. AWS, Minikub, Openshift)\n-* Have helm installed\n-** Follow these https://docs.helm.sh/using_helm/[instructions] if you don't\n-* You have your kubernetes cluster to allow for dynamic provisioning of persistent volumes in K8s\n-** If you don't have it then you will need to manually create the volume or turn on dynamic provisioning.  Refer to this link https://kubernetes.io/docs/concepts/storage/dynamic-provisioning/[here]\n+* a working Kubernetes Cluster to install into - if not available, follow this\n+https://kubernetes.io/docs/setup/[tutorial^]\n+[NOTE]\n+Any other cloud provider or local install (e.g. AWS, Minikube, OpenShift) can be used\n+\n+* Helm installed - follow these https://docs.helm.sh/using_helm/[instructions^] if you don't\n \n-===== Overview Of Install\n+* allow for https://kubernetes.io/docs/concepts/storage/dynamic-provisioning/[dynamic provisioning^] of persistent\n+volumes - otherwise you will need to manually create the volume\n \n-The install is broken into two separate helm charts.  This is due to the fact that syncope doesn't startup properly is the database isn't fully initialized yet.\n+The install process is broken into two separate Helm charts; this is due to the fact that Apache Syncope doesn't startup\n+properly if the database used as internal storage is not fully initialized yet:\n \n-* Postgres Chart - this will install the postgres database.  It will also configure a persistent volume and persistent volume claim to store the data\n-* Syncope Chart - This is the actual syncope install.  It will install 3 separate pods (Core, Console, and Enduser)\n+* `postgres` chart; this will install the PostgreSQL database and configure a persistent volume and persistent volume\n+claim to store the data\n+* `syncope` chart; this is the actual Apache Syncope install, which will deploy three separate pods\n+(Core, Console, and Enduser)\n \n image::SyncopeLayoutInK8s.png[]\n \n-**Values.yaml** - Each Helm Chart has a values.yaml.  These are the configurable parameters for your specific install.  Before running the install you need to update the values.yaml for your needs\n+The installation steps are:\n \n-===== Install Commands\n+. Open a terminal and navigate to the `kubernetes`\n+ifeval::[\"{snapshotOrRelease}\" == \"release\"]\n+https://github.com/apache/syncope/tree/syncope-{docVersion}/docker/src/main/resources/kubernetes[folder^],\n+endif::[]\n+ifeval::[\"{snapshotOrRelease}\" == \"snapshot\"]\n+https://github.com/apache/syncope/tree/master/docker/src/main/resources/kubernetes[folder^],\n+endif::[]\n+wherever you downloaded it\n \n-Open a terminal and navigate to the \"helm\" https://github.com/apache/syncope/tree/master/docker/src/main/resources/k8s/helm[folder] wherever you downloaded the code.  **REMINDER:  SET YOUR VALUES.YAML!!!**\n+. Set your actual values in `postgres/values.yaml`\n \n-.Install postgres\n+. Install PostgreSQL\n++\n [source,bash]\n ----\n helm install postgres --name postgres --namespace <YOUR_NAMESPACE> -f postgres/values.yaml\n ----\n++\n+Wait until PostgreSQL is initialized (watch logs for confirmation)\n \n-Let Postgres initialize (about 20-30 seconds).  You can watch logs to confirm\n+. Set your actual values in `syncope/values.yaml`\n \n-.Install syncope\n+. Install Apache Syncope\n++\n [source,bash]\n ----\n helm install syncope --name syncope --namespace <YOUR_NAMESPACE> -f syncope/values.yaml"}]}