{"sha":"1d11d9764bd56e2aef3986d95558305814206024","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjFkMTFkOTc2NGJkNTZlMmFlZjM5ODZkOTU1NTgzMDU4MTQyMDYwMjQ=","commit":{"author":{"name":"skylark17","email":"matteo.alessandroni@tirasa.net","date":"2017-12-06T10:03:02Z"},"committer":{"name":"skylark17","email":"matteo.alessandroni@tirasa.net","date":"2017-12-06T10:17:06Z"},"message":"[SYNCOPE-1237] Fix for copy-to-clipboard feature in multiple-opened toggle menus","tree":{"sha":"d49cc8430e1185d771a15ec63f4dcba82b502563","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/d49cc8430e1185d771a15ec63f4dcba82b502563"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/1d11d9764bd56e2aef3986d95558305814206024","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/1d11d9764bd56e2aef3986d95558305814206024","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/1d11d9764bd56e2aef3986d95558305814206024","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/1d11d9764bd56e2aef3986d95558305814206024/comments","author":{"login":"mat-ale","id":25547301,"node_id":"MDQ6VXNlcjI1NTQ3MzAx","avatar_url":"https://avatars.githubusercontent.com/u/25547301?v=4","gravatar_id":"","url":"https://api.github.com/users/mat-ale","html_url":"https://github.com/mat-ale","followers_url":"https://api.github.com/users/mat-ale/followers","following_url":"https://api.github.com/users/mat-ale/following{/other_user}","gists_url":"https://api.github.com/users/mat-ale/gists{/gist_id}","starred_url":"https://api.github.com/users/mat-ale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mat-ale/subscriptions","organizations_url":"https://api.github.com/users/mat-ale/orgs","repos_url":"https://api.github.com/users/mat-ale/repos","events_url":"https://api.github.com/users/mat-ale/events{/privacy}","received_events_url":"https://api.github.com/users/mat-ale/received_events","type":"User","site_admin":false},"committer":{"login":"mat-ale","id":25547301,"node_id":"MDQ6VXNlcjI1NTQ3MzAx","avatar_url":"https://avatars.githubusercontent.com/u/25547301?v=4","gravatar_id":"","url":"https://api.github.com/users/mat-ale","html_url":"https://github.com/mat-ale","followers_url":"https://api.github.com/users/mat-ale/followers","following_url":"https://api.github.com/users/mat-ale/following{/other_user}","gists_url":"https://api.github.com/users/mat-ale/gists{/gist_id}","starred_url":"https://api.github.com/users/mat-ale/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mat-ale/subscriptions","organizations_url":"https://api.github.com/users/mat-ale/orgs","repos_url":"https://api.github.com/users/mat-ale/repos","events_url":"https://api.github.com/users/mat-ale/events{/privacy}","received_events_url":"https://api.github.com/users/mat-ale/received_events","type":"User","site_admin":false},"parents":[{"sha":"597a57f1ae4e36f93ed2fd9258d901a171f4f81a","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/597a57f1ae4e36f93ed2fd9258d901a171f4f81a","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/597a57f1ae4e36f93ed2fd9258d901a171f4f81a"}],"stats":{"total":45,"additions":23,"deletions":22},"files":[{"sha":"2d7199ac0fdae9e4ffff81faf5b90d63e6c4e334","filename":"client/console/src/main/java/org/apache/syncope/client/console/panels/TogglePanel.java","status":"modified","additions":3,"deletions":2,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/1d11d9764bd56e2aef3986d95558305814206024/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FTogglePanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/1d11d9764bd56e2aef3986d95558305814206024/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FTogglePanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FTogglePanel.java?ref=1d11d9764bd56e2aef3986d95558305814206024","patch":"@@ -66,7 +66,7 @@\n     private static final long serialVersionUID = -2025535531121434056L;\n \n     protected static final Logger LOG = LoggerFactory.getLogger(TogglePanel.class);\n-    \n+\n     protected static final int HEADER_FIRST_ABBREVIATION = 25;\n \n     private enum Status {\n@@ -211,7 +211,8 @@ private String getTargetKey(final Serializable modelObject) {\n         } else if (modelObject instanceof EntityTO) {\n             key = ((EntityTO) modelObject).getKey();\n         } else if (modelObject instanceof StatusBean) {\n-            key = ((StatusBean) modelObject).getKey();\n+            key = StringUtils.isNotBlank(((StatusBean) modelObject).getResource())\n+                    ? ((StatusBean) modelObject).getResource() : ((StatusBean) modelObject).getKey();\n         } else if (modelObject instanceof PolicyRuleWrapper) {\n             key = ((PolicyRuleWrapper) modelObject).getConf().getName();\n         } else if (modelObject instanceof PolicyRuleWrapper) {"},{"sha":"b6d8634561fe9ee3d0bb1001db49e9f4609d0c8f","filename":"client/console/src/main/resources/META-INF/resources/js/copyToClipboard.js","status":"modified","additions":19,"deletions":19,"changes":38,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/1d11d9764bd56e2aef3986d95558305814206024/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fjs%2FcopyToClipboard.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/1d11d9764bd56e2aef3986d95558305814206024/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fjs%2FcopyToClipboard.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fjs%2FcopyToClipboard.js?ref=1d11d9764bd56e2aef3986d95558305814206024","patch":"@@ -16,50 +16,50 @@\n  * specific language governing permissions and limitations\n  * under the License.\n  */\n-// Copy to clipboard\n if (typeof copyToClipboard === 'undefined') {\n   copyToClipboard = function (element, tag_value_to_copy, fake_textarea_ID, feedback_selector) {\n-    // creating new textarea element and giveing it id 't'\n+    var $elem = $(element);\n+\n+    // creating new textarea element and giveing it an ID\n     var temp = document.createElement('textarea');\n     temp.id = fake_textarea_ID;\n+    temp.style.display = 'block';\n \n-    // Optional step to make less noise in the page, if any!\n+    // Make less noise in the page\n     temp.style.height = 0;\n \n-    // You have to append it to your page somewhere, I chose <body>\n+    // Append it to the page somewhere, in this case <body>\n     $(document.body).append(temp);\n \n-    // Copy whatever is in your div to our new textarea\n-    temp.value = $(element).attr(tag_value_to_copy);\n+    // Copy whatever is in the div to our new textarea\n+    temp.value = $elem.attr(tag_value_to_copy);\n \n-    // Now copy whatever inside the textarea to clipboard\n-    var selector = document.querySelector(\"#\" + fake_textarea_ID);\n-    selector.select();\n+    // Copy whatever inside the textarea to clipboard\n+    $(temp).focus().select();\n \n-    document.execCommand('copy');\n+    document.execCommand('SelectAll');\n+    document.execCommand(\"Copy\", false, null);\n \n     // Remove the textarea\n     $(temp).remove();\n \n-    $(feedback_selector).fadeIn();\n+    $elem.siblings(feedback_selector).fadeIn();\n \n-    // Remove Message of feedback\n-    setTimeout(function () {\n-      $(feedback_selector).fadeOut();\n+    // Remove feedback element\n+    window.setTimeout(function () {\n+      $elem.siblings(feedback_selector).fadeOut();\n     }, 1000);\n   };\n \n-  $(document).off('click', '.label-with-key:visible');\n-  $(document).on('click', '.label-with-key:visible', function (e) {\n+  function doCopyToClipboard(el) {\n     var feedback_selector = '.copy-clipboard-feedback';\n     var fake_textarea_selector = 'tttt';\n     var tag_value_to_copy = 'data-value';\n \n     if (!$(feedback_selector + \":visible\").length) {\n-      copyToClipboard(this, tag_value_to_copy, fake_textarea_selector, feedback_selector);\n+      copyToClipboard(el, tag_value_to_copy, fake_textarea_selector, feedback_selector);\n     }\n-    e.stopPropagation();\n-  });\n+  }\n }\n \n "},{"sha":"95a1b2299fbe767901d734640e4712f62e6a74aa","filename":"client/console/src/main/resources/org/apache/syncope/client/console/panels/TogglePanel.html","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/1d11d9764bd56e2aef3986d95558305814206024/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FTogglePanel.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/1d11d9764bd56e2aef3986d95558305814206024/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FTogglePanel.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fpanels%2FTogglePanel.html?ref=1d11d9764bd56e2aef3986d95558305814206024","patch":"@@ -119,7 +119,7 @@\n           <div class=\"copy-clipboard-feedback\" style=\"display: none\"> \n             <wicket:message key=\"copy_to_clipboard.feedback\"/>\n           </div>\n-          <label wicket:id=\"label\" class=\"label-with-key\"/>\n+          <label wicket:id=\"label\" class=\"label-with-key\" onclick=\"doCopyToClipboard(this)\"/>\n \n         </div>\n         <div class=\"close\">"}]}