{"sha":"bdb6a180dcae6f1baaff16619cb906b7292da0d1","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmJkYjZhMTgwZGNhZTZmMWJhYWZmMTY2MTljYjkwNmI3MjkyZGEwZDE=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2018-10-25T10:57:02Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2018-10-25T11:07:03Z"},"message":"Ensuring all XML input processing is safe - disable DTD and external entities","tree":{"sha":"936b0e1e6f237f85090350bf0427ea0b82642b40","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/936b0e1e6f237f85090350bf0427ea0b82642b40"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/bdb6a180dcae6f1baaff16619cb906b7292da0d1","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/bdb6a180dcae6f1baaff16619cb906b7292da0d1","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/bdb6a180dcae6f1baaff16619cb906b7292da0d1","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/bdb6a180dcae6f1baaff16619cb906b7292da0d1/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"6d285b20104369f1afcb85f162386b1eae827038","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/6d285b20104369f1afcb85f162386b1eae827038","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/6d285b20104369f1afcb85f162386b1eae827038"}],"stats":{"total":27,"additions":18,"deletions":9},"files":[{"sha":"95e6fd896997d9b09be31ec5206d31dd8d6fe874","filename":"client/console/src/main/java/org/apache/syncope/client/console/widgets/reconciliation/ReconciliationReportParser.java","status":"modified","additions":7,"deletions":2,"changes":9,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/bdb6a180dcae6f1baaff16619cb906b7292da0d1/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwidgets%2Freconciliation%2FReconciliationReportParser.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/bdb6a180dcae6f1baaff16619cb906b7292da0d1/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwidgets%2Freconciliation%2FReconciliationReportParser.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fconsole%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fconsole%2Fwidgets%2Freconciliation%2FReconciliationReportParser.java?ref=bdb6a180dcae6f1baaff16619cb906b7292da0d1","patch":"@@ -32,10 +32,15 @@\n \n public final class ReconciliationReportParser {\n \n-    private static final XMLInputFactory INPUT_FACTORY = XMLInputFactory.newInstance();\n+    private static final XMLInputFactory XML_INPUT_FACTORY = XMLInputFactory.newInstance();\n+\n+    static {\n+        XML_INPUT_FACTORY.setProperty(XMLInputFactory.IS_SUPPORTING_EXTERNAL_ENTITIES, Boolean.FALSE);\n+        XML_INPUT_FACTORY.setProperty(XMLInputFactory.SUPPORT_DTD, Boolean.FALSE);\n+    }\n \n     public static ReconciliationReport parse(final Date run, final InputStream in) throws XMLStreamException {\n-        XMLStreamReader streamReader = INPUT_FACTORY.createXMLStreamReader(in);\n+        XMLStreamReader streamReader = XML_INPUT_FACTORY.createXMLStreamReader(in);\n         streamReader.nextTag(); // root\n         streamReader.nextTag(); // report\n         streamReader.nextTag(); // reportlet"},{"sha":"115d02775f6c0adae39334fdfd310994d368c630","filename":"ext/flowable/flowable-bpmn/src/main/java/org/apache/syncope/core/flowable/impl/FlowableDeployUtils.java","status":"modified","additions":8,"deletions":1,"changes":9,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/bdb6a180dcae6f1baaff16619cb906b7292da0d1/ext%2Fflowable%2Fflowable-bpmn%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fflowable%2Fimpl%2FFlowableDeployUtils.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/bdb6a180dcae6f1baaff16619cb906b7292da0d1/ext%2Fflowable%2Fflowable-bpmn%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fflowable%2Fimpl%2FFlowableDeployUtils.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fflowable%2Fflowable-bpmn%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fflowable%2Fimpl%2FFlowableDeployUtils.java?ref=bdb6a180dcae6f1baaff16619cb906b7292da0d1","patch":"@@ -41,6 +41,13 @@ public final class FlowableDeployUtils {\n \n     private static final ObjectMapper OBJECT_MAPPER = new ObjectMapper();\n \n+    private static final XMLInputFactory XML_INPUT_FACTORY = XMLInputFactory.newInstance();\n+\n+    static {\n+        XML_INPUT_FACTORY.setProperty(XMLInputFactory.IS_SUPPORTING_EXTERNAL_ENTITIES, Boolean.FALSE);\n+        XML_INPUT_FACTORY.setProperty(XMLInputFactory.SUPPORT_DTD, Boolean.FALSE);\n+    }\n+\n     public static Deployment deployDefinition(\n             final ProcessEngine engine, final String resourceName, final byte[] definition) {\n \n@@ -58,7 +65,7 @@ public static void deployModel(final ProcessEngine engine, final ProcessDefiniti\n                 getResourceAsStream(procDef.getDeploymentId(), procDef.getResourceName());\n                 InputStreamReader isr = new InputStreamReader(bpmnStream)) {\n \n-            xtr = XMLInputFactory.newInstance().createXMLStreamReader(isr);\n+            xtr = XML_INPUT_FACTORY.createXMLStreamReader(isr);\n             BpmnModel bpmnModel = new BpmnXMLConverter().convertToBpmnModel(xtr);\n \n             Model model = engine.getRepositoryService().newModel();"},{"sha":"81b0fd82b152802cd74c8b376f7ba0947807cef8","filename":"ext/flowable/flowable-bpmn/src/main/java/org/apache/syncope/core/flowable/support/DomainProcessEngineFactoryBean.java","status":"modified","additions":3,"deletions":6,"changes":9,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/bdb6a180dcae6f1baaff16619cb906b7292da0d1/ext%2Fflowable%2Fflowable-bpmn%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fflowable%2Fsupport%2FDomainProcessEngineFactoryBean.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/bdb6a180dcae6f1baaff16619cb906b7292da0d1/ext%2Fflowable%2Fflowable-bpmn%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fflowable%2Fsupport%2FDomainProcessEngineFactoryBean.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/ext%2Fflowable%2Fflowable-bpmn%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fflowable%2Fsupport%2FDomainProcessEngineFactoryBean.java?ref=bdb6a180dcae6f1baaff16619cb906b7292da0d1","patch":"@@ -18,16 +18,14 @@\n  */\n package org.apache.syncope.core.flowable.support;\n \n-import java.util.ArrayList;\n+import java.util.Arrays;\n import java.util.HashMap;\n-import java.util.List;\n import java.util.Map;\n import javax.sql.DataSource;\n import org.apache.commons.lang3.StringUtils;\n import org.flowable.engine.ProcessEngine;\n import org.flowable.common.engine.impl.cfg.SpringBeanFactoryProxyMap;\n import org.flowable.common.engine.impl.interceptor.EngineConfigurationConstants;\n-import org.flowable.engine.form.AbstractFormType;\n import org.flowable.engine.impl.util.EngineServiceUtil;\n import org.flowable.idm.spring.SpringIdmEngineConfiguration;\n import org.flowable.spring.SpringExpressionManager;\n@@ -84,9 +82,8 @@ public DomainProcessEngine getObject() throws Exception {\n                                 EngineConfigurationConstants.KEY_IDM_ENGINE_CONFIG,\n                                 ctx.getBean(SpringIdmEngineConfiguration.class));\n                     }\n-                    List<AbstractFormType> customFormTypes = new ArrayList<>();\n-                    customFormTypes.add(new DropdownFormType(null));\n-                    conf.setCustomFormTypes(customFormTypes);\n+                    conf.setEnableSafeBpmnXml(true);\n+                    conf.setCustomFormTypes(Arrays.asList(new DropdownFormType(null)));\n \n                     engines.put(domain, conf.buildProcessEngine());\n                 }"}]}