{"sha":"b1846943b228878c898fd897c5588330ca41b389","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmIxODQ2OTQzYjIyODg3OGM4OThmZDg5N2M1NTg4MzMwY2E0MWIzODk=","commit":{"author":{"name":"Unknown","email":"unknown@apache.org","date":"2011-02-09T09:26:30Z"},"committer":{"name":"Unknown","email":"unknown@apache.org","date":"2011-02-09T09:26:30Z"},"message":"Now managing console logger levels as well\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/syncope/trunk@1246772 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"bb58586de81239c4ec4efe5fae81c31486a6ac01","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/bb58586de81239c4ec4efe5fae81c31486a6ac01"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/b1846943b228878c898fd897c5588330ca41b389","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/b1846943b228878c898fd897c5588330ca41b389","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/b1846943b228878c898fd897c5588330ca41b389","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/b1846943b228878c898fd897c5588330ca41b389/comments","author":null,"committer":null,"parents":[{"sha":"e66b4d776619fb97fc6a179de4fb337a55ea01ab","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/e66b4d776619fb97fc6a179de4fb337a55ea01ab","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/e66b4d776619fb97fc6a179de4fb337a55ea01ab"}],"stats":{"total":294,"additions":189,"deletions":105},"files":[{"sha":"89e0b5ddc94819962307054f110c9d9bbb5b6281","filename":"console/pom.xml","status":"modified","additions":9,"deletions":39,"changes":48,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b1846943b228878c898fd897c5588330ca41b389/console%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b1846943b228878c898fd897c5588330ca41b389/console%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fpom.xml?ref=b1846943b228878c898fd897c5588330ca41b389","patch":"@@ -31,8 +31,6 @@\n     <properties>\n         <hsqldb.version>2.0.0</hsqldb.version>\n \n-        <jetty.port>8080</jetty.port>\n-\n         <logfile>/var/tmp/syncope-console.log</logfile>\n         <logfile.test>/var/tmp/syncope-console-test.log</logfile.test>\n \n@@ -220,48 +218,11 @@\n                 </executions>\n             </plugin>\n \n-\n-            <plugin>\n-                <groupId>org.mortbay.jetty</groupId>\n-                <artifactId>maven-jetty-plugin</artifactId>\n-                <inherited>true</inherited>\n-                <configuration>\n-                    <stopKey>foo</stopKey>\n-                    <stopPort>9999</stopPort>\n-                    <connectors>\n-                        <connector implementation=\"org.mortbay.jetty.nio.SelectChannelConnector\">\n-                            <port>${jetty.port}</port>\n-                        </connector>\n-                    </connectors>\n-                </configuration>\n-                <executions>\n-                    <execution>\n-                        <id>start-jetty</id>\n-                        <phase>pre-integration-test</phase>\n-                        <goals>\n-                            <goal>run-war</goal>\n-                        </goals>\n-                        <configuration>\n-                            <scanIntervalSeconds>0</scanIntervalSeconds>\n-                            <daemon>true</daemon>\n-                        </configuration>\n-                    </execution>\n-                    <execution>\n-                        <id>stop-jetty</id>\n-                        <phase>post-integration-test</phase>\n-                        <goals>\n-                            <goal>stop</goal>\n-                        </goals>\n-                    </execution>\n-                </executions>\n-            </plugin>\n-\n             <plugin>\n                 <groupId>org.codehaus.cargo</groupId>\n                 <artifactId>cargo-maven2-plugin</artifactId>\n                 <inherited>true</inherited>\n                 <configuration>\n-                    <wait>false</wait>\n                     <container>\n                         <containerId>tomcat6x</containerId>\n                         <zipUrlInstaller>\n@@ -296,6 +257,12 @@\n                                     <context>syncope</context>\n                                 </properties>\n                             </deployable>\n+                            <deployable>\n+                                <location>${project.build.directory}/${project.build.finalName}.war</location>\n+                                <properties>\n+                                    <context>syncope-console</context>\n+                                </properties>\n+                            </deployable>\n                         </deployables>\n                     </configuration>\n                 </configuration>\n@@ -306,6 +273,9 @@\n                         <goals>\n                             <goal>start</goal>\n                         </goals>\n+                        <configuration>\n+                            <wait>false</wait>\n+                        </configuration>\n                     </execution>\n                     <execution>\n                         <id>stop-container</id>"},{"sha":"d34b3aeedc6d35dd54283cfc7c74c77060c35034","filename":"console/src/main/java/org/syncope/console/pages/Configuration.java","status":"modified","additions":132,"deletions":49,"changes":181,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b1846943b228878c898fd897c5588330ca41b389/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FConfiguration.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b1846943b228878c898fd897c5588330ca41b389/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FConfiguration.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FConfiguration.java?ref=b1846943b228878c898fd897c5588330ca41b389","patch":"@@ -14,6 +14,9 @@\n  */\n package org.syncope.console.pages;\n \n+import ch.qos.logback.classic.Level;\n+import ch.qos.logback.classic.Logger;\n+import ch.qos.logback.classic.LoggerContext;\n import java.io.Serializable;\n import java.io.UnsupportedEncodingException;\n import java.util.ArrayList;\n@@ -50,6 +53,7 @@\n import org.apache.wicket.model.Model;\n import org.apache.wicket.model.PropertyModel;\n import org.apache.wicket.spring.injection.annot.SpringBean;\n+import org.slf4j.LoggerFactory;\n import org.springframework.web.client.RestClientException;\n import org.syncope.client.to.ConfigurationTO;\n import org.syncope.client.to.LoggerTO;\n@@ -286,53 +290,29 @@ protected void onUpdate(AjaxRequestTarget target) {\n         add(paginatorForm);\n \n         // Logger stuff\n-        add(new PropertyListView<LoggerTO>(\n-                \"logger\", restClient.getAllLoggers()) {\n-\n-            @Override\n-            protected void populateItem(final ListItem<LoggerTO> item) {\n-                item.add(new Label(\"name\"));\n-\n-                DropDownChoice<LoggerLevel> level =\n-                        new DropDownChoice<LoggerLevel>(\"level\");\n-                level.setModel(new IModel<LoggerLevel>() {\n-\n-                    @Override\n-                    public LoggerLevel getObject() {\n-                        return LoggerLevel.valueOf(\n-                                item.getModelObject().getLevel());\n-                    }\n-\n-                    @Override\n-                    public void setObject(final LoggerLevel object) {\n-                        item.getModelObject().setLevel(object.toString());\n-                    }\n-\n-                    @Override\n-                    public void detach() {\n-                    }\n-                });\n-                level.setChoices(Arrays.asList(LoggerLevel.values()));\n-                level.setOutputMarkupId(true);\n-                level.add(new AjaxFormComponentUpdatingBehavior(\"onchange\") {\n-\n-                    @Override\n-                    protected void onUpdate(final AjaxRequestTarget target) {\n-                        if (restClient.setLoggerLevel(\n-                                item.getModelObject().getName(),\n-                                item.getModelObject().getLevel())) {\n-\n-                            info(getString(\"operation_succeded\"));\n-                        } else {\n-                            info(getString(\"operation_error\"));\n-\n-                        }\n-                        target.addComponent(feedbackPanel);\n-                    }\n-                });\n-                item.add(level);\n-            }\n-        });\n+        PropertyListView coreLoggerList =\n+                new LoggerPropertyList(null,\n+                \"corelogger\",\n+                restClient.getLoggers());\n+        WebMarkupContainer coreLoggerContainer =\n+                new WebMarkupContainer(\"coreLoggerContainer\");\n+        coreLoggerContainer.add(coreLoggerList);\n+        coreLoggerContainer.setOutputMarkupId(true);\n+        add(coreLoggerContainer);\n+\n+\n+        ConsoleLoggerController consoleLoggerController =\n+                new ConsoleLoggerController();\n+        PropertyListView consoleLoggerList =\n+                new LoggerPropertyList(\n+                consoleLoggerController,\n+                \"consolelogger\",\n+                consoleLoggerController.getLoggers());\n+        WebMarkupContainer consoleLoggerContainer =\n+                new WebMarkupContainer(\"consoleLoggerContainer\");\n+        consoleLoggerContainer.add(consoleLoggerList);\n+        consoleLoggerContainer.setOutputMarkupId(true);\n+        add(consoleLoggerContainer);\n     }\n \n     /**\n@@ -365,7 +345,8 @@ public void setOperationResult(boolean operationResult) {\n         this.operationResult = operationResult;\n     }\n \n-    class SyncopeConfProvider extends SortableDataProvider<ConfigurationTO> {\n+    private class SyncopeConfProvider\n+            extends SortableDataProvider<ConfigurationTO> {\n \n         private SortableDataProviderComparator comparator =\n                 new SortableDataProviderComparator();\n@@ -413,7 +394,7 @@ private List<ConfigurationTO> getAllConfigurations() {\n             return list;\n         }\n \n-        class SortableDataProviderComparator implements\n+        private class SortableDataProviderComparator implements\n                 Comparator<ConfigurationTO>, Serializable {\n \n             public int compare(final ConfigurationTO o1,\n@@ -450,4 +431,106 @@ enum LoggerLevel {\n         OFF, ERROR, WARN, INFO, DEBUG, TRACE, ALL\n \n     }\n+\n+    private class LoggerPropertyList extends PropertyListView<LoggerTO> {\n+\n+        private final ConsoleLoggerController consoleLoggerController;\n+\n+        public LoggerPropertyList(\n+                final ConsoleLoggerController consoleLoggerController,\n+                final String id,\n+                final List<? extends LoggerTO> list) {\n+\n+            super(id, list);\n+            this.consoleLoggerController = consoleLoggerController;\n+        }\n+\n+        @Override\n+        protected void populateItem(final ListItem<LoggerTO> item) {\n+            item.add(new Label(\"name\"));\n+\n+            DropDownChoice<LoggerLevel> level =\n+                    new DropDownChoice<LoggerLevel>(\"level\");\n+            level.setModel(new IModel<LoggerLevel>() {\n+\n+                @Override\n+                public LoggerLevel getObject() {\n+                    return LoggerLevel.valueOf(\n+                            item.getModelObject().getLevel());\n+                }\n+\n+                @Override\n+                public void setObject(final LoggerLevel object) {\n+                    item.getModelObject().setLevel(object.toString());\n+                }\n+\n+                @Override\n+                public void detach() {\n+                }\n+            });\n+            level.setChoices(Arrays.asList(LoggerLevel.values()));\n+            level.setOutputMarkupId(true);\n+            level.add(new AjaxFormComponentUpdatingBehavior(\n+                    \"onchange\") {\n+\n+                @Override\n+                protected void onUpdate(final AjaxRequestTarget target) {\n+                    boolean result = getId().equals(\"corelogger\")\n+                            ? restClient.setLoggerLevel(\n+                            item.getModelObject().getName(),\n+                            item.getModelObject().getLevel())\n+                            : consoleLoggerController.setLoggerLevel(\n+                            item.getModelObject().getName(),\n+                            item.getModelObject().getLevel());\n+\n+                    if (result) {\n+                        info(getString(\"operation_succeded\"));\n+                    } else {\n+                        info(getString(\"operation_error\"));\n+\n+                    }\n+\n+                    target.addComponent(feedbackPanel);\n+                }\n+            });\n+\n+\n+\n+            item.add(level);\n+        }\n+    }\n+\n+    private class ConsoleLoggerController implements Serializable {\n+\n+        public List<LoggerTO> getLoggers() {\n+            LoggerContext lc =\n+                    (LoggerContext) LoggerFactory.getILoggerFactory();\n+            List<LoggerTO> result =\n+                    new ArrayList<LoggerTO>(lc.getLoggerList().size());\n+            LoggerTO loggerTO;\n+            for (Logger logger : lc.getLoggerList()) {\n+                if (logger.getLevel() != null) {\n+                    loggerTO = new LoggerTO();\n+                    loggerTO.setName(logger.getName());\n+                    loggerTO.setLevel(logger.getLevel().toString());\n+                    result.add(loggerTO);\n+                }\n+            }\n+\n+            return result;\n+        }\n+\n+        public boolean setLoggerLevel(final String name,\n+                final String level) {\n+\n+            LoggerContext lc =\n+                    (LoggerContext) LoggerFactory.getILoggerFactory();\n+            Logger logger = lc.getLogger(name);\n+            if (logger != null) {\n+                logger.setLevel(Level.valueOf(level));\n+            }\n+\n+            return logger != null;\n+        }\n+    }\n }"},{"sha":"caed9d3082914026e4b5dec359e1d95747874ab8","filename":"console/src/main/java/org/syncope/console/rest/ConfigurationRestClient.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b1846943b228878c898fd897c5588330ca41b389/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Frest%2FConfigurationRestClient.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b1846943b228878c898fd897c5588330ca41b389/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Frest%2FConfigurationRestClient.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Frest%2FConfigurationRestClient.java?ref=b1846943b228878c898fd897c5588330ca41b389","patch":"@@ -113,7 +113,7 @@ public void deleteConfiguration(String confKey)\n      * Get all loggers.\n      * @return LoggerTOs\n      */\n-    public List<LoggerTO> getAllLoggers()\n+    public List<LoggerTO> getLoggers()\n             throws SyncopeClientCompositeErrorException {\n \n         List<LoggerTO> loggers = Arrays.asList("},{"sha":"164e898e51c36bfdb9dd38b161b9bb3d606b477e","filename":"console/src/main/resources/org/syncope/console/pages/Configuration.html","status":"modified","additions":40,"deletions":13,"changes":53,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b1846943b228878c898fd897c5588330ca41b389/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FConfiguration.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b1846943b228878c898fd897c5588330ca41b389/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FConfiguration.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FConfiguration.html?ref=b1846943b228878c898fd897c5588330ca41b389","patch":"@@ -20,6 +20,7 @@\n                 <a href=\"#tabs-1\"><span><wicket:message key=\"tab1\"/></span></a>\n             </li>\n             <li><a href=\"#tabs-2\"><span><wicket:message key=\"tab2\"/></span></a></li>\n+            <li><a href=\"#tabs-3\"><span><wicket:message key=\"tab3\"/></span></a></li>\n         </ul>\n         <div id=\"tabs-1\">\n \n@@ -46,20 +47,46 @@\n             </a>\n         </div>\n         <div id=\"tabs-2\">\n-            <table>\n-                <thead>\n-                    <tr>\n-                        <th><wicket:message key=\"logger\"/></th>\n+\n+            <div id=\"users-contain\" class=\"ui-widget\" style=\"width:inherit\">\n+                <span wicket:id=\"coreLoggerContainer\">\n+                    <table class=\"ui-widget ui-widget-content table-hover\">\n+                        <thead class=\"ui-widget-header\">\n+                            <tr class=\"heaaders\">\n+                                <th><wicket:message key=\"logger\"/></th>\n+                        <th><wicket:message key=\"level\"/></th>\n+                        </tr>\n+                        </thead>\n+                        <tbody>\n+                            <tr wicket:id=\"corelogger\">\n+                                <td><span wicket:id=\"name\"/></td>\n+                                <td><select wicket:id=\"level\"/></td>\n+                            </tr>\n+                        </tbody>\n+                    </table>\n+                </span>\n+            </div>\n+        </div>\n+        <div id=\"tabs-3\">\n+\n+            <div id=\"users-contain\" class=\"ui-widget\" style=\"width:inherit\">\n+                <span wicket:id=\"consoleLoggerContainer\">\n+                    <table class=\"ui-widget ui-widget-content table-hover\">\n+                        <thead class=\"ui-widget-header\">\n+                            <tr class=\"heaaders\">\n+                                <th><wicket:message key=\"logger\"/></th>\n                         <th><wicket:message key=\"level\"/></th>\n-                    </tr>\n-                </thead>\n-                <tbody>\n-                    <tr wicket:id=\"logger\">\n-                        <td><span wicket:id=\"name\"/></td>\n-                        <td><select wicket:id=\"level\"/></td>\n-                    </tr>\n-                </tbody>\n-            </table>\n+                        </tr>\n+                        </thead>\n+                        <tbody>\n+                            <tr wicket:id=\"consolelogger\">\n+                                <td><span wicket:id=\"name\"/></td>\n+                                <td><select wicket:id=\"level\"/></td>\n+                            </tr>\n+                        </tbody>\n+                    </table>\n+                </span>\n+            </div>\n         </div>\n     </div>\n </wicket:extend>\n\\ No newline at end of file"},{"sha":"846b2793a133f200c6e777d98f86a6b2c6adabf5","filename":"console/src/main/resources/org/syncope/console/pages/Configuration.properties","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b1846943b228878c898fd897c5588330ca41b389/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FConfiguration.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b1846943b228878c898fd897c5588330ca41b389/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FConfiguration.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FConfiguration.properties?ref=b1846943b228878c898fd897c5588330ca41b389","patch":"@@ -1,7 +1,8 @@\n key=Key\n value=Value\n tab1=Parameters\n-tab2=Log\n+tab2=Core Log\n+tab3=Console Log\n edit=Edit\n delete=Delete\n create_configuration=Create new configuration"},{"sha":"701431c6e705570473df70408fb095b8d5483f96","filename":"console/src/main/resources/org/syncope/console/pages/Configuration_it.properties","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b1846943b228878c898fd897c5588330ca41b389/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FConfiguration_it.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b1846943b228878c898fd897c5588330ca41b389/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FConfiguration_it.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FConfiguration_it.properties?ref=b1846943b228878c898fd897c5588330ca41b389","patch":"@@ -1,7 +1,8 @@\n key=Chiave\n value=Valore\n tab1=Parametri\n-tab2=Log\n+tab2=Log Core\n+tab3=Log Console\n edit=Modifica\n delete=Elimina\n create_configuration=Crea nuova configurazione"},{"sha":"c835856f529fa5c83dabbcf9274bbce8cc012d41","filename":"core/pom.xml","status":"modified","additions":3,"deletions":1,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/b1846943b228878c898fd897c5588330ca41b389/core%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/b1846943b228878c898fd897c5588330ca41b389/core%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpom.xml?ref=b1846943b228878c898fd897c5588330ca41b389","patch":"@@ -437,7 +437,6 @@\n                 <artifactId>cargo-maven2-plugin</artifactId>\n                 <inherited>true</inherited>\n                 <configuration>\n-                    <wait>false</wait>\n                     <container>\n                         <containerId>tomcat6x</containerId>\n                         <zipUrlInstaller>\n@@ -485,6 +484,9 @@\n                         <goals>\n                             <goal>start</goal>\n                         </goals>\n+                        <configuration>\n+                            <wait>false</wait>\n+                        </configuration>\n                     </execution>\n                     <execution>\n                         <id>stop-container</id>"}]}