{"sha":"e073cc43225bbeb4c8ea670750b8f5a0829d6676","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmUwNzNjYzQzMjI1YmJlYjRjOGVhNjcwNzUwYjhmNWEwODI5ZDY2NzY=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2018-03-01T14:47:13Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2018-03-02T11:13:18Z"},"message":"Small improvements to build-tools, including Swagger","tree":{"sha":"c93c47609c8298eef0f31a4d2872ebd0305561bc","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/c93c47609c8298eef0f31a4d2872ebd0305561bc"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/e073cc43225bbeb4c8ea670750b8f5a0829d6676","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/e073cc43225bbeb4c8ea670750b8f5a0829d6676","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/e073cc43225bbeb4c8ea670750b8f5a0829d6676","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/e073cc43225bbeb4c8ea670750b8f5a0829d6676/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"d50562757b1f5e2c90294b763bac920025e208a7","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/d50562757b1f5e2c90294b763bac920025e208a7","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/d50562757b1f5e2c90294b763bac920025e208a7"}],"stats":{"total":58,"additions":54,"deletions":4},"files":[{"sha":"a4172e7f89b7440dc9d008e78e38c45271b4c483","filename":"fit/build-tools/pom.xml","status":"modified","additions":15,"deletions":1,"changes":16,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e073cc43225bbeb4c8ea670750b8f5a0829d6676/fit%2Fbuild-tools%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e073cc43225bbeb4c8ea670750b8f5a0829d6676/fit%2Fbuild-tools%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fbuild-tools%2Fpom.xml?ref=e073cc43225bbeb4c8ea670750b8f5a0829d6676","patch":"@@ -44,6 +44,11 @@ under the License.\n       <scope>provided</scope>\n     </dependency>\n     \n+    <dependency>\n+      <groupId>javax.validation</groupId>\n+      <artifactId>validation-api</artifactId>\n+    </dependency>\n+\n     <dependency>\n       <groupId>org.apache.directory.server</groupId>\n       <artifactId>apacheds-all</artifactId>\n@@ -88,12 +93,21 @@ under the License.\n     <dependency>\n       <groupId>org.apache.cxf</groupId>\n       <artifactId>cxf-rt-rs-service-description</artifactId>\n-    </dependency>    \n+    </dependency>\n+    <dependency>\n+      <groupId>org.apache.cxf</groupId>\n+      <artifactId>cxf-rt-rs-service-description-openapi-v3</artifactId>\n+    </dependency>\n     <dependency>\n       <groupId>com.fasterxml.jackson.jaxrs</groupId>\n       <artifactId>jackson-jaxrs-json-provider</artifactId>\n     </dependency>\n \n+    <dependency>\n+      <groupId>org.webjars</groupId>\n+      <artifactId>swagger-ui</artifactId>\n+    </dependency>\n+\n     <dependency>\n       <groupId>org.springframework</groupId>\n       <artifactId>spring-core</artifactId>"},{"sha":"f02cae4cf5df209adad27a079dd9a3c91b312e0a","filename":"fit/build-tools/src/main/java/org/apache/syncope/fit/buildtools/cxf/UserService.java","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e073cc43225bbeb4c8ea670750b8f5a0829d6676/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fbuildtools%2Fcxf%2FUserService.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e073cc43225bbeb4c8ea670750b8f5a0829d6676/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fbuildtools%2Fcxf%2FUserService.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fbuildtools%2Fcxf%2FUserService.java?ref=e073cc43225bbeb4c8ea670750b8f5a0829d6676","patch":"@@ -30,6 +30,7 @@\n import javax.ws.rs.Produces;\n import javax.ws.rs.QueryParam;\n import javax.ws.rs.core.MediaType;\n+import javax.ws.rs.core.Response;\n \n @Path(\"users\")\n public interface UserService {\n@@ -44,7 +45,7 @@ public interface UserService {\n \n     @POST\n     @Consumes({ MediaType.APPLICATION_JSON })\n-    void create(User user);\n+    Response create(User user);\n \n     @PUT\n     @Path(\"{key}\")"},{"sha":"6b0451589f3f381586ba6126a589299b821f12c0","filename":"fit/build-tools/src/main/java/org/apache/syncope/fit/buildtools/cxf/UserServiceImpl.java","status":"modified","additions":11,"deletions":2,"changes":13,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e073cc43225bbeb4c8ea670750b8f5a0829d6676/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fbuildtools%2Fcxf%2FUserServiceImpl.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e073cc43225bbeb4c8ea670750b8f5a0829d6676/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fbuildtools%2Fcxf%2FUserServiceImpl.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fbuildtools%2Fcxf%2FUserServiceImpl.java?ref=e073cc43225bbeb4c8ea670750b8f5a0829d6676","patch":"@@ -23,15 +23,22 @@\n import java.util.List;\n import java.util.Map;\n import java.util.UUID;\n+import javax.ws.rs.ClientErrorException;\n import javax.ws.rs.ForbiddenException;\n import javax.ws.rs.NotFoundException;\n+import javax.ws.rs.core.Context;\n+import javax.ws.rs.core.Response;\n+import javax.ws.rs.core.UriInfo;\n import org.springframework.stereotype.Service;\n \n @Service\n public class UserServiceImpl implements UserService {\n \n     private static final Map<UUID, User> USERS = new HashMap<UUID, User>();\n \n+    @Context\n+    private UriInfo uriInfo;\n+\n     @Override\n     public List<User> list() {\n         return new ArrayList<>(USERS.values());\n@@ -47,14 +54,16 @@ public User read(final UUID key) {\n     }\n \n     @Override\n-    public void create(final User user) {\n+    public Response create(final User user) {\n         if (user.getKey() == null) {\n             user.setKey(UUID.randomUUID());\n         }\n         if (USERS.containsKey(user.getKey())) {\n-            throw new IllegalArgumentException(\"User already exists: \" + user.getKey());\n+            throw new ClientErrorException(\"User already exists: \" + user.getKey(), Response.Status.CONFLICT);\n         }\n         USERS.put(user.getKey(), user);\n+\n+        return Response.created(uriInfo.getAbsolutePathBuilder().path(user.getKey().toString()).build()).build();\n     }\n \n     @Override"},{"sha":"6e7bd364d34051c484e97facb29ed7932d3c0b35","filename":"fit/build-tools/src/main/resources/META-INF/cxf/org.apache.cxf.Logger","status":"added","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e073cc43225bbeb4c8ea670750b8f5a0829d6676/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fcxf%2Forg.apache.cxf.Logger","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e073cc43225bbeb4c8ea670750b8f5a0829d6676/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fcxf%2Forg.apache.cxf.Logger","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fcxf%2Forg.apache.cxf.Logger?ref=e073cc43225bbeb4c8ea670750b8f5a0829d6676","patch":"@@ -0,0 +1 @@\n+org.apache.cxf.common.logging.Slf4jLogger"},{"sha":"7384e551d2ca51a783bc571fdc2d097374edcf7e","filename":"fit/build-tools/src/main/resources/cxfContext.xml","status":"modified","additions":25,"deletions":0,"changes":25,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e073cc43225bbeb4c8ea670750b8f5a0829d6676/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fresources%2FcxfContext.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e073cc43225bbeb4c8ea670750b8f5a0829d6676/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fresources%2FcxfContext.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fresources%2FcxfContext.xml?ref=e073cc43225bbeb4c8ea670750b8f5a0829d6676","patch":"@@ -38,13 +38,38 @@ under the License.\n       \n   <jaxws:endpoint id=\"soapProvisioning\" address=\"/soap\" implementor=\"#provisioningImpl\"/>\n   \n+  <bean id=\"openApiCustomizer\" class=\"org.apache.cxf.jaxrs.openapi.OpenApiCustomizer\">\n+    <property name=\"dynamicBasePath\" value=\"true\"/>\n+    <property name=\"replaceTags\" value=\"false\"/>\n+  </bean>\n+  <bean id=\"openapiFeature\" class=\"org.apache.cxf.jaxrs.openapi.OpenApiFeature\">\n+    <property name=\"title\" value=\"Apache Syncope FIT Build Tools\"/>\n+    <property name=\"version\" value=\"${syncope.version}\"/>\n+    <property name=\"description\" value=\"Apache Syncope ${syncope.version}\"/>    \n+    <property name=\"contactName\" value=\"The Apache Syncope community\"/>    \n+    <property name=\"contactEmail\" value=\"dev@syncope.apache.org\"/>    \n+    <property name=\"contactUrl\" value=\"http://syncope.apache.org\"/>    \n+    \n+    <property name=\"scan\" value=\"false\"/>    \n+    <property name=\"resourcePackages\">\n+      <set>\n+        <value>org.apache.syncope.fit.buildtools.cxf</value>\n+      </set>\n+    </property>\n+    \n+    <property name=\"customizer\" ref=\"openApiCustomizer\"/>\n+  </bean>\n+  \n   <bean id=\"jsonProvider\" class=\"com.fasterxml.jackson.jaxrs.json.JacksonJaxbJsonProvider\"/>\n   <jaxrs:server id=\"restProvisioning\" address=\"/rest\"\n                 basePackages=\"org.apache.syncope.fit.buildtools.cxf\" \n                 staticSubresourceResolution=\"true\">\n     <jaxrs:providers>\n       <ref bean=\"jsonProvider\"/>\n     </jaxrs:providers>\n+    <jaxrs:features>\n+      <ref bean=\"openapiFeature\"/>\n+    </jaxrs:features>\n   </jaxrs:server>\n \n </beans>"}]}