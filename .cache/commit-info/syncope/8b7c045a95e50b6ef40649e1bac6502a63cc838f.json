{"sha":"8b7c045a95e50b6ef40649e1bac6502a63cc838f","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjhiN2MwNDVhOTVlNTBiNmVmNDA2NDllMWJhYzY1MDJhNjNjYzgzOGY=","commit":{"author":{"name":"Misagh Moayyed","email":"mm1844@gmail.com","date":"2020-12-02T08:30:29Z"},"committer":{"name":"GitHub","email":"noreply@github.com","date":"2020-12-02T08:30:29Z"},"message":"Upgrade WA to use CAS v6.3.0-RC5 (#229)","tree":{"sha":"985f9587bb9b7400dd8c05040656c2e57db62cf9","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/985f9587bb9b7400dd8c05040656c2e57db62cf9"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/8b7c045a95e50b6ef40649e1bac6502a63cc838f","comment_count":0,"verification":{"verified":true,"reason":"valid","signature":"-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJfx1ClCRBK7hj4Ov3rIwAAdHIIAF+GzzWC/dYuZOV20twFikOi\njM5V0lyrNzn+Akek1Bg2KWkm7HOL+MKuQNIP+5oe8fYOwkeSXvfe9cU+wKCBemLk\ndZRfufhFPC33uHxEGHGe6up0rAgwuuCJeJkcj0NXHxq+FnaZ2jE0VjD9AR5/hRwi\nl6jH3qt+XjGTnjgjhfUsh0INk1CG61I0QTnn/fBUonvt61QDrYcW8flDwLtDY64N\ni1EB7u5bjDFh+Ri+/zsF28pla+48fI9fGEleLhyBK5vpm9UDfynzroOCzDZLSEkG\n9/WZyieiA+q9ebse05sxK08twYmXK9P7nBmh27QWnbgEk3HZELl0OPas1WRjW0s=\n=1XA0\n-----END PGP SIGNATURE-----\n","payload":"tree 985f9587bb9b7400dd8c05040656c2e57db62cf9\nparent 44db3ed2b914b7b2cedff8c34c7f2ef817e432a1\nauthor Misagh Moayyed <mm1844@gmail.com> 1606897829 +0400\ncommitter GitHub <noreply@github.com> 1606897829 +0330\n\nUpgrade WA to use CAS v6.3.0-RC5 (#229)\n\n"}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/8b7c045a95e50b6ef40649e1bac6502a63cc838f","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/8b7c045a95e50b6ef40649e1bac6502a63cc838f","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/8b7c045a95e50b6ef40649e1bac6502a63cc838f/comments","author":{"login":"mmoayyed","id":1205228,"node_id":"MDQ6VXNlcjEyMDUyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/1205228?v=4","gravatar_id":"","url":"https://api.github.com/users/mmoayyed","html_url":"https://github.com/mmoayyed","followers_url":"https://api.github.com/users/mmoayyed/followers","following_url":"https://api.github.com/users/mmoayyed/following{/other_user}","gists_url":"https://api.github.com/users/mmoayyed/gists{/gist_id}","starred_url":"https://api.github.com/users/mmoayyed/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mmoayyed/subscriptions","organizations_url":"https://api.github.com/users/mmoayyed/orgs","repos_url":"https://api.github.com/users/mmoayyed/repos","events_url":"https://api.github.com/users/mmoayyed/events{/privacy}","received_events_url":"https://api.github.com/users/mmoayyed/received_events","type":"User","site_admin":false},"committer":{"login":"web-flow","id":19864447,"node_id":"MDQ6VXNlcjE5ODY0NDQ3","avatar_url":"https://avatars.githubusercontent.com/u/19864447?v=4","gravatar_id":"","url":"https://api.github.com/users/web-flow","html_url":"https://github.com/web-flow","followers_url":"https://api.github.com/users/web-flow/followers","following_url":"https://api.github.com/users/web-flow/following{/other_user}","gists_url":"https://api.github.com/users/web-flow/gists{/gist_id}","starred_url":"https://api.github.com/users/web-flow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/web-flow/subscriptions","organizations_url":"https://api.github.com/users/web-flow/orgs","repos_url":"https://api.github.com/users/web-flow/repos","events_url":"https://api.github.com/users/web-flow/events{/privacy}","received_events_url":"https://api.github.com/users/web-flow/received_events","type":"User","site_admin":false},"parents":[{"sha":"44db3ed2b914b7b2cedff8c34c7f2ef817e432a1","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/44db3ed2b914b7b2cedff8c34c7f2ef817e432a1","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/44db3ed2b914b7b2cedff8c34c7f2ef817e432a1"}],"stats":{"total":37,"additions":30,"deletions":7},"files":[{"sha":"5fcd31707acb055a0fcfcdc3cceb0dcf571791db","filename":"pom.xml","status":"modified","additions":16,"deletions":2,"changes":18,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/8b7c045a95e50b6ef40649e1bac6502a63cc838f/pom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/8b7c045a95e50b6ef40649e1bac6502a63cc838f/pom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/pom.xml?ref=8b7c045a95e50b6ef40649e1bac6502a63cc838f","patch":"@@ -443,13 +443,16 @@ under the License.\n     <commons-jexl.version>3.1</commons-jexl.version>\n     <commons-lang.version>3.11</commons-lang.version>\n     <commons-text.version>1.9</commons-text.version>\n+    <commons-codec.version>1.15</commons-codec.version>\n     <commons-logging.version>1.1.3</commons-logging.version>\n-    \n+\n+    <okio.version>2.9.0</okio.version>\n+\n     <modernizer-maven.version>2.1.0</modernizer-maven.version>\n \n     <pac4j.version>4.2.0</pac4j.version>\n \n-    <cas.version>6.3.0-RC4</cas.version>\n+    <cas.version>6.3.0-RC5</cas.version>\n     <cas-client.version>3.6.2</cas-client.version>\n \n     <h2.version>1.4.200</h2.version>\n@@ -1096,6 +1099,17 @@ under the License.\n         <artifactId>commons-text</artifactId>\n         <version>${commons-text.version}</version>\n       </dependency>\n+      <dependency>\n+        <groupId>commons-codec</groupId>\n+        <artifactId>commons-codec</artifactId>\n+        <version>${commons-codec.version}</version>\n+      </dependency>\n+\n+      <dependency>\n+        <groupId>com.squareup.okio</groupId>\n+        <artifactId>okio</artifactId>\n+        <version>${okio.version}</version>\n+      </dependency>\n \n       <dependency>\n         <groupId>org.gaul</groupId>"},{"sha":"230847d551972e8f4f21b131a7d1cc5646d4f5f7","filename":"wa/starter/pom.xml","status":"modified","additions":8,"deletions":1,"changes":9,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/8b7c045a95e50b6ef40649e1bac6502a63cc838f/wa%2Fstarter%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/8b7c045a95e50b6ef40649e1bac6502a63cc838f/wa%2Fstarter%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fstarter%2Fpom.xml?ref=8b7c045a95e50b6ef40649e1bac6502a63cc838f","patch":"@@ -298,7 +298,14 @@ under the License.\n       <groupId>org.bouncycastle</groupId>\n       <artifactId>bcpkix-jdk15on</artifactId>\n     </dependency>\n-    \n+    <dependency>\n+      <groupId>commons-codec</groupId>\n+      <artifactId>commons-codec</artifactId>\n+    </dependency>\n+    <dependency>\n+      <groupId>com.squareup.okio</groupId>\n+      <artifactId>okio</artifactId>\n+    </dependency>\n     <dependency>\n       <groupId>org.apache.cxf</groupId>\n       <artifactId>cxf-rt-transports-http-jetty</artifactId>"},{"sha":"73b4309f4531a543764749d71ffcb0a032cbf507","filename":"wa/starter/src/main/java/org/apache/syncope/wa/starter/webauthn/SyncopeWAWebAuthnCredentialRepository.java","status":"modified","additions":6,"deletions":4,"changes":10,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/8b7c045a95e50b6ef40649e1bac6502a63cc838f/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fwebauthn%2FSyncopeWAWebAuthnCredentialRepository.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/8b7c045a95e50b6ef40649e1bac6502a63cc838f/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fwebauthn%2FSyncopeWAWebAuthnCredentialRepository.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fwebauthn%2FSyncopeWAWebAuthnCredentialRepository.java?ref=8b7c045a95e50b6ef40649e1bac6502a63cc838f","patch":"@@ -21,6 +21,7 @@\n \n import org.apereo.cas.configuration.CasConfigurationProperties;\n import org.apereo.cas.util.crypto.CipherExecutor;\n+import org.apereo.cas.webauthn.WebAuthnUtils;\n import org.apereo.cas.webauthn.storage.BaseWebAuthnCredentialRepository;\n \n import com.fasterxml.jackson.core.type.TypeReference;\n@@ -74,7 +75,7 @@ protected Stream<CredentialRegistration> load() {\n             flatMap(Collection::stream).\n             map(Unchecked.function(record -> {\n                 String json = getCipherExecutor().decode(record.getJson());\n-                return getObjectMapper().readValue(json, new TypeReference<>() {\n+                return WebAuthnUtils.getObjectMapper().readValue(json, new TypeReference<>() {\n                 });\n             }));\n     }\n@@ -84,7 +85,8 @@ protected void update(final String username, final Collection<CredentialRegistra\n         try {\n             List<WebAuthnDeviceCredential> devices = records.stream().\n                 map(Unchecked.function(record -> {\n-                    String json = getCipherExecutor().encode(getObjectMapper().writeValueAsString(record));\n+                    String json = getCipherExecutor().encode(WebAuthnUtils.getObjectMapper().\n+                        writeValueAsString(record));\n                     return new WebAuthnDeviceCredential.Builder().\n                         json(json).\n                         owner(username).\n@@ -118,8 +120,8 @@ public Collection<CredentialRegistration> getRegistrationsByUsername(final Strin\n                 return account.getRecords().stream().\n                     map(Unchecked.function(record -> {\n                         String json = getCipherExecutor().decode(record.getJson());\n-                        return getObjectMapper().readValue(json, new TypeReference<CredentialRegistration>() {\n-                        });\n+                        return WebAuthnUtils.getObjectMapper()\n+                            .readValue(json, new TypeReference<CredentialRegistration>() { });\n                     })).\n                     collect(Collectors.toList());\n             }"}]}