{"sha":"26354051408bf2d1b06076d7adc6cc941dd463c6","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjI2MzU0MDUxNDA4YmYyZDFiMDYwNzZkN2FkYzZjYzk0MWRkNDYzYzY=","commit":{"author":{"name":"Andrea Patricelli","email":"andreapatricelli@apache.org","date":"2017-04-13T09:02:37Z"},"committer":{"name":"Andrea Patricelli","email":"andreapatricelli@apache.org","date":"2017-04-13T09:04:22Z"},"message":"[SYNCOPE-1009] added documentation about customization of enduser form, minor code cleansing","tree":{"sha":"7fddde4afe4efa99ea49ba09ec0c2de4d19ca065","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/7fddde4afe4efa99ea49ba09ec0c2de4d19ca065"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/26354051408bf2d1b06076d7adc6cc941dd463c6","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/26354051408bf2d1b06076d7adc6cc941dd463c6","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/26354051408bf2d1b06076d7adc6cc941dd463c6","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/26354051408bf2d1b06076d7adc6cc941dd463c6/comments","author":{"login":"andrea-patricelli","id":3763111,"node_id":"MDQ6VXNlcjM3NjMxMTE=","avatar_url":"https://avatars.githubusercontent.com/u/3763111?v=4","gravatar_id":"","url":"https://api.github.com/users/andrea-patricelli","html_url":"https://github.com/andrea-patricelli","followers_url":"https://api.github.com/users/andrea-patricelli/followers","following_url":"https://api.github.com/users/andrea-patricelli/following{/other_user}","gists_url":"https://api.github.com/users/andrea-patricelli/gists{/gist_id}","starred_url":"https://api.github.com/users/andrea-patricelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrea-patricelli/subscriptions","organizations_url":"https://api.github.com/users/andrea-patricelli/orgs","repos_url":"https://api.github.com/users/andrea-patricelli/repos","events_url":"https://api.github.com/users/andrea-patricelli/events{/privacy}","received_events_url":"https://api.github.com/users/andrea-patricelli/received_events","type":"User","site_admin":false},"committer":{"login":"andrea-patricelli","id":3763111,"node_id":"MDQ6VXNlcjM3NjMxMTE=","avatar_url":"https://avatars.githubusercontent.com/u/3763111?v=4","gravatar_id":"","url":"https://api.github.com/users/andrea-patricelli","html_url":"https://github.com/andrea-patricelli","followers_url":"https://api.github.com/users/andrea-patricelli/followers","following_url":"https://api.github.com/users/andrea-patricelli/following{/other_user}","gists_url":"https://api.github.com/users/andrea-patricelli/gists{/gist_id}","starred_url":"https://api.github.com/users/andrea-patricelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/andrea-patricelli/subscriptions","organizations_url":"https://api.github.com/users/andrea-patricelli/orgs","repos_url":"https://api.github.com/users/andrea-patricelli/repos","events_url":"https://api.github.com/users/andrea-patricelli/events{/privacy}","received_events_url":"https://api.github.com/users/andrea-patricelli/received_events","type":"User","site_admin":false},"parents":[{"sha":"b398bcb60dd475053c1dac5440449d2ccddf3069","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/b398bcb60dd475053c1dac5440449d2ccddf3069","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/b398bcb60dd475053c1dac5440449d2ccddf3069"}],"stats":{"total":211,"additions":159,"deletions":52},"files":[{"sha":"21a79843c9e20599641c8ad5accea3a72452b979","filename":"client/enduser/src/main/resources/META-INF/resources/app/index.html","status":"modified","additions":0,"deletions":1,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/26354051408bf2d1b06076d7adc6cc941dd463c6/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Findex.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/26354051408bf2d1b06076d7adc6cc941dd463c6/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Findex.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Findex.html?ref=26354051408bf2d1b06076d7adc6cc941dd463c6","patch":"@@ -99,7 +99,6 @@\n   <script src=\"js/services/groupService.js\"></script>\n   <script src=\"js/services/anyService.js\"></script>\n   <script src=\"js/services/saml2IdPService.js\"></script>\n-  <script src=\"js/services/configurationService.js\"></script>\n   <!--controllers-->\n   <script src=\"js/controllers/HomeController.js\"></script>\n   <script src=\"js/controllers/LoginController.js\"></script>"},{"sha":"e74152451240ec8e15cb66631a8ef9384d79a88d","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/controllers/UserController.js","status":"modified","additions":0,"deletions":1,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/26354051408bf2d1b06076d7adc6cc941dd463c6/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/26354051408bf2d1b06076d7adc6cc941dd463c6/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js?ref=26354051408bf2d1b06076d7adc6cc941dd463c6","patch":"@@ -299,7 +299,6 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n           if ($scope.user.mustChangePassword) {\n             $location.path('/mustchangepassword');\n           } else {\n-//            initConfiguration();\n             initProperties();\n           }\n         }, function (e) {"},{"sha":"9e26dfeeb6e641a33dae4961196235bdb965b21b","filename":"client/enduser/src/test/resources/customForm.json","status":"modified","additions":1,"deletions":47,"changes":48,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/26354051408bf2d1b06076d7adc6cc941dd463c6/client%2Fenduser%2Fsrc%2Ftest%2Fresources%2FcustomForm.json","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/26354051408bf2d1b06076d7adc6cc941dd463c6/client%2Fenduser%2Fsrc%2Ftest%2Fresources%2FcustomForm.json","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Ftest%2Fresources%2FcustomForm.json?ref=26354051408bf2d1b06076d7adc6cc941dd463c6","patch":"@@ -1,47 +1 @@\n-{\n-  \"PLAIN\": \n-          {\n-            \"show\": true,\n-            \"attributes\": {\n-              \"firstname\": {\n-                \"readonly\": true,\n-                \"defaultValues\": [\"defaultFirstname\"]\n-              },\n-              \"surname\": {\n-                \"readonly\": false,\n-                \"defaultValues\": []\n-              },\n-              \"fullname\": {\n-                \"readonly\": false\n-              },\n-              \"loginDate\": {\n-                \"readonly\": false\n-              },\n-              \"additional#loginDate\": {\n-                \"readonly\": false\n-              },\n-              \"additional#ctype\": {\n-                \"readonly\": false,\n-                \"defaultValues\": [\"ctypeDefault\"]\n-              },\n-              \"additional#cool\": {\n-                \"readonly\": false,\n-                \"defaultValues\": [\"true\"]\n-              }\n-            }\n-          },\n-  \"DERIVED\":\n-          {\n-            \"show\": false\n-          },\n-  \"VIRTUAL\": \n-          {\n-            \"show\": true,\n-            \"attributes\": {\n-              \"virtualdata\": {\n-                \"readonly\": true,\n-                \"defaultValues\": [\"defaultVirtualData\"]\n-              }\n-            }\n-          }\n-}\n\\ No newline at end of file\n+{}\n\\ No newline at end of file"},{"sha":"ed72922f54fc50423632104657c2865ce66d9bbc","filename":"src/main/asciidoc/reference-guide/workingwithapachesyncope/customization.adoc","status":"modified","additions":158,"deletions":3,"changes":161,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/26354051408bf2d1b06076d7adc6cc941dd463c6/src%2Fmain%2Fasciidoc%2Freference-guide%2Fworkingwithapachesyncope%2Fcustomization.adoc","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/26354051408bf2d1b06076d7adc6cc941dd463c6/src%2Fmain%2Fasciidoc%2Freference-guide%2Fworkingwithapachesyncope%2Fcustomization.adoc","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/src%2Fmain%2Fasciidoc%2Freference-guide%2Fworkingwithapachesyncope%2Fcustomization.adoc?ref=26354051408bf2d1b06076d7adc6cc941dd463c6","patch":"@@ -110,6 +110,7 @@ $ mvn clean verify \\\n $ cp core/target/classes/*properties /opt/syncope/conf\n $ cp console/target/classes/*properties /opt/syncope/conf\n $ cp enduser/target/classes/*properties /opt/syncope/conf\n+$ cp enduser/target/classes/customForm.json /opt/syncope/conf\n ....\n \n After downloading all of the dependencies that are needed, three WAR files will be produced:\n@@ -404,10 +405,10 @@ Add the following dependencies to `enduser/pom.xml`:\n \n Copy `enduser/src/main/resources/all/saml2sp-agent.properties` to `enduser/src/main/resources/saml2sp-agent.properties`.\n \n-[[customization-enduser-translations]]\n-===== Translations\n+[[customization-enduser-i18n]]\n+===== i18n \n \n-The <<enduser-application>> comes with a native translation mechanism.\n+The <<enduser-application>> comes with a native internationalization mechanism.\n \n Under the `enduser/src/main/webapp/app/languages/` directory, a sub-directory for each supported language is available;\n each language sub-directory contains two JSON files:\n@@ -459,6 +460,160 @@ as\n and modify the JSON files under the new directory\n ====\n \n+===== Form customization\n+\n+User self create/edit form could be customized in order to:\n+\n+* Hide/show some attributes\n+* Deny/allow attribute write\n+\n+Under the `enduser/src/main/resources` directory you can find `customForm.json` file.\n+This specifies the rules about form customization, in particular it allows to customize `PLAIN`, `DERIVED` and `VIRTUAL`\n+attributes forms.\n+\n+[TIP]\n+====\n+The file provided with the archetype contains an empty json: `{}`.\n+If such file is deleted or contains empty or not parseable json, customization will be simply ignored and all attributes\n+will be shown.\n+====\n+\n+Here is an example:\n+\n+```\n+{\n+  \"PLAIN\": \n+          {\n+            \"show\": true,\n+            \"attributes\": {\n+              \"firstname\": {\n+                \"readonly\": true,\n+                \"defaultValues\": [\"defaultFirstname1\", \"defaultFirstname2\"]\n+              },\n+              \"surname\": {\n+                \"readonly\": false,\n+                \"defaultValues\": []\n+              },\n+              \"fullname\": {\n+                \"readonly\": false\n+              },\n+              \"email\": {\n+                \"readonly\": false,\n+                \"defaultValues\": [\"test@apache.org\"]\n+              },\n+              \"userId\": {\n+                \"readonly\": false\n+              },\n+              \"cool\": {\n+                \"readonly\": true,\n+                \"defaultValues\": [\"true\"]\n+              },\n+              \"additional#loginDate\": {\n+                \"readonly\": false\n+              },\n+              \"additional#cool\": {\n+                \"readonly\": false,\n+                \"defaultValues\": [\"true\"]\n+              }\n+            }\n+          },\n+  \"DERIVED\":\n+          {\n+            \"show\": false\n+          },\n+  \"VIRTUAL\": \n+          {\n+            \"show\": true,\n+            \"attributes\": {\n+              \"virtualdata\": {\n+                \"readonly\": true,\n+                \"defaultValues\": [\"defaultVirtualData\"]\n+              }\n+            }\n+          }\n+}\n+```\n+As you can see the file has two main levels:\n+\n+* Schema type: `PLAIN`, `DERIVED`, `VIRTUAL`.\n+* Attributes: list of attributes (by schema type) to be shown in the form.\n+\n+====== Schema type\n+\n+The schema type level allows to define customization of the three sub-forms available in the wizard.\n+An user can specify one or each of the three sections in order to customize only what is really needed.\n+Though enable/disable of schema forms can be configured also from the `app.js` file of the enduser, form customization\n+json provides an attribute `show` to hide/show attributes input fields.\n+If `show` is set to `false` info contained into `attributes` will be ignored and nothing is displayed in the form section.\n+\n+====== Attributes\n+\n+Attributes level contains a map of attributes to show.\n+\n+[TIP]\n+====\n+Attributes map is meant to be populated, i.e. empty `attributes` field means \"do not filter at all and show all attributes\".\n+For example:\n+```\n+{\n+  \"PLAIN\": \n+          {\n+            \"show\": true,\n+            \"attributes\": {}\n+          }\n+}\n+```\n+shows all attributes.\n+If you want to hide all attributes please use `show` field: `show: false`.\n+====\n+\n+As you can see from the sample json each attribute has:\n+\n+* A name: the name of schema from which the attribute has been generated.\n+* A body: specifies if attribute should be readonly and its default values.\n+\n+Here is an example of attribute specification:\n+\n+```\n+\"firstname\": {\n+                \"readonly\": true,\n+                \"defaultValues\": [\"defaultFirstname\",\"defaultFirstname2\"]\n+              }\n+```\n+In the example `firstname` is readonly and has two default values defined by a (comma separated) array of strings. \n+Default values section can be omitted if there are not default values to assign to that attribute.\n+\n+[CAUTION]\n+====\n+There are some clarifications to be made about form customization:\n+\n+* Default value of `show` (about schema sections) is `true`, i.e. if not specified the section is visible.\n+* `readonly` field must not be confused with schema `readonly` information. In form customization `readonly` \n+means a front-end readonly, i.e. the attribute is not modifiable from the enduser, but it can be fully accessible \n+from the administration console. \n+It does not provide info about the schema, but about the specific attribute of the USER.\n+* If `readonly` is not specified it is considered `false` by default.\n+* `defaultValues` is an array of strings; this means that also date values should be specified as strings, in particular\n+in dates must be provided into timestamp format in milliseconds (this behavior will be improved further).\n+* `defaultValues` (obviously) do not averride populated fields, an attribute is filled with default values \n+only if it is empty (in create and update).\n+====\n+\n+====== Hot deploy\n+\n+Form customization supports \"hot deploy\" feature. This means that `customForm.json` could be edited and reloaded \n+without stopping and re-starting the application server.\n+Obviously to see \"hot\" modifications to the form you must refresh the page of the browser.\n+\n+[TIP]\n+====\n+When running Syncope into embedded mode you should edit `fit/enduser-reference/target/test-classes/customForm.json`\n+file.\n+\n+While running, instead, Syncope in a real environment you should edit the file under `conf.directory`. Please refer to <<deployment-directories>> section. \n+====\n+\n+\n [[customization-extensions]]\n ==== Extensions\n "}]}