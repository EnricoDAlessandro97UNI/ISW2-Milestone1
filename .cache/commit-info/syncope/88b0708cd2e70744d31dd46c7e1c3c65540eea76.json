{"sha":"88b0708cd2e70744d31dd46c7e1c3c65540eea76","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjg4YjA3MDhjZDJlNzA3NDRkMzFkZDQ2YzdlMWMzYzY1NTQwZWVhNzY=","commit":{"author":{"name":"Unknown","email":"unknown@apache.org","date":"2011-03-24T16:23:50Z"},"committer":{"name":"Unknown","email":"unknown@apache.org","date":"2011-03-24T16:23:50Z"},"message":"more enhancements to Users usability\n\ngit-svn-id: https://svn.apache.org/repos/asf/incubator/syncope/trunk@1246818 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"c238f766a2057a8afb9547e29881a24efb921ac0","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/c238f766a2057a8afb9547e29881a24efb921ac0"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/88b0708cd2e70744d31dd46c7e1c3c65540eea76","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/88b0708cd2e70744d31dd46c7e1c3c65540eea76","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/88b0708cd2e70744d31dd46c7e1c3c65540eea76","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/88b0708cd2e70744d31dd46c7e1c3c65540eea76/comments","author":null,"committer":null,"parents":[{"sha":"323ce79b01ca6e99eaf79084c6c365ae13f99c47","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/323ce79b01ca6e99eaf79084c6c365ae13f99c47","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/323ce79b01ca6e99eaf79084c6c365ae13f99c47"}],"stats":{"total":89,"additions":49,"deletions":40},"files":[{"sha":"c381b226a6be6bc83ea940ba9fb5c474e89aab31","filename":"console/src/main/java/org/syncope/console/pages/DerivedSchemaModalPage.java","status":"modified","additions":2,"deletions":4,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/88b0708cd2e70744d31dd46c7e1c3c65540eea76/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FDerivedSchemaModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/88b0708cd2e70744d31dd46c7e1c3c65540eea76/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FDerivedSchemaModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FDerivedSchemaModalPage.java?ref=88b0708cd2e70744d31dd46c7e1c3c65540eea76","patch":"@@ -50,7 +50,7 @@ public enum Entity {\n     @SpringBean\n     private SchemaRestClient restClient;\n \n-    public DerivedSchemaModalPage(final BasePage basePage,\n+    public DerivedSchemaModalPage(final Schema basePage,\n             final ModalWindow window,\n             DerivedSchemaTO schema,\n             final boolean createFlag) {\n@@ -86,7 +86,6 @@ protected void onSubmit(AjaxRequestTarget target, Form form) {\n                                 (DerivedSchemaTO) form.getDefaultModelObject());\n                     }\n                 } else if (getEntity() == Entity.ROLE) {\n-\n                     if (createFlag) {\n                         restClient.createRoleDerivedSchema(\n                                 (DerivedSchemaTO) form.getDefaultModelObject());\n@@ -95,7 +94,6 @@ protected void onSubmit(AjaxRequestTarget target, Form form) {\n                                 (DerivedSchemaTO) form.getDefaultModelObject());\n                     }\n                 } else if (getEntity() == Entity.MEMBERSHIP) {\n-\n                     if (createFlag) {\n                         restClient.createMembershipDerivedSchema(\n                                 (DerivedSchemaTO) form.getDefaultModelObject());\n@@ -104,7 +102,7 @@ protected void onSubmit(AjaxRequestTarget target, Form form) {\n                                 (DerivedSchemaTO) form.getDefaultModelObject());\n                     }\n                 }\n-                ((Schema) basePage).setOperationResult(true);\n+                basePage.setOperationResult(true);\n \n                 window.close(target);\n             }"},{"sha":"7476c0b7ddc32a06d42b44b9f9c8e629983b6cad","filename":"console/src/main/java/org/syncope/console/pages/DisplayAttributesModalPage.java","status":"modified","additions":8,"deletions":26,"changes":34,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/88b0708cd2e70744d31dd46c7e1c3c65540eea76/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FDisplayAttributesModalPage.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/88b0708cd2e70744d31dd46c7e1c3c65540eea76/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FDisplayAttributesModalPage.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FDisplayAttributesModalPage.java?ref=88b0708cd2e70744d31dd46c7e1c3c65540eea76","patch":"@@ -18,20 +18,17 @@\n \n import java.util.List;\n import org.apache.wicket.ajax.AjaxRequestTarget;\n-import org.apache.wicket.ajax.markup.html.form.AjaxButton;\n import org.apache.wicket.extensions.ajax.markup.html.IndicatingAjaxButton;\n import org.apache.wicket.extensions.ajax.markup.html.modal.ModalWindow;\n import org.apache.wicket.markup.html.form.CheckBoxMultipleChoice;\n import org.apache.wicket.markup.html.form.Form;\n import org.apache.wicket.model.CompoundPropertyModel;\n import org.apache.wicket.model.IModel;\n-import org.apache.wicket.model.LoadableDetachableModel;\n import org.apache.wicket.model.Model;\n import org.apache.wicket.model.PropertyModel;\n import org.apache.wicket.spring.injection.annot.SpringBean;\n import org.syncope.console.commons.Constants;\n import org.syncope.console.commons.PreferenceManager;\n-import org.syncope.console.rest.SchemaRestClient;\n \n /**\n  * Modal window with Display attributes form.\n@@ -41,46 +38,31 @@ public class DisplayAttributesModalPage extends BaseModalPage {\n     @SpringBean\n     private PreferenceManager prefMan;\n \n-    @SpringBean\n-    private SchemaRestClient schemaRestClient;\n-\n-    private List<String> selections;\n-\n-    public AjaxButton submit;\n+    private final List<String> selectedSchemas;\n \n     public DisplayAttributesModalPage(final Users basePage,\n+            final IModel<List<String>> schemaNames,\n             final ModalWindow window) {\n \n         super();\n \n         Form userAttributesForm = new Form(\"UserAttributesForm\");\n         userAttributesForm.setModel(new CompoundPropertyModel(this));\n-        selections = prefMan.getList(getWebRequestCycle().getWebRequest(),\n+        selectedSchemas = prefMan.getList(getWebRequestCycle().getWebRequest(),\n                 Constants.PREF_USERS_ATTRIBUTES_VIEW);\n \n-        final IModel attributes = new LoadableDetachableModel() {\n-\n-            @Override\n-            protected Object load() {\n-                return schemaRestClient.getAllUserSchemasNames();\n-            }\n-        };\n-\n-        userAttributesForm.add(new CheckBoxMultipleChoice(\"usersSchemasList\",\n-                new PropertyModel(this, \"selections\"), attributes));\n-\n-        submit = new IndicatingAjaxButton(\"submit\", new Model(\n-                getString(\"submit\"))) {\n+        userAttributesForm.add(new CheckBoxMultipleChoice(\"schemaNames\",\n+                new PropertyModel(this, \"selectedSchemas\"), schemaNames));\n+        IndicatingAjaxButton submit = new IndicatingAjaxButton(\"submit\",\n+                new Model(getString(\"submit\"))) {\n \n             @Override\n             protected void onSubmit(final AjaxRequestTarget target,\n                     final Form form) {\n \n                 prefMan.setList(getWebRequest(),\n                         getWebRequestCycle().getWebResponse(),\n-                        Constants.PREF_USERS_ATTRIBUTES_VIEW,\n-                        selections);\n-\n+                        Constants.PREF_USERS_ATTRIBUTES_VIEW, selectedSchemas);\n                 basePage.setModalResult(true);\n                 window.close(target);\n             }"},{"sha":"ac385a3f6cb6e84d78eff2dc696be08de83ce0d6","filename":"console/src/main/java/org/syncope/console/pages/Roles.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/88b0708cd2e70744d31dd46c7e1c3c65540eea76/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FRoles.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/88b0708cd2e70744d31dd46c7e1c3c65540eea76/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FRoles.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FRoles.java?ref=88b0708cd2e70744d31dd46c7e1c3c65540eea76","patch":"@@ -103,7 +103,7 @@ public void onClose(final AjaxRequestTarget target) {\n                             getSession().info(getString(\"operation_succeded\"));\n                         }\n \n-                        setResponsePage(new Roles(null));\n+                        setResponsePage(Roles.class);\n                     }\n                 });\n     }"},{"sha":"875e69d4e7c776d96144263d2f24f27a6cb6461f","filename":"console/src/main/java/org/syncope/console/pages/Users.java","status":"modified","additions":37,"deletions":8,"changes":45,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/88b0708cd2e70744d31dd46c7e1c3c65540eea76/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUsers.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/88b0708cd2e70744d31dd46c7e1c3c65540eea76/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUsers.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fsyncope%2Fconsole%2Fpages%2FUsers.java?ref=88b0708cd2e70744d31dd46c7e1c3c65540eea76","patch":"@@ -35,6 +35,8 @@\n import org.apache.wicket.extensions.markup.html.repeater.data.table.IColumn;\n import org.apache.wicket.extensions.markup.html.repeater.data.table.PropertyColumn;\n import org.apache.wicket.extensions.markup.html.repeater.util.SortableDataProvider;\n+import org.apache.wicket.feedback.FeedbackMessage;\n+import org.apache.wicket.feedback.IFeedbackMessageFilter;\n import org.apache.wicket.markup.html.WebMarkupContainer;\n import org.apache.wicket.markup.html.basic.Label;\n import org.apache.wicket.markup.html.form.CheckBox;\n@@ -242,7 +244,8 @@ public void onClick(final AjaxRequestTarget target) {\n                             @Override\n                             public Page createPage() {\n                                 return new DisplayAttributesModalPage(\n-                                        Users.this, displayAttrsModalWin);\n+                                        Users.this, schemaNames,\n+                                        displayAttrsModalWin);\n                             }\n                         });\n \n@@ -277,11 +280,31 @@ protected void onUpdate(final AjaxRequestTarget target) {\n         paginatorForm.add(rowsChooser);\n \n         // search form\n-        Form searchForm = new Form(\"searchForm\");\n+        final Form searchForm = new Form(\"searchForm\");\n         add(searchForm);\n \n-        searchForm.add(new FeedbackPanel(\"searchFeedback\").setOutputMarkupId(\n-                true));\n+        FeedbackPanel searchFeedback = new FeedbackPanel(\"searchFeedback\",\n+                new IFeedbackMessageFilter() {\n+\n+                    @Override\n+                    public boolean accept(final FeedbackMessage message) {\n+                        boolean result;\n+\n+                        // messages reported on the session have a null reporter\n+                        if (message.getReporter() != null) {\n+                            // only accept messages coming from the children\n+                            // of the form\n+                            result = searchForm.contains(message.getReporter(),\n+                                    true);\n+                        } else {\n+                            result = false;\n+                        }\n+\n+                        return result;\n+                    }\n+                });\n+        searchFeedback.setOutputMarkupId(true);\n+        searchForm.add(searchFeedback);\n \n         final WebMarkupContainer searchFormContainer =\n                 new WebMarkupContainer(\"searchFormContainer\");\n@@ -353,6 +376,13 @@ public void onClose(final AjaxRequestTarget target) {\n                         if (modalResult) {\n                             info(getString(\"operation_succeded\"));\n \n+                            getPage().getPageParameters().put(\n+                                    searchResultTable.getId()\n+                                    + Constants.PAGEPARAM_CURRENT_PAGE,\n+                                    searchResultTable.getCurrentPage());\n+                            setResponsePage(Users.class,\n+                                    getPage().getPageParameters());\n+\n                             target.addComponent(feedbackPanel);\n \n                             modalResult = false;\n@@ -415,12 +445,11 @@ public void onClose(final AjaxRequestTarget target) {\n                         if (modalResult) {\n                             getSession().info(getString(\"operation_succeded\"));\n \n-                            PageParameters params =\n-                                    getPage().getPageParameters();\n-                            params.put(table.getId()\n+                            getPage().getPageParameters().put(table.getId()\n                                     + Constants.PAGEPARAM_CURRENT_PAGE,\n                                     table.getCurrentPage());\n-                            setResponsePage(Users.class, params);\n+                            setResponsePage(Users.class,\n+                                    getPage().getPageParameters());\n \n                             target.addComponent(feedbackPanel);\n "},{"sha":"c78f0e40aa7b0c56b54c7ba4a7a49d3b76c95205","filename":"console/src/main/resources/org/syncope/console/pages/DisplayAttributesModalPage.html","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/88b0708cd2e70744d31dd46c7e1c3c65540eea76/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FDisplayAttributesModalPage.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/88b0708cd2e70744d31dd46c7e1c3c65540eea76/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FDisplayAttributesModalPage.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fsyncope%2Fconsole%2Fpages%2FDisplayAttributesModalPage.html?ref=88b0708cd2e70744d31dd46c7e1c3c65540eea76","patch":"@@ -19,7 +19,7 @@\n             <wicket:message key=\"title\"/>\n             </p>\n \n-            <span wicket:id=\"usersSchemasList\"/>\n+            <span wicket:id=\"schemaNames\"/>\n \n         </div>\n         <input type=\"submit\" class=\"ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only\" wicket:id=\"submit\"/>"}]}