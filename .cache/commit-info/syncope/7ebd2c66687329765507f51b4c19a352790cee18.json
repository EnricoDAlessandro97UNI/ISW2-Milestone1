{"sha":"7ebd2c66687329765507f51b4c19a352790cee18","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjdlYmQyYzY2Njg3MzI5NzY1NTA3ZjUxYjRjMTlhMzUyNzkwY2VlMTg=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2020-03-24T09:29:39Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2020-03-30T08:26:35Z"},"message":"Initial steps to enable Payara Server 5","tree":{"sha":"b44d2dadc2dc63e93ce2cab36c2a05e30142529c","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/b44d2dadc2dc63e93ce2cab36c2a05e30142529c"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/7ebd2c66687329765507f51b4c19a352790cee18","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/7ebd2c66687329765507f51b4c19a352790cee18","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/7ebd2c66687329765507f51b4c19a352790cee18","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/7ebd2c66687329765507f51b4c19a352790cee18/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"901608cce1e49223a538551de718402a7734334a","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/901608cce1e49223a538551de718402a7734334a","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/901608cce1e49223a538551de718402a7734334a"}],"stats":{"total":48,"additions":24,"deletions":24},"files":[{"sha":"e82f294e24e6e6f536aa44c0646461a4d275056c","filename":"core/spring/src/main/java/org/apache/syncope/core/spring/security/JWTAuthenticationFilter.java","status":"modified","additions":5,"deletions":10,"changes":15,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7ebd2c66687329765507f51b4c19a352790cee18/core%2Fspring%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fspring%2Fsecurity%2FJWTAuthenticationFilter.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7ebd2c66687329765507f51b4c19a352790cee18/core%2Fspring%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fspring%2Fsecurity%2FJWTAuthenticationFilter.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fspring%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fspring%2Fsecurity%2FJWTAuthenticationFilter.java?ref=7ebd2c66687329765507f51b4c19a352790cee18","patch":"@@ -20,7 +20,6 @@\n \n import java.io.IOException;\n import java.util.Optional;\n-\n import javax.servlet.FilterChain;\n import javax.servlet.ServletException;\n import javax.servlet.http.HttpServletRequest;\n@@ -33,25 +32,22 @@\n import org.springframework.beans.factory.annotation.Autowired;\n import org.springframework.security.authentication.AuthenticationManager;\n import org.springframework.security.authentication.BadCredentialsException;\n-import org.springframework.security.core.Authentication;\n import org.springframework.security.core.AuthenticationException;\n import org.springframework.security.core.context.SecurityContextHolder;\n import org.springframework.security.web.AuthenticationEntryPoint;\n-import org.springframework.web.filter.OncePerRequestFilter;\n+import org.springframework.security.web.authentication.www.BasicAuthenticationFilter;\n \n /**\n  * Processes the JSON Web Token provided as {@link HttpHeaders#AUTHORIZATION} HTTP header, putting the result into the\n  * {@link SecurityContextHolder}.\n  */\n-public class JWTAuthenticationFilter extends OncePerRequestFilter {\n+public class JWTAuthenticationFilter extends BasicAuthenticationFilter {\n \n     private static final Logger LOG = LoggerFactory.getLogger(JWTAuthenticationFilter.class);\n \n     @Autowired\n     private AuthenticationEntryPoint authenticationEntryPoint;\n \n-    private AuthenticationManager authenticationManager;\n-\n     @Autowired\n     private SyncopeAuthenticationDetailsSource authenticationDetailsSource;\n \n@@ -61,8 +57,8 @@ public class JWTAuthenticationFilter extends OncePerRequestFilter {\n     @Autowired\n     private DefaultCredentialChecker credentialChecker;\n \n-    public void setAuthenticationManager(final AuthenticationManager authenticationManager) {\n-        this.authenticationManager = authenticationManager;\n+    public JWTAuthenticationFilter(final AuthenticationManager authenticationManager) {\n+        super(authenticationManager);\n     }\n \n     @Override\n@@ -91,9 +87,8 @@ protected void doFilterInternal(\n                 throw new BadCredentialsException(\"Invalid signature found in JWT\");\n             }\n \n-            Authentication authentication = authenticationManager.authenticate(\n+            SecurityContextHolder.getContext().setAuthentication(\n                     new JWTAuthentication(consumer.getJwtClaims(), authenticationDetailsSource.buildDetails(request)));\n-            SecurityContextHolder.getContext().setAuthentication(authentication);\n \n             chain.doFilter(request, response);\n         } catch (JwsException e) {"},{"sha":"05dfc94831bca637a14c58021d2a1c27d1bdea33","filename":"core/spring/src/main/java/org/apache/syncope/core/spring/security/WebSecurityContext.java","status":"modified","additions":1,"deletions":3,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7ebd2c66687329765507f51b4c19a352790cee18/core%2Fspring%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fspring%2Fsecurity%2FWebSecurityContext.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7ebd2c66687329765507f51b4c19a352790cee18/core%2Fspring%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fspring%2Fsecurity%2FWebSecurityContext.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fspring%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fspring%2Fsecurity%2FWebSecurityContext.java?ref=7ebd2c66687329765507f51b4c19a352790cee18","patch":"@@ -110,9 +110,7 @@ public AccessDeniedHandler accessDeniedHandler() {\n \n     @Bean\n     public JWTAuthenticationFilter jwtAuthenticationFilter() throws Exception {\n-        JWTAuthenticationFilter jwtAuthenticationFilter = new JWTAuthenticationFilter();\n-        jwtAuthenticationFilter.setAuthenticationManager(authenticationManager());\n-        return jwtAuthenticationFilter;\n+        return new JWTAuthenticationFilter(authenticationManager());\n     }\n \n     @Bean"},{"sha":"fe10e452fba64c931c7f49f776faf6ede346ded2","filename":"fit/build-tools/pom.xml","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7ebd2c66687329765507f51b4c19a352790cee18/fit%2Fbuild-tools%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7ebd2c66687329765507f51b4c19a352790cee18/fit%2Fbuild-tools%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fbuild-tools%2Fpom.xml?ref=7ebd2c66687329765507f51b4c19a352790cee18","patch":"@@ -363,7 +363,7 @@ under the License.\n       <dependencies>\n         <dependency>\n           <groupId>org.glassfish</groupId>\n-          <artifactId>javax.faces</artifactId>\n+          <artifactId>jakarta.faces</artifactId>\n           <version>${javax.faces.version}</version>\n         </dependency>\n \n@@ -401,6 +401,7 @@ under the License.\n               </container>\n               <configuration>\n                 <properties>\n+                  <cargo.glassfish.removeDefaultDatasource>false</cargo.glassfish.removeDefaultDatasource>\n                   <cargo.jvmargs>-Xdebug -Djaxb.debug=true -Xrunjdwp:transport=dt_socket,address=8000,server=y,suspend=n\n                     -XX:+CMSClassUnloadingEnabled</cargo.jvmargs>\n                 </properties>"},{"sha":"01ee06417c0b39c1a74c93478dc768cae85646db","filename":"fit/build-tools/src/main/webapp/WEB-INF/payara-web.xml","status":"renamed","additions":4,"deletions":4,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7ebd2c66687329765507f51b4c19a352790cee18/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fpayara-web.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7ebd2c66687329765507f51b4c19a352790cee18/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fpayara-web.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fpayara-web.xml?ref=7ebd2c66687329765507f51b4c19a352790cee18","patch":"@@ -17,12 +17,12 @@ KIND, either express or implied.  See the License for the\n specific language governing permissions and limitations\n under the License.\n -->\n-<!DOCTYPE glassfish-web-app PUBLIC \"-//GlassFish.org//DTD \n-GlassFish Application Server 3.1 Servlet 3.0//EN\" \"http://glassfish.org/dtds/glassfish-web-app_3_0-1.dtd\">\n-<glassfish-web-app>\n+<!DOCTYPE payara-web-app PUBLIC \"-//Payara.fish//DTD Payara Server 4 Servlet 3.0//EN\" \"https://docs.payara.fish/schemas/payara-web-app_4.dtd\">\n+<payara-web-app error-url=\"\">\n   <context-root>/syncope-fit-build-tools</context-root>\n   <class-loader delegate=\"false\"/>\n+  <jaxrs-roles-allowed-enabled>false</jaxrs-roles-allowed-enabled>\n   <jsp-config>\n     <property name=\"httpMethods\" value=\"GET,POST,HEAD,PUT,DELETE\"/>\n   </jsp-config>\n-</glassfish-web-app>\n+</payara-web-app>","previous_filename":"fit/build-tools/src/main/webapp/WEB-INF/glassfish-web.xml"},{"sha":"4b477c9f40a4e4238aa5354930b4e870f16dc90c","filename":"fit/core-reference/pom.xml","status":"modified","additions":6,"deletions":0,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7ebd2c66687329765507f51b4c19a352790cee18/fit%2Fcore-reference%2Fpom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7ebd2c66687329765507f51b4c19a352790cee18/fit%2Fcore-reference%2Fpom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fcore-reference%2Fpom.xml?ref=7ebd2c66687329765507f51b4c19a352790cee18","patch":"@@ -1488,6 +1488,12 @@ under the License.\n           </exclusions>\n         </dependency>\n \n+        <dependency>\n+          <groupId>org.glassfish</groupId>\n+          <artifactId>jakarta.faces</artifactId>\n+          <version>${javax.faces.version}</version>\n+        </dependency>\n+\n         <dependency>\n           <groupId>com.fasterxml.jackson.dataformat</groupId>\n           <artifactId>jackson-dataformat-xml</artifactId>"},{"sha":"a32bda05d28896630532553f67963ffb3149dd20","filename":"fit/core-reference/src/main/webapp/WEB-INF/payara-web.xml","status":"renamed","additions":5,"deletions":5,"changes":10,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7ebd2c66687329765507f51b4c19a352790cee18/fit%2Fcore-reference%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fpayara-web.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7ebd2c66687329765507f51b4c19a352790cee18/fit%2Fcore-reference%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fpayara-web.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fcore-reference%2Fsrc%2Fmain%2Fwebapp%2FWEB-INF%2Fpayara-web.xml?ref=7ebd2c66687329765507f51b4c19a352790cee18","patch":"@@ -17,18 +17,18 @@ KIND, either express or implied.  See the License for the\n specific language governing permissions and limitations\n under the License.\n -->\n-<!DOCTYPE glassfish-web-app PUBLIC \"-//GlassFish.org//DTD \n-GlassFish Application Server 3.1 Servlet 3.0//EN\" \"http://glassfish.org/dtds/glassfish-web-app_3_0-1.dtd\">\n-<glassfish-web-app>\n-  <context-root>/syncope</context-root>\n+<!DOCTYPE payara-web-app PUBLIC \"-//Payara.fish//DTD Payara Server 4 Servlet 3.0//EN\" \"https://docs.payara.fish/schemas/payara-web-app_4.dtd\">\n+<payara-web-app error-url=\"\">\n   <!-- Uncomment this when using JNDI DataSource -->\n   <!--<resource-ref>\n     <res-ref-name>jdbc/syncopeMasterDataSource</res-ref-name>\n     <jndi-name>jdbc/syncopeMasterDataSource</jndi-name>\n   </resource-ref>-->\n   <class-loader delegate=\"false\"/>\n   <scanning-exclude>*</scanning-exclude>\n+  <scanning-exclude>*</scanning-exclude>\n+  <jaxrs-roles-allowed-enabled>false</jaxrs-roles-allowed-enabled>\n   <jsp-config>\n     <property name=\"httpMethods\" value=\"GET,POST,HEAD,PUT,DELETE\"/>\n   </jsp-config>\n-</glassfish-web-app>\n+</payara-web-app>","previous_filename":"fit/core-reference/src/main/webapp/WEB-INF/glassfish-web.xml"},{"sha":"1e2b71ae022677ca0ef70c4eb944df881719b383","filename":"pom.xml","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/7ebd2c66687329765507f51b4c19a352790cee18/pom.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/7ebd2c66687329765507f51b4c19a352790cee18/pom.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/pom.xml?ref=7ebd2c66687329765507f51b4c19a352790cee18","patch":"@@ -516,7 +516,7 @@ under the License.\n     <tomcat.version>9.0.33</tomcat.version>\n     <wildfly.version>19.0.0.Final</wildfly.version>\n     <payara.version>5.201</payara.version>\n-    <javax.faces.version>2.4.0</javax.faces.version>\n+    <javax.faces.version>2.3.14</javax.faces.version>\n \n     <docker.postgresql.version>12</docker.postgresql.version>\n     <docker.mysql.version>8.0.19</docker.mysql.version>"}]}