{"sha":"3d7159e7b089d012e9b86c8499ae283859678c29","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjNkNzE1OWU3YjA4OWQwMTJlOWI4NmM4NDk5YWUyODM4NTk2NzhjMjk=","commit":{"author":{"name":"Matteo Di Carlo","email":"matteo.dicarlo@tirasa.net","date":"2016-06-23T10:51:08Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2016-06-23T11:28:10Z"},"message":"[SYNCOPE-869] adds a final state to edit/create user and password reset in case of success - This closes #25","tree":{"sha":"75a574b3a594c3d003adb58633c6201657890228","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/75a574b3a594c3d003adb58633c6201657890228"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/3d7159e7b089d012e9b86c8499ae283859678c29","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/3d7159e7b089d012e9b86c8499ae283859678c29","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/3d7159e7b089d012e9b86c8499ae283859678c29","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/3d7159e7b089d012e9b86c8499ae283859678c29/comments","author":null,"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"0370ddc65b42fc163d6bc277572074bfff2a14fb","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/0370ddc65b42fc163d6bc277572074bfff2a14fb","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/0370ddc65b42fc163d6bc277572074bfff2a14fb"}],"stats":{"total":105,"additions":73,"deletions":32},"files":[{"sha":"5bffed2361659e0800a8dad1b3e44e724dcf1b5e","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/app.js","status":"modified","additions":5,"deletions":1,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3d7159e7b089d012e9b86c8499ae283859678c29/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fapp.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3d7159e7b089d012e9b86c8499ae283859678c29/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fapp.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fapp.js?ref=3d7159e7b089d012e9b86c8499ae283859678c29","patch":"@@ -48,7 +48,7 @@ var app = angular.module('SyncopeEnduserApp', [\n app.config(['$stateProvider', '$urlRouterProvider', '$httpProvider', '$translateProvider', '$translatePartialLoaderProvider',\n   function ($stateProvider, $urlRouterProvider, $httpProvider, $translateProvider, $translatePartialLoaderProvider) {\n \n-   $translatePartialLoaderProvider.addPart('static');\n+    $translatePartialLoaderProvider.addPart('static');\n     $translatePartialLoaderProvider.addPart('dynamic');\n     $translateProvider.useLoader('$translatePartialLoader', {\n       urlTemplate: 'languages/{lang}/{part}.json'\n@@ -112,6 +112,10 @@ app.config(['$stateProvider', '$urlRouterProvider', '$httpProvider', '$translate\n               url: '/finish',\n               templateUrl: 'views/user-form-finish.html'\n             })\n+            .state('success', {\n+              url: '/success',\n+              templateUrl: 'views/success.html'\n+            })\n             .state('update', {\n               url: '/self/update',\n               templateUrl: 'views/editUser.html',"},{"sha":"a4a313544b75d226768d3f30d61a9a619f5abeb0","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/controllers/UserController.js","status":"modified","additions":16,"deletions":26,"changes":42,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3d7159e7b089d012e9b86c8499ae283859678c29/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3d7159e7b089d012e9b86c8499ae283859678c29/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js?ref=3d7159e7b089d012e9b86c8499ae283859678c29","patch":"@@ -17,12 +17,14 @@\n  * under the License.\n  */\n \n+/* global message, component, $state, rootScope */\n+\n 'use strict';\n \n-angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$location', '$compile', 'AuthService',\n+angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$location', '$compile', \"$state\", 'AuthService',\n   'UserSelfService', 'SchemaService', 'RealmService', 'ResourceService', 'SecurityQuestionService', 'GroupService',\n   'AnyService', 'UserUtil', 'GenericUtil', \"ValidationExecutor\",\n-  function ($scope, $rootScope, $location, $compile, AuthService, UserSelfService, SchemaService, RealmService,\n+  function ($scope, $rootScope, $location, $compile, $state, AuthService, UserSelfService, SchemaService, RealmService,\n           ResourceService, SecurityQuestionService, GroupService, AnyService, UserUtil, GenericUtil, ValidationExecutor) {\n \n     $scope.user = {};\n@@ -41,7 +43,6 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n     };\n \n     $scope.initUser = function () {\n-\n       $scope.dynamicForm = {\n         plainSchemas: [],\n         derSchemas: [],\n@@ -77,17 +78,13 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n       var initSchemaValues = function (schemas) {\n         // initialize plain attributes\n         for (var i = 0; i < schemas.plainSchemas.length; i++) {\n-\n           var plainSchemaKey = schemas.plainSchemas[i].key;\n-\n           if (!$scope.user.plainAttrs[plainSchemaKey]) {\n-\n             $scope.user.plainAttrs[plainSchemaKey] = {\n               schema: plainSchemaKey,\n               values: [],\n               readonly: schemas.plainSchemas[i].readonly\n             };\n-\n             // initialize multivalue schema and support table: create mode, only first value\n             if (schemas.plainSchemas[i].multivalue) {\n               $scope.dynamicForm.attributeTable[schemas.plainSchemas[i].key] = {\n@@ -108,27 +105,20 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n \n         // initialize derived attributes\n         for (var i = 0; i < schemas.derSchemas.length; i++) {\n-\n           var derSchemaKey = schemas.derSchemas[i].key;\n-\n           if (!$scope.user.derAttrs[derSchemaKey]) {\n-\n             $scope.user.derAttrs[derSchemaKey] = {\n               schema: derSchemaKey,\n               values: [],\n               readonly: true\n             };\n-\n           }\n         }\n \n         // initialize virtual attributes\n         for (var i = 0; i < schemas.virSchemas.length; i++) {\n-\n           var virSchemaKey = schemas.virSchemas[i].key;\n-\n           if (!$scope.user.virAttrs[virSchemaKey]) {\n-\n             $scope.user.virAttrs[virSchemaKey] = {\n               schema: virSchemaKey,\n               values: [],\n@@ -329,20 +319,18 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n         // read user from syncope core\n         readUser();\n       }\n-\n     };\n \n     $scope.saveUser = function (user) {\n       console.debug(\"Save user: \", user);\n-\n       var wrappedUser = UserUtil.getWrappedUser(user);\n \n       if ($scope.createMode) {\n-\n         UserSelfService.create(wrappedUser, $scope.captchaInput.value).then(function (response) {\n-          console.info(\"Created user: \", response);\n-          $scope.showSuccess(\"User \" + $scope.user.username + \" successfully created\", $scope.notification);\n-          $location.path('/self');\n+          console.info(\"User \" + $scope.user.username + \" SUCCESSFULLY_CREATED\");\n+          $rootScope.currentUser = $scope.user.username;\n+          $rootScope.currentOp = \"SUCCESSFULLY_CREATED\";\n+          $state.go('success');\n         }, function (response) {\n           console.error(\"Error during user creation: \", response);\n           var errorMessage;\n@@ -353,15 +341,15 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n           }\n           $scope.showError(\"Error: \" + (errorMessage || response), $scope.notification);\n         });\n-\n       } else {\n-\n         UserSelfService.update(wrappedUser, $scope.captchaInput.value).then(function (response) {\n           console.debug(\"Updated user: \", response);\n           AuthService.logout().then(function (response) {\n             console.info(\"LOGOUT SUCCESS: \", response);\n-            $location.path('/self');\n-            $scope.showSuccess(\"User \" + $scope.user.username + \" successfully updated\", $scope.notification);\n+            console.info(\"User \" + $scope.user.username + \" SUCCESSFULLY_UPDATED\");\n+            $rootScope.currentUser = $scope.user.username;\n+            $rootScope.currentOp = \"SUCCESSFULLY_UPDATED\";\n+            $state.go('success');\n           }, function () {\n             console.error(\"LOGOUT FAILED\");\n           });\n@@ -402,8 +390,10 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n       if (user && user.username) {\n         $scope.retrieveSecurityQuestion(user);\n         UserSelfService.passwordReset(user, $scope.captchaInput.value).then(function (data) {\n-          $scope.showSuccess(data, $scope.notification);\n-          $location.path('/self');\n+          console.info(\"User \" + $scope.user.username);\n+          $rootScope.currentUser = $scope.user.username;\n+          $rootScope.currentOp = \"PASSWORD_UPDATED\";\n+          $state.go('success');\n         }, function (response) {\n           var errorMessage;\n           // parse error response "},{"sha":"d8b69869a95cd4c6d9dff4d38fa7ccba7230e43d","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/directives/navigationButtons.js","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3d7159e7b089d012e9b86c8499ae283859678c29/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FnavigationButtons.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3d7159e7b089d012e9b86c8499ae283859678c29/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FnavigationButtons.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fdirectives%2FnavigationButtons.js?ref=3d7159e7b089d012e9b86c8499ae283859678c29","patch":"@@ -47,8 +47,7 @@ angular.module('self')\n                     if (ValidationExecutor.validate(currentForm, $scope.$parent)) {\n                       if (state) {\n                         $scope.nextTab(state);\n-                      }\n-                      else if ($scope.wizard) {\n+                      } else if ($scope.wizard) {\n                         $scope.nextTab($scope.next);\n                       }\n                     }\n@@ -58,6 +57,7 @@ angular.module('self')\n \n                 $scope.nextTab = function (state) {\n                   //change route through parent event\n+                  console.log(\"State: \", state);\n                   $state.go(state);\n                 };\n "},{"sha":"09a8ac863119eb7a3967369e42a3c74fb6f01998","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/services/userSelfService.js","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3d7159e7b089d012e9b86c8499ae283859678c29/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fservices%2FuserSelfService.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3d7159e7b089d012e9b86c8499ae283859678c29/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fservices%2FuserSelfService.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fservices%2FuserSelfService.js?ref=3d7159e7b089d012e9b86c8499ae283859678c29","patch":"@@ -42,6 +42,7 @@ angular.module('login')\n                       .then(function (response) {\n                         console.debug(\"response save: \", response);\n                         var username = response;\n+                        return username;\n                       }, function (response) {\n                         console.error(\"Something went wrong during user self creation, exit with status: \", response);\n                         return $q.reject(response.data || response.statusText);"},{"sha":"59e623937f7f3c21f0559f83be758653b271dc12","filename":"client/enduser/src/main/resources/META-INF/resources/app/languages/de/static.json","status":"modified","additions":6,"deletions":1,"changes":7,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3d7159e7b089d012e9b86c8499ae283859678c29/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Flanguages%2Fde%2Fstatic.json","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3d7159e7b089d012e9b86c8499ae283859678c29/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Flanguages%2Fde%2Fstatic.json","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Flanguages%2Fde%2Fstatic.json?ref=3d7159e7b089d012e9b86c8499ae283859678c29","patch":"@@ -37,6 +37,11 @@\n   \"VIRTUALSCHEMAS\": \"Virtuelle Schemen\",\n   \"RESOURCES\": \"Ressourcen\",\n   \"REALM\": \"Realm\",\n-  \"NEWUSER\": \"Neuer benutzer\"\n+  \"NEWUSER\": \"Neuer benutzer\",\n+  \"SUCCESSFULLY_CREATED\": \"succes aangemaakt\",\n+  \"SUCCESSFULLY_UPDATED\": \"succesvol geüpdatet\",\n+  \"PASSWORD_UPDATED\": \": password succesfully updated\",\n+  \"GOBACKHOME\": \"Klik op deze link om terug te gaan naar de home page\"\n+\n }\n "},{"sha":"a8aa5a87ad73b628a1bdaea58855bc2a3e41c820","filename":"client/enduser/src/main/resources/META-INF/resources/app/languages/en/static.json","status":"modified","additions":5,"deletions":1,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3d7159e7b089d012e9b86c8499ae283859678c29/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Flanguages%2Fen%2Fstatic.json","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3d7159e7b089d012e9b86c8499ae283859678c29/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Flanguages%2Fen%2Fstatic.json","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Flanguages%2Fen%2Fstatic.json?ref=3d7159e7b089d012e9b86c8499ae283859678c29","patch":"@@ -37,6 +37,10 @@\n   \"VIRTUALSCHEMAS\": \"VirtualSchemas\",\n   \"RESOURCES\": \"Resources\",\n   \"REALM\": \"Realm\",\n-  \"NEWUSER\": \"New User\"\n+  \"NEWUSER\": \"New User\",\n+  \"SUCCESSFULLY_CREATED\": \"succesfully created\",\n+  \"SUCCESSFULLY_UPDATED\": \"succesfully updated\",\n+  \"PASSWORD_UPDATED\": \": password succesfully updated\",\n+  \"GOBACKHOME\": \"Click on this link to go back to the home page\"\n }\n "},{"sha":"f098ca622ff21509262681e3ca01ace90b9ac3bb","filename":"client/enduser/src/main/resources/META-INF/resources/app/languages/it/static.json","status":"modified","additions":5,"deletions":1,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3d7159e7b089d012e9b86c8499ae283859678c29/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Flanguages%2Fit%2Fstatic.json","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3d7159e7b089d012e9b86c8499ae283859678c29/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Flanguages%2Fit%2Fstatic.json","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Flanguages%2Fit%2Fstatic.json?ref=3d7159e7b089d012e9b86c8499ae283859678c29","patch":"@@ -36,5 +36,9 @@\n   \"VIRTUALSCHEMAS\": \"VirtualSchemas\",\n   \"RESOURCES\": \"Risorse\",\n   \"NEWUSER\": \"Nuovo utente\",\n-  \"REALM\": \"Realm\"\n+  \"REALM\": \"Realm\",\n+  \"SUCCESSFULLY_CREATED\": \"creato con successo\",\n+  \"SUCCESSFULLY_UPDATED\": \"aggiornato con successo\",\n+  \"PASSWORD_UPDATED\": \": password succesfully updated\",\n+  \"GOBACKHOME\": \"Clicca su questo link per tornare alla home page\"\n }\n\\ No newline at end of file"},{"sha":"d9933da240bed110dbc111714ba09a2331fc3d1c","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/success.html","status":"added","additions":33,"deletions":0,"changes":33,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/3d7159e7b089d012e9b86c8499ae283859678c29/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fsuccess.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/3d7159e7b089d012e9b86c8499ae283859678c29/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fsuccess.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fsuccess.html?ref=3d7159e7b089d012e9b86c8499ae283859678c29","patch":"@@ -0,0 +1,33 @@\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+\n+<div ng-cloak class=\"container\">\n+  <div class=\"login-container\" ng-controller=\"UserController\" ng-init=\"initUser();\" style=\"box-sizing: border-box; \">\n+    <div id=\"form-container\" class=\"col-md-6 col-md-offset-3\" style=\"box-sizing: border-box; background-color: #F7F7F7;\">\n+      <div>\n+        <div class=\"page-header\" style=\"text-align: left; font-weight: 700;\">          \n+          <span>{{'USER'| translate}} <b> {{currentUser}}</b> {{currentOp| translate}}</span>\n+        </div>\n+        <span>\n+          <a href=\"javascript:void(0);\" class=\"btn btn-link\" ng-click=\"logout()\">{{'GOBACKHOME'| translate}}</a>\n+        </span> \n+      </div>\n+    </div>\n+  </div>\n+</div>\n\\ No newline at end of file"}]}