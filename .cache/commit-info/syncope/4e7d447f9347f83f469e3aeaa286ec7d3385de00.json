{"sha":"4e7d447f9347f83f469e3aeaa286ec7d3385de00","node_id":"C_kwDOJfYA1toAKDRlN2Q0NDdmOTM0N2Y4M2Y0NjllM2FlYWEyODZlYzdkMzM4NWRlMDA","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2021-12-24T12:34:31Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2021-12-24T12:34:31Z"},"message":"Fix following CAS code changes","tree":{"sha":"e238fc3ca86defa00eef4fd2c852b75791b4dc3b","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/e238fc3ca86defa00eef4fd2c852b75791b4dc3b"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/4e7d447f9347f83f469e3aeaa286ec7d3385de00","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/4e7d447f9347f83f469e3aeaa286ec7d3385de00","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/4e7d447f9347f83f469e3aeaa286ec7d3385de00","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/4e7d447f9347f83f469e3aeaa286ec7d3385de00/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"cce345771e11cceed3b7817aadd27aaffdb358b3","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/cce345771e11cceed3b7817aadd27aaffdb358b3","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/cce345771e11cceed3b7817aadd27aaffdb358b3"}],"stats":{"total":29,"additions":16,"deletions":13},"files":[{"sha":"6aff8a3aaf45933fc7c5c7cc8a14bbd6c2636ac2","filename":"wa/starter/src/main/java/org/apache/syncope/wa/starter/config/SyncopeWAConfiguration.java","status":"modified","additions":13,"deletions":12,"changes":25,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4e7d447f9347f83f469e3aeaa286ec7d3385de00/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fconfig%2FSyncopeWAConfiguration.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4e7d447f9347f83f469e3aeaa286ec7d3385de00/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fconfig%2FSyncopeWAConfiguration.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fconfig%2FSyncopeWAConfiguration.java?ref=4e7d447f9347f83f469e3aeaa286ec7d3385de00","patch":"@@ -250,8 +250,8 @@ public CasEventRepositoryFilter syncopeWAEventRepositoryFilter() {\n     @Autowired\n     @Bean\n     public CasEventRepository casEventRepository(final WARestClient restClient,\n-                                                 @Qualifier(\"syncopeWAEventRepositoryFilter\")\n-                                                 final CasEventRepositoryFilter syncopeWAEventRepositoryFilter) {\n+            @Qualifier(\"syncopeWAEventRepositoryFilter\")\n+            final CasEventRepositoryFilter syncopeWAEventRepositoryFilter) {\n         return new SyncopeWAEventRepository(syncopeWAEventRepositoryFilter, restClient);\n     }\n \n@@ -263,8 +263,8 @@ public DelegatedClientFactoryCustomizer<Client> delegatedClientCustomizer(final\n \n     @Bean\n     public OneTimeTokenRepository oneTimeTokenAuthenticatorTokenRepository(\n-        final CasConfigurationProperties casProperties,\n-        final WARestClient restClient) {\n+            final CasConfigurationProperties casProperties,\n+            final WARestClient restClient) {\n         return new SyncopeWAGoogleMfaAuthTokenRepository(\n                 restClient, casProperties.getAuthn().getMfa().getGauth().getCore().getTimeStepSize());\n     }\n@@ -280,8 +280,8 @@ public OneTimeTokenCredentialRepository googleAuthenticatorAccountRegistry(\n     @Autowired\n     @Bean\n     public OidcJsonWebKeystoreGeneratorService oidcJsonWebKeystoreGeneratorService(\n-        final ConfigurableApplicationContext ctx,\n-        final WARestClient restClient) {\n+            final ConfigurableApplicationContext ctx,\n+            final WARestClient restClient) {\n         int size = ctx.getEnvironment().\n                 getProperty(\"cas.authn.oidc.jwks.size\", int.class, 2048);\n         JWSAlgorithm algorithm = ctx.getEnvironment().\n@@ -292,23 +292,24 @@ public OidcJsonWebKeystoreGeneratorService oidcJsonWebKeystoreGeneratorService(\n     @RefreshScope\n     @Bean\n     public WebAuthnCredentialRepository webAuthnCredentialRepository(\n-        final CasConfigurationProperties casProperties,\n-        final WARestClient restClient) {\n+            final CasConfigurationProperties casProperties,\n+            final WARestClient restClient) {\n         return new SyncopeWAWebAuthnCredentialRepository(casProperties, restClient);\n     }\n \n     @Bean\n     @RefreshScope\n     public U2FDeviceRepository u2fDeviceRepository(\n-        final CasConfigurationProperties casProperties,\n-        final WARestClient restClient) {\n+            final CasConfigurationProperties casProperties,\n+            final WARestClient restClient) {\n+\n         U2FCoreMultifactorAuthenticationProperties u2f = casProperties.getAuthn().getMfa().getU2f().getCore();\n         LocalDate expirationDate = LocalDate.now(ZoneId.systemDefault()).\n                 minus(u2f.getExpireDevices(), DateTimeUtils.toChronoUnit(u2f.getExpireDevicesTimeUnit()));\n         LoadingCache<String, String> requestStorage = Caffeine.newBuilder().\n                 expireAfterWrite(u2f.getExpireRegistrations(), u2f.getExpireRegistrationsTimeUnit()).\n                 build(key -> StringUtils.EMPTY);\n-        return new SyncopeWAU2FDeviceRepository(requestStorage, restClient, expirationDate);\n+        return new SyncopeWAU2FDeviceRepository(casProperties, requestStorage, restClient, expirationDate);\n     }\n \n     @Bean\n@@ -342,7 +343,7 @@ public KeymasterStop keymasterStop() {\n \n     @Bean\n     public CasThymeleafLoginFormDirector casThymeleafLoginFormDirector(\n-        @Qualifier(\"casWebflowExecutionPlan\") final CasWebflowExecutionPlan webflowExecutionPlan) {\n+            @Qualifier(\"casWebflowExecutionPlan\") final CasWebflowExecutionPlan webflowExecutionPlan) {\n         return new CasThymeleafLoginFormDirector(webflowExecutionPlan);\n     }\n }"},{"sha":"f6539fbbc995f29281106151b6711c65f4ac7c68","filename":"wa/starter/src/main/java/org/apache/syncope/wa/starter/u2f/SyncopeWAU2FDeviceRepository.java","status":"modified","additions":3,"deletions":1,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/4e7d447f9347f83f469e3aeaa286ec7d3385de00/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fu2f%2FSyncopeWAU2FDeviceRepository.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/4e7d447f9347f83f469e3aeaa286ec7d3385de00/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fu2f%2FSyncopeWAU2FDeviceRepository.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/wa%2Fstarter%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fwa%2Fstarter%2Fu2f%2FSyncopeWAU2FDeviceRepository.java?ref=4e7d447f9347f83f469e3aeaa286ec7d3385de00","patch":"@@ -34,6 +34,7 @@\n import org.apache.syncope.wa.bootstrap.WARestClient;\n import org.apereo.cas.adaptors.u2f.storage.BaseU2FDeviceRepository;\n import org.apereo.cas.adaptors.u2f.storage.U2FDeviceRegistration;\n+import org.apereo.cas.configuration.CasConfigurationProperties;\n import org.apereo.cas.util.crypto.CipherExecutor;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n@@ -48,11 +49,12 @@ public class SyncopeWAU2FDeviceRepository extends BaseU2FDeviceRepository {\n     private final LocalDate expirationDate;\n \n     public SyncopeWAU2FDeviceRepository(\n+            final CasConfigurationProperties casProperties,\n             final LoadingCache<String, String> requestStorage,\n             final WARestClient waRestClient,\n             final LocalDate expirationDate) {\n \n-        super(requestStorage, CipherExecutor.noOpOfSerializableToString());\n+        super(casProperties, requestStorage, CipherExecutor.noOpOfSerializableToString());\n         this.waRestClient = waRestClient;\n         this.expirationDate = expirationDate;\n     }"}]}