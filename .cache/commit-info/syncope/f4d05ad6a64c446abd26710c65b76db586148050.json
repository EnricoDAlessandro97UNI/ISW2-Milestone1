{"sha":"f4d05ad6a64c446abd26710c65b76db586148050","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmY0ZDA1YWQ2YTY0YzQ0NmFiZDI2NzEwYzY1Yjc2ZGI1ODYxNDgwNTA=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2013-10-30T16:08:07Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2013-10-30T16:08:07Z"},"message":"[SYNCOPE-432] Merge from 1_1_X\n\ngit-svn-id: https://svn.apache.org/repos/asf/syncope/trunk@1537151 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"050bc85f0dfde1eb391296dae9e35fd8849acd40","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/050bc85f0dfde1eb391296dae9e35fd8849acd40"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/f4d05ad6a64c446abd26710c65b76db586148050","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/f4d05ad6a64c446abd26710c65b76db586148050","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/f4d05ad6a64c446abd26710c65b76db586148050","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/f4d05ad6a64c446abd26710c65b76db586148050/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"e410841e4c4e513b8800281f2ccc40d21fa6d302","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/e410841e4c4e513b8800281f2ccc40d21fa6d302","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/e410841e4c4e513b8800281f2ccc40d21fa6d302"},{"sha":"d22d853bc2c44ab1776be2a3d01ad1a79fee33ab","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/d22d853bc2c44ab1776be2a3d01ad1a79fee33ab","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/d22d853bc2c44ab1776be2a3d01ad1a79fee33ab"}],"stats":{"total":499,"additions":178,"deletions":321},"files":[{"sha":"12af7856d180955e810d9cf27a1a0f522db253e5","filename":"console/src/main/java/org/apache/syncope/console/pages/panels/RoleSummaryPanel.java","status":"modified","additions":46,"deletions":17,"changes":63,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/f4d05ad6a64c446abd26710c65b76db586148050/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleSummaryPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/f4d05ad6a64c446abd26710c65b76db586148050/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleSummaryPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleSummaryPanel.java?ref=f4d05ad6a64c446abd26710c65b76db586148050","patch":"@@ -21,12 +21,18 @@\n import java.io.Serializable;\n import org.apache.syncope.common.to.RoleTO;\n import org.apache.syncope.common.validation.SyncopeClientException;\n+import org.apache.syncope.console.commons.XMLRolesReader;\n+import org.apache.syncope.console.pages.RoleModalPage;\n import org.apache.syncope.console.rest.RoleRestClient;\n-import org.apache.syncope.console.wicket.markup.html.tree.TreeActionLinkPanel;\n+import org.apache.syncope.console.wicket.markup.html.form.ActionLink;\n+import org.apache.syncope.console.wicket.markup.html.form.ActionLinksPanel;\n+import org.apache.wicket.Page;\n import org.apache.wicket.PageReference;\n+import org.apache.wicket.ajax.AjaxRequestTarget;\n import org.apache.wicket.extensions.ajax.markup.html.modal.ModalWindow;\n import org.apache.wicket.markup.html.panel.Fragment;\n import org.apache.wicket.markup.html.panel.Panel;\n+import org.apache.wicket.model.Model;\n import org.apache.wicket.spring.injection.annot.SpringBean;\n import org.slf4j.Logger;\n import org.slf4j.LoggerFactory;\n@@ -40,17 +46,14 @@ public class RoleSummaryPanel extends Panel {\n      */\n     private static final Logger LOG = LoggerFactory.getLogger(RoleSummaryPanel.class);\n \n+    @SpringBean\n+    private XMLRolesReader xmlRolesReader;\n+\n     @SpringBean\n     private RoleRestClient restClient;\n \n     private RoleTO selectedNode;\n \n-    private final Fragment fragment;\n-\n-    private RoleTabPanel roleTabPanel;\n-\n-    private TreeActionLinkPanel actionLink;\n-\n     public static class Builder implements Serializable {\n \n         private static final long serialVersionUID = 4164563358509351832L;\n@@ -91,28 +94,54 @@ private RoleSummaryPanel(final Builder builder) {\n         super(builder.id);\n \n         if (builder.selectedNodeId == null || builder.selectedNodeId == 0) {\n-            this.selectedNode = null;\n+            selectedNode = null;\n         } else {\n             try {\n-                this.selectedNode = restClient.read(builder.selectedNodeId);\n+                selectedNode = restClient.read(builder.selectedNodeId);\n             } catch (SyncopeClientException e) {\n                 LOG.error(\"Could not read {}\", builder.selectedNodeId, e);\n-                this.selectedNode = null;\n+                selectedNode = null;\n                 builder.selectedNodeId = null;\n             }\n         }\n \n-        fragment = new Fragment(\"roleSummaryPanel\", builder.selectedNodeId == null ? \"fakerootFrag\"\n-                : (builder.selectedNodeId == 0 ? \"rootPanel\" : \"roleViewPanel\"), this);\n+        Fragment fragment = new Fragment(\"roleSummaryPanel\",\n+                builder.selectedNodeId == null\n+                ? \"fakerootFrag\"\n+                : (builder.selectedNodeId == 0 ? \"rootPanel\" : \"roleViewPanel\"),\n+                this);\n \n         if (builder.selectedNodeId != null) {\n             if (builder.selectedNodeId == 0) {\n-                actionLink = new TreeActionLinkPanel(\"actionLink\", builder.selectedNodeId,\n-                        builder.window, builder.callerPageRef);\n-                actionLink.setOutputMarkupId(true);\n-                fragment.add(actionLink);\n+                @SuppressWarnings(\"rawtypes\")\n+                final ActionLinksPanel links = new ActionLinksPanel(\"actionLinks\", new Model(), builder.callerPageRef);\n+                links.setOutputMarkupId(true);\n+                fragment.add(links);\n+\n+                links.addWithRoles(new ActionLink() {\n+\n+                    private static final long serialVersionUID = -3722207913631435501L;\n+\n+                    @Override\n+                    public void onClick(final AjaxRequestTarget target) {\n+                        builder.window.setPageCreator(new ModalWindow.PageCreator() {\n+\n+                            private static final long serialVersionUID = -7834632442532690940L;\n+\n+                            @Override\n+                            public Page createPage() {\n+                                RoleTO roleTO = new RoleTO();\n+                                RoleModalPage form = new RoleModalPage(builder.callerPageRef, builder.window, roleTO);\n+                                return form;\n+                            }\n+                        });\n+\n+                        builder.window.show(target);\n+                    }\n+                }, ActionLink.ActionType.CREATE, xmlRolesReader.getAllAllowedRoles(\"Roles\", \"create\"));\n             } else {\n-                roleTabPanel = new RoleTabPanel(\"nodeViewPanel\", selectedNode, builder.window, builder.callerPageRef);\n+                RoleTabPanel roleTabPanel =\n+                        new RoleTabPanel(\"nodeViewPanel\", selectedNode, builder.window, builder.callerPageRef);\n                 roleTabPanel.setOutputMarkupId(true);\n                 fragment.add(roleTabPanel);\n             }"},{"sha":"1582e409e6b441e7d15768201847c40ac2458a85","filename":"console/src/main/java/org/apache/syncope/console/pages/panels/RoleTabPanel.java","status":"modified","additions":120,"deletions":13,"changes":133,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/f4d05ad6a64c446abd26710c65b76db586148050/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleTabPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/f4d05ad6a64c446abd26710c65b76db586148050/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleTabPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleTabPanel.java?ref=f4d05ad6a64c446abd26710c65b76db586148050","patch":"@@ -21,10 +21,19 @@\n import org.apache.syncope.common.search.MembershipCond;\n import org.apache.syncope.common.search.NodeCond;\n import org.apache.syncope.common.to.RoleTO;\n+import org.apache.syncope.common.validation.SyncopeClientException;\n+import org.apache.syncope.console.commons.Constants;\n+import org.apache.syncope.console.commons.XMLRolesReader;\n+import org.apache.syncope.console.pages.ResultStatusModalPage;\n import org.apache.syncope.console.pages.RoleModalPage;\n+import org.apache.syncope.console.pages.Roles;\n+import org.apache.syncope.console.pages.StatusModalPage;\n+import org.apache.syncope.console.rest.RoleRestClient;\n import org.apache.syncope.console.rest.UserRestClient;\n import org.apache.syncope.console.wicket.ajax.markup.html.ClearIndicatingAjaxButton;\n-import org.apache.syncope.console.wicket.markup.html.tree.TreeActionLinkPanel;\n+import org.apache.syncope.console.wicket.markup.html.form.ActionLink;\n+import org.apache.syncope.console.wicket.markup.html.form.ActionLinksPanel;\n+import org.apache.wicket.Page;\n import org.apache.wicket.PageReference;\n import org.apache.wicket.ajax.AjaxRequestTarget;\n import org.apache.wicket.extensions.ajax.markup.html.modal.ModalWindow;\n@@ -33,6 +42,7 @@\n import org.apache.wicket.markup.html.form.Form;\n import org.apache.wicket.markup.html.panel.Panel;\n import org.apache.wicket.model.CompoundPropertyModel;\n+import org.apache.wicket.model.Model;\n import org.apache.wicket.model.ResourceModel;\n import org.apache.wicket.spring.injection.annot.SpringBean;\n \n@@ -41,44 +51,141 @@ public class RoleTabPanel extends Panel {\n     private static final long serialVersionUID = 859236186975983959L;\n \n     @SpringBean\n-    private UserRestClient restClient;\n+    private XMLRolesReader xmlRolesReader;\n \n-    public RoleTabPanel(final String id, final RoleTO roleTO, final ModalWindow window,\n+    @SpringBean\n+    private RoleRestClient roleRestClient;\n+\n+    @SpringBean\n+    private UserRestClient userRestClient;\n+\n+    @SuppressWarnings({ \"unchecked\", \"rawtypes\" })\n+    public RoleTabPanel(final String id, final RoleTO selectedNode, final ModalWindow window,\n             final PageReference pageRef) {\n \n         super(id);\n \n-        final Form form = new Form(\"roleForm\");\n+        this.add(new Label(\"displayName\", selectedNode.getDisplayName()));\n+\n+        final ActionLinksPanel links = new ActionLinksPanel(\"actionLinks\", new Model(), pageRef);\n+        links.setOutputMarkupId(true);\n+        this.add(links);\n+        links.addWithRoles(new ActionLink() {\n+\n+            private static final long serialVersionUID = -3722207913631435501L;\n+\n+            @Override\n+            public void onClick(final AjaxRequestTarget target) {\n+                window.setPageCreator(new ModalWindow.PageCreator() {\n \n-        final TreeActionLinkPanel actionLink = new TreeActionLinkPanel(\"actionLink\", roleTO.getId(), window, pageRef);\n+                    private static final long serialVersionUID = -7834632442532690940L;\n \n-        this.add(actionLink);\n-        this.add(new Label(\"displayName\", roleTO.getDisplayName()));\n+                    @Override\n+                    public Page createPage() {\n+                        RoleTO roleTO = new RoleTO();\n+                        roleTO.setParent(selectedNode.getId());\n+                        RoleModalPage form = new RoleModalPage(pageRef, window, roleTO);\n+                        return form;\n+                    }\n+                });\n+\n+                window.show(target);\n+            }\n+        }, ActionLink.ActionType.CREATE, xmlRolesReader.getAllAllowedRoles(\"Roles\", \"create\"));\n+        links.addWithRoles(new ActionLink() {\n+\n+            private static final long serialVersionUID = -3722207913631435501L;\n+\n+            @Override\n+            public void onClick(final AjaxRequestTarget target) {\n+                window.setPageCreator(new ModalWindow.PageCreator() {\n+\n+                    private static final long serialVersionUID = -7834632442532690940L;\n+\n+                    @Override\n+                    public Page createPage() {\n+                        return new StatusModalPage<RoleTO>(pageRef, window, roleRestClient.read(selectedNode.getId()));\n+                    }\n+                });\n+\n+                window.show(target);\n+            }\n+        }, ActionLink.ActionType.MANAGE_RESOURCES, xmlRolesReader.getAllAllowedRoles(\"Roles\", \"update\"));\n+        links.addWithRoles(new ActionLink() {\n \n-        form.setModel(new CompoundPropertyModel(roleTO));\n+            private static final long serialVersionUID = -3722207913631435501L;\n+\n+            @Override\n+            public void onClick(final AjaxRequestTarget target) {\n+                window.setPageCreator(new ModalWindow.PageCreator() {\n+\n+                    private static final long serialVersionUID = -7834632442532690940L;\n+\n+                    @Override\n+                    public Page createPage() {\n+                        RoleTO roleTO = roleRestClient.read(selectedNode.getId());\n+                        RoleModalPage form = new RoleModalPage(pageRef, window, roleTO);\n+                        return form;\n+                    }\n+                });\n+\n+                window.show(target);\n+            }\n+        }, ActionLink.ActionType.EDIT, xmlRolesReader.getAllAllowedRoles(\"Roles\", \"update\"));\n+        links.addWithRoles(new ActionLink() {\n+\n+            private static final long serialVersionUID = -3722207913631435501L;\n+\n+            @Override\n+            public void onClick(final AjaxRequestTarget target) {\n+                try {\n+                    final RoleTO roleTO = roleRestClient.delete(selectedNode.getId());\n+\n+                    ((Roles) pageRef.getPage()).setModalResult(true);\n+\n+                    window.setPageCreator(new ModalWindow.PageCreator() {\n+\n+                        private static final long serialVersionUID = -7834632442532690940L;\n+\n+                        @Override\n+                        public Page createPage() {\n+                            return new ResultStatusModalPage.Builder(window, roleTO).build();\n+                        }\n+                    });\n+\n+                    window.show(target);\n+                } catch (SyncopeClientException e) {\n+                    error(getString(Constants.OPERATION_ERROR) + \": \" + e.getMessage());\n+                    target.add(((Roles) pageRef.getPage()).getFeedbackPanel());\n+                }\n+            }\n+        }, ActionLink.ActionType.DELETE, xmlRolesReader.getAllAllowedRoles(\"Roles\", \"delete\"));\n+\n+        final Form form = new Form(\"roleForm\");\n+        form.setModel(new CompoundPropertyModel(selectedNode));\n         form.setOutputMarkupId(true);\n \n-        final RolePanel rolePanel = new RolePanel.Builder(\"rolePanel\").form(form).roleTO(roleTO)\n-                .roleModalPageMode(RoleModalPage.Mode.ADMIN).build();\n+        final RolePanel rolePanel = new RolePanel.Builder(\"rolePanel\").form(form).roleTO(selectedNode).\n+                roleModalPageMode(RoleModalPage.Mode.ADMIN).build();\n         rolePanel.setEnabled(false);\n         form.add(rolePanel);\n \n         final WebMarkupContainer userListContainer = new WebMarkupContainer(\"userListContainer\");\n \n         userListContainer.setOutputMarkupId(true);\n         userListContainer.setEnabled(true);\n-        userListContainer.add(new UserSearchResultPanel(\"userList\", true, null, pageRef, restClient));\n+        userListContainer.add(new UserSearchResultPanel(\"userList\", true, null, pageRef, userRestClient));\n         userListContainer.add(new ClearIndicatingAjaxButton(\"search\", new ResourceModel(\"search\"), pageRef) {\n \n             private static final long serialVersionUID = -958724007591692537L;\n \n             @Override\n             protected void onSubmitInternal(final AjaxRequestTarget target, final Form<?> form) {\n                 final MembershipCond membershipCond = new MembershipCond();\n-                membershipCond.setRoleName(roleTO.getName());\n+                membershipCond.setRoleName(selectedNode.getName());\n                 NodeCond cond = NodeCond.getLeafCond(membershipCond);\n \n-                userListContainer.replace(new UserSearchResultPanel(\"userList\", true, cond, pageRef, restClient));\n+                userListContainer.replace(new UserSearchResultPanel(\"userList\", true, cond, pageRef, userRestClient));\n \n                 target.add(userListContainer);\n             }"},{"sha":"7c2e0e93cbee24b12db78906150bac84be251287","filename":"console/src/main/java/org/apache/syncope/console/wicket/markup/html/tree/TreeActionLinkPanel.java","status":"removed","additions":0,"deletions":159,"changes":159,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e410841e4c4e513b8800281f2ccc40d21fa6d302/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FTreeActionLinkPanel.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e410841e4c4e513b8800281f2ccc40d21fa6d302/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FTreeActionLinkPanel.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FTreeActionLinkPanel.java?ref=e410841e4c4e513b8800281f2ccc40d21fa6d302","patch":"@@ -1,159 +0,0 @@\n-/*\n- * Licensed to the Apache Software Foundation (ASF) under one\n- * or more contributor license agreements.  See the NOTICE file\n- * distributed with this work for additional information\n- * regarding copyright ownership.  The ASF licenses this file\n- * to you under the Apache License, Version 2.0 (the\n- * \"License\"); you may not use this file except in compliance\n- * with the License.  You may obtain a copy of the License at\n- *\n- *   http://www.apache.org/licenses/LICENSE-2.0\n- *\n- * Unless required by applicable law or agreed to in writing,\n- * software distributed under the License is distributed on an\n- * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n- * KIND, either express or implied.  See the License for the\n- * specific language governing permissions and limitations\n- * under the License.\n- */\n-package org.apache.syncope.console.wicket.markup.html.tree;\n-\n-import org.apache.syncope.common.to.RoleTO;\n-import org.apache.syncope.common.validation.SyncopeClientException;\n-import org.apache.syncope.console.commons.Constants;\n-import org.apache.syncope.console.commons.XMLRolesReader;\n-import org.apache.syncope.console.pages.ResultStatusModalPage;\n-import org.apache.syncope.console.pages.RoleModalPage;\n-import org.apache.syncope.console.pages.Roles;\n-import org.apache.syncope.console.rest.RoleRestClient;\n-import org.apache.syncope.console.wicket.ajax.markup.html.ClearIndicatingAjaxLink;\n-import org.apache.syncope.console.wicket.ajax.markup.html.IndicatingOnConfirmAjaxLink;\n-import org.apache.wicket.Page;\n-import org.apache.wicket.PageReference;\n-import org.apache.wicket.ajax.AjaxRequestTarget;\n-import org.apache.wicket.ajax.markup.html.AjaxLink;\n-import org.apache.wicket.authroles.authorization.strategies.role.metadata.MetaDataRoleAuthorizationStrategy;\n-import org.apache.wicket.extensions.ajax.markup.html.modal.ModalWindow;\n-import org.apache.wicket.markup.html.panel.Fragment;\n-import org.apache.wicket.markup.html.panel.Panel;\n-import org.apache.wicket.spring.injection.annot.SpringBean;\n-\n-/**\n- * Panel for a node element form.\n- */\n-public class TreeActionLinkPanel extends Panel {\n-\n-    private static final long serialVersionUID = -7292448006463567909L;\n-\n-    @SpringBean\n-    private RoleRestClient restClient;\n-\n-    @SpringBean\n-    private XMLRolesReader xmlRolesReader;\n-\n-    private final Fragment fragment;\n-\n-    public TreeActionLinkPanel(final String id, final long idRole, final ModalWindow window,\n-            final PageReference pageRef) {\n-\n-        super(id);\n-\n-        fragment = new Fragment(\"menuPanel\", idRole == 0\n-                ? \"fakerootFrag\"\n-                : \"roleFrag\", this);\n-        fragment.setOutputMarkupId(true);\n-\n-        final AjaxLink<Void> createRoleLink = new ClearIndicatingAjaxLink<Void>(\"createRoleLink\", pageRef) {\n-\n-            private static final long serialVersionUID = -7978723352517770644L;\n-\n-            @Override\n-            protected void onClickInternal(final AjaxRequestTarget target) {\n-                window.setPageCreator(new ModalWindow.PageCreator() {\n-\n-                    private static final long serialVersionUID = -7834632442532690940L;\n-\n-                    @Override\n-                    public Page createPage() {\n-                        RoleTO roleTO = new RoleTO();\n-                        roleTO.setParent(idRole);\n-                        return new RoleModalPage(pageRef, window, roleTO);\n-                    }\n-                });\n-\n-                window.show(target);\n-            }\n-        };\n-\n-        MetaDataRoleAuthorizationStrategy.authorize(createRoleLink, ENABLE,\n-                xmlRolesReader.getAllAllowedRoles(\"Roles\", \"create\"));\n-\n-        createRoleLink.setOutputMarkupId(true);\n-        fragment.add(createRoleLink);\n-\n-        if (idRole != 0) {\n-            final AjaxLink<Void> updateRoleLink = new ClearIndicatingAjaxLink<Void>(\"updateRoleLink\", pageRef) {\n-\n-                private static final long serialVersionUID = -7978723352517770644L;\n-\n-                @Override\n-                protected void onClickInternal(final AjaxRequestTarget target) {\n-                    window.setPageCreator(new ModalWindow.PageCreator() {\n-\n-                        private static final long serialVersionUID = -7834632442532690940L;\n-\n-                        @Override\n-                        public Page createPage() {\n-                            return new RoleModalPage(pageRef, window, restClient.read(idRole));\n-                        }\n-                    });\n-\n-                    window.show(target);\n-                }\n-            };\n-\n-            MetaDataRoleAuthorizationStrategy.authorize(updateRoleLink, ENABLE,\n-                    xmlRolesReader.getAllAllowedRoles(\"Roles\", \"read\"));\n-\n-            updateRoleLink.setOutputMarkupId(true);\n-            fragment.add(updateRoleLink);\n-\n-            final AjaxLink<Void> dropRoleLink = new IndicatingOnConfirmAjaxLink<Void>(\"dropRoleLink\", pageRef) {\n-\n-                private static final long serialVersionUID = -7978723352517770644L;\n-\n-                @Override\n-                protected void onClickInternal(final AjaxRequestTarget target) {\n-                    try {\n-                        final RoleTO roleTO = restClient.delete(idRole);\n-\n-                        ((Roles) pageRef.getPage()).setModalResult(true);\n-\n-                        window.setPageCreator(new ModalWindow.PageCreator() {\n-\n-                            private static final long serialVersionUID = -7834632442532690940L;\n-\n-                            @Override\n-                            public Page createPage() {\n-                                return new ResultStatusModalPage.Builder(window, roleTO).build();\n-                            }\n-                        });\n-\n-                        window.show(target);\n-                    } catch (SyncopeClientException scce) {\n-                        error(getString(Constants.OPERATION_ERROR) + \": \" + scce.getMessage());\n-                        target.add(((Roles) pageRef.getPage()).getFeedbackPanel());\n-                    }\n-                }\n-            };\n-\n-            MetaDataRoleAuthorizationStrategy.authorize(dropRoleLink, ENABLE,\n-                    xmlRolesReader.getAllAllowedRoles(\"Roles\", \"delete\"));\n-\n-            dropRoleLink.setOutputMarkupId(true);\n-            fragment.add(dropRoleLink);\n-        }\n-\n-        add(fragment);\n-    }\n-}"},{"sha":"3d5e7b94cbedd15b0ac86c421edc939842e4c0d8","filename":"console/src/main/resources/org/apache/syncope/console/pages/panels/RoleSummaryPanel.html","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/f4d05ad6a64c446abd26710c65b76db586148050/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleSummaryPanel.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/f4d05ad6a64c446abd26710c65b76db586148050/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleSummaryPanel.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleSummaryPanel.html?ref=f4d05ad6a64c446abd26710c65b76db586148050","patch":"@@ -28,7 +28,7 @@\n     <wicket:fragment wicket:id=\"rootPanel\">\n       <div style=\"float:left; width:70%;\">\n         <p style=\"height:15px; margin-top: 0px;\" class=\"ui-widget ui-corner-all ui-widget-header\">\n-          <span wicket:id=\"actionLink\"/>\n+          <span style=\"float:right;\" wicket:id=\"actionLinks\"/>\n         </p>\n       </div>\n     </wicket:fragment>"},{"sha":"bc09288b1fc2212a9ecf52e4aa020b04bc029d3b","filename":"console/src/main/resources/org/apache/syncope/console/pages/panels/RoleTabPanel.html","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/f4d05ad6a64c446abd26710c65b76db586148050/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleTabPanel.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/f4d05ad6a64c446abd26710c65b76db586148050/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleTabPanel.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fpages%2Fpanels%2FRoleTabPanel.html?ref=f4d05ad6a64c446abd26710c65b76db586148050","patch":"@@ -22,7 +22,7 @@\n       <p style=\"height:15px; margin-top: 0px;\" class=\"ui-widget ui-corner-all ui-widget-header\">\n         <wicket:message key=\"title\"/>\n         <span wicket:id=\"displayName\"/>\n-        <span wicket:id=\"actionLink\"/>\n+        <span style=\"float:right;\" wicket:id=\"actionLinks\"/>\n       </p>\n \n       <form wicket:id=\"roleForm\">"},{"sha":"1a312c464c1d0390c392d5497cd6f9fc9335bf81","filename":"console/src/main/resources/org/apache/syncope/console/wicket/markup/html/tree/TreeActionLinkPanel.html","status":"removed","additions":0,"deletions":51,"changes":51,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e410841e4c4e513b8800281f2ccc40d21fa6d302/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FTreeActionLinkPanel.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e410841e4c4e513b8800281f2ccc40d21fa6d302/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FTreeActionLinkPanel.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FTreeActionLinkPanel.html?ref=e410841e4c4e513b8800281f2ccc40d21fa6d302","patch":"@@ -1,51 +0,0 @@\n-<!--\n-Licensed to the Apache Software Foundation (ASF) under one\n-or more contributor license agreements.  See the NOTICE file\n-distributed with this work for additional information\n-regarding copyright ownership.  The ASF licenses this file\n-to you under the Apache License, Version 2.0 (the\n-\"License\"); you may not use this file except in compliance\n-with the License.  You may obtain a copy of the License at\n-\n-  http://www.apache.org/licenses/LICENSE-2.0\n-\n-Unless required by applicable law or agreed to in writing,\n-software distributed under the License is distributed on an\n-\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n-KIND, either express or implied.  See the License for the\n-specific language governing permissions and limitations\n-under the License.\n--->\n-<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:wicket=\"http://wicket.apache.org\">\n-  <wicket:head>\n-    <style type=\"text/css\">\n-      .actionLink a{\n-        text-decoration: none;\n-        font-weight: normal;\n-      }\n-    </style>\n-  </wicket:head>\n-  <wicket:panel>\n-\n-    <span class=\"actionLink\" style=\"float:right\" wicket:id=\"menuPanel\"/>\n-\n-    <wicket:fragment wicket:id=\"roleFrag\">\n-      <a wicket:id=\"createRoleLink\">\n-        <wicket:message key=\"create_role\"/>\n-      </a>|\n-      <a wicket:id=\"updateRoleLink\">\n-        <wicket:message key=\"update_role\"/>\n-      </a>|\n-      <a wicket:id=\"dropRoleLink\">\n-        <wicket:message key=\"drop_role\"/>\n-      </a>\n-    </wicket:fragment>\n-\n-    <wicket:fragment wicket:id=\"fakerootFrag\">\n-      <a wicket:id=\"createRoleLink\">\n-        <wicket:message key=\"create_role\"/>\n-      </a>\n-    </wicket:fragment>\n-\n-  </wicket:panel>\n-</html>"},{"sha":"92ffe1e66fabd3a1c4750a1eee4bc862c5f50b91","filename":"console/src/main/resources/org/apache/syncope/console/wicket/markup/html/tree/TreeActionLinkPanel.properties","status":"removed","additions":0,"deletions":21,"changes":21,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e410841e4c4e513b8800281f2ccc40d21fa6d302/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FTreeActionLinkPanel.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e410841e4c4e513b8800281f2ccc40d21fa6d302/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FTreeActionLinkPanel.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FTreeActionLinkPanel.properties?ref=e410841e4c4e513b8800281f2ccc40d21fa6d302","patch":"@@ -1,21 +0,0 @@\n-# Licensed to the Apache Software Foundation (ASF) under one\n-# or more contributor license agreements.  See the NOTICE file\n-# distributed with this work for additional information\n-# regarding copyright ownership.  The ASF licenses this file\n-# to you under the Apache License, Version 2.0 (the\n-# \"License\"); you may not use this file except in compliance\n-# with the License.  You may obtain a copy of the License at\n-#\n-#   http://www.apache.org/licenses/LICENSE-2.0\n-#\n-# Unless required by applicable law or agreed to in writing,\n-# software distributed under the License is distributed on an\n-# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n-# KIND, either express or implied.  See the License for the\n-# specific language governing permissions and limitations\n-# under the License.\n-column1=Roles\n-column2=Action\n-create_role=Add child\n-update_role=Edit\n-drop_role=Drop"},{"sha":"4ff3143d562939bb48e06911d1b65c45da010aed","filename":"console/src/main/resources/org/apache/syncope/console/wicket/markup/html/tree/TreeActionLinkPanel_it.properties","status":"removed","additions":0,"deletions":21,"changes":21,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e410841e4c4e513b8800281f2ccc40d21fa6d302/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FTreeActionLinkPanel_it.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e410841e4c4e513b8800281f2ccc40d21fa6d302/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FTreeActionLinkPanel_it.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FTreeActionLinkPanel_it.properties?ref=e410841e4c4e513b8800281f2ccc40d21fa6d302","patch":"@@ -1,21 +0,0 @@\n-# Licensed to the Apache Software Foundation (ASF) under one\n-# or more contributor license agreements.  See the NOTICE file\n-# distributed with this work for additional information\n-# regarding copyright ownership.  The ASF licenses this file\n-# to you under the Apache License, Version 2.0 (the\n-# \"License\"); you may not use this file except in compliance\n-# with the License.  You may obtain a copy of the License at\n-#\n-#   http://www.apache.org/licenses/LICENSE-2.0\n-#\n-# Unless required by applicable law or agreed to in writing,\n-# software distributed under the License is distributed on an\n-# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n-# KIND, either express or implied.  See the License for the\n-# specific language governing permissions and limitations\n-# under the License.\n-column1=Ruoli\n-column2=Azione\n-create_role=Aggiungi figlio\n-update_role=Modifica\n-drop_role=Rimuovi"},{"sha":"8ee410a7e5db7368aac9ebd9262f40e21803e16b","filename":"console/src/main/resources/org/apache/syncope/console/wicket/markup/html/tree/TreeActionLinkPanel_pt_BR.properties","status":"removed","additions":0,"deletions":21,"changes":21,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/e410841e4c4e513b8800281f2ccc40d21fa6d302/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FTreeActionLinkPanel_pt_BR.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/e410841e4c4e513b8800281f2ccc40d21fa6d302/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FTreeActionLinkPanel_pt_BR.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fresources%2Forg%2Fapache%2Fsyncope%2Fconsole%2Fwicket%2Fmarkup%2Fhtml%2Ftree%2FTreeActionLinkPanel_pt_BR.properties?ref=e410841e4c4e513b8800281f2ccc40d21fa6d302","patch":"@@ -1,21 +0,0 @@\n-# Licensed to the Apache Software Foundation (ASF) under one\n-# or more contributor license agreements.  See the NOTICE file\n-# distributed with this work for additional information\n-# regarding copyright ownership.  The ASF licenses this file\n-# to you under the Apache License, Version 2.0 (the\n-# \"License\"); you may not use this file except in compliance\n-# with the License.  You may obtain a copy of the License at\n-#\n-#   http://www.apache.org/licenses/LICENSE-2.0\n-#\n-# Unless required by applicable law or agreed to in writing,\n-# software distributed under the License is distributed on an\n-# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n-# KIND, either express or implied.  See the License for the\n-# specific language governing permissions and limitations\n-# under the License.\n-column1=Fun\\u00e7\\u00f5es\n-column2=A\\u00e7\\u00f5es\n-create_role=Adicionar Filho\n-update_role=Editar\n-drop_role=Excluir"},{"sha":"0ea124a744763ffe056b84a56b6100c45303068a","filename":"console/src/main/webapp/img/actions/create.png","status":"modified","additions":0,"deletions":0,"changes":0,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/f4d05ad6a64c446abd26710c65b76db586148050/console%2Fsrc%2Fmain%2Fwebapp%2Fimg%2Factions%2Fcreate.png","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/f4d05ad6a64c446abd26710c65b76db586148050/console%2Fsrc%2Fmain%2Fwebapp%2Fimg%2Factions%2Fcreate.png","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Fmain%2Fwebapp%2Fimg%2Factions%2Fcreate.png?ref=f4d05ad6a64c446abd26710c65b76db586148050"},{"sha":"c9c8c60b9b84e19d0d53834eaa8ce8fd1733421c","filename":"console/src/test/java/org/apache/syncope/console/RoleTestITCase.java","status":"modified","additions":10,"deletions":16,"changes":26,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/f4d05ad6a64c446abd26710c65b76db586148050/console%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2FRoleTestITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/f4d05ad6a64c446abd26710c65b76db586148050/console%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2FRoleTestITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/console%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Fconsole%2FRoleTestITCase.java?ref=f4d05ad6a64c446abd26710c65b76db586148050","patch":"@@ -49,10 +49,9 @@ public void browseCreateModal() {\n \n         selenium.click(\"//div/div/span/div/div/div/div/div[2]/div/div/span/a\");\n \n-        selenium.waitForCondition(\"selenium.isElementPresent(\"\n-                + \"\\\"//div/div/span[2]/span/span/div/p/span[2]/span/a\\\");\", \"30000\");\n+        selenium.waitForCondition(\"selenium.isElementPresent(\\\"css=img[title='Create']\\\");\", \"30000\");\n \n-        selenium.click(\"//div/div/span[2]/span/span/div/p/span[2]/span/a\");\n+        selenium.click(\"css=img[title='Create']\");\n \n         selenium.waitForCondition(\"selenium.isElementPresent(\\\"//iframe\\\");\", \"30000\");\n \n@@ -78,16 +77,15 @@ public void browseEditModal() {\n \n         selenium.click(\"//div/div/span/div/div/div/div/div[2]/div/div/span/a\");\n \n-        selenium.waitForCondition(\"selenium.isElementPresent(\"\n-                + \"\\\"//div/div/span[2]/span/span/div/p/span[2]/span/a[2]\\\");\", \"30000\");\n+        selenium.waitForCondition(\"selenium.isElementPresent(\\\"css=img[title='Edit']\\\");\", \"30000\");\n \n-        selenium.click(\"//div/div/span[2]/span/span/div/p/span[2]/span/a[2]\");\n+        selenium.click(\"css=img[title='Edit']\");\n \n         selenium.waitForCondition(\"selenium.isElementPresent(\\\"//iframe\\\");\", \"30000\");\n \n         selenium.selectFrame(\"relative=up\");\n \n-        selenium.waitForCondition(\"selenium.isElementPresent(\" + \"\\\"//div[2]/form/div[3]/div/ul/li[1]/a/span\\\");\", \"30000\");\n+        selenium.waitForCondition(\"selenium.isElementPresent(\\\"//div[2]/form/div[3]/div/ul/li[1]/a/span\\\");\", \"30000\");\n \n         selenium.click(\"//div[2]/form/div[3]/div/ul/li[2]/a/span\");\n         selenium.click(\"//div[2]/form/div[3]/div/ul/li[3]/a/span\");\n@@ -142,7 +140,7 @@ public void browseUserEditModal() {\n     }\n \n     @Test\n-    public void deleteUser() {\n+    public void searchUsers() {\n         selenium.click(\"css=img[alt=\\\"Roles\\\"]\");\n \n         selenium.waitForCondition(\"selenium.isElementPresent(\\\"//div[@id='navigationPane']\\\");\", \"30000\");\n@@ -152,15 +150,11 @@ public void deleteUser() {\n         selenium.waitForCondition(\"selenium.isElementPresent(\"\n                 + \"\\\"//div/div/span[2]/span/span/div/form/div[2]/ul/li[8]/a\\\");\", \"30000\");\n \n-        selenium.click(\"//div/form/div[2]/ul/li[7]/a\");\n+        selenium.click(\"//div/div/span[2]/span/span/div/form/div[2]/ul/li[8]/a\");\n \n         selenium.click(\"//input[@name=\\\"userListContainer:search\\\"]\");\n \n         selenium.waitForCondition(\"selenium.isElementPresent(\\\"//span[14]/a\\\");\", \"30000\");\n-\n-        selenium.click(\"//span[14]/a\");\n-\n-        assertTrue(selenium.getConfirmation().matches(\"^Do you really want to delete the selected item[\\\\s\\\\S]$\"));\n     }\n \n     @Test\n@@ -172,10 +166,10 @@ public void deleteRole() {\n         selenium.click(\n                 \"//div/div/span/div/div/div/div/div[2]/div[2]/div[2]/div/div[2]/div[3]/div/span[2]/a/span\");\n \n-        selenium.waitForCondition(\"selenium.isElementPresent(\\\"//div/p/span[2]/span/a[3]\\\");\", \"30000\");\n+        selenium.waitForCondition(\"selenium.isElementPresent(\\\"css=img[title='Delete']\\\");\", \"30000\");\n \n-        selenium.click(\"//div/div/span[2]/span/span/div/p/span[2]/span/a[3]\");\n+        selenium.click(\"css=img[title='Delete']\");\n \n         assertTrue(selenium.getConfirmation().matches(\"^Do you really want to delete the selected item[\\\\s\\\\S]$\"));\n     }\n-}\n\\ No newline at end of file\n+}"}]}