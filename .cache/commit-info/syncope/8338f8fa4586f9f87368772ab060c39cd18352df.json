{"sha":"8338f8fa4586f9f87368772ab060c39cd18352df","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjgzMzhmOGZhNDU4NmY5Zjg3MzY4NzcyYWIwNjBjMzljZDE4MzUyZGY=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2015-08-28T11:00:35Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2015-08-28T11:00:35Z"},"message":"[SYNCOPE-686] Fix was not working with DefaultUserWorkflowAdapter","tree":{"sha":"628cbde6c58dd11d4c0fc10c452518212b28ae7b","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/628cbde6c58dd11d4c0fc10c452518212b28ae7b"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/8338f8fa4586f9f87368772ab060c39cd18352df","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/8338f8fa4586f9f87368772ab060c39cd18352df","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/8338f8fa4586f9f87368772ab060c39cd18352df","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/8338f8fa4586f9f87368772ab060c39cd18352df/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"02d4888011b26dfb470136ad621dcfc4bb406e33","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/02d4888011b26dfb470136ad621dcfc4bb406e33","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/02d4888011b26dfb470136ad621dcfc4bb406e33"}],"stats":{"total":15,"additions":8,"deletions":7},"files":[{"sha":"ef40bd5c9127c42b5ae8ced4ccf880a8a8b8b856","filename":"core/workflow-java/src/main/java/org/apache/syncope/core/workflow/java/DefaultUserWorkflowAdapter.java","status":"modified","additions":8,"deletions":7,"changes":15,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/8338f8fa4586f9f87368772ab060c39cd18352df/core%2Fworkflow-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fworkflow%2Fjava%2FDefaultUserWorkflowAdapter.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/8338f8fa4586f9f87368772ab060c39cd18352df/core%2Fworkflow-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fworkflow%2Fjava%2FDefaultUserWorkflowAdapter.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fworkflow-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fworkflow%2Fjava%2FDefaultUserWorkflowAdapter.java?ref=8338f8fa4586f9f87368772ab060c39cd18352df","patch":"@@ -107,18 +107,19 @@ protected WorkflowResult<Long> doActivate(final User user, final String token) {\n     @Override\n     protected WorkflowResult<Pair<UserMod, Boolean>> doUpdate(final User user, final UserMod userMod) {\n         // update password internally only if required\n-        UserMod actualMod = SerializationUtils.clone(userMod);\n-        if (actualMod.getPwdPropRequest() != null && !actualMod.getPwdPropRequest().isOnSyncope()) {\n-            actualMod.setPassword(null);\n+        UserMod updatedMod = SerializationUtils.clone(userMod);\n+        String updatedPwd = updatedMod.getPassword();\n+        if (updatedMod.getPwdPropRequest() != null && !updatedMod.getPwdPropRequest().isOnSyncope()) {\n+            updatedMod.setPassword(null);\n         }\n         // update User\n-        PropagationByResource propByRes = dataBinder.update(user, actualMod);\n+        PropagationByResource propByRes = dataBinder.update(user, updatedMod);\n+        updatedMod.setPassword(updatedPwd);\n \n-        User updated = userDAO.save(user);\n+        userDAO.save(user);\n \n-        userMod.setKey(updated.getKey());\n         return new WorkflowResult<Pair<UserMod, Boolean>>(\n-                new ImmutablePair<>(userMod, !user.isSuspended()), propByRes, \"update\");\n+                new ImmutablePair<>(updatedMod, !user.isSuspended()), propByRes, \"update\");\n     }\n \n     @Override"}]}