{"sha":"9b5121d0866f37bce16fc0802b1202e2380acbc0","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjliNTEyMWQwODY2ZjM3YmNlMTZmYzA4MDJiMTIwMmUyMzgwYWNiYzA=","commit":{"author":{"name":"Colm O hEigeartaigh","email":"coheigea@apache.org","date":"2016-12-08T16:35:42Z"},"committer":{"name":"Colm O hEigeartaigh","email":"coheigea@apache.org","date":"2016-12-08T16:36:32Z"},"message":"Switch to use PreparedStatements in a few places for the fit tests","tree":{"sha":"ff4805c2005f41aebaf6251c4a8d1626fbd2b6d6","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/ff4805c2005f41aebaf6251c4a8d1626fbd2b6d6"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/9b5121d0866f37bce16fc0802b1202e2380acbc0","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/9b5121d0866f37bce16fc0802b1202e2380acbc0","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/9b5121d0866f37bce16fc0802b1202e2380acbc0","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/9b5121d0866f37bce16fc0802b1202e2380acbc0/comments","author":{"login":"coheigea","id":472162,"node_id":"MDQ6VXNlcjQ3MjE2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/472162?v=4","gravatar_id":"","url":"https://api.github.com/users/coheigea","html_url":"https://github.com/coheigea","followers_url":"https://api.github.com/users/coheigea/followers","following_url":"https://api.github.com/users/coheigea/following{/other_user}","gists_url":"https://api.github.com/users/coheigea/gists{/gist_id}","starred_url":"https://api.github.com/users/coheigea/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coheigea/subscriptions","organizations_url":"https://api.github.com/users/coheigea/orgs","repos_url":"https://api.github.com/users/coheigea/repos","events_url":"https://api.github.com/users/coheigea/events{/privacy}","received_events_url":"https://api.github.com/users/coheigea/received_events","type":"User","site_admin":false},"committer":{"login":"coheigea","id":472162,"node_id":"MDQ6VXNlcjQ3MjE2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/472162?v=4","gravatar_id":"","url":"https://api.github.com/users/coheigea","html_url":"https://github.com/coheigea","followers_url":"https://api.github.com/users/coheigea/followers","following_url":"https://api.github.com/users/coheigea/following{/other_user}","gists_url":"https://api.github.com/users/coheigea/gists{/gist_id}","starred_url":"https://api.github.com/users/coheigea/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/coheigea/subscriptions","organizations_url":"https://api.github.com/users/coheigea/orgs","repos_url":"https://api.github.com/users/coheigea/repos","events_url":"https://api.github.com/users/coheigea/events{/privacy}","received_events_url":"https://api.github.com/users/coheigea/received_events","type":"User","site_admin":false},"parents":[{"sha":"f1d294d6fe23b03ade5f59f9d1b94959c518cb86","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/f1d294d6fe23b03ade5f59f9d1b94959c518cb86","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/f1d294d6fe23b03ade5f59f9d1b94959c518cb86"}],"stats":{"total":24,"additions":16,"deletions":8},"files":[{"sha":"e3847343697e03311098a6ec702f19bbd1ecb0a0","filename":"fit/build-tools/src/main/java/org/apache/syncope/fit/buildtools/cxf/ProvisioningImpl.java","status":"modified","additions":16,"deletions":8,"changes":24,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/9b5121d0866f37bce16fc0802b1202e2380acbc0/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fbuildtools%2Fcxf%2FProvisioningImpl.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/9b5121d0866f37bce16fc0802b1202e2380acbc0/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fbuildtools%2Fcxf%2FProvisioningImpl.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fbuildtools%2Fcxf%2FProvisioningImpl.java?ref=9b5121d0866f37bce16fc0802b1202e2380acbc0","patch":"@@ -19,6 +19,7 @@\n package org.apache.syncope.fit.buildtools.cxf;\n \n import java.sql.Connection;\n+import java.sql.PreparedStatement;\n import java.sql.ResultSet;\n import java.sql.ResultSetMetaData;\n import java.sql.SQLException;\n@@ -63,12 +64,14 @@ public String delete(final String accountid) throws ProvisioningException {\n         try {\n             conn = DataSourceUtils.getConnection(dataSource);\n \n-            Statement statement = conn.createStatement();\n+            PreparedStatement statement =\n+                conn.prepareStatement(\"DELETE FROM user WHERE userId=?\");\n+            statement.setString(1, accountid);\n \n             String query = \"DELETE FROM user WHERE userId='\" + accountid + \"';\";\n             LOG.debug(\"Execute query: \" + query);\n \n-            statement.executeUpdate(query);\n+            statement.executeUpdate();\n \n             return accountid;\n         } catch (SQLException e) {\n@@ -113,7 +116,6 @@ public String update(final String accountid, final List<WSAttributeValue> data)\n \n         try {\n             conn = DataSourceUtils.getConnection(dataSource);\n-            final Statement statement = conn.createStatement();\n \n             String value;\n \n@@ -155,10 +157,13 @@ public String update(final String accountid, final List<WSAttributeValue> data)\n             }\n \n             if (set.length() > 0) {\n+                PreparedStatement statement =\n+                    conn.prepareStatement(\"UPDATE user SET \" + set.toString() + \" WHERE userId=?\");\n+                statement.setString(1, accountid);\n                 String query = \"UPDATE user SET \" + set.toString() + \" WHERE userId='\" + accountid + \"';\";\n                 LOG.debug(\"Execute query: \" + query);\n \n-                statement.executeUpdate(query);\n+                statement.executeUpdate();\n             }\n \n             return accountid;\n@@ -339,22 +344,25 @@ public String resolve(final String username) throws ProvisioningException {\n         Connection conn = null;\n         try {\n             conn = DataSourceUtils.getConnection(dataSource);\n-            Statement statement = conn.createStatement();\n+            PreparedStatement statement =\n+                conn.prepareStatement(\"SELECT userId FROM user WHERE userId=?\");\n+            statement.setString(1, username);\n \n             final String query = \"SELECT userId FROM user WHERE userId='\" + username + \"';\";\n \n             LOG.debug(\"Execute query: \" + query);\n \n-            ResultSet rs = statement.executeQuery(query);\n+            ResultSet rs = statement.executeQuery();\n \n             resolved = rs.next() ? rs.getString(1) : null;\n \n             if (resolved == null) {\n-                statement = conn.createStatement();\n+                statement = conn.prepareStatement(\"SELECT roleName FROM role WHERE roleName=?\");\n+                statement.setString(1, username);\n                 final String roleQuery = \"SELECT roleName FROM role WHERE roleName='\" + username + \"';\";\n                 LOG.debug(\"Execute query: \" + roleQuery);\n \n-                rs = statement.executeQuery(roleQuery);\n+                rs = statement.executeQuery();\n \n                 resolved = rs.next() ? rs.getString(1) : null;\n             }"}]}