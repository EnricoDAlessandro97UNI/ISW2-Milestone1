{"sha":"f8212ae2b290acadbc47e5b737b057b33dda5654","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmY4MjEyYWUyYjI5MGFjYWRiYzQ3ZTViNzM3YjA1N2IzM2RkYTU2NTQ=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2016-07-07T10:02:00Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2016-07-07T10:02:00Z"},"message":"[SYNCOPE-898] Missing parts on core now fixed","tree":{"sha":"2a113d987b0f72fe242133e329f6c68b55eefc1f","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/2a113d987b0f72fe242133e329f6c68b55eefc1f"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/f8212ae2b290acadbc47e5b737b057b33dda5654","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/f8212ae2b290acadbc47e5b737b057b33dda5654","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/f8212ae2b290acadbc47e5b737b057b33dda5654","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/f8212ae2b290acadbc47e5b737b057b33dda5654/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"0656bc07fc99d8fa9d87bf407f7641c4fa221ad8","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/0656bc07fc99d8fa9d87bf407f7641c4fa221ad8","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/0656bc07fc99d8fa9d87bf407f7641c4fa221ad8"}],"stats":{"total":22,"additions":15,"deletions":7},"files":[{"sha":"ed9edade0d941a7e8f93f55169f18ffc39f7e5ba","filename":"core/persistence-jpa/src/test/resources/domains/MasterContent.xml","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/f8212ae2b290acadbc47e5b737b057b33dda5654/core%2Fpersistence-jpa%2Fsrc%2Ftest%2Fresources%2Fdomains%2FMasterContent.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/f8212ae2b290acadbc47e5b737b057b33dda5654/core%2Fpersistence-jpa%2Fsrc%2Ftest%2Fresources%2Fdomains%2FMasterContent.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa%2Fsrc%2Ftest%2Fresources%2Fdomains%2FMasterContent.xml?ref=f8212ae2b290acadbc47e5b737b057b33dda5654","patch":"@@ -1070,7 +1070,7 @@ under the License.\n         destinationRealm_id=\"e4c28e7a-9dbf-4ee7-9441-93812a0d4a28\" pullMode=\"FULL_RECONCILIATION\" performCreate=\"1\" performDelete=\"1\" performUpdate=\"1\" syncStatus=\"0\"\n         unmatchingRule=\"PROVISION\" matchingRule=\"UPDATE\" active=\"1\"/>\n   <AnyTemplatePullTask id=\"df655a2a-40c0-43b1-a157-3f4988802f58\" pullTask_id=\"1e419ca4-ea81-4493-a14f-28b90113686d\" anyType_id=\"USER\"\n-                       template='{\"@class\":\"org.apache.syncope.common.lib.to.UserTO\",\"creator\":null,\"creationDate\":null,\"lastModifier\":null,\"lastChangeDate\":null,\"key\":null,\"type\":\"USER\",\"realm\":null,\"status\":null,\"password\":null,\"token\":null,\"tokenExpireTime\":null,\"username\":null,\"lastLoginDate\":null,\"changePwdDate\":null,\"failedLogins\":null,\"securityQuestion\":null,\"securityAnswer\":null,\"auxClasses\":[],\"derAttrs\":[],\"virAttrs\":[{\"schema\":\"virtualReadOnly\",\"readonly\":true,\"values\":[\"\"]}],\"resources\":[\"resource-ldap\"],\"roles\":[],\"dynRoles\":[],\"relationships\":[],\"memberships\":[],\"dynGroups\":[],\"plainAttrs\":[]}'/>\n+                       template='{\"@class\":\"org.apache.syncope.common.lib.to.UserTO\",\"creator\":null,\"creationDate\":null,\"lastModifier\":null,\"lastChangeDate\":null,\"key\":null,\"type\":\"USER\",\"realm\":\"&apos;/&apos; + title\",\"status\":null,\"password\":null,\"token\":null,\"tokenExpireTime\":null,\"username\":null,\"lastLoginDate\":null,\"changePwdDate\":null,\"failedLogins\":null,\"securityQuestion\":null,\"securityAnswer\":null,\"auxClasses\":[\"minimal group\"],\"derAttrs\":[],\"virAttrs\":[{\"schema\":\"virtualReadOnly\",\"readonly\":true,\"values\":[\"\"]}],\"resources\":[\"resource-ldap\"],\"roles\":[],\"dynRoles\":[],\"relationships\":[],\"memberships\":[],\"dynGroups\":[],\"plainAttrs\":[]}'/>\n   <AnyTemplatePullTask id=\"fda22ff3-98f3-42e4-a2ae-cd9a28282d57\" pullTask_id=\"1e419ca4-ea81-4493-a14f-28b90113686d\" anyType_id=\"GROUP\"\n                        template='{\"@class\":\"org.apache.syncope.common.lib.to.GroupTO\",\"creator\":null,\"creationDate\":null,\"lastModifier\":null,\"lastChangeDate\":null,\"key\":null,\"type\":\"GROUP\",\"realm\":null,\"status\":null,\"name\":null,\"userOwner\":null,\"groupOwner\":null,\"udynMembershipCond\":null,\"auxClasses\":[],\"derAttrs\":[],\"virAttrs\":[],\"resources\":[],\"plainAttrs\":[{\"schema\":\"show\",\"readonly\":false,\"values\":[\"true\"]}]}'/>\n   <PullTask_actionsClassNames pullTask_id=\"1e419ca4-ea81-4493-a14f-28b90113686d\" actionClassName=\"org.apache.syncope.core.provisioning.java.pushpull.LDAPMembershipPullActions\"/>"},{"sha":"94822ed28b543f939a040883accfdee4c4a573ed","filename":"core/provisioning-java/src/main/java/org/apache/syncope/core/provisioning/java/utils/ConnObjectUtils.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/f8212ae2b290acadbc47e5b737b057b33dda5654/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Futils%2FConnObjectUtils.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/f8212ae2b290acadbc47e5b737b057b33dda5654/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Futils%2FConnObjectUtils.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Futils%2FConnObjectUtils.java?ref=f8212ae2b290acadbc47e5b737b057b33dda5654","patch":"@@ -133,7 +133,7 @@ public <T extends AnyTO> T getAnyTO(\n \n         // (for users) if password was not set above, generate\n         if (anyTO instanceof UserTO && StringUtils.isBlank(((UserTO) anyTO).getPassword())) {\n-            final UserTO userTO = (UserTO) anyTO;\n+            UserTO userTO = (UserTO) anyTO;\n \n             List<PasswordRuleConf> ruleConfs = new ArrayList<>();\n "},{"sha":"de0480f2506f2f3e10dfa5242ebbf0db5e39943e","filename":"core/provisioning-java/src/main/java/org/apache/syncope/core/provisioning/java/utils/TemplateUtils.java","status":"modified","additions":5,"deletions":4,"changes":9,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/f8212ae2b290acadbc47e5b737b057b33dda5654/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Futils%2FTemplateUtils.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/f8212ae2b290acadbc47e5b737b057b33dda5654/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Futils%2FTemplateUtils.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fprovisioning-java%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fprovisioning%2Fjava%2Futils%2FTemplateUtils.java?ref=f8212ae2b290acadbc47e5b737b057b33dda5654","patch":"@@ -69,7 +69,10 @@ private AttrTO evaluateAttr(final AnyTO anyTO, final AttrTO template) {\n \n     private void fill(final AnyTO anyTO, final AnyTO template) {\n         if (template.getRealm() != null) {\n-            anyTO.setRealm(template.getRealm());\n+            String evaluated = JexlUtils.evaluate(template.getRealm(), anyTO, new MapContext());\n+            if (StringUtils.isNotBlank(evaluated)) {\n+                anyTO.setRealm(evaluated);\n+            }\n         }\n \n         Map<String, AttrTO> currentAttrMap = anyTO.getPlainAttrMap();\n@@ -99,9 +102,7 @@ private void fill(final AnyTO anyTO, final AnyTO template) {\n             }\n         }\n \n-        for (String resource : template.getResources()) {\n-            anyTO.getResources().add(resource);\n-        }\n+        anyTO.getResources().addAll(template.getResources());\n \n         anyTO.getAuxClasses().addAll(template.getAuxClasses());\n     }"},{"sha":"18f184fdbb3730d8a330334586cd60b809ac0e29","filename":"fit/build-tools/src/main/resources/content.ldif","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/f8212ae2b290acadbc47e5b737b057b33dda5654/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fresources%2Fcontent.ldif","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/f8212ae2b290acadbc47e5b737b057b33dda5654/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fresources%2Fcontent.ldif","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fbuild-tools%2Fsrc%2Fmain%2Fresources%2Fcontent.ldif?ref=f8212ae2b290acadbc47e5b737b057b33dda5654","patch":"@@ -44,6 +44,7 @@ sn: Surname\n uid: pullFromLDAP\n userpassword:: cGFzc3dvcmQxMjM=\n givenname: pullFromLDAP\n+title: odd\n registeredAddress:  5BAA61E4C9B93F3F0682250B6CF8331B7EE68FD8\n jpegPhoto:: /9j/4AAQSkZJRgABAQEBKwErAAD/2wBDAAMCAgMCAgMDAwMEAwMEBQgFBQQEBQoH\n  BwYIDAoMDAsKCwsNDhIQDQ4RDgsLEBYQERMUFRUVDA8XGBYUGBIUFRT/2wBDAQMEBAUEBQkFBQk"},{"sha":"74f8b17ccbf90ed1687291560e7ecb345ba62707","filename":"fit/core-reference/src/test/java/org/apache/syncope/fit/core/PullTaskITCase.java","status":"modified","additions":7,"deletions":1,"changes":8,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/f8212ae2b290acadbc47e5b737b057b33dda5654/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FPullTaskITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/f8212ae2b290acadbc47e5b737b057b33dda5654/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FPullTaskITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FPullTaskITCase.java?ref=f8212ae2b290acadbc47e5b737b057b33dda5654","patch":"@@ -208,7 +208,7 @@ public void fromCSV() throws Exception {\n \n             ExecTO exec = execProvisioningTask(taskService, PULL_TASK_KEY, 50, false);\n             assertEquals(PropagationTaskExecStatus.SUCCESS, PropagationTaskExecStatus.valueOf(exec.getStatus()));\n-            \n+\n             LOG.debug(\"Execution of task {}:\\n{}\", PULL_TASK_KEY, exec);\n \n             // check for pull results\n@@ -382,6 +382,10 @@ public void reconcileFromLDAP() {\n                 build());\n         assertNotNull(matchingGroups);\n         assertEquals(1, matchingGroups.getResult().size());\n+        // SYNCOPE-898\n+        PullTaskTO task = taskService.read(\"1e419ca4-ea81-4493-a14f-28b90113686d\", false);\n+        assertEquals(\"/\", task.getDestinationRealm());\n+        assertEquals(\"/\", matchingGroups.getResult().get(0).getRealm());\n \n         // 3. verify that pulled user is found\n         PagedResult<UserTO> matchingUsers = userService.search(\n@@ -390,6 +394,8 @@ public void reconcileFromLDAP() {\n                 build());\n         assertNotNull(matchingUsers);\n         assertEquals(1, matchingUsers.getResult().size());\n+        // SYNCOPE-898\n+        assertEquals(\"/odd\", matchingUsers.getResult().get(0).getRealm());\n \n         // Check for SYNCOPE-436\n         assertEquals(\"pullFromLDAP\","}]}