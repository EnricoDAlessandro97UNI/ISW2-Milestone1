{"sha":"02bccb360a0320a7df1b8db8e436350f4f657c10","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjAyYmNjYjM2MGEwMzIwYTdkZjFiOGRiOGU0MzYzNTBmNGY2NTdjMTA=","commit":{"author":{"name":"Tushar","email":"tusharm567@gmail.com","date":"2016-06-03T12:57:17Z"},"committer":{"name":"Francesco Chicchiricc√≤","email":"ilgrosso@apache.org","date":"2016-06-06T09:15:14Z"},"message":"Added Exception for existing key (SYNCOPE-866) - This closes #18","tree":{"sha":"563dadbb843bf21ea8c4814bbee6a391b7c629a3","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/563dadbb843bf21ea8c4814bbee6a391b7c629a3"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/02bccb360a0320a7df1b8db8e436350f4f657c10","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/02bccb360a0320a7df1b8db8e436350f4f657c10","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/02bccb360a0320a7df1b8db8e436350f4f657c10","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/02bccb360a0320a7df1b8db8e436350f4f657c10/comments","author":{"login":"tmess567","id":9494086,"node_id":"MDQ6VXNlcjk0OTQwODY=","avatar_url":"https://avatars.githubusercontent.com/u/9494086?v=4","gravatar_id":"","url":"https://api.github.com/users/tmess567","html_url":"https://github.com/tmess567","followers_url":"https://api.github.com/users/tmess567/followers","following_url":"https://api.github.com/users/tmess567/following{/other_user}","gists_url":"https://api.github.com/users/tmess567/gists{/gist_id}","starred_url":"https://api.github.com/users/tmess567/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tmess567/subscriptions","organizations_url":"https://api.github.com/users/tmess567/orgs","repos_url":"https://api.github.com/users/tmess567/repos","events_url":"https://api.github.com/users/tmess567/events{/privacy}","received_events_url":"https://api.github.com/users/tmess567/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"eb7abbdf70a57a7b59a3a17c86e95cd05ac2ec13","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/eb7abbdf70a57a7b59a3a17c86e95cd05ac2ec13","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/eb7abbdf70a57a7b59a3a17c86e95cd05ac2ec13"}],"stats":{"total":32,"additions":32,"deletions":0},"files":[{"sha":"978b2bdd810387a89b3b907ac96441d27bdb4407","filename":"core/logic/src/main/java/org/apache/syncope/core/logic/MailTemplateLogic.java","status":"modified","additions":4,"deletions":0,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/02bccb360a0320a7df1b8db8e436350f4f657c10/core%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FMailTemplateLogic.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/02bccb360a0320a7df1b8db8e436350f4f657c10/core%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FMailTemplateLogic.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FMailTemplateLogic.java?ref=02bccb360a0320a7df1b8db8e436350f4f657c10","patch":"@@ -31,6 +31,7 @@\n import org.apache.syncope.common.lib.types.MailTemplateFormat;\n import org.apache.syncope.common.lib.types.StandardEntitlement;\n import org.apache.syncope.core.persistence.api.dao.NotFoundException;\n+import org.apache.syncope.core.persistence.api.dao.DuplicateException;\n import org.apache.syncope.core.persistence.api.dao.MailTemplateDAO;\n import org.apache.syncope.core.persistence.api.dao.NotificationDAO;\n import org.apache.syncope.core.persistence.api.entity.EntityFactory;\n@@ -83,6 +84,9 @@ public MailTemplateTO transform(final MailTemplate input) {\n \n     @PreAuthorize(\"hasRole('\" + StandardEntitlement.MAIL_TEMPLATE_CREATE + \"')\")\n     public MailTemplateTO create(final String key) {\n+        if (mailTemplateDAO.find(key) != null) {\n+            throw new DuplicateException(key);\n+        }\n         MailTemplate mailTemplate = entityFactory.newEntity(MailTemplate.class);\n         mailTemplate.setKey(key);\n         mailTemplateDAO.save(mailTemplate);"},{"sha":"11a7f385c3621a7ae2a59f3cc566ad7e0896260d","filename":"core/logic/src/main/java/org/apache/syncope/core/logic/ReportTemplateLogic.java","status":"modified","additions":4,"deletions":0,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/02bccb360a0320a7df1b8db8e436350f4f657c10/core%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FReportTemplateLogic.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/02bccb360a0320a7df1b8db8e436350f4f657c10/core%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FReportTemplateLogic.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Flogic%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Flogic%2FReportTemplateLogic.java?ref=02bccb360a0320a7df1b8db8e436350f4f657c10","patch":"@@ -31,6 +31,7 @@\n import org.apache.syncope.common.lib.types.ReportTemplateFormat;\n import org.apache.syncope.common.lib.types.StandardEntitlement;\n import org.apache.syncope.core.persistence.api.dao.NotFoundException;\n+import org.apache.syncope.core.persistence.api.dao.DuplicateException;\n import org.apache.syncope.core.persistence.api.dao.ReportTemplateDAO;\n import org.apache.syncope.core.persistence.api.dao.ReportDAO;\n import org.apache.syncope.core.persistence.api.entity.EntityFactory;\n@@ -84,6 +85,9 @@ public ReportTemplateTO transform(final ReportTemplate input) {\n \n     @PreAuthorize(\"hasRole('\" + StandardEntitlement.REPORT_TEMPLATE_CREATE + \"')\")\n     public ReportTemplateTO create(final String key) {\n+        if (reportTemplateDAO.find(key) != null) {\n+            throw new DuplicateException(key);\n+        }\n         ReportTemplate reportTemplate = entityFactory.newEntity(ReportTemplate.class);\n         reportTemplate.setKey(key);\n         reportTemplateDAO.save(reportTemplate);"},{"sha":"c43cb9b5cc50afdabc510a7a2cc7a94ffdfcec93","filename":"fit/core-reference/src/test/java/org/apache/syncope/fit/core/MailTemplateITCase.java","status":"modified","additions":12,"deletions":0,"changes":12,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/02bccb360a0320a7df1b8db8e436350f4f657c10/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FMailTemplateITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/02bccb360a0320a7df1b8db8e436350f4f657c10/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FMailTemplateITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FMailTemplateITCase.java?ref=02bccb360a0320a7df1b8db8e436350f4f657c10","patch":"@@ -150,4 +150,16 @@ public void crud() throws IOException {\n             assertEquals(ClientExceptionType.NotFound, e.getType());\n         }\n     }\n+\n+    @Test\n+    public void issueSYNCOPE866() {\n+        MailTemplateTO mailTemplateTO = new MailTemplateTO();\n+        mailTemplateTO.setKey(\"optin\");\n+        try {\n+            mailTemplateService.create(mailTemplateTO);\n+            fail();\n+        } catch (SyncopeClientException e) {\n+            assertEquals(ClientExceptionType.EntityExists, e.getType());\n+        }\n+    }\n }"},{"sha":"487e9368ea6bf942a2c5623846e6c3364c8ce96c","filename":"fit/core-reference/src/test/java/org/apache/syncope/fit/core/ReportTemplateITCase.java","status":"modified","additions":12,"deletions":0,"changes":12,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/02bccb360a0320a7df1b8db8e436350f4f657c10/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FReportTemplateITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/02bccb360a0320a7df1b8db8e436350f4f657c10/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FReportTemplateITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fcore%2FReportTemplateITCase.java?ref=02bccb360a0320a7df1b8db8e436350f4f657c10","patch":"@@ -152,4 +152,16 @@ public void crud() throws IOException {\n             assertEquals(ClientExceptionType.NotFound, e.getType());\n         }\n     }\n+\n+    @Test\n+    public void issueSYNCOPE866() {\n+        ReportTemplateTO reportTemplateTO = new ReportTemplateTO();\n+        reportTemplateTO.setKey(\"empty\");\n+        try {\n+            reportTemplateService.create(reportTemplateTO);\n+            fail();\n+        } catch (SyncopeClientException e) {\n+            assertEquals(ClientExceptionType.EntityExists, e.getType());\n+        }\n+    }\n }"}]}