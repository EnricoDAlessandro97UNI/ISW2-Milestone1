{"sha":"755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjc1NTU5MWM3Y2Y4YzlmZTFiYjdjOWUzOThjMmNjZDE1OGM5Y2RkNjc=","commit":{"author":{"name":"giacomolm","email":"giacomolm@hotmail.it","date":"2016-02-08T16:09:36Z"},"committer":{"name":"giacomolm","email":"giacomolm@hotmail.it","date":"2016-02-08T16:18:42Z"},"message":"[SYNCOPE-720] Password reset flow completed","tree":{"sha":"893e8d8ad81a253b21c592a6e08b120435446d3b","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/893e8d8ad81a253b21c592a6e08b120435446d3b"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67/comments","author":{"login":"giacomolm","id":4027829,"node_id":"MDQ6VXNlcjQwMjc4Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/4027829?v=4","gravatar_id":"","url":"https://api.github.com/users/giacomolm","html_url":"https://github.com/giacomolm","followers_url":"https://api.github.com/users/giacomolm/followers","following_url":"https://api.github.com/users/giacomolm/following{/other_user}","gists_url":"https://api.github.com/users/giacomolm/gists{/gist_id}","starred_url":"https://api.github.com/users/giacomolm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/giacomolm/subscriptions","organizations_url":"https://api.github.com/users/giacomolm/orgs","repos_url":"https://api.github.com/users/giacomolm/repos","events_url":"https://api.github.com/users/giacomolm/events{/privacy}","received_events_url":"https://api.github.com/users/giacomolm/received_events","type":"User","site_admin":false},"committer":{"login":"giacomolm","id":4027829,"node_id":"MDQ6VXNlcjQwMjc4Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/4027829?v=4","gravatar_id":"","url":"https://api.github.com/users/giacomolm","html_url":"https://github.com/giacomolm","followers_url":"https://api.github.com/users/giacomolm/followers","following_url":"https://api.github.com/users/giacomolm/following{/other_user}","gists_url":"https://api.github.com/users/giacomolm/gists{/gist_id}","starred_url":"https://api.github.com/users/giacomolm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/giacomolm/subscriptions","organizations_url":"https://api.github.com/users/giacomolm/orgs","repos_url":"https://api.github.com/users/giacomolm/repos","events_url":"https://api.github.com/users/giacomolm/events{/privacy}","received_events_url":"https://api.github.com/users/giacomolm/received_events","type":"User","site_admin":false},"parents":[{"sha":"4cc46deba44f82aab3df3235bd43fa41aa6cc5e5","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/4cc46deba44f82aab3df3235bd43fa41aa6cc5e5","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/4cc46deba44f82aab3df3235bd43fa41aa6cc5e5"}],"stats":{"total":250,"additions":241,"deletions":9},"files":[{"sha":"a5a42aec53970c0a4d778ab03e0047aa73505e85","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/SyncopeEnduserApplication.java","status":"modified","additions":11,"deletions":0,"changes":11,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeEnduserApplication.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeEnduserApplication.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2FSyncopeEnduserApplication.java?ref=755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67","patch":"@@ -37,6 +37,7 @@\n import org.apache.syncope.client.enduser.resources.SyncopeAnyTypeResource;\n import org.apache.syncope.client.enduser.resources.SyncopeGroupResource;\n import org.apache.syncope.client.enduser.resources.SyncopeResourceResource;\n+import org.apache.syncope.client.enduser.resources.UserSelfConfirmPasswordReset;\n import org.apache.syncope.client.enduser.resources.UserSelfCreateResource;\n import org.apache.syncope.client.enduser.resources.UserSelfPasswordReset;\n import org.apache.syncope.client.enduser.resources.UserSelfReadResource;\n@@ -196,6 +197,16 @@ public IResource getResource() {\n             }\n         });\n \n+        mountResource(\"/api/self/confirmPasswordReset\", new ResourceReference(\"userSelfConfirmPasswordReset\") {\n+\n+            private static final long serialVersionUID = -128426276529456602L;\n+\n+            @Override\n+            public IResource getResource() {\n+                return new UserSelfConfirmPasswordReset();\n+            }\n+        });\n+\n         mountResource(\"/api/schemas\", new ResourceReference(\"schemas\") {\n \n             private static final long serialVersionUID = -128426276529456602L;"},{"sha":"801aeda57ba0b5581ecec7db4221d8a89569faf2","filename":"client/enduser/src/main/java/org/apache/syncope/client/enduser/resources/UserSelfConfirmPasswordReset.java","status":"added","additions":93,"deletions":0,"changes":93,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfConfirmPasswordReset.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfConfirmPasswordReset.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fenduser%2Fresources%2FUserSelfConfirmPasswordReset.java?ref=755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67","patch":"@@ -0,0 +1,93 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.client.enduser.resources;\n+\n+import java.io.IOException;\n+import java.util.Map;\n+import javax.servlet.http.HttpServletRequest;\n+import javax.ws.rs.core.Response;\n+import org.apache.syncope.client.enduser.SyncopeEnduserSession;\n+import org.apache.syncope.common.rest.api.service.UserSelfService;\n+import org.apache.wicket.request.resource.AbstractResource;\n+import org.apache.wicket.request.resource.IResource;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+public class UserSelfConfirmPasswordReset extends AbstractBaseResource {\n+\n+    private static final long serialVersionUID = -2721621682300247583L;\n+\n+    private static final Logger LOG = LoggerFactory.getLogger(UserSelfConfirmPasswordReset.class);\n+\n+    private final UserSelfService userSelfService;\n+\n+    public UserSelfConfirmPasswordReset() {\n+        userSelfService = SyncopeEnduserSession.get().getService(UserSelfService.class);\n+    }\n+\n+    @Override\n+    protected ResourceResponse newResourceResponse(final IResource.Attributes attributes) {\n+\n+        AbstractResource.ResourceResponse response = new AbstractResource.ResourceResponse();\n+\n+        try {\n+            HttpServletRequest request = (HttpServletRequest) attributes.getRequest().getContainerRequest();\n+            if (!xsrfCheck(request)) {\n+                LOG.error(\"XSRF TOKEN does not match\");\n+                response.setError(Response.Status.BAD_REQUEST.getStatusCode(), \"XSRF TOKEN does not match\");\n+                return response;\n+            }\n+\n+            Map<String, String[]> parameters = request.getParameterMap();\n+            String token;\n+            if (parameters.get(\"token\") == null || parameters.get(\"token\").length == 0) {\n+                throw new Exception(\"A valid token should be provided\");\n+            } else {\n+                token = parameters.get(\"token\")[0];\n+            }\n+\n+            if (parameters.get(\"newPassword\") == null || parameters.get(\"newPassword\").length == 0) {\n+                throw new Exception(\"A new correct password should be provided\");\n+            }\n+            userSelfService.confirmPasswordReset(token, parameters.get(\"newPassword\")[0]);\n+\n+            final String responseMessage = new StringBuilder().append(\"Password changed correctly\").toString();\n+\n+            response.setWriteCallback(new WriteCallback() {\n+\n+                @Override\n+                public void writeData(final Attributes attributes) throws IOException {\n+                    attributes.getResponse().write(responseMessage);\n+                }\n+            });\n+\n+            response.setStatusCode(Response.Status.OK.getStatusCode());\n+\n+        } catch (final Exception e) {\n+            LOG.error(\"Error while updating user\", e);\n+            response.setError(Response.Status.BAD_REQUEST.getStatusCode(), new StringBuilder()\n+                    .append(\"ErrorMessage{{ \")\n+                    .append(e.getMessage())\n+                    .append(\" }}\")\n+                    .toString());\n+        }\n+        return response;\n+    }\n+\n+}"},{"sha":"04f4eb23ff1005f66d02d361ef8245ac125edeaa","filename":"client/enduser/src/main/resources/META-INF/resources/app/css/app.css","status":"modified","additions":1,"deletions":0,"changes":1,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fcss%2Fapp.css","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fcss%2Fapp.css","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fcss%2Fapp.css?ref=755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67","patch":"@@ -29,6 +29,7 @@ under the License.\n \n .k-notification-wrap{\n   white-space: normal !important;\n+  word-wrap: break-word !important;\n }\n \n .k-notification{"},{"sha":"a8f71202a7eb83ec5511d08d649b1f962791c9e2","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/app.js","status":"modified","additions":5,"deletions":1,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fapp.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fapp.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fapp.js?ref=755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67","patch":"@@ -179,6 +179,10 @@ app.config(['$stateProvider', '$urlRouterProvider', '$httpProvider',\n             .state('passwordreset', {\n               url: '/passwordreset',\n               templateUrl: 'views/passwordreset.html'\n+            })\n+            .state('confirmpasswordreset', {\n+              url: '/confirmpasswordreset?token',\n+              templateUrl: 'views/confirmpasswordreset.html'\n             });\n \n     // catch all other routes\n@@ -309,7 +313,7 @@ app.controller('ApplicationController', ['$scope', '$rootScope', 'InfoService',\n       $scope.showError = function (message, component) {\n         if (!$scope.notificationExists(message)) {\n           component.options.autoHideAfter = 0;\n-          component.show(message, \"error\");\n+          component.show(message, \"error\");          \n         }\n       }\n       $scope.notificationExists = function (message) {"},{"sha":"45dc623172943498bb1be7ca2bf98112de0f6815","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/controllers/UserController.js","status":"modified","additions":32,"deletions":3,"changes":35,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fcontrollers%2FUserController.js?ref=755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67","patch":"@@ -21,9 +21,10 @@\n \n angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$location', '$compile', 'AuthService',\n   'UserSelfService', 'SchemaService', 'RealmService', 'ResourceService', 'SecurityQuestionService', 'CaptchaService',\n-  'GroupService', 'AnyService', 'UserUtil',\n+  'GroupService', 'AnyService', 'UserUtil', 'GenericUtil', \"ValidationExecutor\",\n   function ($scope, $rootScope, $location, $compile, AuthService, UserSelfService, SchemaService, RealmService,\n-          ResourceService, SecurityQuestionService, CaptchaService, GroupService, AnyService, UserUtil) {\n+          ResourceService, SecurityQuestionService, CaptchaService, GroupService, AnyService, UserUtil, GenericUtil,\n+          ValidationExecutor) {\n \n     $scope.user = {};\n     $scope.confirmPassword = {\n@@ -411,5 +412,33 @@ angular.module(\"self\").controller(\"UserController\", ['$scope', '$rootScope', '$l\n       } else {\n         $scope.showError(\"You should use a valid and non-empty username\", $scope.notification);\n       }\n-    };    \n+    };\n+\n+    $scope.confirmPasswordReset = function (user, event) {\n+\n+      //getting the enclosing form in order to access to its controller                \n+      var currentForm = GenericUtil.getEnclosingFormController(event.target, $scope);\n+      if (currentForm != null) {\n+        //check if password and confirmPassword are equals using angular built-in validation\n+        if (ValidationExecutor.validate(currentForm, $scope)) {          \n+          var token = $location.search().token;\n+          if (user && user.password && token) {\n+            UserSelfService.confirmPasswordReset({\"newPassword\": user.password, \"token\": token}).then(function (data) {\n+              $scope.showSuccess(data, $scope.notification);\n+              $location.path('/self');\n+            }, function (response) {\n+              var errorMessage;\n+              // parse error response \n+              if (response !== undefined) {\n+                errorMessage = response.split(\"ErrorMessage{{\")[1];\n+                errorMessage = errorMessage.split(\"}}\")[0];\n+                $scope.showError(\"An error occured during password reset: \" + errorMessage, $scope.notification);                \n+              }\n+            });\n+          } else {\n+            $scope.showError(\"You should use a valid and non-empty password\", $scope.notification);\n+          }\n+        }\n+      }\n+    };\n   }]);"},{"sha":"ec1f51e655c808b19756ca1a15682a0ec251b170","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/services/userSelfService.js","status":"modified","additions":20,"deletions":0,"changes":20,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fservices%2FuserSelfService.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fservices%2FuserSelfService.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fservices%2FuserSelfService.js?ref=755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67","patch":"@@ -82,6 +82,26 @@ angular.module('login')\n                         return $q.reject(response.data || response.statusText);\n                       });\n             };\n+            userSelfService.confirmPasswordReset = function (body) {\n+              return $http\n+                      .post('/syncope-enduser/api/self/confirmPasswordReset', body,\n+                              {\n+                                headers: {\n+                                  'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8'\n+                                },\n+                                transformRequest: function (obj) {\n+                                  var str = [];\n+                                  for (var p in obj)\n+                                    str.push(encodeURIComponent(p) + \"=\" + encodeURIComponent(obj[p]));\n+                                  return str.join(\"&\");\n+                                }\n+                              })\n+                      .then(function (response) {\n+                        return response.data || response.statusText;\n+                      }, function (response) {\n+                        return $q.reject(response.data || response.statusText);\n+                      });\n+            };\n             return userSelfService;\n           }]);\n "},{"sha":"db4e4cbdf825fcd75a3f6f92638b4a55a4302984","filename":"client/enduser/src/main/resources/META-INF/resources/app/js/validator/validationExecutor.js","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fvalidator%2FvalidationExecutor.js","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fvalidator%2FvalidationExecutor.js","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fjs%2Fvalidator%2FvalidationExecutor.js?ref=755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67","patch":"@@ -26,7 +26,7 @@ angular.module('SyncopeEnduserApp')\n             \n             validationExecutor.validate = function (form, scope) {              \n               if(scope.validationEnabled){\n-                var currentForm = scope[form.name];              \n+                var currentForm = scope[form.name] || scope[form.$name];              \n                 angular.forEach(currentForm.$error, function (field) {\n                   for (var i in field) {                  \n                     scope.$root.$broadcast(field[i].$name, {errors: field[i].$error});"},{"sha":"432404b59f480f0300665561fb25534965d08dd1","filename":"client/enduser/src/main/resources/META-INF/resources/app/views/confirmpasswordreset.html","status":"added","additions":74,"deletions":0,"changes":74,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fconfirmpasswordreset.html","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fconfirmpasswordreset.html","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fenduser%2Fsrc%2Fmain%2Fresources%2FMETA-INF%2Fresources%2Fapp%2Fviews%2Fconfirmpasswordreset.html?ref=755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67","patch":"@@ -0,0 +1,74 @@\n+<!--\n+Licensed to the Apache Software Foundation (ASF) under one\n+or more contributor license agreements.  See the NOTICE file\n+distributed with this work for additional information\n+regarding copyright ownership.  The ASF licenses this file\n+to you under the Apache License, Version 2.0 (the\n+\"License\"); you may not use this file except in compliance\n+with the License.  You may obtain a copy of the License at\n+\n+  http://www.apache.org/licenses/LICENSE-2.0\n+\n+Unless required by applicable law or agreed to in writing,\n+software distributed under the License is distributed on an\n+\"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+KIND, either express or implied.  See the License for the\n+specific language governing permissions and limitations\n+under the License.\n+-->\n+<div ng-cloak class=\"container\">\n+  <div ng-controller=\"UserController\" style=\"box-sizing: border-box; \">\n+\n+    <div id=\"form-container\" class=\"col-md-6 col-md-offset-3\" style=\"box-sizing: border-box; background-color: #F7F7F7;\">\n+\n+      <div>\n+        <div class=\"page-header\" style=\"text-align: left; font-weight: 700;\">\n+          <span>Confirm password reset</span>\n+        </div>\n+        <div class=\"breadcrumb-header text-center\">\n+\n+          <div class=\"row\">            \n+            <div id=\"status-buttons\" class=\"btn-group btn-breadcrumb\">\n+              <a href=\"#/self\" class=\"btn btn-default\"><i class=\"glyphicon glyphicon-home\"></i></a>\n+              <!--add class breadcrumb-disabled-link to buttons to prevent click-->\n+              <a ui-sref-active=\"active\" class=\"btn btn-default\">Password reset</a>\n+            </div>\n+          </div>\n+        </div>\n+        <form class=\"signup-form\" name=\"confirmPasswordResetForm\" ng-submit=\"confirmPasswordReset(user, $event)\" novalidate>\n+\n+          <div id=\"form-views\" ui-view>\n+            <div id=\"attribute\" class=\"form-group\">\n+              <label for=\"user.password\">Password</label>\n+              <input type=\"password\" class=\"form-control\" name=\"password\" ng-model=\"user.password\" placeholder=\"password\">\n+            </div>\n+\n+            <div id=\"attribute\" class=\"form-group\">\n+              <label for=\"confirmPassword\">Confirm Password</label>\n+              <input name=\"password\" type=\"password\" class=\"form-control\" equals=\"user.password\" ng-model=\"confirmPassword.value\"\n+                     placeholder=\"confirm password\" validate=\"true\">\n+              <validation-message name=\"password\"/>\n+            </div>\n+\n+            <div id=\"attribute\" class=\"form-group\">\n+              <div class=\"suggestions\">\n+                Password Strength: \n+                <span ng-if=\"passStrength < 50\">Not secure!</span>\n+                <span ng-if=\"passStrength >= 50 && passStrength <= 82\">Secure, but you could do better!</span>\n+                <span ng-if=\"passStrength > 82\">Very Good!</span>\n+              </div>\n+              <div ng-password-strength=\"user.password\" strength=\"passStrength\" inner-class=\"progress-bar\" inner-class-prefix=\"progress-bar-\">\n+              </div>\n+            </div>\n+            <div id=\"attribute\" class=\"form-group row\">\n+              <button id=\"resetpassword\" type=\"submit\" class=\"btn btn-default pull-right\">Submit</button>\n+              <div class=\"pull-left\">\n+                <a id=\"cancel\" href=\"#/self\" class=\"btn btn-danger\">Cancel</a>\n+              </div>\n+            </div>\n+          </div>\n+        </form>\n+      </div>\n+    </div>\n+  </div>\n+</div>"},{"sha":"1d59b715bed4f93ce42fd99831ffe423a45ad102","filename":"core/persistence-jpa/src/main/resources/domains/MasterContent.xml","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67/core%2Fpersistence-jpa%2Fsrc%2Fmain%2Fresources%2Fdomains%2FMasterContent.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67/core%2Fpersistence-jpa%2Fsrc%2Fmain%2Fresources%2Fdomains%2FMasterContent.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa%2Fsrc%2Fmain%2Fresources%2Fdomains%2FMasterContent.xml?ref=755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67","patch":"@@ -122,7 +122,7 @@ a password reset was request for ${user.getUsername()}.\n \n In order to complete this request, you need to visit this link:\n \n-http://localhost:9080/syncope-console/?pwdResetToken=${input.get(0).replaceAll(' ', '%20')}\n+http://localhost:9080/syncope-enduser/app/#/confirmpasswordreset?token=${input.get(0).replaceAll(' ', '%20')}\n \n If you did not request this reset, just ignore the present e-mail.\n \n@@ -133,7 +133,7 @@ Best regards.\"\n a password reset was request for ${user.getUsername()}.&lt;/p&gt;\n \n &lt;p&gt;In order to complete this request, you need to visit this \n-&lt;a href=&quot;http://localhost:9080/syncope-console/?pwdResetToken=${input.get(0).replaceAll(' ', '%20')}&quot;&gt;link&lt;/a&gt;&lt;/p&gt;.\n+&lt;a href=&quot;http://localhost:9080/syncope-enduser/app/#/confirmpasswordreset?token=${input.get(0).replaceAll(' ', '%20')}&quot;&gt;link&lt;/a&gt;&lt;/p&gt;.\n \n &lt;p&gt;If you did not request this reset, just ignore the present e-mail.&lt;/p&gt;\n "},{"sha":"fa890e605012e0ad9de68eb66bb2e02dd5630064","filename":"core/persistence-jpa/src/test/resources/domains/MasterContent.xml","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67/core%2Fpersistence-jpa%2Fsrc%2Ftest%2Fresources%2Fdomains%2FMasterContent.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67/core%2Fpersistence-jpa%2Fsrc%2Ftest%2Fresources%2Fdomains%2FMasterContent.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa%2Fsrc%2Ftest%2Fresources%2Fdomains%2FMasterContent.xml?ref=755591c7cf8c9fe1bb7c9e398c2ccd158c9cdd67","patch":"@@ -1100,7 +1100,7 @@ a password reset was request for ${user.getUsername()}.\n \n In order to complete this request, you need to visit this link:\n \n-http://localhost:9080/syncope-console/?pwdResetToken=${input.get(0).replaceAll(' ', '%20')}\n+http://localhost:9080/syncope-enduser/app/#/confirmpasswordreset?token=${input.get(0).replaceAll(' ', '%20')}\n \n If you did not request this reset, just ignore the present e-mail.\n \n@@ -1111,7 +1111,7 @@ Best regards.\"\n a password reset was request for ${user.getUsername()}.&lt;/p&gt;\n \n &lt;p&gt;In order to complete this request, you need to visit this \n-&lt;a href=&quot;http://localhost:9080/syncope-console/?pwdResetToken=${input.get(0).replaceAll(' ', '%20')}&quot;&gt;link&lt;/a&gt;&lt;/p&gt;.\n+&lt;a href=&quot;http://localhost:9080/syncope-enduser/app/#/confirmpasswordreset?token=${input.get(0).replaceAll(' ', '%20')}&quot;&gt;link&lt;/a&gt;&lt;/p&gt;.\n \n &lt;p&gt;If you did not request this reset, just ignore the present e-mail.&lt;/p&gt;\n "}]}