{"sha":"78b0d9ddc22f71a82eb20e396c83c46b1d08d642","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjc4YjBkOWRkYzIyZjcxYTgyZWIyMGUzOTZjODNjNDZiMWQwOGQ2NDI=","commit":{"author":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2021-03-16T09:35:12Z"},"committer":{"name":"Francesco Chicchiriccò","email":"ilgrosso@apache.org","date":"2021-03-16T14:49:23Z"},"message":"Fixing explicit typecast missing with PostgreSQL 13 (verified it works with PostgreSQL 12 too)","tree":{"sha":"7552acd7306206b5a5fda6c723edf15d2be9aef3","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/7552acd7306206b5a5fda6c723edf15d2be9aef3"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/78b0d9ddc22f71a82eb20e396c83c46b1d08d642","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/78b0d9ddc22f71a82eb20e396c83c46b1d08d642","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/78b0d9ddc22f71a82eb20e396c83c46b1d08d642","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/78b0d9ddc22f71a82eb20e396c83c46b1d08d642/comments","author":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"committer":{"login":"ilgrosso","id":1064664,"node_id":"MDQ6VXNlcjEwNjQ2NjQ=","avatar_url":"https://avatars.githubusercontent.com/u/1064664?v=4","gravatar_id":"","url":"https://api.github.com/users/ilgrosso","html_url":"https://github.com/ilgrosso","followers_url":"https://api.github.com/users/ilgrosso/followers","following_url":"https://api.github.com/users/ilgrosso/following{/other_user}","gists_url":"https://api.github.com/users/ilgrosso/gists{/gist_id}","starred_url":"https://api.github.com/users/ilgrosso/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilgrosso/subscriptions","organizations_url":"https://api.github.com/users/ilgrosso/orgs","repos_url":"https://api.github.com/users/ilgrosso/repos","events_url":"https://api.github.com/users/ilgrosso/events{/privacy}","received_events_url":"https://api.github.com/users/ilgrosso/received_events","type":"User","site_admin":false},"parents":[{"sha":"3514e04b4fb7908885a20e8ed713802edfeb4006","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/3514e04b4fb7908885a20e8ed713802edfeb4006","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/3514e04b4fb7908885a20e8ed713802edfeb4006"}],"stats":{"total":6,"additions":3,"deletions":3},"files":[{"sha":"56df7a528a2b0acb6ab3fb1c8805d3bd08de69cb","filename":"core/persistence-jpa-json/src/main/java/org/apache/syncope/core/persistence/jpa/dao/PGJPAJSONAnyDAO.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/78b0d9ddc22f71a82eb20e396c83c46b1d08d642/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FPGJPAJSONAnyDAO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/78b0d9ddc22f71a82eb20e396c83c46b1d08d642/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FPGJPAJSONAnyDAO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FPGJPAJSONAnyDAO.java?ref=78b0d9ddc22f71a82eb20e396c83c46b1d08d642","patch":"@@ -64,7 +64,7 @@ protected String attrValueMatch(\n             } else {\n                 ((JSONPlainAttr) container).add(attrValue);\n             }\n-            return \"plainAttrs @> '\" + POJOHelper.serialize(List.of(container)).replace(\"'\", \"''\") + \"'::jsonb\";\n+            return \"plainAttrs::jsonb @> '\" + POJOHelper.serialize(List.of(container)).replace(\"'\", \"''\") + \"'::jsonb\";\n         }\n     }\n }"},{"sha":"071625d86a919454811456d3e4e5cd45799f06f4","filename":"core/persistence-jpa-json/src/main/java/org/apache/syncope/core/persistence/jpa/dao/PGJPAJSONLoggerDAO.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/78b0d9ddc22f71a82eb20e396c83c46b1d08d642/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FPGJPAJSONLoggerDAO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/78b0d9ddc22f71a82eb20e396c83c46b1d08d642/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FPGJPAJSONLoggerDAO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FPGJPAJSONLoggerDAO.java?ref=78b0d9ddc22f71a82eb20e396c83c46b1d08d642","patch":"@@ -41,7 +41,7 @@ protected String doBuild(final List<ObjectNode> containers) {\n                 if (entityKey != null) {\n                     query.append(\" AND (\");\n                 }\n-                query.append(containers.stream().map(container -> AUDIT_MESSAGE_COLUMN + \" @> '\"\n+                query.append(containers.stream().map(container -> AUDIT_MESSAGE_COLUMN + \"::jsonb @> '\"\n                         + POJOHelper.serialize(container).replace(\"'\", \"''\")\n                         + \"'::jsonb\").collect(Collectors.joining(\" OR \")));\n                 if (entityKey != null) {"},{"sha":"e9ad63f21f5126659650c188101be4b7519c2335","filename":"core/persistence-jpa-json/src/main/java/org/apache/syncope/core/persistence/jpa/dao/PGJPAJSONPlainSchemaDAO.java","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/78b0d9ddc22f71a82eb20e396c83c46b1d08d642/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FPGJPAJSONPlainSchemaDAO.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/78b0d9ddc22f71a82eb20e396c83c46b1d08d642/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FPGJPAJSONPlainSchemaDAO.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/core%2Fpersistence-jpa-json%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fcore%2Fpersistence%2Fjpa%2Fdao%2FPGJPAJSONPlainSchemaDAO.java?ref=78b0d9ddc22f71a82eb20e396c83c46b1d08d642","patch":"@@ -28,7 +28,7 @@ public class PGJPAJSONPlainSchemaDAO extends AbstractJPAJSONPlainSchemaDAO {\n     public <T extends PlainAttr<?>> boolean hasAttrs(final PlainSchema schema, final Class<T> reference) {\n         Query query = entityManager().createNativeQuery(\n                 \"SELECT COUNT(id) FROM \" + new SearchSupport(getAnyTypeKind(reference)).table().name\n-                + \" WHERE plainAttrs @> '[{\\\"schema\\\":\\\"\" + schema.getKey() + \"\\\"}]'::jsonb\");\n+                + \" WHERE plainAttrs::jsonb @> '[{\\\"schema\\\":\\\"\" + schema.getKey() + \"\\\"}]'::jsonb\");\n \n         return ((Number) query.getSingleResult()).intValue() > 0;\n     }"}]}