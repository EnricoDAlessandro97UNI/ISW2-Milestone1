{"sha":"fa91567d71b7e62cbb4c88a3ad9a70e2de7bd97d","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOmZhOTE1NjdkNzFiN2U2MmNiYjRjODhhM2FkOWE3MGUyZGU3YmQ5N2Q=","commit":{"author":{"name":"massi","email":"massimiliano.perrone@tirasa.net","date":"2015-12-04T13:00:44Z"},"committer":{"name":"massi","email":"massimiliano.perrone@tirasa.net","date":"2015-12-04T13:00:59Z"},"message":"Added delete all propagation tasks and bugfix on delete propagation, SYNCOPE-158","tree":{"sha":"adc66d67930cdb1d06faa1e821b2584debddc0dc","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/adc66d67930cdb1d06faa1e821b2584debddc0dc"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/fa91567d71b7e62cbb4c88a3ad9a70e2de7bd97d","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/fa91567d71b7e62cbb4c88a3ad9a70e2de7bd97d","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/fa91567d71b7e62cbb4c88a3ad9a70e2de7bd97d","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/fa91567d71b7e62cbb4c88a3ad9a70e2de7bd97d/comments","author":{"login":"massx1","id":1792923,"node_id":"MDQ6VXNlcjE3OTI5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/1792923?v=4","gravatar_id":"","url":"https://api.github.com/users/massx1","html_url":"https://github.com/massx1","followers_url":"https://api.github.com/users/massx1/followers","following_url":"https://api.github.com/users/massx1/following{/other_user}","gists_url":"https://api.github.com/users/massx1/gists{/gist_id}","starred_url":"https://api.github.com/users/massx1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massx1/subscriptions","organizations_url":"https://api.github.com/users/massx1/orgs","repos_url":"https://api.github.com/users/massx1/repos","events_url":"https://api.github.com/users/massx1/events{/privacy}","received_events_url":"https://api.github.com/users/massx1/received_events","type":"User","site_admin":false},"committer":{"login":"massx1","id":1792923,"node_id":"MDQ6VXNlcjE3OTI5MjM=","avatar_url":"https://avatars.githubusercontent.com/u/1792923?v=4","gravatar_id":"","url":"https://api.github.com/users/massx1","html_url":"https://github.com/massx1","followers_url":"https://api.github.com/users/massx1/followers","following_url":"https://api.github.com/users/massx1/following{/other_user}","gists_url":"https://api.github.com/users/massx1/gists{/gist_id}","starred_url":"https://api.github.com/users/massx1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/massx1/subscriptions","organizations_url":"https://api.github.com/users/massx1/orgs","repos_url":"https://api.github.com/users/massx1/repos","events_url":"https://api.github.com/users/massx1/events{/privacy}","received_events_url":"https://api.github.com/users/massx1/received_events","type":"User","site_admin":false},"parents":[{"sha":"2080b51c515d17eb1b7c5c9d6ddf875e2952550e","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/2080b51c515d17eb1b7c5c9d6ddf875e2952550e","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/2080b51c515d17eb1b7c5c9d6ddf875e2952550e"}],"stats":{"total":78,"additions":76,"deletions":2},"files":[{"sha":"903cbfc156c9dfbe8e5037ee4a63d817cc4bfb55","filename":"client/cli/src/main/java/org/apache/syncope/client/cli/commands/task/TaskCommand.java","status":"modified","additions":4,"deletions":0,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fa91567d71b7e62cbb4c88a3ad9a70e2de7bd97d/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Ftask%2FTaskCommand.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fa91567d71b7e62cbb4c88a3ad9a70e2de7bd97d/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Ftask%2FTaskCommand.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Ftask%2FTaskCommand.java?ref=fa91567d71b7e62cbb4c88a3ad9a70e2de7bd97d","patch":"@@ -58,6 +58,9 @@ public void execute(final Input input) {\n             case DELETE:\n                 new TaskDelete(input).delete();\n                 break;\n+            case DELETE_PROP_TASK:\n+                new TaskDeleteAllProp(input).delete();\n+                break;\n             case DELETE_EXECUTION:\n                 new TaskExecutionDelete(input).delete();\n                 break;\n@@ -87,6 +90,7 @@ private enum Options {\n         READ(\"--read\"),\n         READ_EXECUTION(\"--read-execution\"),\n         DELETE(\"--delete\"),\n+        DELETE_PROP_TASK(\"--delete-all-prop\"),\n         DELETE_EXECUTION(\"--delete-execution\"),\n         EXECUTE(\"--execute\");\n "},{"sha":"4f41428175371ab8d411f435e0341df3aaf43241","filename":"client/cli/src/main/java/org/apache/syncope/client/cli/commands/task/TaskDeleteAllProp.java","status":"added","additions":66,"deletions":0,"changes":66,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fa91567d71b7e62cbb4c88a3ad9a70e2de7bd97d/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Ftask%2FTaskDeleteAllProp.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fa91567d71b7e62cbb4c88a3ad9a70e2de7bd97d/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Ftask%2FTaskDeleteAllProp.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Ftask%2FTaskDeleteAllProp.java?ref=fa91567d71b7e62cbb4c88a3ad9a70e2de7bd97d","patch":"@@ -0,0 +1,66 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.client.cli.commands.task;\n+\n+import javax.xml.ws.WebServiceException;\n+import org.apache.syncope.client.cli.Input;\n+import org.apache.syncope.common.lib.SyncopeClientException;\n+import org.apache.syncope.common.lib.to.AbstractTaskTO;\n+import org.slf4j.Logger;\n+import org.slf4j.LoggerFactory;\n+\n+public class TaskDeleteAllProp extends AbstractTaskCommand {\n+\n+    private static final Logger LOG = LoggerFactory.getLogger(TaskDeleteAllProp.class);\n+\n+    private static final String DELETE_HELP_MESSAGE = \"task --delete-all-prop\";\n+\n+    private final Input input;\n+\n+    public TaskDeleteAllProp(final Input input) {\n+        this.input = input;\n+    }\n+\n+    public void delete() {\n+\n+        if (input.parameterNumber() == 0) {\n+            for (final AbstractTaskTO taskTO : taskSyncopeOperations.listPropagationTask()) {\n+                final String taskId = String.valueOf(taskTO.getKey());\n+                try {\n+                    taskSyncopeOperations.delete(taskId);\n+                    taskResultManager.deletedMessage(\"Task\", taskId);\n+                } catch (final WebServiceException | SyncopeClientException ex) {\n+                    LOG.error(\"Error deleting task\", ex);\n+                    if (ex.getMessage().startsWith(\"NotFound\")) {\n+                        taskResultManager.notFoundError(\"Task\", taskId);\n+                    } else if (ex.getMessage().startsWith(\"DataIntegrityViolation\")) {\n+                        taskResultManager.genericError(\"You cannot delete task \" + taskId);\n+                    } else {\n+                        taskResultManager.genericError(ex.getMessage());\n+                    }\n+                } catch (final NumberFormatException ex) {\n+                    LOG.error(\"Error deleting task\", ex);\n+                    taskResultManager.notBooleanDeletedError(\"task\", taskId);\n+                }\n+            }\n+        } else {\n+            taskResultManager.commandOptionError(DELETE_HELP_MESSAGE);\n+        }\n+    }\n+}"},{"sha":"8a2ec627374da3634101a2849dbb2c28b9afe2e4","filename":"client/cli/src/main/java/org/apache/syncope/client/cli/commands/task/TaskSyncopeOperations.java","status":"modified","additions":5,"deletions":1,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fa91567d71b7e62cbb4c88a3ad9a70e2de7bd97d/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Ftask%2FTaskSyncopeOperations.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fa91567d71b7e62cbb4c88a3ad9a70e2de7bd97d/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Ftask%2FTaskSyncopeOperations.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Fclient%2Fcli%2Fcommands%2Ftask%2FTaskSyncopeOperations.java?ref=fa91567d71b7e62cbb4c88a3ad9a70e2de7bd97d","patch":"@@ -44,12 +44,16 @@ public <T extends AbstractTaskTO> T read(final String taskId) {\n     }\n \n     public void delete(final String taskId) {\n-        taskService.read(Long.valueOf(taskId));\n+        taskService.delete(Long.valueOf(taskId));\n     }\n \n     public List<AbstractTaskTO> list(final String type) {\n         return taskService.list(new TaskQuery.Builder().type(TaskType.valueOf(type)).build()).getResult();\n     }\n+    \n+    public List<AbstractTaskTO> listPropagationTask() {\n+        return taskService.list(new TaskQuery.Builder().type(TaskType.PROPAGATION).build()).getResult();\n+    }\n \n     public TaskExecTO readExecution(final String executionId) {\n         return taskService.readExecution(Long.valueOf(executionId));"},{"sha":"acd35abfa78df8514afdad65cc2d74af5f42d877","filename":"client/cli/src/main/resources/messages.properties","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/fa91567d71b7e62cbb4c88a3ad9a70e2de7bd97d/client%2Fcli%2Fsrc%2Fmain%2Fresources%2Fmessages.properties","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/fa91567d71b7e62cbb4c88a3ad9a70e2de7bd97d/client%2Fcli%2Fsrc%2Fmain%2Fresources%2Fmessages.properties","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/client%2Fcli%2Fsrc%2Fmain%2Fresources%2Fmessages.properties?ref=fa91567d71b7e62cbb4c88a3ad9a70e2de7bd97d","patch":"@@ -29,6 +29,6 @@ report.help.message=\\nUsage: report [options]\\n  Options:\\n    --help \\n    --de\n resource.help.message=\\nUsage: resource [options]\\n  Options:\\n    --help \\n    --details \\n    --list \\n    --read \\n       Syntax: --read {RESOURCE-NAME} {RESOURCE-NAME} [...]\\n    --delete \\n       Syntax: --delete {RESOURCE-NAME} {RESOURCE-NAME} [...]\\n\n role.help.message=\\nUsage: role [options]\\n  Options:\\n    --help \\n    --details \\n    --list \\n    --read \\n       Syntax: --read {ROLE-ID} {ROLE-ID} [...]\\n    --delete \\n       Syntax: --delete {ROLE-ID} {ROLE-ID} [...]\\n\n schema.help.message=\\nUsage: schema [options]\\n  Options:\\n    --help \\n    --details \\n    --list-all\\n    --list-plain\\n    --list-derived\\n    --list-virtual\\n    --read {SCHEMA-TYPE} {SCHEMA-KEY}\\n        Schema type: PLAIN / DERIVED / VIRTUAL\\n    --delete {SCHEMA-TYPE} {SCHEMA-KEY}\\n        Schema type: PLAIN / DERIVED / VIRTUAL\\n\n-task.help.message=\\nUsage: task [options]\\n  Options:\\n    --help \\n    --details\\n    --list\\n       Syntax: --list {TASK-TYPE} \\n          Task type: NOTIFICATION / PROPAGATION / PUSH / SCHEDULED / SYNCHRONIZATION\\n    --list-running-jobs \\n    --list-scheduled-jobs \\n    --read \\n       Syntax: --read {TASK-ID} {TASK-ID} [...]\\n    --read-execution \\n       Syntax: --read-execution {TASK-EXEC-ID} {TASK-EXEC-ID} [...]\\n    --delete \\n       Syntax: --delete {TASK-ID} {TASK-ID} [...]\\n    --delete-execution \\n       Syntax: --delete-execution {TASK-EXEC-ID} {TASK-EXEC-ID} [...]\\n    --execute \\n       Syntax: --execute {TASK-ID} {DRY-RUN}\\n          Dry run: true / false\\n\n+task.help.message=\\nUsage: task [options]\\n  Options:\\n    --help \\n    --details\\n    --list\\n       Syntax: --list {TASK-TYPE} \\n          Task type: NOTIFICATION / PROPAGATION / PUSH / SCHEDULED / SYNCHRONIZATION\\n    --list-running-jobs \\n    --list-scheduled-jobs \\n    --read \\n       Syntax: --read {TASK-ID} {TASK-ID} [...]\\n    --read-execution \\n       Syntax: --read-execution {TASK-EXEC-ID} {TASK-EXEC-ID} [...]\\n    --delete \\n       Syntax: --delete {TASK-ID} {TASK-ID} [...]\\n    --delete-all-prop\\n    --delete-execution \\n       Syntax: --delete-execution {TASK-EXEC-ID} {TASK-EXEC-ID} [...]\\n    --execute \\n       Syntax: --execute {TASK-ID} {DRY-RUN}\\n          Dry run: true / false\\n\n user.help.message=\\nUsage: user [options]\\n  Options:\\n    --help \\n    --details \\n    --list \\n    --get-user-key\\n       Syntax: --get-user-key {USERNAME}\\n    --get-username\\n       Syntax: --get-username {USER-ID}\\n    --read-by-userid \\n       Syntax: --read-by-userid {USER-ID} {USER-ID} [...]\\n    --read-by-username\\n       Syntax: --read-by-username {USERNAME} {USERNAME} [...]\\n    --search-by-attribute \\n       Syntax: --search-by-attribute {REALM} {ATTR-NAME}={ATTR-VALUE}\\n    --search-by-role \\n       Syntax: --search-by-role {REALM} {ROLE-NAME}\\n    --search-by-resource \\n       Syntax: --search-by-resource {REALM} {RESOURCE-NAME}\\n    --delete \\n       Syntax: --delete {USER-ID} {USER-ID} [...]\\n    --delete-all \\n       Syntax: --delete-all {REALM}\\n    --delete-by-attribute \\n       Syntax: --delete-by-attribute {REALM} {ATTR-NAME}={ATTR-VALUE}\\n\n workflow.help.message=\\nUsage: workflow [options]\\n  Options:\\n    --help \\n    --export-diagram {ANY-TYPE-KIND}\\n        Any type kind: ANY_OBJECT / USER / GROUP\\n    --export-definition {ANY-TYPE-KIND}\\n        Any type kind: ANY_OBJECT / USER / GROUP\\n"}]}