{"sha":"1c009cadee30715e83824908d59836933ec210d8","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjFjMDA5Y2FkZWUzMDcxNWU4MzgyNDkwOGQ1OTgzNjkzM2VjMjEwZDg=","commit":{"author":{"name":"fmartelli","email":"fabio.martelli@gmail.com","date":"2016-05-30T10:43:22Z"},"committer":{"name":"fmartelli","email":"fabio.martelli@gmail.com","date":"2016-05-30T10:43:22Z"},"message":"Fix for topology integration case about pull task execution","tree":{"sha":"9b21c132036b4aae30700153c22b9afce28a1a57","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/9b21c132036b4aae30700153c22b9afce28a1a57"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/1c009cadee30715e83824908d59836933ec210d8","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/1c009cadee30715e83824908d59836933ec210d8","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/1c009cadee30715e83824908d59836933ec210d8","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/1c009cadee30715e83824908d59836933ec210d8/comments","author":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"committer":{"login":"fmartelli","id":1791932,"node_id":"MDQ6VXNlcjE3OTE5MzI=","avatar_url":"https://avatars.githubusercontent.com/u/1791932?v=4","gravatar_id":"","url":"https://api.github.com/users/fmartelli","html_url":"https://github.com/fmartelli","followers_url":"https://api.github.com/users/fmartelli/followers","following_url":"https://api.github.com/users/fmartelli/following{/other_user}","gists_url":"https://api.github.com/users/fmartelli/gists{/gist_id}","starred_url":"https://api.github.com/users/fmartelli/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fmartelli/subscriptions","organizations_url":"https://api.github.com/users/fmartelli/orgs","repos_url":"https://api.github.com/users/fmartelli/repos","events_url":"https://api.github.com/users/fmartelli/events{/privacy}","received_events_url":"https://api.github.com/users/fmartelli/received_events","type":"User","site_admin":false},"parents":[{"sha":"eb30ae0a2727dfe6e0a968b4f69f65eefbbbb5db","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/eb30ae0a2727dfe6e0a968b4f69f65eefbbbb5db","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/eb30ae0a2727dfe6e0a968b4f69f65eefbbbb5db"}],"stats":{"total":54,"additions":32,"deletions":22},"files":[{"sha":"51c1517aa1409f175a00cfb9d5db7515fc3bf714","filename":"fit/core-reference/src/test/java/org/apache/syncope/fit/console/AbstractConsoleITCase.java","status":"modified","additions":16,"deletions":0,"changes":16,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/1c009cadee30715e83824908d59836933ec210d8/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fconsole%2FAbstractConsoleITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/1c009cadee30715e83824908d59836933ec210d8/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fconsole%2FAbstractConsoleITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fconsole%2FAbstractConsoleITCase.java?ref=1c009cadee30715e83824908d59836933ec210d8","patch":"@@ -104,6 +104,22 @@ public void component(final ListItem<?> object, final IVisit<Component> visit) {\n                 });\n     }\n \n+    protected Component findComponentById(final String searchPath, final String id) {\n+\n+        final Component component = wicketTester.getComponentFromLastRenderedPage(searchPath);\n+\n+        return (component instanceof MarkupContainer ? MarkupContainer.class.cast(component) : component.getPage())\n+                .visitChildren(Component.class, new IVisitor<Component, Component>() {\n+\n+                    @Override\n+                    public void component(final Component object, final IVisit<Component> visit) {\n+                        if (object.getId().equals(id)) {\n+                            visit.stop(object);\n+                        }\n+                    }\n+                });\n+    }\n+\n     protected void closeCallBack(final Component modal) {\n         final List<? extends Behavior> behaviors = modal.getBehaviors();\n         for (Behavior behavior : behaviors) {"},{"sha":"bd62785b75adb2a3a1a7cab7b7d6eed6450e0a81","filename":"fit/core-reference/src/test/java/org/apache/syncope/fit/console/TopologyITCase.java","status":"modified","additions":16,"deletions":22,"changes":38,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/1c009cadee30715e83824908d59836933ec210d8/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fconsole%2FTopologyITCase.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/1c009cadee30715e83824908d59836933ec210d8/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fconsole%2FTopologyITCase.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/fit%2Fcore-reference%2Fsrc%2Ftest%2Fjava%2Forg%2Fapache%2Fsyncope%2Ffit%2Fconsole%2FTopologyITCase.java?ref=1c009cadee30715e83824908d59836933ec210d8","patch":"@@ -20,7 +20,6 @@\n \n import static org.junit.Assert.assertNotNull;\n import static org.junit.Assert.assertNull;\n-import static org.junit.Assert.fail;\n \n import de.agilecoders.wicket.core.markup.html.bootstrap.dialog.Modal;\n import org.apache.wicket.ajax.markup.html.form.AjaxSubmitLink;\n@@ -256,12 +255,6 @@ public void executePullTask() {\n                 + \"container:content:startAt:container:content:togglePanelContainer:startAtForm:startAt\");\n         wicketTester.assertInfoMessages(\"Operation executed successfully\");\n \n-        try {\n-            // requires a short delay\n-            Thread.sleep(5000);\n-        } catch (Exception ignore) {\n-        }\n-\n         component = findComponentByProp(\"name\", \"body:toggle:outerObjectsRepeater:2:outer:form:content:tasks:\"\n                 + \"firstLevelContainer:first:container:content:searchContainer:resultTable:tablePanel:groupForm:\"\n                 + \"checkgroup:dataTable\", \"TestDB Task\");\n@@ -273,30 +266,31 @@ public void executePullTask() {\n                 \"Executions of task &#039;TestDB Task&#039;\");\n \n         int iteration = 0;\n-        try {\n-            wicketTester.assertComponent(\n-                    \"body:toggle:outerObjectsRepeater:2:outer:form:content:tasks:secondLevelContainer:\"\n-                    + \"second:executions:firstLevelContainer:first:container:content:searchContainer:resultTable:\"\n-                    + \"tablePanel:groupForm:checkgroup:dataTable:body:rows:1:cells:6:cell:panelView:viewLink\",\n-                    AjaxLink.class);\n-        } catch (Exception e) {\n-            if (iteration < 10) {\n+        do {\n+            try {\n+                wicketTester.assertComponent(\n+                        \"body:toggle:outerObjectsRepeater:2:outer:form:content:tasks:secondLevelContainer:\"\n+                        + \"second:executions:firstLevelContainer:first:container:content:searchContainer:resultTable:\"\n+                        + \"tablePanel:groupForm:checkgroup:dataTable:body:rows:1:cells:6:cell:panelView:viewLink\",\n+                        AjaxLink.class);\n+                iteration = 10;\n+            } catch (AssertionError e) {\n                 try {\n                     // requires a short delay\n                     Thread.sleep(1000);\n                 } catch (Exception ignore) {\n                 }\n-                \n-                wicketTester.clickLink(\n+\n+                component = findComponentById(\n                         \"body:toggle:outerObjectsRepeater:2:outer:form:content:tasks:secondLevelContainer:second:\"\n                         + \"executions:firstLevelContainer:first:container:content:searchContainer:resultTable:\"\n-                        + \"tablePanel:groupForm:checkgroup:dataTable:topToolbars:toolbars:1:headers:24:header:label:\"\n-                        + \"panelReload:reloadLink\");\n+                        + \"tablePanel:groupForm:checkgroup:dataTable:topToolbars:toolbars:1:headers\", \"panelReload\");\n+\n+                wicketTester.executeAjaxEvent(component.getPageRelativePath() + \":reloadLink\", Constants.ON_CLICK);\n                 iteration++;\n-            } else {\n-                fail();\n             }\n-        }\n+        } while (iteration < 10);\n+\n         wicketTester.clickLink(\"body:toggle:outerObjectsRepeater:2:outer:form:content:tasks:secondLevelContainer:\"\n                 + \"second:executions:firstLevelContainer:first:container:content:searchContainer:resultTable:\"\n                 + \"tablePanel:groupForm:checkgroup:dataTable:body:rows:1:cells:6:cell:panelView:viewLink\");"}]}