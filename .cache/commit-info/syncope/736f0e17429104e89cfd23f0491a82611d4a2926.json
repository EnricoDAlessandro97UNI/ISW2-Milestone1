{"sha":"736f0e17429104e89cfd23f0491a82611d4a2926","node_id":"MDY6Q29tbWl0NjM2ODc5MDYyOjczNmYwZTE3NDI5MTA0ZTg5Y2ZkMjNmMDQ5MWE4MjYxMWQ0YTI5MjY=","commit":{"author":{"name":"Massimiliano Perrone","email":"massi@apache.org","date":"2014-07-07T09:38:18Z"},"committer":{"name":"Massimiliano Perrone","email":"massi@apache.org","date":"2014-07-07T09:38:18Z"},"message":"Fixed #SYNCOPE-532\n\ngit-svn-id: https://svn.apache.org/repos/asf/syncope/trunk@1608386 13f79535-47bb-0310-9956-ffa450edef68","tree":{"sha":"42d45deaf385188f81df2e9ba4e2617097d3f125","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/trees/42d45deaf385188f81df2e9ba4e2617097d3f125"},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/git/commits/736f0e17429104e89cfd23f0491a82611d4a2926","comment_count":0,"verification":{"verified":false,"reason":"unsigned","signature":null,"payload":null}},"url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/736f0e17429104e89cfd23f0491a82611d4a2926","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/736f0e17429104e89cfd23f0491a82611d4a2926","comments_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/736f0e17429104e89cfd23f0491a82611d4a2926/comments","author":null,"committer":null,"parents":[{"sha":"b8ce4ce9ed7d73dd892d706338e3034d090b32a8","url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/commits/b8ce4ce9ed7d73dd892d706338e3034d090b32a8","html_url":"https://github.com/EnricoDAlessandro97UNI/syncope/commit/b8ce4ce9ed7d73dd892d706338e3034d090b32a8"}],"stats":{"total":92,"additions":66,"deletions":26},"files":[{"sha":"3bdc309694ef74e9972a944dc76dfeb2252ba4d7","filename":"installer/src/main/java/org/apache/syncope/installer/containers/AbstractContainer.java","status":"added","additions":27,"deletions":0,"changes":27,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/736f0e17429104e89cfd23f0491a82611d4a2926/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FAbstractContainer.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/736f0e17429104e89cfd23f0491a82611d4a2926/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FAbstractContainer.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FAbstractContainer.java?ref=736f0e17429104e89cfd23f0491a82611d4a2926","patch":"@@ -0,0 +1,27 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *   http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing,\n+ * software distributed under the License is distributed on an\n+ * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n+ * KIND, either express or implied.  See the License for the\n+ * specific language governing permissions and limitations\n+ * under the License.\n+ */\n+package org.apache.syncope.installer.containers;\n+\n+public abstract class AbstractContainer {\n+\n+    protected static final String CORE_RELATIVE_PATH = \"%s/%s/core/target/syncope.war\";\n+\n+    protected static final String CONSOLE_RELATIVE_PATH = \"%s/%s/console/target/syncope-console.war\";\n+\n+}"},{"sha":"771526f336f225b9890e3927dc0be8055037ed21","filename":"installer/src/main/java/org/apache/syncope/installer/containers/Glassfish.java","status":"modified","additions":20,"deletions":5,"changes":25,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/736f0e17429104e89cfd23f0491a82611d4a2926/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FGlassfish.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/736f0e17429104e89cfd23f0491a82611d4a2926/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FGlassfish.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FGlassfish.java?ref=736f0e17429104e89cfd23f0491a82611d4a2926","patch":"@@ -18,13 +18,28 @@\n  */\n package org.apache.syncope.installer.containers;\n \n-public class Glassfish {\n+public class Glassfish extends AbstractContainer {\n \n-    public static final String deploySyncopeCore\n-            = \"%s/%s/core/target/syncope.war\";\n+    private final String installPath;\n \n-    public static final String deploySyncopeConsole\n-            = \"%s/%s/console/target/syncope-console.war\";\n+    private final String artifactId;\n+\n+    public Glassfish(final String installPath, final String artifactId) {\n+        this.installPath = installPath;\n+        this.artifactId = artifactId;\n+    }\n+\n+    public String deployCore() {\n+        return deploy(CORE_RELATIVE_PATH);\n+    }\n+\n+    public String deployConsole() {\n+        return deploy(CONSOLE_RELATIVE_PATH);\n+    }\n+\n+    public String deploy(final String what) {\n+        return String.format(what, installPath, artifactId);\n+    }\n \n     public static final String CREATE_JAVA_OPT_COMMAND = \"/bin/asadmin create-jvm-options\"\n             + \"-Dcom.sun.enterprise.overrideablejavaxpackages=javax.ws.rs,javax.ws.rs.core,javax.ws.rs.ext\";"},{"sha":"bca3af5a157d2175d12d4533c913229ad8458588","filename":"installer/src/main/java/org/apache/syncope/installer/containers/Tomcat.java","status":"modified","additions":3,"deletions":3,"changes":6,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/736f0e17429104e89cfd23f0491a82611d4a2926/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FTomcat.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/736f0e17429104e89cfd23f0491a82611d4a2926/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FTomcat.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2FTomcat.java?ref=736f0e17429104e89cfd23f0491a82611d4a2926","patch":"@@ -23,16 +23,16 @@\n import org.apache.syncope.installer.utilities.Commands;\n import org.apache.syncope.installer.utilities.HttpUtils;\n \n-public class Tomcat {\n+public class Tomcat extends AbstractContainer {\n \n     private static final String UNIX_DEPLOY_SYNCOPE_CORE_QUERY\n-            = \"/manager/text/deploy?path=/syncope&war=file:%s/%s/core/target/syncope.war\";\n+            = \"/manager/text/deploy?path=/syncope&war=file:\" + CORE_RELATIVE_PATH;\n \n     private static final String WIN_DEPLOY_SYNCOPE_CORE_QUERY\n             = \"/manager/text/deploy?path=/syncope&war=file:%s\\\\%s\\\\core\\\\target\\\\syncope.war\";\n \n     private static final String UNIX_DEPLOY_SYNCOPE_CONSOLE_QUERY\n-            = \"/manager/text/deploy?path=/syncope-console&war=file:%s/%s/console/target/syncope-console.war\";\n+            = \"/manager/text/deploy?path=/syncope-console&war=file:\" + CONSOLE_RELATIVE_PATH;\n \n     private static final String WIN_DEPLOY_SYNCOPE_CONSOLE_QUERY\n             = \"/manager/text/deploy?path=/syncope-console&war=file:%s\\\\%s\\\\console\\\\target\\\\syncope-console.war\";"},{"sha":"054d6542036d69b361b2f9d3938a461b7e4a9a62","filename":"installer/src/main/java/org/apache/syncope/installer/containers/jboss/JBoss.java","status":"modified","additions":4,"deletions":7,"changes":11,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/736f0e17429104e89cfd23f0491a82611d4a2926/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2Fjboss%2FJBoss.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/736f0e17429104e89cfd23f0491a82611d4a2926/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2Fjboss%2FJBoss.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fcontainers%2Fjboss%2FJBoss.java?ref=736f0e17429104e89cfd23f0491a82611d4a2926","patch":"@@ -18,14 +18,11 @@\n  */\n package org.apache.syncope.installer.containers.jboss;\n \n+import org.apache.syncope.installer.containers.AbstractContainer;\n import org.apache.syncope.installer.utilities.HttpUtils;\n import org.apache.syncope.installer.utilities.JsonUtils;\n \n-public class JBoss {\n-\n-    private final String core = \"%s/%s/core/target/syncope.war\";\n-\n-    private final String console = \"%s/%s/console/target/syncope-console.war\";\n+public class JBoss extends AbstractContainer {\n \n     private final String addContentUrl = \"http://%s:%s/management/add-content\";\n \n@@ -56,11 +53,11 @@ public JBoss(final boolean jbossSsl, final String jbossHost, final String jbossP\n     }\n \n     public boolean deployCore() {\n-        return deploy(core, \"syncope.war\");\n+        return deploy(CORE_RELATIVE_PATH, \"syncope.war\");\n     }\n \n     public boolean deployConsole() {\n-        return deploy(console, \"syncope-console.war\");\n+        return deploy(CONSOLE_RELATIVE_PATH, \"syncope-console.war\");\n     }\n \n     public boolean deploy(final String whatDeploy, final String warName) {"},{"sha":"f9bf3f466b140668ed6f3cebeacd13b545277cf9","filename":"installer/src/main/java/org/apache/syncope/installer/files/Pom.java","status":"modified","additions":2,"deletions":2,"changes":4,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/736f0e17429104e89cfd23f0491a82611d4a2926/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Ffiles%2FPom.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/736f0e17429104e89cfd23f0491a82611d4a2926/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Ffiles%2FPom.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Ffiles%2FPom.java?ref=736f0e17429104e89cfd23f0491a82611d4a2926","patch":"@@ -39,8 +39,8 @@ public class Pom {\n             + \"--><project xmlns=\\\"http://maven.apache.org/POM/4.0.0\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xsi:schemaLocation=\\\"http://maven.apache.org/POM/4.0.0          http://maven.apache.org/maven-v4_0_0.xsd\\\">\\n\"\n             + \"\\n\" + \"  <modelVersion>4.0.0</modelVersion>\\n\" + \"\\n\" + \"  <parent>\\n\"\n             + \"    <groupId>org.apache.syncope</groupId>\\n\" + \"    <artifactId>syncope</artifactId>\\n\"\n-            + \"    <version xmlns=\\\"\\\">1.2.0-SNAPSHOT</version>\\n\" + \"  </parent>\\n\" + \"\\n\" + \"  <properties>\\n\"\n-            + \"    <syncope.version xmlns=\\\"\\\">1.2.0-SNAPSHOT</syncope.version>\\n\"\n+            + \"    <version xmlns=\\\"\\\">%s</version>\\n\" + \"  </parent>\\n\" + \"\\n\" + \"  <properties>\\n\"\n+            + \"    <syncope.version xmlns=\\\"\\\">%s</syncope.version>\\n\"\n             + \"    <secretKey>123456789asdfghj</secretKey>\\n\" + \"    <anonymousKey>aoshdaiuhdaiuhd</anonymousKey>\\n\"\n             + \"  </properties>\\n\" + \"\\n\" + \"  <name>Apache Syncope sample project</name>\\n\"\n             + \"  <groupId>net.tirasa</groupId>\\n\" + \"  <artifactId>syncope</artifactId>\\n\""},{"sha":"070cf557726bea9783a89d4568bab4baf9c9e79b","filename":"installer/src/main/java/org/apache/syncope/installer/processes/ArchetypeProcess.java","status":"modified","additions":2,"deletions":1,"changes":3,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/736f0e17429104e89cfd23f0491a82611d4a2926/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fprocesses%2FArchetypeProcess.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/736f0e17429104e89cfd23f0491a82611d4a2926/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fprocesses%2FArchetypeProcess.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fprocesses%2FArchetypeProcess.java?ref=736f0e17429104e89cfd23f0491a82611d4a2926","patch":"@@ -43,7 +43,8 @@ public void run(final AbstractUIProcessHandler handler, final String[] args) {\n         }\n         exec(Commands.createArchetype(mavenDir, syncopeVersion, groupId, artifactId, secretKey, anonymousKey),\n                 handler, installPath);\n-        writeToFile(new File(installPath + \"/\" + artifactId + Pom.PATH), Pom.FILE);\n+        writeToFile(new File(installPath + \"/\" + artifactId + Pom.PATH),\n+                String.format(Pom.FILE, syncopeVersion, syncopeVersion));\n \n         exec(Commands.createDirectory(logsDirectory), handler, null);\n "},{"sha":"5145fe943b05217b4e4d42a47b7b18db023f25de","filename":"installer/src/main/java/org/apache/syncope/installer/processes/ContainerProcess.java","status":"modified","additions":5,"deletions":4,"changes":9,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/736f0e17429104e89cfd23f0491a82611d4a2926/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fprocesses%2FContainerProcess.java","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/736f0e17429104e89cfd23f0491a82611d4a2926/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fprocesses%2FContainerProcess.java","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fsyncope%2Finstaller%2Fprocesses%2FContainerProcess.java?ref=736f0e17429104e89cfd23f0491a82611d4a2926","patch":"@@ -149,10 +149,11 @@ public void run(final AbstractUIProcessHandler handler, final String[] args) {\n             case GLASSFISH:\n                 final String createJavaOptCommand = \"sh \" + glassfishDir + Glassfish.CREATE_JAVA_OPT_COMMAND;\n                 exec(createJavaOptCommand, handler, null);\n-                exec(\"sh \" + glassfishDir + Glassfish.DEPLOY_COMMAND\n-                        + String.format(Glassfish.deploySyncopeCore, installPath, artifactId), handler, null);\n-                exec(\"sh \" + glassfishDir + Glassfish.DEPLOY_COMMAND\n-                        + String.format(Glassfish.deploySyncopeConsole, installPath, artifactId), handler, null);\n+\n+                final Glassfish glassfish = new Glassfish(installPath, artifactId);\n+\n+                exec(\"sh \" + glassfishDir + Glassfish.DEPLOY_COMMAND + glassfish.deployCore(), handler, null);\n+                exec(\"sh \" + glassfishDir + Glassfish.DEPLOY_COMMAND + glassfish.deployConsole(), handler, null);\n                 break;\n         }\n     }"},{"sha":"2297b0df8befb3cac43dfdf0a55a4329d94a5fba","filename":"installer/src/main/resources/izpack/install.xml","status":"modified","additions":2,"deletions":3,"changes":5,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/736f0e17429104e89cfd23f0491a82611d4a2926/installer%2Fsrc%2Fmain%2Fresources%2Fizpack%2Finstall.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/736f0e17429104e89cfd23f0491a82611d4a2926/installer%2Fsrc%2Fmain%2Fresources%2Fizpack%2Finstall.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fresources%2Fizpack%2Finstall.xml?ref=736f0e17429104e89cfd23f0491a82611d4a2926","patch":"@@ -24,7 +24,6 @@ under the License.\n                      http://izpack.org/schema/5.0/izpack-installation-5.0.xsd\">\n   <properties>\n     <property name=\"info.appName\" value=\"Apache Syncope\"/>\n-    <property name=\"info.appVersion\" value=\"@{project.version}\"/>\n     <property name=\"info.url\" value=\"http://syncope.apache.org\"/>\n     <property name=\"info.company.name\" value=\"Tirasa S.r.l.\"/>\n     <property name=\"info.company.email\" value=\"info@tirasa.net\"/>\n@@ -118,7 +117,7 @@ under the License.\n   </conditions>\n   \n   <resources>\n-    <res id=\"installer.jar\" src=\"../syncope-installer-1.2.0-SNAPSHOT.jar\"/>\n+    <res id=\"installer.jar\" src=\"../syncope-installer-@{syncope.version}.jar\"/>\n     \n     <res id=\"Installer.image\" src=\"img/apache-syncope-vert.png\" />\n     \n@@ -132,7 +131,7 @@ under the License.\n     <res id=\"ProcessPanel.Spec.xml\" src=\"ProcessPanel.Spec.xml\"/>\n   </resources>\n   \n-  <jar src=\"../syncope-installer-1.2.0-SNAPSHOT.jar\" stage=\"install\"/>\n+  <jar src=\"../syncope-installer-@{syncope.version}.jar\" stage=\"install\"/>\n   <jar src=\"lib/commons-logging-1.1.3.jar\"/>\n   <jar src=\"lib/commons-codec-1.9.jar\"/>\n   <jar src=\"lib/commons-io-2.4.jar\"/>"},{"sha":"0c7f8284a2db098834c02d8fe08380381dc682eb","filename":"installer/src/main/resources/izpack/userInputSpec.xml","status":"modified","additions":1,"deletions":1,"changes":2,"blob_url":"https://github.com/EnricoDAlessandro97UNI/syncope/blob/736f0e17429104e89cfd23f0491a82611d4a2926/installer%2Fsrc%2Fmain%2Fresources%2Fizpack%2FuserInputSpec.xml","raw_url":"https://github.com/EnricoDAlessandro97UNI/syncope/raw/736f0e17429104e89cfd23f0491a82611d4a2926/installer%2Fsrc%2Fmain%2Fresources%2Fizpack%2FuserInputSpec.xml","contents_url":"https://api.github.com/repos/EnricoDAlessandro97UNI/syncope/contents/installer%2Fsrc%2Fmain%2Fresources%2Fizpack%2FuserInputSpec.xml?ref=736f0e17429104e89cfd23f0491a82611d4a2926","patch":"@@ -53,7 +53,7 @@ under the License.\n     </field>\n     <field type=\"space\"/>\n     <field type=\"text\" variable=\"mvn.syncope.version\">\n-      <spec id=\"mvn.syncope.version.id\" size=\"20\" set=\"1.2.0-SNAPSHOT\"/>\n+      <spec id=\"mvn.syncope.version.id\" size=\"20\" set=\"${syncope.version}\"/>\n     </field>\n     <!--    <field type=\"space\"/>\n     <field type=\"password\" variable=\"mvn.syncope.admin.password\">"}]}